-- MySQL dump 10.13  Distrib 5.6.17, for Win64 (x86_64)
--
-- Host: 174.143.132.245    Database: 649984_bluhorn
-- ------------------------------------------------------
-- Server version	5.1.70-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `FLX_TEMPLATE`
--

DROP TABLE IF EXISTS `FLX_TEMPLATE`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `FLX_TEMPLATE` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `templateID` int(10) unsigned NOT NULL,
  `name` varchar(100) NOT NULL,
  `modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `title` varchar(128) NOT NULL DEFAULT '',
  `source` longblob NOT NULL,
  `template` varchar(64) NOT NULL DEFAULT '',
  `sequence` int(10) unsigned DEFAULT NULL,
  `media` varchar(32) DEFAULT NULL,
  `version` float(10,1) unsigned NOT NULL DEFAULT '1.0',
  `editWith` varchar(32) NOT NULL DEFAULT 'ace',
  `doctype` varchar(128) NOT NULL DEFAULT '',
  `status` varchar(32) NOT NULL DEFAULT '',
  `expireStamp` datetime NOT NULL,
  `beginStamp` datetime NOT NULL,
  `views` bigint(20) unsigned NOT NULL,
  `isDefault` tinyint(1) NOT NULL DEFAULT '0',
  `themeID` int(10) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=106 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `FLX_TEMPLATE`
--

LOCK TABLES `FLX_TEMPLATE` WRITE;
/*!40000 ALTER TABLE `FLX_TEMPLATE` DISABLE KEYS */;
INSERT  IGNORE INTO `FLX_TEMPLATE` (`id`, `templateID`, `name`, `modified`, `title`, `source`, `template`, `sequence`, `media`, `version`, `editWith`, `doctype`, `status`, `expireStamp`, `beginStamp`, `views`, `isDefault`, `themeID`) VALUES (1,0,'home','2015-05-05 06:07:41','','{extends file=\"db:kingboard-framework\"}\n\n	{block name=\"footer-js\"}\n<script type=\'text/javascript\' src=\'http://fullcalendar.io/js/fullcalendar-2.1.1/gcal.js\'></script>\n<script>\n$( function() {\n\n	$(\'#calendar\').fullCalendar({\n\n    eventSources: [\n\n        // your event source\n        {\n		url: \'/calendar/ajax/campaigns{$url}\',\n        }\n\n    ]\n\n	});\n});\n\n</script>\n	{/block}\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(2,0,'kingboard-framework','2015-05-06 14:23:18','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/\"}\">\n	<title>{block name=\"title\"}Dashboard | BluHorn{/block}</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n	<meta name=\"description\" content=\"BluHorn - Media Buying Platform\">\n	<meta name=\"author\" content=\"BluHorn (powered by FileLogix)\">\n\n	<meta http-equiv=\"cache-control\" content=\"max-age=0\" />\n	<meta http-equiv=\"cache-control\" content=\"no-cache\" />\n	<meta http-equiv=\"expires\" content=\"0\" />\n	<meta http-equiv=\"expires\" content=\"Tue, 01 Jan 1980 1:00:00 GMT\" />\n	<meta http-equiv=\"pragma\" content=\"no-cache\" />\n\n	<script type=\"text/javascript\">\n\n		var runCount = 0;\n\n		window.onerror = function (errorMsg, url, lineNum, column, errorObj) {\n\n		    if (errorMsg[\"namespace\"].substring(0,2) === \"bv\") {\n				return false;\n		    }\n\n		    else if (runCount < 1) {\n			runCount++;\n\n			console.log(\'Error: \' + errorMsg + \' Script: \' + url + \' Line: \' + lineNum + \' Column: \' + column + \' StackTrace: \' +  errorObj);\n\n		   	 if(encodeURIComponent) {\n				var error = \'e=\' + encodeURIComponent(errorMsg) + \'&u=\' + encodeURIComponent(url) + \'&l=\' + encodeURIComponent(lineNum);\n\n				var data = new FormData();\n				data.append(\'errorMsg\', errorMsg);\n				data.append(\'url\', url);\n				data.append(\'lineNumber\', lineNum);\n				data.append(\'column\', column);\n				data.append(\'errorObj\', errorObj);\n	\n				var xmlRequest = new XMLHttpRequest(); \n				xmlRequest.open(\"POST\", \"/support/ajax/report/error/\", true);\n				xmlRequest.onreadystatechange = function () {\n				if (xmlRequest.readyState != 4 || xmlRequest.status != 200) return; \n					console.log(xmlRequest.responseText);\n				};\n				xmlRequest.send(data);\n			   	alert( \"An error has occurred while loading this page.\\nSome features may not work correctly.\\nA case has been logged.\" );\n				return true;\n			}\n			alert(\"An error has occurred while loading this page.\\nSome features may not work correctly.\\nPlease contact support if you need further assistance.\");\n		     }\n		}\n\n	</script>\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/lib/fontawesome/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/skins/darkblue.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link type=\"text/css\" rel=\"stylesheet\" href=\"/assets/css/jquery.simplecolorpicker.css\">\n	<link type=\"text/css\" rel=\"stylesheet\" href=\"/assets/css/jquery.simplecolorpicker-glyphicons.css\">\n{*\n	<!-- CSS for demo style switcher. you can remove this -->\n	<link href=\"/demo-style-switcher/assets/css/style-switcher.css\" rel=\"stylesheet\" type=\"text/css\">\n*}\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"/assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"/assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"/assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"/assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n	{if $hideSideBar}\n		<style>\n			.left-sidebar .sub-menu {\n				display: none;\n				overflow: hidden;\n			}\n		</style>\n	{/if}\n\n			\n\n	{block name=\"header-css\"}\n\n	{/block}\n\n	{block name=\"header-js\"}\n\n\n\n	{/block}\n\n</head>\n\n<body class=\"dashboard\">\n\n	<!-- WRAPPER -->\n	{block name=\"body\"}\n<div id=\"mainBody\">\n	<div class=\"wrapper\">\n\n		<!-- TOP GENERAL ALERT -->\n		<div class=\"alert alert-info top-general-alert\">\n			<span>The system has been upgraded to the new version. Click the <a href=\"#\">release notes</a> to see the changes.</span>\n			<a type=\"button\" class=\"close\">&times;</a>\n		</div>\n		<!-- END TOP GENERAL ALERT -->\n\n		<!-- TOP BAR -->\n		<div class=\"top-bar\">\n			<div class=\"container\">\n				<div class=\"row\">\n					<!-- logo -->\n					<div class=\"col-md-2 col-lg-2 logo\">\n						<a href=\"/\">\n							<img src=\"/assets/img/kingboard-logo-white.png\" alt=\"BluHorn - Dashboard\" />\n						</a>\n						<h1 class=\"sr-only\">BluHorn Dashboard</h1>\n					</div>\n					<!-- end logo -->\n					<div class=\"col-md-10\">\n						<div class=\"row\">\n							<div class=\"col-md-3 hidden-xs hidden-sm\">\n								<!-- search box -->\n							<form method=get id=\"searchForm\" class=\"form-horizontal label-left\">\n								<div id=\"tour-searchbox\" class=\"input-group searchbox {if $userID != 1}hidden{/if}\" style=\"width: 30em;\">\n										<input type=\"search\" name=\"q\" id=\"searchText\" class=\"form-control input-lg\" placeholder=\"enter keyword here...\" onkeydown=\"if (event.keyCode == 13) { search(); return false; }\">\n										<span class=\"input-group-btn\">\n											<button class=\"btn btn-default\" type=\"button\" onclick=\"search();\"><i class=\"fa fa-search\"></i>\n											</button>\n										</span>\n								</div>\n							</form>\n								<!-- end search box -->\n							</div>\n							<div class=\"col-md-3 hidden-md hidden-lg\">\n								&nbsp;\n							</div>											<div class=\"col-md-9\">\n								<div class=\"top-bar-right\">\n									<!-- responsive menu bar icon -->\n									<a href=\"#\" class=\"hidden-md hidden-lg main-nav-toggle\"><i class=\"fa fa-bars\"></i></a>\n									<!-- end responsive menu bar icon -->\n									<button type=\"button\" id=\"restart-tour\" class=\"btn btn-link\" disabled=\"disabled\"><i class=\"fa fa-refresh\"></i> Restart Tour</button> \n									<div class=\"notifications hide\">\n										<ul>\n\n											<!-- notification: general -->\n											<li class=\"notification-item general\">\n												<div class=\"btn-group\">\n													<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n														<i class=\"fa fa-bell\"></i>\n														<span class=\"count\">8</span>\n														<span class=\"circle\"></span>\n													</a>\n													<ul class=\"dropdown-menu\" role=\"menu\">\n														<li class=\"notification-header\">\n															<em>You have 8 notifications</em>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-comment green-font\"></i>\n																<span class=\"text\">New comment on the blog post</span>\n																<span class=\"timestamp\">1 minute ago</span>\n															</a>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-user green-font\"></i>\n																<span class=\"text\">New registered user</span>\n																<span class=\"timestamp\">12 minutes ago</span>\n															</a>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-comment green-font\"></i>\n																<span class=\"text\">New comment on the blog post</span>\n																<span class=\"timestamp\">18 minutes ago</span>\n															</a>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-shopping-cart red-font\"></i>\n																<span class=\"text\">4 new sales order</span>\n																<span class=\"timestamp\">4 hours ago</span>\n															</a>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-edit yellow-font\"></i>\n																<span class=\"text\">3 product reviews awaiting moderation</span>\n																<span class=\"timestamp\">1 day ago</span>\n															</a>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-comment green-font\"></i>\n																<span class=\"text\">New comment on the blog post</span>\n																<span class=\"timestamp\">3 days ago</span>\n															</a>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-comment green-font\"></i>\n																<span class=\"text\">New comment on the blog post</span>\n																<span class=\"timestamp\">Oct 15</span>\n															</a>\n														</li>\n														<li>\n															<a href=\"#\">\n																<i class=\"fa fa-warning red-font\"></i>\n																<span class=\"text red-font\">Low disk space!</span>\n																<span class=\"timestamp\">Oct 11</span>\n															</a>\n														</li>\n														<li class=\"notification-footer\">\n															<a href=\"#\">View All Notifications</a>\n														</li>\n													</ul>\n												</div>\n											</li>\n											<!-- end notification: general -->\n										</ul>\n									</div>\n\n									<!-- logged user and the menu -->\n									<div class=\"logged-user\">\n										<div class=\"btn-group\">\n											<a href=\"/user/{$username}\" class=\"btn btn-link dropdown-toggle\" data-toggle=\"dropdown\">\n												<img src=\"https://www.gravatar.com/avatar/{$gravatar|default:\"20\"}?s=20&r=pg&d=mm\" />\n												<span class=\"name\">{$shortname}</span>\n												<span class=\"caret\"></span>\n											</a>\n											<ul class=\"dropdown-menu\" role=\"menu\">\n												<li>\n													<a href=\"/user/account/{$username}\">\n														<i class=\"fa fa-user\"></i>\n														<span class=\"text\">Profile</span>\n													</a>\n												</li>\n												<li>\n													<a href=\"/user/settings/{$username}\">\n														<i class=\"fa fa-cog\"></i>\n														<span class=\"text\">Settings</span>\n													</a>\n												</li>\n												<li>\n													<a href=\"/logout\">\n														<i class=\"fa fa-power-off\"></i>\n														<span class=\"text\">Logout</span>\n													</a>\n												</li>\n											</ul>\n										</div>\n									</div>\n									<!-- end logged user and the menu -->\n								</div>\n								<!-- /top-bar-right -->\n							</div>\n						</div>\n						<!-- /row -->\n					</div>\n				</div>\n				<!-- /row -->\n			</div>\n			<!-- /container -->\n		</div>\n		<!-- /top -->\n\n\n		<!-- BOTTOM: LEFT NAV AND RIGHT MAIN CONTENT -->\n		<div class=\"bottom\">\n			<div class=\"container\">\n				<div class=\"row\">\n					<!-- left sidebar -->\n					<div class=\"col-md-2 left-sidebar   {if $hideSideBar}minified{/if}\">\n\n						<!-- main-nav -->\n						<nav class=\"main-nav\">\n\n							<ul class=\"main-menu\">\n								<li class=\"{$activeSideBar.dashboard}\"><a href=\"home\"><i class=\"fa fa-dashboard fa-fw\"></i><span class=\"text\">Dashboard</span></a>\n								</li>\n								<li class=\"{$activeSideBar.clients}\"><a href=\"clients\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-users fa-fw\"></i><span class=\"text\">Clients</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/clients/create\">\n												<span class=\"text\">Add New Client</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/clients/all\">\n												<span class=\"text\">Show All Clients</span>\n											</a>\n										</li>									</ul>\n								</li>\n								<li class=\"{$activeSideBar.campaigns}\"><a href=\"campaigns\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-rocket fw\"></i><span class=\"text\">Campaigns</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/campaigns/create\">\n												<span class=\"text\">Create A New Campaign</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/campaigns/pending\">\n												<span class=\"text\">Pending Campaigns</span>\n											</a>\n										</li>											<li>\n											<a href=\"/campaigns/active\">\n												<span class=\"text\">Active Campaigns</span>\n											</a>\n										</li>											<li>\n											<a href=\"/campaigns/archived\">\n												<span class=\"text\">Archived Campaigns</span>\n											</a>\n										</li>											<li>\n											<a href=\"/campaigns/all\">\n												<span class=\"text\">All Campaigns</span>\n											</a>\n										</li>									</ul>\n								</li>\n								<li class=\"{$activeSideBar.worksheets}\"><a href=\"worksheets\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-table fw\"></i><span class=\"text\">Worksheets</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n{*\n										<li>\n											<a href=\"/worksheets/create\">\n												<span class=\"text\">Create A New Worksheet</span>\n											</a>\n										</li>\n*}\n										<li>\n											<a href=\"/worksheets/pending\">\n												<span class=\"text\">Pending Worksheets</span>\n											</a>\n										</li>											<li>\n											<a href=\"/worksheets/active\">\n												<span class=\"text\">Active Worksheets</span>\n											</a>\n										</li>											<li>\n											<a href=\"/worksheets/archived\">\n												<span class=\"text\">Archived Worksheets</span>\n											</a>\n										</li>											<li>\n											<a href=\"/worksheets/all\">\n												<span class=\"text\">All Worksheets</span>\n											</a>\n										</li>									</ul>\n								</li>\n\n								<li class=\"{$activeSideBar.orders}\"><a href=\"orders\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-gavel fw\"></i><span class=\"text\">Orders</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/orders/pending\">\n												<span class=\"text\">Pending Orders</span>\n											</a>\n										</li>	\n										<li>\n											<a href=\"/orders/active\">\n												<span class=\"text\">Active Orders</span>\n											</a>\n										</li>											<li>\n											<a href=\"/orders/archived\">\n												<span class=\"text\">Archived Orderss</span>\n											</a>\n										</li>											<li>\n											<a href=\"/orders/cancelled\">\n												<span class=\"text\">Cancelled Orderss</span>\n											</a>\n										</li>											<li>\n											<a href=\"/orders/all\">\n												<span class=\"text\">All Orders</span>\n											</a>\n										</li>									</ul>\n								</li>\n{if $user.useProjects}\n								<li class=\"{$activeSideBar.projects}\"><a href=\"projects\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-tree fw\"></i><span class=\"text\">Projects</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/projects/create\">\n												<span class=\"text\">New Project</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/projects/active\">\n												<span class=\"text\">Active Projects</span>\n											</a>\n										</li>											<li>\n											<a href=\"/projects/completed\">\n												<span class=\"text\">Completed Projects</span>\n											</a>\n										</li>											<li>\n											<a href=\"/projects/tasks/open\">\n												<span class=\"text\">Open Tasks</span>\n											</a>\n										</li>											<li>\n											<a href=\"/projects/all\">\n												<span class=\"text\">All Projects</span>\n											</a>\n										</li>									</ul>\n								</li>\n{/if}\n								<li class=\"{$activeSideBar.reports}\"><a href=\"reports\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-briefcase fw\"></i><span class=\"text\">Reports</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/reports/summary/tv\">\n												<span class=\"text\">TV Summary</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/summary/tvcable\">\n												<span class=\"text\">TV/Cable Summary</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/summary/radio\">\n												<span class=\"text\">Radio Summary</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/summary/cable\">\n												<span class=\"text\">Cable Summary</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/summary/print\">\n												<span class=\"text\">Print Summary</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/summary/digital\">\n												<span class=\"text\">Digital Summary</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/summary/outdoor\">\n												<span class=\"text\">Outdoor Summary</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/tracking/billing\">\n												<span class=\"text\">Billing Tracking</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/reports/tracking/ordered\">\n												<span class=\"text\">Order Tracking</span>\n											</a>\n										</li>	\n										<li>\n											<a href=\"/reports/tracking/pending\">\n												<span class=\"text\">Pending Tracking</span>\n											</a>\n										</li>	\n\n										<li>\n											<a href=\"/reports/planning/media\">\n												<span class=\"text\">Media Planning</span>\n											</a>\n										</li>\n								</ul>\n								</li>\n								<li class=\"{$activeSideBar.vendors}\"><a href=\"vendors\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-truck fw\"></i><span class=\"text\">Vendors</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/vendors/create\">\n												<span class=\"text\">Add a New Vendor</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/vendors/all\">\n												<span class=\"text\">Show All Vendors</span>\n											</a>\n										</li>									</ul>\n								</li>\n								<li class=\"{$activeSideBar.markets}\"><a href=\"markets\"><i class=\"fa fa-map-marker fa-fw\"></i><span class=\"text\">Markets</span></a>\n								</li>\n{if $user.useInventory}\n								<li class=\"{$activeSideBar.inventory}\"><a href=\"inventory\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-cube fw\"></i><span class=\"text\">Inventory</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/inventory/imports\">\n												<span class=\"text\">Imports</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/programs/create\">\n												<span class=\"text\">Add New Program</span>\n											</a>\n										</li>											<li>\n											<a href=\"/programs/all\">\n												<span class=\"text\">Show All Programs</span>\n											</a>\n										</li>											<li>\n											<a href=\"/publication/add\">\n												<span class=\"text\">Add New Publication</span>\n											</a>\n										</li>											<li>\n											<a href=\"/publications/all\">\n												<span class=\"text\">Show All Publications</span>\n											</a>\n										</li>												<li>\n											<a href=\"/inventory/all\">\n												<span class=\"text\">Show All Inventory</span>\n											</a>\n										</li>									</ul>\n\n{/if}\n\n								</li>\n								<li class=\"{$activeSideBar.agency}\"><a href=\"agency\"><i class=\"fa fa-building-o fa-fw\"></i><span class=\"text\">Agency</span></a>\n								</li>			\n								<li class=\"{$activeSideBar.documents}\"><a href=\"cabinet\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-archive fw\"></i><span class=\"text\">Documents</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/cabinet/invoices\">\n												<span class=\"text\">Invoices</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/cabinet/buys\">\n												<span class=\"text\">Buys</span>\n											</a>\n										</li>\n									</ul>\n								</li>\n								<li class=\"{$activeSideBar.more}\"><a href=\"cabinet\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-life-ring fw\"></i><span class=\"text\">Support</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/support/kb\">\n												<span class=\"text\">Knowledge Base</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/support/cases/create\">\n												<span class=\"text\">Create A Case</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/support/cases\">\n												<span class=\"text\">View Cases</span>\n											</a>\n										</li>									</ul>\n								</li>\n{if $userID==1 or $userID==3 or $userID==4 or $userID==150}\n								<li class=\"{$activeSideBar.more}\"><a href=\"#\" class=\"js-sub-menu-toggle\"><i class=\"fa fa-cogs fw\"></i><span class=\"text\">Admin</span>\n									<i class=\"toggle-icon fa fa-angle-left\"></i></a>\n									<ul class=\"sub-menu \">\n										<li>\n											<a href=\"/admin/users\">\n												<span class=\"text\">Users</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/admin/inbox\">\n												<span class=\"text\">Inbox</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/admin/agencies\">\n												<span class=\"text\">Agencies</span>\n											</a>\n										</li>\n										<li>\n											<a href=\"/admin/subscriptions\">\n												<span class=\"text\">Subscriptions</span>\n											</a>\n										</li>	\n										<li>\n											<a href=\"/admin/billing\">\n												<span class=\"text\">Billing</span>\n											</a>\n										</li>	\n										<li>\n											<a href=\"/admin/logs\">\n												<span class=\"text\">Logs</span>\n											</a>\n										</li>\n								</ul>\n								</li>\n{/if}\n							</ul>\n						</nav>\n						<!-- /main-nav -->\n\n						<div class=\"sidebar-minified js-toggle-{if $hideSideBar}expanded{else}minified{/if}\">\n							<i class=\"fa fa-angle-left {if $hideSideBar}fa-angle-right{/if}\" {block name=\"sidebar-clicked\"}onclick=\"toggleSideBar(this);\"{/block}></i>\n						</div>\n\n						<!-- sidebar content -->\n						<div class=\"sidebar-content\">\n							<div class=\"panel panel-default\">\n								<div class=\"panel-heading\">\n									<h5><i class=\"fa fa-lightbulb-o\"></i> Tips</h5>\n								</div>\n								<div class=\"panel-body\">\n									<p>{$tip|default:\"Want to request a new feature or enhance an existing one?<br>We want to hear from you, contact us at support@bluhorn.com\"}</p>\n								</div>\n							</div>\n{*\n							<h5 class=\"label label-default\"><i class=\"fa fa-info-circle\"></i> Server Info</h5>\n							<ul class=\"list-unstyled list-info-sidebar bottom-30px\">\n								<li class=\"data-row\">\n									<span class=\"data-name\">Disk Space Usage</span>\n									<span class=\"data-value\">\n										274.43 / 2 GB\n										<div class=\"progress progress-xs\">\n											<div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"10\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 10%\">\n												<span class=\"sr-only\">10%</span>\n											</div>\n										</div>\n									</span>\n								</li>\n								<li class=\"data-row\">\n									<span class=\"data-name\">Monthly Bandwidth Transfer</span>\n									<span class=\"data-value\">\n										230 / 500 GB\n										<div class=\"progress progress-xs\">\n											<div class=\"progress-bar progress-bar-warning\" role=\"progressbar\" aria-valuenow=\"46\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 46%\">\n												<span class=\"sr-only\">46%</span>\n											</div>\n										</div>\n									</span>\n								</li>\n								<li class=\"data-row\">\n									<span class=\"data-name\">Database Disk Space</span>\n									<span class=\"data-value\">219.45 MB</span>\n								</li>\n								<li class=\"data-row\">\n									<span class=\"data-name\">Operating System</span>\n									<span class=\"data-value\">Linux</span>\n								</li>\n								<li class=\"data-row\">\n									<span class=\"data-name\">Apache Version</span>\n									<span class=\"data-value\">2.4.6</span>\n								</li>\n								<li class=\"data-row\">\n									<span class=\"data-name\">PHP Version</span>\n									<span class=\"data-value\">5.3.27</span>\n								</li>\n								<li class=\"data-row\">\n									<span class=\"data-name\">MySQL Version</span>\n									<span class=\"data-value\">5.5.34-cll</span>\n								</li>\n								<li class=\"data-row\">\n									<span class=\"data-name\">Architecture</span>\n									<span class=\"data-value\">x86_64</span>\n								</li>\n							</ul>\n*}\n						</div>\n						<!-- end sidebar content -->\n					</div>\n					<!-- end left sidebar -->\n\n					<!-- content-wrapper -->\n					<div class=\"col-md-10 content-wrapper   {if $hideSideBar}expanded{/if}\n\n\">\n						<div class=\"row\">\n							<div class=\"col-md-4\">\n								{block name=\"breadcrumb\"}\n								<ul class=\"breadcrumb\">\n									<li><i class=\"fa fa-home\"></i><a href=\"#\">Home</a>\n									</li>\n									<li class=\"active\">Dashboard</li>\n								</ul>\n								{/block}\n							</div>\n							<div class=\"col-md-8\">\n								<div class=\"top-content\">\n									<ul class=\"list-inline mini-stat\">\n										<li>\n											<h5>CAMPAIGNS\n												<span class=\"stat-value stat-color-orange\"><i class=\"fa fa-plus-circle\"></i> {$chartCampaignsTotal|number_format:0:\".\":\",\"|default:\"0\"}</span>\n											</h5>\n											<span id=\"mini-bar-chart-campaigns\" class=\"mini-bar-chart\"></span>\n										</li>\n										<li>\n											<h5>BUYS\n												<span class=\"stat-value stat-color-blue\"><i class=\"fa fa-plus-circle\"></i> {$chartBuysTotal|number_format:0:\".\":\",\"|default:\"0\"}</span>\n											</h5>\n											<span id=\"mini-bar-chart-buys\" class=\"mini-bar-chart\"></span>\n										</li>\n										<li class=\"hide\">\n											<h5>ADS\n												<span class=\"stat-value stat-color-seagreen\"><i class=\"fa fa-plus-circle\"></i> {$chartAdsTotal|number_format:0:\".\":\",\"|default:\"0\"}</span>\n											</h5>\n											<span id=\"mini-bar-chart-ads\" class=\"mini-bar-chart\"></span>\n										</li>\n									</ul>\n								</div>\n							</div>\n						</div>\n\n	{block name=\"pdf\"}\n	{/block}\n\n						<!-- main -->\n\n						{block name=\"main\"}\n\n						<div class=\"content\" >\n							<div class=\"main-header\">\n								<h2>DASHBOARD</h2>\n								<em>{$agency.name|default:\"Overview\"}</em>\n							</div>\n\n							<div class=\"main-content\">\n								<div class=\"row\">\n									<div class=\"col-md-12\">\n										<!-- WIDGET NO HEADER -->\n										<div class=\"widget widget-hide-header\">\n											<div class=\"widget-header hide\">\n												<h3>Summary Info</h3>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"row\">\n													<div class=\"col-md-3\">\n														<div class=\"easy-pie-chart green\" data-percent=\"{$TVCableRatio|default:\'0\'}\">\n															<span class=\"percent\">{$TVCableRatio|default:\"0\"}</span>\n														</div>\n														<p class=\"text-center\">TV/Cable %</p>\n													</div>\n													<div class=\"col-md-3\">\n														<div class=\"easy-pie-chart red\" data-percent=\"{$RadioRatio|default:\"0\"}\">\n															<span class=\"percent\">{$RadioRatio|default:\"0\"}</span>\n														</div>\n														<p class=\"text-center\">Radio %</p>\n													</div>\n													<div class=\"col-md-3\">\n														<div class=\"easy-pie-chart yellow\" data-percent=\"{$PrintDigitalRatio|default:\"0\"}\">\n															<span class=\"percent\">{$PrintDigitallRatio|default:\"0\"}</span>\n														</div>\n														<p class=\"text-center\">Print/Digital %</p>\n													</div>\n													<div class=\"col-md-3\">\n														<div class=\"easy-pie-chart red\" data-percent=\"{$OutdoorRatio|default:\"0\"}\">\n															<span class=\"percent\">{$OutdoorRatio|default:\"0\"}</span>\n														</div>\n														<p class=\"text-center\">Outdoor %</p>\n													</div>\n\n\n												</div>\n											</div>\n										</div>\n										<!-- WIDGET NO HEADER -->\n									</div>\n{*\n									<div class=\"col-md-3\">\n										<!-- WIDGET REMINDER -->\n										<div class=\"widget widget-hide-header widget-reminder\">\n											<div class=\"widget-header hide\">\n												<h3>Today\'s Reminder</h3>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"today-reminder\">\n													<h4 class=\"reminder-title\">Project Meeting</h4>\n													<p class=\"reminder-time\"><i class=\"fa fa-clock-o\"></i> 9:00 AM</p>\n													<p class=\"reminder-place\">War Room</p>\n													<em class=\"reminder-notes\">Bring weekly report summary</em>\n													<i class=\"fa fa-bell\"></i>\n													<div class=\"btn-group btn-group-xs\">\n														<button type=\"button\" class=\"btn btn-warning\"><i class=\"fa fa-cloud-upload\"></i> Sync</button>\n														<div class=\"btn-group  btn-group-xs\">\n															<button type=\"button\" class=\"btn btn-warning dropdown-toggle\" data-toggle=\"dropdown\">Remind Me\n																<span class=\"caret\"></span>\n															</button>\n															<ul class=\"dropdown-menu pull-right\">\n																<li><a href=\"#\">15 minutes later</a>\n																</li>\n																<li><a href=\"#\">30 minutes later</a>\n																</li>\n																<li><a href=\"#\">1 hour later</a>\n																</li>\n															</ul>\n														</div>\n													</div>\n												</div>\n											</div>\n										</div>\n\n										<!-- END WIDGET REMINDER -->\n									</div>\n*}\n\n								</div>\n\n								<!-- WIDGET MAIN CHART WITH TABBED CONTENT -->\n								<div class=\"row\">\n									<div class=\"col-md-12 col-lg-6\">\n									\n										<!-- WIDGET TABLE -->\n										<div class=\"widget widget-table\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-rocket\"></i> Recent Campaigns</h3>\n												<div class=\"btn-group widget-header-toolbar\">\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n												<div class=\"btn-group widget-header-toolbar\">\n											\n												</div>\n											</div>\n											<div class=\"widget-content\">\n												<table id=\"recent-campaigns-table\" class=\"table table-striped table-hover display_recent\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n													<thead>\n														<tr>\n															<th>Name</th>\n															<th>Client</th>\n															<th>Dates</th>\n															<th>Job #</th>\n														</tr>\n													</thead>\n													<tbody>\n		{foreach $recentCampaigns as $campaign}\n		<tr>\n															<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></td>\n															<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.clientName}</a></td>\n															<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.flightStart} - {$campaign.flightEnd}</a></td>\n															<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.jobNumber}</a></td>\n														</tr>\n			\n		{/foreach}																																	</tbody>\n												</table>\n											</div>\n										</div>\n										<!-- END WIDGET TABLE -->\n\n								<div class=\"widget hidden\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-bar-chart-o\"></i> Sales Stat</h3>\n										<em>- Sales - Media Buys</em>\n										<button type=\"button\" class=\"btn btn-link btn-help\"><i class=\"fa fa-question-circle\"></i>\n										</button>\n										<div class=\"btn-group widget-header-toolbar\">\n											<a href=\"#\" id=\"tour-focus\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n										</div>\n									</div>\n									<div class=\"widget-content\">\n										<!-- chart tab nav -->\n										<div class=\"chart-nav\">\n											<strong>Select period:</strong>\n											<ul id=\"sales-stat-tab\">\n												<li class=\"active\"><a href=\"#week\">Weekly</a>\n												</li>\n												<li><a href=\"#month\">Monthly</a>\n												</li>\n												<li><a href=\"#year\">Annually</a>\n												</li>\n											</ul>\n										</div>\n										<!-- end chart tab nav -->\n\n										<!-- chart placeholder-->\n										<div class=\"chart-content\">\n											<div class=\"demo-flot-chart sales-chart\"></div>\n										</div>\n										<!-- end chart placeholder-->\n\n										<hr class=\"separator\">\n\n										<!-- secondary stat -->\n										<div class=\"secondary-stat\">\n											<div class=\"row\">\n												<div class=\"col-lg-4\">\n													<div id=\"secondary-stat-item1\" class=\"secondary-stat-item big-number-stat clearfix\">\n														<div class=\"data\">\n															<span class=\"col-left big-number\">260</span>\n															<span class=\"col-right\">\n																<em>New Orders</em>\n																<em>3% <i class=\"fa fa-caret-down\"></i>\n																</em>\n															</span>\n														</div>\n														<div id=\"spark-stat1\" class=\"inlinesparkline\">Loading...</div>\n													</div>\n												</div>\n\n												<div class=\"col-lg-4 hidden\">\n													<div id=\"secondary-stat-item2\" class=\"secondary-stat-item big-number-stat clearfix\">\n														<p class=\"data\">\n															<span class=\"col-left big-number\">$23,000</span>\n															<span class=\"col-right\">\n																<em>Revenue</em>\n																<em>5% <i class=\"fa fa-caret-up\"></i>\n																</em>\n															</span>\n														</p>\n														<div id=\"spark-stat2\" class=\"inlinesparkline\">Loading...</div>\n													</div>\n												</div>\n												<div class=\"col-lg-4 hidden\">\n													<div id=\"secondary-stat-item3\" class=\"secondary-stat-item big-number-stat clearfix\">\n														<p class=\"data\">\n															<span class=\"col-left big-number\">$47,000</span>\n															<span class=\"col-right\">\n																<em>Total Sales</em>\n																<em>7% <i class=\"fa fa-caret-up\"></i>\n																</em>\n															</span>\n														</p>\n														<div id=\"spark-stat3\" class=\"inlinesparkline\">Loading...</div>\n													</div>\n												</div>\n											</div>\n										</div>\n										<!-- end secondary stat -->\n									</div>\n								</div>\n								<!-- END WIDGET MAIN CHART WITH TABBED CONTENT -->\n\n\n\n										<!-- WIDGET DONUT AND PIE CHART -->\n										<div class=\"widget hidden\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Vendors</h3>\n												<em>- Share of Campaign $</em>\n												<div class=\"btn-group widget-header-toolbar\">\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"demo-flot-chart\" id=\"demo-donut-chart\"></div>\n												<div class=\"panel panel-default panel-pie-chart\">\n													<div class=\"panel-heading\">\n														<h3 class=\"panel-title\">Last Week Visits</h3>\n													</div>\n													<div class=\"panel-body\">\n														<ul class=\"list-inline\">\n															<li>\n																<span id=\"mini-pie-chart1\" class=\"mini-pie-chart\"></span>\n																<div>Mon</div>\n															</li>\n															<li>\n																<span id=\"mini-pie-chart2\" class=\"mini-pie-chart\"></span>\n																<div>Tue</div>\n															</li>\n															<li>\n																<span id=\"mini-pie-chart3\" class=\"mini-pie-chart\"></span>\n																<div>Wed</div>\n															</li>\n															<li>\n																<span id=\"mini-pie-chart4\" class=\"mini-pie-chart\"></span>\n																<div>Thu</div>\n															</li>\n															<li>\n																<span id=\"mini-pie-chart5\" class=\"mini-pie-chart\"></span>\n																<div>Fri</div>\n															</li>\n															<li>\n																<span id=\"mini-pie-chart6\" class=\"mini-pie-chart\"></span>\n																<div>Sat</div>\n															</li>\n															<li>\n																<span id=\"mini-pie-chart7\" class=\"mini-pie-chart\"></span>\n																<div>Sun</div>\n															</li>\n														</ul>\n													</div>\n												</div>\n											</div>\n										</div>\n										<!-- END WIDGET DONUT AND PIE CHART -->\n									</div>\n										\n									<div class=\"col-md-12 col-lg-6\">\n\n\n										<!-- WIDGET TABLE -->\n										<div class=\"widget widget-table\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-folder\"></i> Recent Worksheets</h3>\n												<div class=\"btn-group widget-header-toolbar\">\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n												<div class=\"btn-group widget-header-toolbar\">\n											\n												</div>\n											</div>\n											<div class=\"widget-content\">\n												<table id=\"recent-worksheets-table\" class=\"table table-sorting table-striped table-hover display_recent\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n													<thead>\n														<tr>\n															<th>Name</th>\n															<th>Campaign</th>\n															<th>Amount</th>\n															<th>Spots</th>\n														</tr>\n													</thead>\n													<tbody>\n		{foreach $recentWorksheets as $worksheet}\n		<tr>\n															<td><a href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\">{$worksheet.name}</a></td>\n															<td><a href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\">{$worksheet.campaignName}</a></td>\n															<td><a href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\">{$worksheet.totalSpend}</a></td>\n															<td><a href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\">{$worksheet.totalSpots}</a></td>\n														</tr>\n			\n		{/foreach}																																																		</tbody>\n												</table>\n											</div>\n											\n										</div>\n										<!-- END WIDGET TABLE -->\n										\n										<!-- WIDGET SALES MAP -->\n										<div class=\"widget hidden\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-globe\"></i> Map</h3>\n												<em>- Sales by location</em>\n												<div class=\"btn-group widget-header-toolbar\">\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"map-custom-width data-us-map\">\n													<div class=\"map\"></div>\n													<div class=\"plotLegend\"></div>\n												</div>\n											</div>\n										</div>\n										<!-- END WIDGET SALES MAP -->\n\n										<!-- WIDGET INLINE SPARKLINE -->\n										<div class=\"widget widget-sparkline hidden\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-bar-chart-o\"></i> Scoreboard</h3>\n												<em>- Agency Data</em>\n												<div class=\"btn-group widget-header-toolbar\">\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"row first\">\n													<div class=\"col-md-6\">\n														<div class=\"sparkline-stat-item\">\n															<div class=\"info\">\n																<span>Campaigns</span>\n																<strong>1,363</strong>\n															</div>\n															<span id=\"sparkline1\" class=\"inlinesparkline\">Loading...</span>\n														</div>\n													</div>\n													<div class=\"col-md-6\">\n														<div class=\"sparkline-stat-item\">\n															<div class=\"info\">\n																<span>Buys</span>\n																<strong>1,221</strong>\n															</div>\n															<span id=\"sparkline2\" class=\"inlinesparkline\">Loading...</span>\n														</div>\n													</div>\n													<div class=\"col-md-6\">\n														<div class=\"sparkline-stat-item last\">\n															<div class=\"info\">\n																<span>Ads</span>\n																<strong>2,300</strong>\n															</div>\n															<span id=\"sparkline3\" class=\"inlinesparkline\">Loading...</span>\n														</div>\n													</div>\n\n													<div class=\"col-md-6\">\n														<div class=\"sparkline-stat-item\">\n															<div class=\"info\">\n																<span>Ads/Campaign</span>\n																<strong>1.19</strong>\n															</div>\n															<span id=\"sparkline4\" class=\"inlinesparkline\">Loading...</span>\n														</div>\n													</div>\n													<div class=\"col-md-6\">\n														<div class=\"sparkline-stat-item\">\n															<div class=\"info\">\n																<span>Time Purchased</span>\n																<strong>00:00:30</strong>\n															</div>\n															<span id=\"sparkline5\" class=\"inlinesparkline\">Loading...</span>\n														</div>\n													</div>\n													<div class=\"col-md-6\">\n														<div class=\"sparkline-stat-item last\">\n															<div class=\"info\">\n																<span>% New Clients</span>\n																<strong>28.35%</strong>\n															</div>\n															<span id=\"sparkline6\" class=\"inlinesparkline\">Loading...</span>\n														</div>\n													</div>\n												</div>\n											</div>\n										</div>\n										<!-- END WIDGET INLINE SPARKLINE -->\n									</div>\n								</div>\n<!-- Calendar -->\n{include file=\"db:full-calendar\"}\n\n<!-- END Calendar -->\n								<div class=\"row\">\n									<div class=\"col-md-4\">\n										<!-- WIDGET TASKS -->\n										<div class=\"widget hidden\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-tasks\"></i> My Tasks</h3>\n												<em>- Summary of Tasks</em>\n												<div class=\"btn-group widget-header-toolbar\">\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\">\n												<ul class=\"task-list\">\n													<li>\n														<p>Pending Worksheets\n															<span class=\"label label-danger\">23%</span>\n														</p>\n														<div class=\"progress progress-xs\">\n															<div class=\"progress-bar progress-bar-danger\" role=\"progressbar\" aria-valuenow=\"23\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:23%\">\n																<span class=\"sr-only\">23% Complete</span>\n															</div>\n														</div>\n													</li>\n													<li>\n														<p>New Invoices\n															<span class=\"label label-success\">80%</span>\n														</p>\n														<div class=\"progress progress-xs\">\n															<div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"80\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 80%\">\n																<span class=\"sr-only\">80% Complete</span>\n															</div>\n														</div>\n													</li>\n													<li>\n														<p> Some Other Task\n															<span class=\"label label-success\">100%</span>\n														</p>\n														<div class=\"progress progress-xs\">\n															<div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n																<span class=\"sr-only\">Success</span>\n															</div>\n														</div>\n													</li>\n																								</ul>\n											</div>\n										</div>\n										<!-- END WIDGET TASKS -->\n									</div>\n									<div class=\"col-md-8\">\n										<!-- WIDGET REAL-TIME CHART -->\n										<div class=\"widget real-time-chart hidden\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-cogs\"></i> Active Campaigns</h3>\n												<em>- Realtime media buys</em>\n												<div class=\"btn-group widget-header-toolbar\">\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"demo-flot-chart\" id=\"demo-real-time-chart\"></div>\n											</div>\n										</div>\n										<!-- END WIDGET REAL-TIME CHART -->\n									</div>\n								</div>\n\n								<!-- WIDGET TICKET TABLE -->\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-group\"></i> Support Tickets</h3>\n										<em>- List of Support Tickets</em>\n										<div class=\"btn-group widget-header-toolbar\">\n											<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n										</div>\n										<div class=\"btn-group widget-header-toolbar hide\">\n											<div class=\"label label-danger\"><i class=\"fa fa-warning\"></i> 2 Critical Messages</div>\n										</div>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"ticket-table\" class=\"table table-sorting\">\n											<thead>\n												<tr>\n													<th>Number</th>\n													<th>Date</th>\n													<th>Category</th>\n													<th>Name</th>\n													<th>Title</th>\n													<th>Priority</th>\n												</tr>\n											</thead>\n											<tbody>\n\n											\n											</tbody>\n										</table>\n									</div>\n								</div>\n								<!-- END WIDGET TICKET TABLE -->\n\n							</div>\n							<!-- /main-content -->\n						\n						{/block}\n\n						</div>\n						<!-- /main -->\n					</div>\n\n					<!-- /content-wrapper -->\n				</div>\n				<!-- /row -->\n			</div>\n			<!-- /container -->\n		</div>\n		<!-- END BOTTOM: LEFT NAV AND RIGHT MAIN CONTENT -->\n		<!-- FOOTER -->\n		<footer class=\"footer\">\n			&copy; 2014 BluHorn (powered by FileLogix)\n		</footer>\n		<!-- END FOOTER -->\n\n	</div>\n	<!-- /wrapper -->\n</div>\n\n	<!-- STYLE SWITCHER -->\n	<div class=\"del-style-switcher hide\">\n		<div class=\"del-switcher-toggle toggle-hide\"></div>\n		<form>\n			<section class=\"del-section del-section-skin\">\n				<h5 class=\"del-switcher-header\">Choose Skins:</h5>\n\n				<ul>\n					<li><a href=\"#\" title=\"Slate Gray\" class=\"switch-skin slategray\" data-skin=\"assets/css/skins/slategray.css\">Slate Gray</a></li>\n					<li><a href=\"#\" title=\"Dark Blue\" class=\"switch-skin darkblue\" data-skin=\"assets/css/skins/darkblue.css\">Dark Blue</a></li>\n					<li><a href=\"#\" title=\"Dark Brown\" class=\"switch-skin darkbrown\" data-skin=\"assets/css/skins/darkbrown.css\">Dark Brown</a></li>\n					<li><a href=\"#\" title=\"Light Green\" class=\"switch-skin lightgreen\" data-skin=\"assets/css/skins/lightgreen.css\">Light Green</a></li>\n					<li><a href=\"#\" title=\"Orange\" class=\"switch-skin orange\" data-skin=\"assets/css/skins/orange.css\">Orange</a></li>\n					<li><a href=\"#\" title=\"Red\" class=\"switch-skin red\" data-skin=\"assets/css/skins/red.css\">Red</a></li>\n					<li><a href=\"#\" title=\"Teal\" class=\"switch-skin teal\" data-skin=\"assets/css/skins/teal.css\">Teal</a></li>\n					<li><a href=\"#\" title=\"Yellow\" class=\"switch-skin yellow\" data-skin=\"assets/css/skins/yellow.css\">Yellow</a></li>\n				</ul>\n\n				<button type=\"button\" class=\"switch-skin-full fulldark\" data-skin=\"assets/css/skins/fulldark.css\">Full Dark</button>\n				<button type=\"button\" class=\"switch-skin-full fullbright\" data-skin=\"assets/css/skins/fullbright.css\">Full Bright</button>\n			</section>\n\n			<p><a href=\"#\" title=\"Reset Style\" class=\"del-reset-style\">Reset Style</a></p>\n		</form>\n	</div>\n	<!-- END STYLE SWITCHER -->\n\n	<!-- Javascript -->\n\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.sparkline.min.js\"></script>\n\n	{block name=\"scripts\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n	\n		<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n	\n	<script type=\"text/javascript\" src=\"/assets/js/stat/jquery.easypiechart.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/raphael-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/stat/flot/jquery.flot.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/stat/flot/jquery.flot.resize.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/stat/flot/jquery.flot.time.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/stat/flot/jquery.flot.pie.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/stat/flot/jquery.flot.tooltip.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.mapael.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/maps/usa_states.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-chart-stat.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-table.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-components.js\"></script>\n\n	{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n	{/block}\n\n	{block name=\"fullcalendar\"}\n		<script type=\"text/javascript\" src=\"/assets/js/fullcalendar.js\"></script>\n		<script type=\"text/javascript\" src=\"/assets/js/fullcalendar.min.js\"></script>\n	{/block}\n\n        <script type=\"text/javascript\" src=\"/lib/gravatar/jquery/md5.js\"></script>\n        <script type=\"text/javascript\" src=\"/lib/gravatar/jquery/jquery.gravatar.js\"></script>\n\n	{block name=\"footer-js\"}\n\n	{/block}\n\n	{/block}\n\n	<script type=\"text/javascript\">\n\n	function search() {\n		window.location.href=\"/search?\" + $(\"#searchForm\").serialize();\n	}\n\n	$(document).ready(function(){\n\n		//*******************************************\n		/*	MINI BAR CHART\n		/********************************************/\n			if( $(\'.mini-bar-chart\').length > 0 ) {\n			var params = {\n				type: \'bar\',\n				barWidth: 5,\n				height: 25\n			}\n	\n			params.barColor = \'#CE7B11\';\n			$(\'#mini-bar-chart-campaigns\').sparkline([{$chartCampaigns|default:\"0\"}], params);\n			params.barColor = \'#1D92AF\';\n			$(\'#mini-bar-chart-buys\').sparkline([{$chartBuys|default:\"0\"}], params);\n			params.barColor = \'#3F7577\';\n			$(\'#mini-bar-chart-ads\').sparkline([{$chartAds|default:\"0\"}], params);\n		}\n\n		//*******************************************\n		/*	EASY PIE CHART\n		/********************************************/\n		if( $(\'.easy-pie-chart\').length > 0 ) {\n	\n			var cOptions = {\n				animate: 3000,\n				trackColor: \"#ccc\",\n				scaleColor: \"#ddd\",\n				lineCap: \"square\",\n				lineWidth: 5,\n				barColor: \"#ef1e25\",\n				onStep: function(from, to, percent) {\n					$(this.el).find(\'.percent\').text(Math.round(percent));\n				}\n			}\n	\n			cOptions.barColor = \"#3E9C1A\"; // green\n			$(\'.easy-pie-chart.green\').easyPieChart(cOptions);\n			cOptions.barColor = \"#FFB800\"; // yellow\n			$(\'.easy-pie-chart.yellow\').easyPieChart(cOptions);\n			cOptions.barColor = \"#E60404\"; // red\n			$(\'.easy-pie-chart.red\').easyPieChart(cOptions);\n		}\n\n{literal}\n\n	//*******************************************\n	/*	MAPS\n	/********************************************/\n\n	var colors = [\"#5DC8CD\", \"#34C6CD\", \"#01939A\", \"#1D7074\", \"#006064\"];\n	\n	if( $(\'body\').hasClass(\'demo-maps\') ) {\n\n		// basic map\n		$(\".basic-map\").mapael({\n			map: {\n				name: \"world_countries\"\n			}\n		});\n\n		// data visualization\n		var data = {\n			\"areas\" : {\n				\"US\": {\n					\"value\": 2200,\n					\"tooltip\": {\n						\"content\": \"<span>United States</span><br />Sales: 2200\"\n					}\n				},\n				\"CN\": {\n					\"value\": 1800,\n					\"tooltip\": {\n						\"content\": \"<span>China</span><br />Sales: 1800\"\n					}\n				},\n				\"JP\": {\n					\"value\": 1550,\n					\"tooltip\": {\n						\"content\": \"<span>Japan</span><br />Sales: 1550\"\n					}\n				},\n				\"IN\": {\n					\"value\": 1400,\n					\"tooltip\": {\n						\"content\": \"<span>India</span><br />Sales: 1400\"\n					}\n				},\n				\"DE\": {\n					\"value\": 1600,\n					\"tooltip\": {\n						\"content\": \"<span>Germany</span><br />Sales: 1600\"\n					}\n				},\n				\"RU\": {\n					\"value\": 900,\n					\"tooltip\": {\n						\"content\": \"<span>Russia</span><br />Sales: 900\"\n					}\n				},\n				\"GB\": {\n					\"value\": 1200,\n					\"tooltip\": {\n						\"content\": \"<span>United Kingdom</span><br />Sales: 1200\"\n					}\n				},\n				\"FR\": {\n					\"value\": 1100,\n					\"tooltip\": {\n						\"content\": \"<span>France</span><br />Sales: 1100\"\n					}\n				},\n				\"BR\": {\n					\"value\": 400,\n					\"tooltip\": {\n						\"content\": \"<span>Brazil</span><br />Sales: 400\"\n					}\n				},\n				\"IT\": {\n					\"value\": 700,\n					\"tooltip\": {\n						\"content\": \"<span>Italy</span><br />Sales: 700\"\n					}\n				},\n				\"MX\": {\n					\"value\": 1900,\n					\"tooltip\": {\n						\"content\": \"<span>Mexico</span><br />Sales: 1900\"\n					}\n				},\n				\"ES\": {\n					\"value\": 300,\n					\"tooltip\": {\n						\"content\": \"<span>Spain</span><br />Sales: 300\"\n					}\n				},\n				\"KR\": {\n					\"value\": 200,\n					\"tooltip\": {\n						\"content\": \"<span>South Korea</span><br />Sales: 200\"\n					}\n				},\n				\"CA\": {\n					\"value\": 2900,\n					\"tooltip\": {\n						\"content\": \"<span>Canada</span><br />Sales: 2900\"\n					}\n				},\n				\"ID\": {\n					\"value\": 1200,\n					\"tooltip\": {\n						\"content\": \"<span>Indonesia</span><br />Sales: 1300\"\n					}\n				},\n				\"TR\": {\n					\"value\": 90,\n					\"tooltip\": {\n						\"content\": \"<span>Turkey</span><br />Sales: 90\"\n					}\n				},\n				\"IR\": {\n					\"value\": 80,\n					\"tooltip\": {\n						\"content\": \"<span>Iran</span><br />Sales: 80\"\n					}\n				},\n				\"AU\": {\n					\"value\": 900,\n					\"tooltip\": {\n						\"content\": \"<span>Australia</span><br />Sales: 1400\"\n					}\n				},\n				\"ZA\": {\n					\"value\": 50,\n					\"tooltip\": {\n						\"content\": \"<span>South Africa</span><br />Sales: 50\"\n					}\n				},\n				\"EG\": {\n					\"value\": 20,\n					\"tooltip\": {\n						\"content\": \"<span>Egypt</span><br />Sales: 20\"\n					}\n				},\n				\"PK\": {\n					\"value\": 1300,\n					\"tooltip\": {\n						\"content\": \"<span>Pakistan</span><br />Sales: 1300\"\n					}\n				},\n				\"SG\": {\n					\"value\": 100,\n					\"tooltip\": {\n						\"content\": \"<span>Singapore</span><br />Sales: 100\"\n					}\n				},\n			}\n		} // end data\n\n		// map with sales data visualization\n		$(\'.data-visualization-map\').mapael({\n			map: {\n				name: \"world_countries\",\n				defaultArea: {\n					attrs : {\n						stroke : \"#fff\", \n						\"stroke-width\" : 1,\n						fill: \"#c4c4c4\"\n					}\n				}\n			},\n			legend: {\n				area: {\n					display: true,\n					title: \"Sales\",\n					slices: [\n						{\n							max: 100,\n							attrs: {\n								fill: colors[0]\n							},\n							label: \"Less than 100\"\n						},\n						{\n							min: 100,\n							max: 500,\n							attrs: {\n								fill: colors[1]\n							},\n							label: \"Between 100 and 500\"\n						},\n						{\n							min: 500,\n							max: 1000,\n							attrs: {\n								fill: colors[2]\n							},\n							label: \"Between 500 and 1000\"\n						},\n						{\n							min: 1000,\n							max: 1500,\n							attrs: {\n								fill: colors[3]\n							},\n							label: \"Between 1000 and 1500\"\n						},\n						{\n							min: 1500,\n							attrs: {\n								fill: colors[4]\n							},\n							label: \"More than 1500\"\n						}\n					]\n				}\n			},\n			areas: data[\'areas\']\n\n		}); // end data visualization map\n\n		// map with zoom features\n		$mapZoom = $(\".zoom-map\");\n		$mapZoom.mapael({\n			map : {\n				name: \"france_departments\",\n				zoom: {\n					enabled: true,\n					maxLevel : 10\n				}, \n				defaultPlot: {\n					attrs: {\n						opacity : 0.6\n					}\n				}\n			},\n			areas: {\n				\"department-56\" : {\n					text : {content : \"56\"}, \n					tooltip: {content : \"Morbihan (56)\"}\n				}\n			},\n			plots : {\n				\'paris\' : {\n					latitude : 48.86, \n					longitude: 2.3444\n				},\n				\'lyon\' : {\n					type: \"circle\",\n					size:50,\n					latitude :45.758888888889, \n					longitude: 4.8413888888889, \n					value : 700000, \n					href : \"http://fr.wikipedia.org/wiki/Lyon\",\n					tooltip: {content : \"<span style=\\\"font-weight:bold;\\\">City :</span> Lyon\"},\n					text : {content : \"Lyon\"}\n				},\n				\'rennes\' : {\n					type :\"square\",\n					size :20,\n					latitude : 48.114166666667, \n					longitude: -1.6808333333333, \n					tooltip: {content : \"<span style=\\\"font-weight:bold;\\\">City :</span> Rennes\"},\n					text : {content : \"Rennes\"},\n					href : \"http://fr.wikipedia.org/wiki/Rennes\"\n				}\n			}\n		});\n\n		// Zoom on mousewheel with mousewheel jQuery plugin\n		$mapZoom.on(\"mousewheel\", function(e) {\n			if (e.deltaY > 0)\n				$mapZoom.trigger(\"zoom\", $mapZoom.data(\"zoomLevel\") + 1);\n			else\n				$mapZoom.trigger(\"zoom\", $mapZoom.data(\"zoomLevel\") - 1);\n				\n			return false;\n		});\n\n		// focus to paris\n		$(\'#focus-paris\').on(\'click\', function() {\n			// Translate latitude,longitude of Paris to x,y coordinates\n			var coords = $.fn.mapael.maps[\"france_departments\"].getCoords(48.114167, 2.3444);\n			$mapZoom.trigger(\'zoom\', [10, coords.x, coords.y]);\n		});\n\n		$(\'#focus-lyon\').on(\'click\', function() {\n			// Translate latitude,longitude of Lyon to x,y coordinates\n			var coords = $.fn.mapael.maps[\"france_departments\"].getCoords(45.758888888889, 4.8413888888889);\n			$mapZoom.trigger(\'zoom\', [5, coords.x, coords.y]);\n		});\n\n		$(\'#map-clear-zoom\').on(\'click\', function() {\n			$mapZoom.trigger(\'zoom\', [0]);\n		});\n	} // end map page demo\n\n	if( $(\'.data-us-map\').length > 0 ) {\n		\n		// map with circle plot\n		$(\'.data-us-map\').mapael({\n			map: {\n				name: \"usa_states\",\n				defaultPlot: {\n					size: 10\n				},\n				defaultArea: {\n					attrs: {\n						stroke: \"#fafafa\", \n						\"stroke-width\": 1,\n						fill: \"#c4c4c4\"\n					}\n				}\n			},\n			legend: {\n				plot: {\n					display: true,\n					title: \"US Sales Map\",\n					hideElemsOnClick: {\n						opacity : 0\n					},\n					slices: [ \n						{\n							size: 10,\n							type: \"circle\",\n							max: 500,\n							attrs: { fill: colors[1] },\n							label: \"Less than 500 sales\"\n						},\n						{\n							size: 20,\n							type: \"circle\",\n							min: 500,\n							max: 750,\n							attrs: { fill: colors[1] },\n							label: \"Between 500 and 750 sales\"\n						},\n						{\n							size: 30,\n							type: \"circle\",\n							min: 750,\n							max: 1000,\n							attrs: { fill: colors[1] },\n							label: \"Between 750 and 1000 sales\"\n						},\n						{\n							size: 40,\n							type: \"circle\",\n							min: 1000,\n							max: 1250,\n							attrs: { fill: colors[1] },\n							label: \"Between 1000 and 1250 sales\"\n						},\n						{\n							size: 50,\n							type: \"circle\",\n							min: 1250,\n							max: 1500,\n							attrs: { fill: colors[1] },\n							label: \"Between 1250 and 1500 sales\"\n						}\n					]\n				}\n			},\n			plots: {\n				\"ny\": {\n					value: 1450,\n					latitude: 40.717079,\n					longitude: -74.00116,\n					tooltip: { content: \"<span>New York</span><br />Sales: 1450\" }\n				},\n				\'an\': {\n					value: 900,\n					latitude: 61.2108398, \n					longitude: -149.9019557,\n					tooltip: { content : \"<span>Anchorage</span><br />Sales: 900\"}\n				},\n				\'sf\': {\n					value: 1200,\n					latitude: 37.792032,\n					longitude: -122.394613,\n					tooltip: { content : \"<span>San Francisco</span><br />Sales: 1200\"}\n				},\n				\'pa\': {\n					value: 400,\n					latitude: 19.493204,\n					longitude: -154.8199569,\n					tooltip: { content : \"<span>Pahoa</span><br />Sales: 400\"}\n				},\n				\'nm\': {\n					value: 850,\n					latitude: 35.101934,\n					longitude: -106.633301,\n					tooltip: { content : \"<span>Albuquerque</span><br />Sales: 850\"}\n				},\n				\'nj\': {\n					value: 30,\n					latitude: 38.934385,\n					longitude: -74.908028,\n					tooltip: { content : \"<span>Cape May</span><br />Sales: 30\"}\n				},\n				\'il\': {\n					value: 1100,\n					latitude: 41.879786,\n					longitude: -87.62352,\n					tooltip: { content : \"<span>Chicago</span><br />Sales: 1100\"}\n				},\n				\'or\': {\n					value: 70,\n					latitude: 19.493204,\n					longitude: -154.8199569,\n					tooltip: { content : \"<span>Portland</span><br />Sales: 70\"}\n				}\n			}\n		}); // end map with circle plot\n	}\n\n{/literal}\n	});\n\n	$(\'.js-toggle-expanded\').clickToggle(\n			   \n			function() {\nconsole.log(\"expanding\");\n\n				$(\'.left-sidebar\').removeClass(\'minified\');\n				$(\'.content-wrapper\').removeClass(\'expanded\');\n				$(\'.sidebar-minified\').find(\'i.fa-angle-left\').toggleClass(\'fa-angle-right\');\n			},\n			function() {\nconsole.log(\"minimizing\");\n				$(\'.left-sidebar\').addClass(\'minified\');\n				$(\'.content-wrapper\').addClass(\'expanded\');\n	\n				$(\'.left-sidebar .sub-menu\')\n				.css(\'display\', \'none\')\n				.css(\'overflow\', \'hidden\'); \n				\n				$(\'.sidebar-minified\').find(\'i.fa-angle-left\').toggleClass(\'fa-angle-right\');\n			}\n	);\n\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status+\"?PHPSESSID={$sessionID}\", function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	</script>\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(3,0,'error','2014-09-25 13:29:45','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>404 Page Not Found | BluHorn</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn\">\n	<meta name=\"author\" content=\"BluHorn (powered by FileLogix)\">\n\n	<!-- CSS -->\n	<link href=\"assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-error text-center\">\n		<div class=\"inner-page\">\n			<h1>\n				<span class=\"clearfix title\">\n					<span class=\"number\">404</span>\n					<span class=\"text\">Oops!<br/>Page Not Found</span>\n				</span>\n			</h1>\n\n			<p>The page you were looking for could not be found, please <a href=\"mailto:support@bluhorn.com\">contact us</a> to report this issue.</p>\n			<p>You may also want to try logging back in or refreshing the previous page you were on.</p>\n			<p class=\"hide\">You can also use search form below to find the page you are looking for.</p>\n			<form class=\"searchbox center-block hide\">\n				<div class=\"input-group input-group-lg\">\n					<input type=\"search\" placeholder=\"type keyword here\" class=\"form-control\">\n					<span class=\"input-group-btn\">\n						<button class=\"btn btn-primary\" type=\"button\"><i class=\"fa fa-search\"></i> Search</button>\n					</span>\n				</div>\n			</form>\n			<p>\n				<a href=\"javascript:history.go(-1)\" class=\"btn btn-custom-primary\"><i class=\"fa fa-arrow-left\"></i> Go Back</a>\n				<a href=\"#\" class=\"btn btn-primary\"><i class=\"fa fa-home\"></i> Home</a>\n			</p>\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/modernizr.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(4,0,'login','2014-08-11 06:35:54','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Dashboard</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-login text-center\">\n\n		<div class=\"inner-page\">\n\n			<div class=\"logo\">\n				<a href=\"/\">\n					<img src=\"assets/img/kingboard-logo.png\" alt=\"\" />\n				</a>\n			</div>\n{*\n			<button type=\"button\" class=\"btn btn-login-facebook\">\n				<span>Login via Facebook</span>\n			</button>\n\n			<div class=\"separator\">\n				<span>OR</span>\n			</div>\n*}\n			<div class=\"login-box center-block\">\n				<form action=\"/login/go\" method=\"post\">\n					<p class=\"title\">Use your Username or Email Address</p>\n					{if $alertError}\n						<div class=\"alert alert-danger\" role=\"alert\">{$errorMsg}</div>\n					{/if}\n					<div class=\"input-group\">\n						<input type=\"text\" name=\"username\" placeholder=\"username\" class=\"form-control\" value=\"{$username}\">\n						<span class=\"input-group-addon\"><i class=\"fa fa-user\"></i></span>\n					</div>\n					<div class=\"input-group\">\n						<input type=\"password\" name=\"password\" placeholder=\"password\" class=\"form-control\">\n						<span class=\"input-group-addon\"><i class=\"fa fa-lock\"></i></span>\n					</div>\n					<div class=\"simple-checkbox hidden\">\n						<input type=\"checkbox\" id=\"checkbox1\">\n						<label for=\"checkbox1\">Remember me next time</label>\n					</div>\n					<button class=\"btn btn-custom-primary btn-lg btn-block btn-login\"><i class=\"fa fa-arrow-circle-o-right\"></i> Login</button>\n				</form>\n\n				<div class=\"links\">\n					<p><a href=\"/login/forgot\">Forgot Username or Password?</a></p>\n					<p><a href=\"/login/register\">Create New Account</a></p>\n				</div>\n			</div>\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/modernizr.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(5,0,'worksheet','2014-05-09 15:03:56','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n	td:nth-child(17) {\n	   text-align: center;\n	}\n	td:nth-child(18) {\n	   text-align: center;\n	}\n	td:nth-child(19) {\n	   text-align: center;\n	}\n</style>\n\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n												<em></em>\n												<button type=\"button\" class=\"btn btn-link btn-help\" data-original-title=\"\" title=\"\"><i class=\"fa fa-question-circle\"></i></button>\n												<div class=\"btn-group widget-header-toolbar\">\n											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												     <a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n												<p>Summary data to go here</p>\n											</div>\n								</div>\n							</div>\n							<div class=\"col-md-2\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"options\" id=\"option1\" checked> Daypart\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"options\" id=\"option2\"> Station\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"options\" id=\"option3\">&nbsp;&nbsp;Full&nbsp;&nbsp;\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" style=\"width: 100%;\">\n\n\n												<div>Number of Spots: </div><div id=\"numSpots\">0</div>\n												\n											</div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-10\">\n\n							<div class=\"main-content\" id=\"main-content\" style=\"overflow: hidden; padding-bottom: 300px;\">\n					\n\n\n								<div id=\"dataTable\"></div>\n\n							\n							\n							</div>\n							</div>\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n\n	<script>\n	\n	  var counter=1;\n\n	  var data = [ \n				{ dayPart: null, vendor: null, copy: null, bold: null, delete: null } \n	  ];\n\n	  $(\"#dataTable\").handsontable({\n	    data: data,\n	    colHeaders: [\"Day Part\",\"Vendor\",\"Station\",\"Time Period\",\"Program Name\",\"Days\",\"Length\",\"Rate\",\"AQH RTG\",\"CPP\",\"000\",\"CPM\",\"Week 1\",\"Week 2\",\"Week 3\",\"Comments\",\"Copy\",\"Bold\",\"Delete\"],\n	    minSpareRows: 1,\n	    manualColumnResize: true,\n	    colWidths: [60, 60, 100, 100, 100,80,60,80,90,70,40,40,80,80,80,80,50,50,50],\n	    columns: [\n	  	  {\n		    data: \'dayPart\',\n	  	    type: \'dropdown\',\n	  	    source: [\"EM\", \"DA\", \"EF\", \"EN\", \"PA\", \"PR\", \"LF\", \"LN\", \"OV\", \"SP\", \"RO\"]\n	  	  },	  \n	  	  {\n		    data: \'vendor\',\n	  	    type: \'dropdown\',\n	  	    source: [\"test\"]\n	  	  },	\n		  {}, // station call letters\n	  	  {}, // time period\n	  	  {}, // program name\n	  	  {}, //days\n	  	  { type: \'numeric\'},  // length\n	  	  { type: \'numeric\'},  // rate\n	  	  { type: \'numeric\'},  // AQH RTG\n	  	  { type: \'numeric\'},  // CPP\n	  	  { type: \'numeric\'},  // 000\n	  	  { type: \'numeric\'},  // CPM\n	  	  { type: \'numeric\'},  // Week 1\n	  	  { type: \'numeric\'},  // Week 2\n	  	  { type: \'numeric\'},  // Week 3\n	  	  {},  // Comments\n	  	  { data: \'copy\', type: \'checkbox\'},  // Copy\n	  	  { data: \'bold\', type: \'checkbox\'},  // Bold\n	  	  { data: \'delete\', type: \'checkbox\'} // Delete\n	    ],\n	    currentRowClassName: \'currentRow\',\n		currentColClassName: \'currentCol\',\n	    startRows: 6,\n	    startCols: 8,\n	    minRows: 10,\n	    stretchH: \'all\',\n//	    dataSchema: { copy: false },\n	    afterChange: function(changes, source) {\n //   		$.ajax({\n //     			url: \"save.php\",\n //		        data: change\n //	        });\n// 		alert(countColumn(data,0));\n		$(\'#numSpots\').html(countColumn(data,0));\n	   }\n	  });\n\n	  function sumColumn(array, col) {\n	\n		var sum = 0;\n\n//		alert(\"Length: \" + array.length);\n\n		for(var i=0; i < array.length; i++) {\n			if (array[i][col] != null) {\n				sum	+= parseFloat(array[i][col]);		\n			}\n		}\n\n		return sum;\n	  }\n\n	  function countColumn(array, col) {\n	\n		var count = 0;\n\n		for(var i=0; i < array.length; i++) {\n			if (array[i][\"dayPart\"] != null) {\n//				alert(array[i][\"dayPart\"]);\n				count++;	\n			}\n		}\n\n		return count;\n	  }\n	</script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(6,0,'worksheet-2','2014-06-18 11:43:48','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-TV | BluHorn{/block}\n\n{block name=\"header-js\"}\n	\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n	td {\n	   text-align: center;\n	}\n	td:nth-child(2) {\n	   text-align: center;\n	}\n	td:nth-child(23) {\n	   text-align: center;\n	}\n	td:nth-child(24) {\n	   text-align: center;\n	}\n	td:nth-child(25) {\n	   text-align: center;\n	}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\n</style>\n\n\n{/block}\n\n{block name=\"sidebar-clicked\"}onclick=\"refreshWorksheet();\"{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Broadcast TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Broadcast TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{include file=\"db:worksheet-info\"}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-lg-6\">\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$campaign.advertiser|default:\'none\'}   <strong>Campaign:</strong> {$campaign.name|default:\'none\'}    <strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Station(s):</strong> {$campaign.stations|default:\'none\'}</div>\n												<div style=\"width: 100%; padding-bottom: 30px;\"><strong>Demo(s):</strong> {$campaign.demographics|default:\'none\'}   <strong>Contract #:</strong> {$campaign.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-lg-6\">\n												   <div class=\"pull-right\">\n												      <button class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n												      <button class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n												   </div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendorss as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPPerStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$order.revision}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$order.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$order.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-4 col-lg-2 col-sm-6\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName}\n\n												    <div class=\"summary-daypart\" id=\"summary-daypart-{$daypart}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypart}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypart}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypart}\">0.0</div></td></tr>\n												      </table>\n												    </div>\n\n												     {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-8 col-lg-10\" id=\"dataTable-container\">\n\n								<div class=\"main-content\" id=\"main-content\" style=\"overflow: hidden; padding-bottom: 300px;\">\n					\n\n\n									<div id=\"dataTable\"></div>\n\n							\n							\n								</div>\n							</div>\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n	\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:0};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  var data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"null\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: 0, daypart: null, vendor: null, timeOfDay: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: null, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false }\n\n	{/if}\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	$( document ).ready(function() {\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n	  $(\"#dataTable\").handsontable({\n	    data: data,\n	    colHeaders: [\"Day Part\",\"Vendor\",\"Station\",\"Time Period\",\"Program Name\",\"M\", \"T\", \"W\", \"R\", \"F\", \"Sa\", \"Su\",\"Length\",\"Rate\",\"AQH RTG\",\"CPP\",\"000\",\"CPM\",{foreach $weekNames as $weekName}\"{$weekName}\",{/foreach} \"Comments\",\"Copy\",\"Bold\",\"Delete\"],\n	    minSpareRows: 1,\n	    manualColumnResize: true,\n	    colWidths: [60, 60, 100, 100, 100,25,25,25,25,25,25,25,60,80,90,70,40,60,{foreach $weeks as $week} 50, {/foreach}80,50,50,50],\n	    columns: [\n	  	  {\n		    data: \'daypart\',\n	  	    type: \'dropdown\',\n	  	    source: [\"EM\", \"DA\", \"EF\", \"EN\", \"PA\", \"PR\", \"LF\", \"LN\", \"OV\", \"SP\", \"RO\"]\n	  	  },	  \n	  	  {\n		    data: \'vendor\',\n	  	    type: \'dropdown\',\n	  	    source: vendorNames\n	  	  },	\n		  { data: \'station\'}, // station call letters\n	  	  { data: \'timeOfDay\', validator: nielsen_time_validator_fn, allowInvalid: true}, // time period\n	  	  { data: \'program\'}, // program name\n	  	  { data: \'mon\', type: \'checkbox\'}, // mon\n	  	  { data: \'tue\', type: \'checkbox\'}, // tues\n	  	  { data: \'wed\', type: \'checkbox\'}, // wed\n	  	  { data: \'thu\', type: \'checkbox\'}, // thurs\n	  	  { data: \'fri\', type: \'checkbox\'}, // fri\n	  	  { data: \'sat\', type: \'checkbox\'}, // sat\n	  	  { data: \'sun\', type: \'checkbox\'}, // sun\n	  	  { data: \'length\', type: \'numeric\'},  // length\n	  	  { data: \'rate\', type: \'numeric\', format: \'$0,0.00\'},  // rate\n	  	  { data: \'aqh\', type: \'numeric\', format: \'0.00\'},  // AQH RTG\n	  	  { data: \'cpp\', type: \'numeric\', readOnly: true, format: \'0,0.00\'},  // CPP\n	  	  { data: \'impact\', type: \'numeric\'},  // 000\n	  	  { data: \'cpm\', type: \'numeric\', readOnly: true, format: \'0,0.00\'},  // CPM\n		{foreach $weeks as $week}\n		  { data: \'week.{$week@iteration}\', type: \'numeric\'},  // Week {$week@iteration} \n                {/foreach}\n	  	  { data: \'comments\'},  // Comments\n	  	  { data: \'copy\', renderer: copyButtonRenderer, readOnly: false},  // Copy\n	  	  { data: \'bold\', renderer: copyButtonRenderer, readOnly: false},  // Bold\n	  	  { data: \'delete\', renderer: copyButtonRenderer,  readOnly: false} // Delete\n	    ],\n	    currentRowClassName: \'currentRow\',\n            currentColClassName: \'currentCol\',\n	    minRows: 1,\n	    autoWrapRow: true,\n	    rowHeaders: true,\n	    contextMenu: [\'row_above\', \'row_below\', \'remove_row\'],\n	    columnSorting: true,\n	    stretchH: \'all\',\n	    persistentState: true,\n	    afterChange: function(changes, source) {\n		if (changes != null) {\n			for (var i = changes.length - 1; i >= 0; i--) {\n\n			     if (changes[i]) {\n			\n				if (changes[i][1] == \"aqh\") {\n					data[ changes[i][0] ][\"cpp\"] = (data[ changes[i][0] ][\"rate\"] / changes[i][3]).toFixed(3); \n					data[ changes[i][0] ][\"cpm\"] =   ((data[ changes[i][0] ][\"rate\"]) / (data[ changes[i][0] ][\"impact\"] / 1000)).toFixed(3); \n\n					this.render();\n				}\n				if (changes[i][1] == \"rate\") {\n					data[ changes[i][0] ][\"cpp\"] =  (changes[i][3] / data[ changes[i][0] ][\"aqh\"]).toFixed(3); \n					data[ changes[i][0] ][\"cpm\"] =   (changes[i][3] / (data[ changes[i][0] ][\"impact\"] / 1000)).toFixed(3); \n\n					this.render();\n				}\n				if (changes[i][1] == \"impact\") {\n					data[ changes[i][0] ][\"cpm\"] =  (data[ changes[i][0] ][\"rate\"] / (changes[i][3] / 1000) ).toFixed(3); \n					data[ changes[i][0] ][\"cpp\"] =  (data[ changes[i][0] ][\"rate\"] / data[ changes[i][0] ][\"aqh\"]).toFixed(3); \n					\n					this.render();\n				}\n				if (changes[i][1] == \"station\") {\n	\n					updateStations();				\n				}\n				if (changes[i][1] == \"delete\") {    \n					var instance = this;\n//					setColumnToCheckBox(changes[i][2], instance);	\n				}\n				if (changes[i][1] == \"vendor\") {\n	\n					data[ changes[i][0] ][\"vendorID\"] = vendors[data[ changes[i][0] ][\"vendor\"]];				\n				}\n		 	    }\n			}\n	\n			saveChanges(changes);\n\n		  }\n\n//		console.log(changes);\n		logData();\n//   		$.post({\n//     		url: \"save.php\",\n//		        data: changes\n//	        });\n// 		alert(countColumn(data,0));\n		summarySpots = sumColumnAssocIfNot(data,\"week\",\"daypart\",null);\n		$(\'#totalSpots\').html(summarySpots);\n//		$(\'#totalSpend\').html(\"$\" + sumColumn(data,\'lineSpendTotal\').toFixed(2));\n		$(\'#totalSpend\').html(\"$\" + sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'rate\', \'lineSpendTotal\').toFixed(2));\n		summaryGRPs = sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'aqh\', \'lineAQHTotal\');\n		$(\'#totalGRPs\').html(summaryGRPs.toFixed(1));\n		if (summarySpots > 0) {\n			$(\'#overallCPP\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpp\', \'lineCPPTotal\') / summarySpots + .001).toFixed(2));\n			$(\'#totalCPM\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpm\', \'lineCPMTotal\') / summarySpots + .001).toFixed(2));\n		}\n		updateSummary();\n		updateStations();\n	    },\n	    beforeChange: function (changes, source) {\n		for (var i = changes.length - 1; i >= 0; i--) {\n			if (changes[i][1] == \"timeOfDay\") {\n				changes[i][3]=nielsen_time_format(changes[i][3]);\n			}\n			if (changes[i][1] == \"copy\") {\n				//changes[i][3]=\"<input type=checkbox>\";\n			}\n		}\n	    },\n	    afterCreateRow: function(index, amount) {\n		maxLineNumber++;\n		data[index][\"lineNumber\"]=maxLineNumber;\n	    },\n	    beforeRemoveRow: function(row, amount) {\n			removeLines(row,amount);\n	    },\n	    afterRemoveRow: function(row, amount) {\n			console.log(\"Remove Row: \" + row + \" and \" + amount + \" after\");\n			data.splice(row,amount-1);\n			summarySpots = sumColumnAssocIfNot(data,\"week\",\"daypart\",null);\n			$(\'#totalSpots\').html(summarySpots);\n//			$(\'#totalSpend\').html(\"$\" + sumColumn(data,\'lineSpendTotal\').toFixed(2));\n			$(\'#totalSpend\').html(\"$\" + sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'rate\', \'lineSpendTotal\').toFixed(2));\n			summaryGRPs = sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'aqh\', \'lineAQHTotal\');\n			$(\'#totalGRPs\').html(summaryGRPs.toFixed(1));\n			if (summarySpots > 0) {\n				$(\'#overallCPP\').html(\"$\" + (sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpp\', \'lineCPPTotal\') / summarySpots +.001).toFixed(2));\n				$(\'#totalCPM\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpm\', \'lineCPMTotal\') / summarySpots + .001).toFixed(2));\n			}\n			updateSummary();\n	    }\n	  });\n      });\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][2] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/worksheets/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/worksheets/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/worksheets/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/worksheets/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.orderID + \"/pdf\";\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	</script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(8,0,'worksheet-tv','2014-06-23 20:37:45','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-TV | BluHorn{/block}\n\n{block name=\"header-js\"}\n	\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n	td {\n	   text-align: center;\n	}\n	td:nth-child(2) {\n	   text-align: center;\n	}\n	td:nth-child(23) {\n	   text-align: center;\n	}\n	td:nth-child(24) {\n	   text-align: center;\n	}\n	td:nth-child(25) {\n	   text-align: center;\n	}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\n</style>\n\n\n{/block}\n\n{block name=\"sidebar-clicked\"}onclick=\"refreshWorksheet();\"{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Broadcast TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Broadcast TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar\">\n<div class=\"control-inline toolbar-item-group\">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-lg-8\">\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'}   <strong>Campaign:</strong> {$campaign.name|default:\'none\'}    <strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Vendors(s):</strong> {foreach $vendors as $vendor} {$vendor.name} {/foreach}</div>\n												<div style=\"width: 100%; padding-bottom: 30px;\"><strong>Demo(s):</strong> {$campaign.demographics|default:\'none\'}   <strong>Contract #:</strong> {$campaign.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-lg-4\">\n												   <div class=\"pull-right\">\n												      <button class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n												      <button class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n												   </div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPPerStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$order.revision}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$order.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$order.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-4 col-lg-2 col-sm-6\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName}\n\n												    <div class=\"summary-daypart\" id=\"summary-daypart-{$daypart}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypart}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypart}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypart}\">0.0</div></td></tr>\n												      </table>\n												    </div>\n\n												     {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-8 col-lg-10\" id=\"dataTable-container\" style=\"overflow: visible; margin-bottom: 100px;\">\n\n								<div class=\"main-content\" id=\"main-content\" style=\"overflow: visible; margin-bottom: 100px;\">\n					\n\n\n									<div id=\"dataTable\"></div>\n\n							\n				\n								</div>						\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\">\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:0};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  var data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"null\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: 0, daypart: null, vendor: null, timeOfDay: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: null, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false }\n\n	{/if}\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	$( document ).ready(function() {\n\n	   $(\'#autoCalc\').bootstrapSwitch();\n	   $(\'#scrolling\').bootstrapSwitch();\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n	  $(\"#dataTable\").handsontable({\n	    data: data,\n	    colHeaders: [\"Day Part\",\"Vendor\",\"Station\",\"Time Period\",\"Program Name\",\"M\", \"T\", \"W\", \"R\", \"F\", \"Sa\", \"Su\",\"Length\",\"Rate\",\"AQH RTG\",\"CPP\",\"000\",\"CPM\",{foreach $weekNames as $weekName}\"{$weekName}\",{/foreach} \"Comments\",\"Copy\",\"Bold\",\"Delete\"],\n	    minSpareRows: 1,\n	    manualColumnResize: true,\n	    colWidths: [60, 60, 100, 100, 100,25,25,25,25,25,25,25,60,80,90,70,40,60,{foreach $weeks as $week} 50, {/foreach}80,50,50,50],\n	    columns: [\n	  	  {\n		    data: \'daypart\',\n	  	    type: \'dropdown\',\n	  	    source: [\"EM\", \"DA\", \"EF\", \"EN\", \"PA\", \"PR\", \"LF\", \"LN\", \"OV\", \"SP\", \"RO\"]\n	  	  },	  \n	  	  {\n		    data: \'vendor\',\n	  	    type: \'dropdown\',\n	  	    source: vendorNames\n	  	  },	\n		  { data: \'station\'}, // station call letters\n	  	  { data: \'timeOfDay\', validator: nielsen_time_validator_fn, allowInvalid: true}, // time period\n	  	  { data: \'program\'}, // program name\n	  	  { data: \'mon\', type: \'checkbox\'}, // mon\n	  	  { data: \'tue\', type: \'checkbox\'}, // tues\n	  	  { data: \'wed\', type: \'checkbox\'}, // wed\n	  	  { data: \'thu\', type: \'checkbox\'}, // thurs\n	  	  { data: \'fri\', type: \'checkbox\'}, // fri\n	  	  { data: \'sat\', type: \'checkbox\'}, // sat\n	  	  { data: \'sun\', type: \'checkbox\'}, // sun\n	  	  { data: \'length\', type: \'numeric\'},  // length\n	  	  { data: \'rate\', type: \'numeric\', format: \'$0,0.00\'},  // rate\n	  	  { data: \'aqh\', type: \'numeric\', format: \'0.00\'},  // AQH RTG\n	  	  { data: \'cpp\', type: \'numeric\', readOnly: true, format: \'0,0.00\'},  // CPP\n	  	  { data: \'impact\', type: \'numeric\'},  // 000\n	  	  { data: \'cpm\', type: \'numeric\', readOnly: true, format: \'0,0.00\'},  // CPM\n		{foreach $weeks as $week}\n		  { data: \'week.{$week@iteration}\', type: \'numeric\'},  // Week {$week@iteration} \n                {/foreach}\n	  	  { data: \'comments\'},  // Comments\n	  	  { data: \'copy\', renderer: copyButtonRenderer, readOnly: false},  // Copy\n	  	  { data: \'bold\', renderer: copyButtonRenderer, readOnly: false},  // Bold\n	  	  { data: \'delete\', renderer: copyButtonRenderer,  readOnly: false} // Delete\n	    ],\n	    currentRowClassName: \'currentRow\',\n            currentColClassName: \'currentCol\',\n	    minRows: 1,\n//	    height: 800,\n	    autoWrapRow: true,\n	    rowHeaders: true,\n	    contextMenu: [\'row_above\', \'row_below\', \'remove_row\'],\n	    columnSorting: true,\n	    stretchH: \'all\',\n	    persistentState: false,\n	    afterChange: function(changes, source) {\n		if (changes != null) {\n		   if ($(\"#autoCalc\").is(\":checked\")) {\n\n			for (var i = changes.length - 1; i >= 0; i--) {\n\n			     if (changes[i]) {\n			\n				if (changes[i][1] == \"aqh\") {\n					data[ changes[i][0] ][\"cpp\"] = (data[ changes[i][0] ][\"rate\"] / changes[i][3]).toFixed(3); \n					data[ changes[i][0] ][\"cpm\"] =   ((data[ changes[i][0] ][\"rate\"]) / (data[ changes[i][0] ][\"impact\"] / 1000)).toFixed(3); \n\n					this.render();\n				}\n				if (changes[i][1] == \"rate\") {\n					data[ changes[i][0] ][\"cpp\"] =  (changes[i][3] / data[ changes[i][0] ][\"aqh\"]).toFixed(3); \n					data[ changes[i][0] ][\"cpm\"] =   (changes[i][3] / (data[ changes[i][0] ][\"impact\"] / 1000)).toFixed(3); \n\n					this.render();\n				}\n				if (changes[i][1] == \"impact\") {\n					data[ changes[i][0] ][\"cpm\"] =  (data[ changes[i][0] ][\"rate\"] / (changes[i][3] / 1000) ).toFixed(3); \n					data[ changes[i][0] ][\"cpp\"] =  (data[ changes[i][0] ][\"rate\"] / data[ changes[i][0] ][\"aqh\"]).toFixed(3); \n					\n					this.render();\n				}\n				if (changes[i][1] == \"station\") {\n	\n					updateStations();				\n				}\n				if (changes[i][1] == \"delete\") {    \n					var instance = this;\n//					setColumnToCheckBox(changes[i][2], instance);	\n				}\n				if (changes[i][1] == \"vendor\") {\n	\n					data[ changes[i][0] ][\"vendorID\"] = vendors[data[ changes[i][0] ][\"vendor\"]];				\n				}\n		 	    }\n			}\n			\n			saveChanges(changes);\n		      }\n		      else {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		      }\n		     	\n		  }\n\n//		console.log(changes);\n//		logData();\n//   		$.post({\n//     		url: \"save.php\",\n//		        data: changes\n//	        });\n// 		alert(countColumn(data,0));\n		summarySpots = sumColumnAssocIfNot(data,\"week\",\"daypart\",null);\n		$(\'#totalSpots\').html(summarySpots);\n//		$(\'#totalSpend\').html(\"$\" + sumColumn(data,\'lineSpendTotal\').toFixed(2));\n		$(\'#totalSpend\').html(\"$\" + sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'rate\', \'lineSpendTotal\').toFixed(2));\n		summaryGRPs = sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'aqh\', \'lineAQHTotal\');\n		$(\'#totalGRPs\').html(summaryGRPs.toFixed(1));\n		if (summarySpots > 0) {\n			$(\'#overallCPP\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpp\', \'lineCPPTotal\') / summarySpots + .001).toFixed(2));\n			$(\'#totalCPM\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpm\', \'lineCPMTotal\') / summarySpots + .001).toFixed(2));\n		}\n		updateSummary();\n		updateStations();\n	    },\n	    beforeChange: function (changes, source) {\n		for (var i = changes.length - 1; i >= 0; i--) {\n			if (changes[i][1] == \"timeOfDay\") {\n				changes[i][3]=nielsen_time_format(changes[i][3]);\n			}\n			if (changes[i][1] == \"copy\") {\n				//changes[i][3]=\"<input type=checkbox>\";\n			}\n		}\n	    },\n	    afterCreateRow: function(index, amount) {\n		maxLineNumber++;\n		data[index][\"lineNumber\"]=maxLineNumber;\n	    },\n	    beforeRemoveRow: function(row, amount) {\n			removeLines(row,amount);\n	    },\n	    afterRemoveRow: function(row, amount) {\n			data.splice(row,amount-1);\n			summarySpots = sumColumnAssocIfNot(data,\"week\",\"daypart\",null);\n			$(\'#totalSpots\').html(summarySpots);\n//			$(\'#totalSpend\').html(\"$\" + sumColumn(data,\'lineSpendTotal\').toFixed(2));\n			$(\'#totalSpend\').html(\"$\" + sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'rate\', \'lineSpendTotal\').toFixed(2));\n			summaryGRPs = sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'aqh\', \'lineAQHTotal\');\n			$(\'#totalGRPs\').html(summaryGRPs.toFixed(1));\n			if (summarySpots > 0) {\n				$(\'#overallCPP\').html(\"$\" + (sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpp\', \'lineCPPTotal\') / summarySpots +.001).toFixed(2));\n				$(\'#totalCPM\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpm\', \'lineCPMTotal\') / summarySpots + .001).toFixed(2));\n			}\n			updateSummary();\n	    }\n	  });\n      });\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/worksheets/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/worksheets/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/worksheets/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/worksheets/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.orderID + \"/pdf\";\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/worksheets/ajax/delete/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option>-This Campaign-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet(\"+ worksheetID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n	function copyWorksheet(worksheetID) {\n				if (worksheetID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheets/ajax/copy/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/worksheets/edit/{$worksheetID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	</script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(9,0,'worksheet-station-summary','2014-05-11 18:00:18','','<div class=\"summary-station\" id=\"summary-station-{$station}\">\n	<center><h5 id=\"summary-station-title-{$station}\"></h5>{$station}</center>\n	<table style=\"border: 0px; margin: 0 auto; \">\n		<tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"station-totalSpots-{$station}\">0</div></td></tr>\n		<tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"station-totalSpend-{$station}\">$0.00</div></td></tr>\n		<tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"station-totalGRPs-{$station}\">0.0</div></td></tr>\n		<tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"station-overallCPP-{$station}\">$0.00</div></td></tr>\n		<tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"station-totalCPM-{$station}\">$0.00</div></td></tr>\n		<tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"station-percentOfTotalGRP-{$station}\">0.0</div></td></tr>\n	</table>\n</div>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(10,0,'clients','2015-05-05 20:28:10','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Clients</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Clients</h2>\n								<em>Listing of All Clients</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Clients</h3>\n										<em>- <a href=\"clients/create\">Add A New Client</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Name</th>\n													<th>Contact</th>\n													<th>Phone Number</th>\n													<th>Email Address</th>\n													<th>Total Spend</th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n\n{foreach $clients as $client}\n												<tr>\n													<td><a href=\"clients/edit/{$client.id}\">{$client.name}</a></td>\n													<td>{$client.contactName}</td>\n													<td>{$client.phoneNumber}</td>\n													<td>{$client.emailAddress}</td>\n													<td>{$client.totalSpend|default:\"$0.00\"|number_format:2:\".\":\"\"}</td>\n\n	<td><center><a href=\"clients/edit/{$client.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n	\n												</tr>\n{/foreach}\n												</tbody>\n										</table>\n									</div>\n								</div>\n\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(11,0,'clients-create','2015-05-07 02:44:48','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Clients</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Clients</h2>\n								<em>Add A New Client</em>\n							</div>\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Add a New Client</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  method=\"post\" action=\"/bluhorn/clients/create/new\" id=\"addClient\" name=\"addClient\" role=\"form\" data-parsley-validate novalidate >\n{if $alert.error}\n<div class=\"alert alert-danger alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> {$alert.error}\n</div>\n{/if}		\n					<div id=\"client-name\" class=\"form-group {if $clientNameError}has-error error{/if}\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Client Name</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"clientName\" value=\"{$client.name}\" id=\"client-name-input\" class=\"form-control\" required>\n							{if $clientNameError}										<span id=\"client-name-help\" class=\"help-block text-danger\">Client Name Already Exists!</span>\n							{/if}\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" value=\"{$client.contactName}\" id=\"contactName\" class=\"form-control\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" value=\"{$client.emailAddress}\" name=\"emailAddress\" class=\"form-control\" data-parsley-trigger=\"change\" >\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\"  value=\"{$client.address}\" name=\"address\" id=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\"></textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" value=\"{$client.phoneNumber}\" name=\"phoneNumber\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\"  value=\"{$client.faxNumber}\" name=\"faxNumber\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<label for=\"website\" class=\"col-sm-4 control-label\">Website\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			<input type=\"text\" id=\"website\" value=\"{$client.website}\" name=\"website\" class=\"form-control\">\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"bgColor\" class=\"col-sm-4 control-label\">Primary Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			\n																			<select id=\"bgColor\" value=\"#ac725e\" name=\"bgColor\" class=\"simplecolorpicker icon\" style=\"display: none;\">\n																				  <option value=\"#fff\">#fff</option>\n																				  <option value=\"#ac725e\">#ac725e</option>\n																				  <option value=\"#d06b64\">#d06b64</option>\n																				  <option value=\"#f83a22\">#f83a22</option>\n																				  <option value=\"#fa573c\">#fa573c</option>\n																				  <option value=\"#ff7537\">#ff7537</option>\n																				  <option value=\"#ffad46\">#ffad46</option>\n																				  <option value=\"#42d692\">#42d692</option>\n																				  <option value=\"#16a765\">#16a765</option>\n																				  <option value=\"#7bd148\">#7bd148</option>\n																				  <option value=\"#b3dc6c\">#b3dc6c</option>\n																				  <option value=\"#fbe983\">#fbe983</option>\n																				  <option value=\"#fad165\">#fad165</option>\n																				  <option value=\"#92e1c0\">#92e1c0</option>\n																				  <option value=\"#9fe1e7\">#9fe1e7</option>\n																				  <option value=\"#9fc6e7\">#9fc6e7</option>\n																				  <option value=\"#4986e7\">#4986e7</option>\n																				  <option value=\"#9a9cff\">#9a9cff</option>\n																				  <option value=\"#b99aff\">#b99aff</option>\n																				  <option value=\"#c2c2c2\">#c2c2c2</option>\n																				  <option value=\"#cabdbf\">#cabdbf</option>\n																				  <option value=\"#cca6ac\">#cca6ac</option>\n																				  <option value=\"#f691b2\">#f691b2</option>\n																				  <option value=\"#cd74e6\">#cd74e6</option>\n																				  <option value=\"#a47ae2\">#a47ae2</option>\n																			</select>\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"fontColor\" class=\"col-sm-4 control-label\">Secondary Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																		\n																			<select  id=\"fontColor\" value=\"#fff\" name=\"fontColor\" class=\"simplecolorpicker icon\" style=\"display: none;\">\n																				  <option value=\"#fff\">#fff</option>	\n																				  <option value=\"#000\">#000</option>\n																			</select>\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Notes</p>\n							<textarea id=\"textarea\" name=\"notes\" id=\"notes\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: none;\">{$client.notes}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"bgColor\" class=\"col-sm-4 control-label\">Calendar Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			<input type=\"text\" id=\"bgColor\" value=\"{$client.bgColor}\" name=\"bgColor\" class=\"form-control\">\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"fontColor\" class=\"col-sm-4 control-label\">Calendar text Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			<input type=\"text\" id=\"fontColor\" value=\"{$client.fontColor}\" name=\"fontColor\" class=\"form-control\">\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<input type=\"hidden\" name=\"clientID\" value=\"new\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"createClient();\">Add Client</button>\n							</p>\n						</div>\n					</div>										</form>\n		</div>\n\n		<div class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n</div>\n\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n\n	<script>\n\n\n	  function createClient() {\n	  \n		$(\"#addClient\").submit();\n		  		 		  \n	\n	  }\n	  \n	  function deleteClient() {\n		  \n		  bootbox.confirm(\'Are you sure?\', function(result) { console.log(\"Confirm result: \"+result); });\n	  }\n\n\n	</script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.simplecolorpicker.js\"></script>\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n			$(\'#fax\').mask(\'(999) 999-9999\');\n\n			$(\"#client-name-input\").change(function() {\n				$(\"#client-name\").removeClass(\"has-error error\");\n				$(\"#client-name-help\").hide();\n			});	\n			$(\'select[name=\"bgColor\"]\').simplecolorpicker( { \n				picker: true, theme: \'glyphicons\',\n			});\n			\n		    $(\'select[name=\"bgColor\"]\').simplecolorpicker(\'selectColor\', \'#ac725e\');\n			$(\'select[name=\"fontColor\"]\').simplecolorpicker( { \n				picker: true, theme: \'glyphicons\',\n			});\n			\n		});\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(12,0,'clients-edit','2015-05-07 02:55:00','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/clients/\">Clients</a></li>\n			<li class=\"active\" id=\"breadcrumb-client-name\">{$client.name}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Clients</h2>\n								<em>Information & Campaigns</em>\n							</div>\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Client Information</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-users\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"clientActive\" name=\"isActive\" {if $client.isActive}checked{/if} class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n		<form id=\"client-form\" class=\"form-horizontal label-left\" role=\"form\">\n			<input type=\"hidden\" name=\"clientID\" value=\"{$client.id}\">\n			<input type=\"hidden\" name=\"agencyID\" value=\"{$client.agencyID}\">\n			<input type=\"hidden\" id=\"client-active\" name=\"isActive\" value=\"{$client.isActive}\">\n\n					<div class=\"form-group\" id=\"client-name\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Client Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"clientName\" id=\"client-name-input\" class=\"form-control\"  value=\"{$client.name}\" required>\n								<span id=\"client-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Client Name Already Exists!</span>						</div>\n					</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" class=\"form-control\"  value=\"{$client.contactName}\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"emailAddress\" id=\"text-input\" class=\"form-control\"  value=\"{$client.emailAddress}\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\" name=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\">{$client.address}</textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" name=\"phoneNumber\" id=\"phone\" value=\"{$client.phoneNumber}\"  class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\"  name=\"faxNumber\" value=\"{$client.faxNumber}\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<label for=\"website\" class=\"col-sm-4 control-label\">Website\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			<input type=\"text\" id=\"website\" value=\"{$client.website}\" name=\"website\" class=\"form-control\">\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"bgColor\" class=\"col-sm-4 control-label\">Primary Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			\n																			<select id=\"bgColor\" value=\"{$client.bgColor}\" name=\"bgColor\" class=\"simplecolorpicker icon\" style=\"display: none;\">\n																				  <option value=\"#fff\">#fff</option>\n																				  <option value=\"#ac725e\">#ac725e</option>\n																				  <option value=\"#d06b64\">#d06b64</option>\n																				  <option value=\"#f83a22\">#f83a22</option>\n																				  <option value=\"#fa573c\">#fa573c</option>\n																				  <option value=\"#ff7537\">#ff7537</option>\n																				  <option value=\"#ffad46\">#ffad46</option>\n																				  <option value=\"#42d692\">#42d692</option>\n																				  <option value=\"#16a765\">#16a765</option>\n																				  <option value=\"#7bd148\">#7bd148</option>\n																				  <option value=\"#b3dc6c\">#b3dc6c</option>\n																				  <option value=\"#fbe983\">#fbe983</option>\n																				  <option value=\"#fad165\">#fad165</option>\n																				  <option value=\"#92e1c0\">#92e1c0</option>\n																				  <option value=\"#9fe1e7\">#9fe1e7</option>\n																				  <option value=\"#9fc6e7\">#9fc6e7</option>\n																				  <option value=\"#4986e7\">#4986e7</option>\n																				  <option value=\"#9a9cff\">#9a9cff</option>\n																				  <option value=\"#b99aff\">#b99aff</option>\n																				  <option value=\"#c2c2c2\">#c2c2c2</option>\n																				  <option value=\"#cabdbf\">#cabdbf</option>\n																				  <option value=\"#cca6ac\">#cca6ac</option>\n																				  <option value=\"#f691b2\">#f691b2</option>\n																				  <option value=\"#cd74e6\">#cd74e6</option>\n																				  <option value=\"#a47ae2\">#a47ae2</option>\n																			</select>\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"fontColor\" class=\"col-sm-4 control-label\">Secondary Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																		\n																			<select  id=\"fontColor\" value=\"{$client.fontColor}\" name=\"fontColor\" class=\"simplecolorpicker icon\" style=\"display: none;\">\n																				  <option value=\"#fff\">#fff</option>	\n																				  <option value=\"#000\">#000</option>\n																			</select>\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Notes</p>\n							<textarea id=\"textarea\" class=\"form-control\" name=\"notes\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: none;\">{$client.notes}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveClient();\">Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteClient();\">Delete</button>\n							</p>\n						</div>\n					</div>		\n															</form>\n\n		</div>\n\n		<div id=\"client-footer\" class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Offices</h3>\n										<div class=\"btn-group widget-header-toolbar\">												<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n										</div>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Name</th>\n													<th>Department</th>\n													<th>City/State</th>\n													<th>Contact Name</th>\n													<th>Phone Number</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $offices as $office}\n												<tr>\n													<td>{$office.name}</td>\n													<td>{$office.dept}</td>\n													<td>{$office.city}{if $office.city},{/if} {$office.state}</td>\n													<td>{$office.contactName}</td>\n													<td>{$office.phoneNumber}</td>\n												</tr>\n{/foreach}\n												</tbody>\n										</table>\n									</div>\n								</div>\n\n\n</div>\n\n<div class=\"col-lg-6\">\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-rocket\"></i> Campaigns</h3>\n										<em>- <a href=\"campaigns/create\">Add A New Campaign</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>#</th>\n\n	<th>Name</th>\n													<th>Job Number</th>\n													<th>Start</th>\n													<th>End</th>\n													<th>Total ($)</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $campaigns as $campaign}\n												<tr>\n													<td>{$campaign.id}</td>\n													<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></td>\n													<td>{$campaign.jobNumber}</td>\n													<td nowrap>{$campaign.flightStart}</td>\n\n	<td nowrap>{$campaign.flightEnd}</td>\n													<td nowrap style=\"min-width: 50px;\">{$campaign.totalSpend|default:\"\"}</td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n<!-- Calendar -->\n{include file=\"db:full-calendar\"}\n\n<!-- END Calendar -->\n</div>\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n    <script type=\'text/javascript\' src=\'http://fullcalendar.io/js/fullcalendar-2.1.1/gcal.js\'></script>\n\n    <script>\n    $( function() {\n    \n    	$(\'#calendar\').fullCalendar({\n    \n        eventSources: [\n    \n            // your event source\n            {\n    		url: \'/calendar/ajax/clients/edit/{$client.id}\',\n            }\n    \n        ]\n    \n    	});\n\n    });\n    \n\n\n    </script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.simplecolorpicker.js\"></script>\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n			$(\'#fax\').mask(\'(999) 999-9999\');\n			$(\'#clientActive\').bootstrapSwitch();\n\n			$(\"#client-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#clientActive\").change(function () {\n			    resetFooter();\n			    clientActive(); \n			}); \n\n			$(\'select[name=\"bgColor\"]\').simplecolorpicker( { \n				picker: true, theme: \'glyphicons\',\n			});\n		    $(\'select[name=\"bgColor\"]\').simplecolorpicker(\'selectColor\', \'{$client.bgColor}\');\n			$(\'select[name=\"fontColor\"]\').simplecolorpicker( { \n				picker: true, theme: \'glyphicons\',\n			});\n\n			$(\'select[name=\"bgColor\"]\').change( function() {\n			     $(\".fc-event-inner\").css(\"background-color\", $(\'select[name=\"bgColor\"]\').val());\n			});\n\n			$(\'select[name=\"fontColor\"]\').change( function() {\n			     $(\".fc-event-inner\").css(\"color\", $(\'select[name=\"fontColor\"]\').val());\n			});\n		});\n\n	</script>\n\n	<script type=\"text/javascript\">\n\n		function resetFooter() {\n				$(\"#client-footer\").html(\"Not Saved\");\n		}\n\n		function clientActive() {\n\n			if ($(\"#clientActive\").is(\":checked\")) {\n				$(\"#client-active\").val(\"1\");\n			}\n			else {\n				$(\"#client-active\").val(\"0\");\n			}\n		}\n\n	 	 function createClient() {\n	  \n	  		alert(\"saving client\");\n			  		 		  \n	  	}\n\n		function saveClient() {\n			\n			$(\"#client-footer\").html(\"Saving.\");\n\n			clientActive();\n\n			$.post( \"/clients/ajax/save/{$client.id}\", $( \"#client-form\" ).serialize(), function() {\n				$(\"#client-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#client-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#client-name-help\").show();\n\n				}\n				else {\n					$(\"#client-name\").removeClass(\"has-error error\");\n					$(\"#client-name-help\").hide();\n				}\n				$(\"#breadcrumb-client-name\").html($(\"#client-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#client-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n	  \n	  	function deleteClient() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#client-footer\").html(\"Deleting..\");\n\n					$.post( \"/clients/ajax/delete/{$client.id}\", $( \"#client-form\" ).serialize(), function() {\n						$(\"#client-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#client-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/clients/all\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#client-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#client-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(13,0,'vendors','2014-07-28 23:52:07','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Vendors</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Vendors</h2>\n								<em>All Vendors</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-truck\"></i> Vendors</h3>\n										<em>- <a href=\"vendors/create\">Add A New Vendor</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Type</th>\n													<th>Name</th>\n													<th>Market</th>\n													<th>City</th>\n													<th>State</th>\n													<th>Annual $</th>\n													<th></th>\n\n												</tr>\n											</thead>\n											<tbody>\n												<tr>\n\n{foreach $vendors as $vendor}\n													<td>{$vendor.vendorTypeDescription}</td>\n													<td><a href=\"vendors/edit/{$vendor.id}\">{$vendor.name}</a></td>\n													<td>{$vendor.marketName}</td>\n													<td>{$vendor.city}</td>\n													<td>{$vendor.state}</td>\n													<td>{$vendor.annualSpend}</td>\n\n	<td><center><a href=\"vendors/edit/{$vendor.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(14,0,'vendors-create','2014-08-11 20:31:09','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Vendors</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Vendors</h2>\n								<em>Create A New Vendor</em>\n							</div>\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Add a New Vendor</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\" method=\"post\" action=\"/vendors/create/new\" id=\"addVendor\" name=\"addVendor\" role=\"form\" data-parsley-validate novalidate >\n{if $alert.error}\n<div class=\"alert alert-danger alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> {$alert.error}\n</div>\n{/if}		\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Type</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"vendor-type\" name=\"vendorType\" class=\"form-control\">\n									{foreach $vendorTypes as $vendorType}\n																						<option value=\"{$vendorType.id}\">{$vendorType.description}</option>\n\n									{/foreach}\n\n								</select>\n\n							</div>\n																		</div>\n\n\n\n					<div id=\"vendor-name\" class=\"form-group {if $vendorNameError}has-error error{/if}\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor Name</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"vendorName\" value=\"{$vendor.name}\" id=\"vendor-name-input\" class=\"form-control\" required>\n							{if $vendorNameError}										<span id=\"vendor-name-help\" class=\"help-block text-danger\">Vendor Name Already Exists!</span>\n							{/if}\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" value=\"{$vendor.contactName}\"  id=\"contactName\" class=\"form-control\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" value=\"{$vendor.emailAddress}\"  name=\"emailAddress\" class=\"form-control\" data-parsley-trigger=\"change\" >\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\"  name=\"address\" id=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\">{$vendor.address}</textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" value=\"{$vendor.phoneNumber}\" name=\"phoneNumber\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\" value=\"{$vendor.phoneNumber}\"  name=\"faxNumber\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Website</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" id=\"website\" value=\"{$vendor.website}\"  name=\"website\" class=\"form-control\" data-parsley-trigger=\"change\" >\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Notes</p>\n							<textarea id=\"textarea\" name=\"notes\" id=\"notes\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"9999\" style=\"resize: none;\">{$vendor.notes}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"createVendor();\">Add Vendor</button>\n							</p>\n						</div>\n					</div>										</form>\n		</div>\n\n		<div class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n</div>\n\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n			$(\'#fax\').mask(\'(999) 999-9999\');\n\n			$(\"#vendor-name-input\").change(function() {\n				$(\"#vendor-name\").removeClass(\"has-error error\");\n				$(\"#vendor-name-help\").hide();\n			});\n		\n			$(\"#vendor-type\").val(\"7\");\n\n		});\n\n	</script>\n\n	<script>\n\n\n	  function createVendor() {\n	  \n		$(\"#addVendor\").submit();\n		  		 		  \n	\n	  }\n\n	</script>\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(15,0,'vendors-edit','2015-02-06 15:51:34','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/vendors/\">Vendors</a></li>\n			<li class=\"active\" id=\"breadcrumb-vendor-name\">{$vendor.name}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Vendors</h2>\n								<em>Information & Markets</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Vendor Information</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-truck\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"vendorActive\" name=\"isActive\" {if $vendor.isActive}checked{/if} class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>	\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  method=\"post\" action=\"/vendors/edit/{$vendor.id}\" id=\"vendor-form\" name=\"addVendor\" role=\"form\" data-parsley-validate novalidate >\n\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n\n{if $alert.error}\n<div class=\"alert alert-danger alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> {$alert.error}\n</div>\n{/if}	\n				<input type=\"hidden\" name=\"vendorID\" value=\"{$vendor.id}\">\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$vendor.agencyID}\">\n				<input type=\"hidden\" id=\"vendor-active\" name=\"isActive\" value=\"{$vendor.isActive}\">\n\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Type</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"vendor-type\" name=\"vendorType\" class=\"form-control\">\n									{foreach $vendorTypes as $vendorType}\n																						<option value=\"{$vendorType.id}\" {if $vendor.vendorType == $vendorType.id}selected{/if}>{$vendorType.description}</option>\n\n									{/foreach}\n\n								</select>\n\n							</div>\n																	</div>\n\n					<div class=\"form-group\"  id=\"vendor-name\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor Name</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"vendorName\" value=\"{$vendor.name}\" id=\"vendorName\" class=\"form-control\" required>\n							<span id=\"vendor-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Vendor Name Already Exists!</span>						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" value=\"{$vendor.contactName}\" id=\"contactName\" class=\"form-control\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" name=\"emailAddress\" value=\"{$vendor.emailAddress}\" class=\"form-control\" data-parsley-trigger=\"change\" >\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\"  name=\"address\" id=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\">{$vendor.address}</textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" name=\"phoneNumber\" value=\"{$vendor.phoneNumber}\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\" name=\"faxNumber\" value=\"{$vendor.faxNumber}\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Website</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"website\" name=\"website\" class=\"form-control\"  value=\"{$vendor.website}\" data-parsley-trigger=\"change\" >\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Notes</p>\n							<textarea id=\"textarea\" name=\"notes\" id=\"notes\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"9999\" style=\"resize: none;\">{$vendor.notes}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveVendor();\">Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteVendor();\">Delete</button>\n							</p>\n						</div>\n					</div>\n\n				</form>\n\n		</div>\n\n		<div id=\"vendor-footer\" class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n</div>\n<div class=\"col-lg-6\">\n\n								<div class=\"widget widget-table hide\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Campaigns</h3>\n										<em>- <a href=\"campaigns/create\">Add A New Campaign</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Campaign #</th>\n\n	<th>Name</th>\n													<th>Job Number</th>\n													<th>Flight Start</th>\n													<th>Flight End</th>\n													<th>Total Spend</th>\n												</tr>\n											</thead>\n											<tbody>\n												<tr>\n													<td>1001</td>\n													<td>Test</td>\n													<td>AFE106.2</td>\n													<td>May 5th, 2014</td>\n\n	<td>May 26th, 2014</td>\n													<td>$12,957</td>\n												</tr>\n\n											</tbody>\n										</table>\n\n\n									</div>\n								</div>\n\n</div>\n</div>\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3><i class=\"fa fa-paper-plane\"></i>Add A New Market & Rep</h3>\n				<div class=\"btn-group widget-header-toolbar\">					<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n				</div>\n			</div>\n			<div class=\"widget-content\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"addMarket\" name=\"addMarket\" role=\"form\">\n							<input type=\"hidden\" name=\"vendorID\" value=\"{$vendor.id}\">\n							<input type=\"hidden\" name=\"agencyID\" value=\"{$vendor.agencyID}\">\n							<div class=\"form-group\" id=\"market-name\">\n																				<label for=\"addMarketName\" class=\"col-sm-4 control-label\">Market Name</label>\n																				<div class=\"col-sm-8\">\n																					<input type=\"text\" id=\"marketName\"  name=\"marketName\" class=\"form-control\">\n									<span id=\"market-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Market Name Already Exists!</span>\n								</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																					<label for=\"text-input\" class=\"col-sm-4 control-label\">Rep Name</label>\n																					<div class=\"col-sm-8\">\n										<input type=\"text\" id=\"text-input\"  name=\"contactName\"  value=\"{$vendor.contactName}\" class=\"form-control\" required>\n									</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																				<div class=\"col-sm-8\">\n									<input type=\"text\" id=\"text-input\" name=\"emailAddress\" value=\"{$vendor.emailAddress}\" class=\"form-control\" required>\n								</div>\n																			</div>\n																			<div class=\"form-group\">\n																				<label for=\"addMarketRepPhone\" class=\"col-sm-4 control-label\">Phone Number\n																				<br>\n																				<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addMarketRepPhone\" name=\"phoneNumber\" value=\"{$vendor.phoneNumber}\" class=\"form-control\">\n																				</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																				<label for=\"addMarketRepFax\" class=\"col-sm-4 control-label\">Fax Number\n																					<br>\n																					<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addMarketRepFax\" name=\"faxNumber\" value=\"{$vendor.faxNumber}\" class=\"form-control\">\n																				</div>\n																			</div>\n\n{if $vendor.isBroadcast}	\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Station(s)</label>\n																				<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n									<input type=\"text\" id=\"addMarketStations\" name=\"stations\" class=\"form-control\">\n\n								</div>\n\n							</div>\n{/if}\n\n\n\n					</form>\n\n					</div>\n\n							<div class=\"form-group\">\n								<div class=\"col-sm-12\">\n									<p class=\"pull-right\">\n										<button type=\"button\" class=\"btn btn-success\" onclick=\"createMarket();\">Add Market Rep</button>\n									</p>\n								</div>\n							</div>\n				</div>\n\n			</div>\n			<div id=\"market-footer\" class=\"widget-footer\">\n			Not Saved\n			</div>\n		</div>\n\n	</div>\n\n</div>\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-map-marker\"></i> Markets</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"vendorMarkets\" class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Market</th>\n\n	<th>Rep</th>\n													<th>Phone</th>\n													<th>Fax</th>\n													<th>Email</th>\n													<th>Station(s)</th>						\n\n	<th></th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $markets as $market}\n												<tr  id=\"market-{$market.id}\">\n													<td>{$market.name}</td>\n													<td>{$market.contactName}</td>\n													<td>{$market.phoneNumber}</td>\n													<td>{$market.faxNumber}</td>\n\n	<td>{$market.emailAddress}</td>\n\n	<td>{$market.stations}</td>\n\n	<td><a href=\"markets/edit/{$market.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><a href=\"javascript:deleteMarket(\'{$market.id}\');\" style=\"a { color: #333;}\"><i class=\"fa fa-trash-o fa-lg\"></i></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n			<div id=\"vendorMarkets-footer\" class=\"widget-footer\">\n			Not Saved\n			</div>\n								</div>\n\n\n</div>\n</div>\n\n{if $vendor.isBroadcast}\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-cube\"></i> Programs</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"vendorPrograms\" class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Station</th>\n\n	<th>Program Name</th>\n													<th>Days</th>\n													<th>Times</th>\n						\n	<th>Rates</th>				\n\n	<th></th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $programs as $program}\n												<tr>\n													<td>{$program.station}</td>\n													<td>{$program.name}</td>\n													<td>{$program.daysOfWeek}</td>\n													<td>{$program.timePeriod}</td>\n\n	<td>{$program.rateRange}</td>\n\n	<td><a href=\"programs/edit/{$program.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><i class=\"fa fa-trash-o fa-lg\"></i></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n\n</div>\n</div>\n{/if}\n\n{if $vendor.isPublished}\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-cube\"></i> Publications</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"vendorPublications\" class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Type</th>\n\n	<th>Name</th>\n													<th>Frequency</th>\n													<th>Distribution</th>\n						\n	<th>Rates</th>				\n\n	<th></th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $publications as $publication}\n												<tr>\n													<td>{$program.station}</td>\n													<td>{$program.name}</td>\n													<td>{$program.daysOfWeek}</td>\n													<td>{$program.timePeriod}</td>\n\n	<td>{$program.rateRange}</td>\n\n	<td><a href=\"programs/edit/{$program.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><i class=\"fa fa-trash-o fa-lg\"></i></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n\n</div>\n</div>\n{/if}\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n			$(\'#fax\').mask(\'(999) 999-9999\');\n			$(\'#vendorActive\').bootstrapSwitch();\n\n			$(\'#addMarketRepPhone\').mask(\'(999) 999-9999? x99999\');\n			$(\'#addMarketRepFax\').mask(\'(999) 999-9999\');\n\n			$(\"#vendor-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#vendorActive\").change(function () {\n			    resetFooter();\n			    vendorActive(); \n			}); \n		});\n\n	</script>\n	<script>\n		function createMarket() {\n\n			$(\"#market-footer\").html(\"Saving.\");\n\n			$.post( \"/markets/ajax/add/\", $( \"#addMarket\" ).serialize(), function() {\n				$(\"#market-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#market-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#market-name-help\").show();\n\n				}\n				else {\n					$(\"#market-name\").removeClass(\"has-error error\");\n					$(\"#market-name-help\").hide();\n					var newRow = $(\'#vendorMarkets\').dataTable().fnAddData( [response.newMarket.name,response.newMarket.contactName,response.newMarket.phoneNumber,response.newMarket.faxNumber,response.newMarket.emailAddress,response.newMarket.stations, \"<a href=\'markets/edit/\" + response.newMarket.id + \"\' style=\'a { color: #333;}\'><i class=\'fa fa-pencil fa-lg\'></i></a>\", \"<a href=\'javascript:deleteMarket(\" + response.newMarket.id + \");\' style=\'a { color: #333;}\'><i class=\'fa fa-trash-o fa-lg\'></i>\"] );\n	\n					var mktDataTable = $(\'#vendorMarkets\').dataTable();\n					var newRowTR = mktDataTable.fnSettings().aoData[ newRow[0] ].nTr;\n					newRowTR.setAttribute(\"id\", \"market-\" + response.newMarket.id);\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#market-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#market-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function resetFooter() {\n				$(\"#vendor-footer\").html(\"Not Saved\");\n		}\n\n		function vendorActive() {\n\n			if ($(\"#vendorActive\").is(\":checked\")) {\n				$(\"#vendor-active\").val(\"1\");\n			}\n			else {\n				$(\"#vendor-active\").val(\"0\");\n			}\n		}\n\n		function saveVendor() {\n			\n			$(\"#vendor-footer\").html(\"Saving.\");\n\n			vendorActive();\n\n			$.post( \"/vendors/ajax/save/{$vendor.id}\", $( \"#vendor-form\" ).serialize(), function() {\n				$(\"#vendor-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#vendor-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#vendor-name-help\").show();\n\n				}\n				else {\n					$(\"#vendor-name\").removeClass(\"has-error error\");\n					$(\"#vendor-name-help\").hide();\n				}\n				$(\"#breadcrumb-vendor-name\").html($(\"#vendorName\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#vendor-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#vendor-footer\").html(\"Error!\");\n			})\n		}\n	  \n	  	function deleteVendor() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#vendor-footer\").html(\"Deleting..\");\n\n					$.post( \"/vendors/ajax/delete/{$vendor.id}\", $( \"#vendor-form\" ).serialize(), function() {\n						$(\"#vendor-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#vendor-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/vendors/all\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#vendor-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#vendor-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n		function deleteMarket(marketID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#vendorMarkets-footer\").html(\"Deleting..\");\n\n					$.post( \"/markets/ajax/delete/\"+marketID, $( \"#vendorMarkets-form\" ).serialize(), function() {\n						$(\"#vendorMarkets-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#vendorMarkets-footer\").html(response.message);\n						if (response.error) {\n							$(\"#vendorMarkets-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var wsDataTable = $(\'#vendorMarkets\').dataTable();\n							wsDataTable.fnDeleteRow(  wsDataTable.$(\'#market-\'+marketID)[0] );\n//							window.location.href=\"/marketss/edit/{$market.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#vendorMarkets-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#vendorMarkets-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n\n\n\n	</script>\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(16,0,'agency','2014-08-29 10:20:16','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Agency</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Agency</h2>\n								<em>Summary</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Agency Information</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  id=\"agency-form\" name=\"agencyInfo\" role=\"form\" data-parsley-validate novalidate >\n\n					<input type=\"hidden\" name=\"agencyID\" value=\"{$agency.id}\">\n\n					<div class=\"form-group\">\n																		<label for=\"agencyName\" class=\"col-sm-4 control-label\">Agency Name</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"agencyName\" id=\"agencyName\" class=\"form-control\"  value=\"{$agency.name}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" id=\"contactName\" class=\"form-control\" value=\"{$agency.contactName}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" name=\"emailAddress\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$agency.emailAddress}\" {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\"  name=\"address\" id=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\" {if $readOnly} readonly{/if}>{$agency.address}</textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" name=\"phoneNumber\" class=\"form-control\" value=\"{$agency.phoneNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\" name=\"faxNumber\" class=\"form-control\" value=\"{$agency.faxNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"website\" class=\"col-sm-4 control-label\">Website</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"website\" name=\"website\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$agency.website}\" {if $readOnly} readonly{/if}> \n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Default Comments</p>\n							<textarea id=\"textarea\" name=\"comments\" id=\"comments\" class=\"form-control\" rows=\"6\" cols=\"30\"  style=\"resize: vertical;\" {if $readOnly} readonly{/if}>{$agency.comments}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n{if ! $readOnly} \n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveAgency();\">Save</button>\n							</p>\n						</div>\n					</div>	\n{/if}\n				</form>\n\n		</div>\n\n		<div class=\"widget-footer\" id=\"agency-footer\">\n		</div>\n\n	</div>\n</div>\n\n{if $user.isAgencyAdmin} \n	<div class=\"col-lg-6\">\n\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-cloud-upload\"></i> Upload Logos & Other Media</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n										<form class=\"dropzone\" enctype=\"multipart/form-data\"></form>\n									</div>\n								</div>\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-image-o\"></i> Agency Logos & Media</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n\n									</div>\n								</div>\n	</div>\n\n</div>\n\n<div class=\"row\">\n\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-credit-card\"></i> Licenses & Subscriptions</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n\n									</div>\n								</div>\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3></i>Add A New User</h3>\n				<div class=\"btn-group widget-header-toolbar\">					<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>\n				</div>\n			</div>\n			<div class=\"widget-content\" style=\"display:none;\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"addUser\" name=\"addUser\" role=\"form\">\n\n							<div class=\"form-group\">\n																				<label for=\"userRole\" class=\"col-sm-4 control-label\">Role</label>\n																				<div class=\"col-sm-8\">\n									<select class=\"form-control input\" name=\"userRole\">\n										\n										<option value=\"agency-user\">Agency User</option>\n										<option value=\"agency-admin\">Agency Admin</option>\n\n									</select>\n	\n								</div>\n																			</div>\n		\n							<div class=\"form-group\">\n																				<label for=\"addUserFirstName\" class=\"col-sm-4 control-label\">First Name</label>\n																				<div class=\"col-sm-8\">\n																					<input type=\"text\" id=\"addUserFirstName\" name=\"addUserFirstName\" class=\"form-control\">\n	\n								</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																					<label for=\"addUserLastName\" class=\"col-sm-4 control-label\">Last Name</label>\n																					<div class=\"col-sm-8\">\n										<input type=\"text\" id=\"addUserLastName\" name=\"addUserLastName\" class=\"form-control\" required>\n									</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"addUserEmailAddress\" class=\"col-sm-4 control-label\">Email Address</label>\n																				<div class=\"col-sm-8\">\n									<input type=\"text\" id=\"addUserEmailAddress\" name=\"addUserEmailAddress\" class=\"form-control\" required>\n								</div>\n																			</div>\n																			<div class=\"form-group\">\n																				<label for=\"addUserPhone\" class=\"col-sm-4 control-label\">Phone Number\n																				<br>\n																				<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addUserPhone\" name=\"addUserPhone\" class=\"form-control\">\n																				</div>\n																			</div>\n\n						<form>\n\n					</div>\n\n							<div class=\"form-group\">\n								<div class=\"col-sm-12\">\n									<p class=\"pull-right\">\n										<button type=\"button\" class=\"btn btn-success\" onclick=\"addMarket();\">Invite User</button>\n									</p>\n								</div>\n							</div>\n				</div>\n\n			</div>\n\n		</div>\n\n	</div>\n\n</div>\n{/if}\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Authorized Users</h3>\n										<em> </em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Role</th>\n													<th>First Name</th>\n													<th>Last Name</th>\n													<th>Email Address</th>\n													<th>Last Login</th>\n													<th>Status</th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $agencyUsers as $agencyUser}\n												<tr>\n													<td>{if $agencyUser.isAgencyAdmin}Admin{else}User{/if}</td>\n													<td>{$agencyUser.firstName}</td>\n													<td>{$agencyUser.lastName}</td>\n													<td>{$agencyUser.emailAddress}</td>\n													<td>{$agencyUser.lastLogin}</td>\n													<td>{$agencyUser.status}</td>\n\n{if ! $readOnly} \n	<td><center><a href=\"/user/edit/{$agencyUser.userID}/{$agencyUser.agencyID}/{$agencyUser.shortName}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n{else}\n	<td><center><i class=\"fa fa-pencil fa-lg\" ></i></center></td>\n\n{/if}\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n\n</div>\n</div>\n\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-institution\"></i> Invoices</h3>\n										<em> </em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>#</th>\n													<th>Date</th>\n													<th>Amount</th>\n													<th>Balance</th>\n													<th>Due Date</th>\n													<th>Status</th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $invoices as $invoice}\n												<tr>\n													<td>{$invoice.id}</td>\n													<td>{$invoice.date}</td>\n													<td>{$invoice.amount}</td>\n													<td>{$invoice.balance}</td>\n													<td>{$invoice.due}</td>\n													<td>{$invoice.status}</td>\n\n	<td><center><a href=\"/agency/invoice/{$invoice.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n\n</div>\n\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-umbrella\"></i> Subscription</h3>\n										<em> </em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Plan</th>\n													<th>Description</th>\n													<th>Start Date</th>\n													<th>Renewal Date</th>\n													<th>Licenses</th>\n													<th>Rate/Period</th>\n													<th>Status</th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $plans as $plan}\n												<tr>\n													<td>{$plan.name}</td>\n													<td>{$plan.description}</td>\n													<td>{$plan.startDate}</td>\n													<td>{$plan.renewalDate}</td>\n													<td>{$plan.licenses}</td>\n													<td>{$plan.rate} / {$plan.period}</td>\n													<td>{$plan.status}</td>\n\n	<td><center><a href=\"/agency/subscription/{$plan.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/dropzone.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				$(\".dropzone\").dropzone({\n					url: \"php/dropzone-upload.php\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'image/*, application/pdf, .txt\',\n					dictResponseError: \'File Upload Error.\'\n				});\n			} // end if dropzone exist\n		});\n\n\n		function saveAgency() {\n			\n			$(\"#agency-footer\").html(\"Saving.\");\n\n			$.post( \"/agency/ajax/save/{$agency.id}\", $( \"#agency-form\" ).serialize(), function() {\n				$(\"#agency-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#agency-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#agency-name-help\").show();\n\n				}\n				else {\n					$(\"#agency-name\").removeClass(\"has-error error\");\n					$(\"#agency-name-help\").hide();\n				}\n				$(\"#breadcrumb-agency-name\").html($(\"#agency-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#agency-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#agency-footer\").html(\"Error!\");\n			})\n		}\n\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(17,0,'cabinet','2015-03-16 16:40:21','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Cabinet</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Cabinets</h2>\n								<em>Invoice, Order and Document Management</em>\n							</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n\n		});\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(18,0,'knowledge-base','2014-09-25 13:25:54','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n	td {\n	   text-align: center;\n	}\n	td:nth-child(2) {\n	   text-align: center;\n	}\n	td:nth-child(23) {\n	   text-align: center;\n	}\n	td:nth-child(24) {\n	   text-align: center;\n	}\n	td:nth-child(25) {\n	   text-align: center;\n	}\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"}onclick=\"updateSummary();\"{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Support</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Knowledge Base</h2>\n								<em>Browse and search our knowledge base or open a support ticket</em>\n							</div>\n\n							<div class=\"main-content\">\n								<!-- knowledge search box -->\n								<form class=\"form-knowledge-search\">\n									<div class=\"input-group input-group-lg\">\n										<input type=\"search\" placeholder=\"enter a search term\" class=\"form-control\">\n										<span class=\"input-group-btn\">\n											<button class=\"btn btn-primary\" type=\"button\"><i class=\"fa fa-search\"></i> Search</button>\n										</span>\n									</div>\n								</form>\n								<!-- end knowledge search box -->\n\n								<div class=\"row\">\n									<!-- left side, main content -->\n									<div class=\"col-lg-9\">\n										<div class=\"row\">\n											<div class=\"col-md-5\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> General <span class=\"pull-right\">22</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left pull-left\"></i><a href=\"#\">What is KINGBOARD admin dashboard?</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left pull-left\"></i><a href=\"#\">How do I change my password?</a></li>\n													</ul>\n												</div>\n											</div>\n											<div class=\"col-md-5 col-md-offset-1\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Customer Support <span class=\"pull-right\">15</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Payment Problems</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Shopping Cart</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Discount Policy</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How do I use promo code?</a></li>\n													</ul>\n												</div>\n											</div>\n										</div>\n										<div class=\"row\">\n											<div class=\"col-md-5\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Products <span class=\"pull-right\">27</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How to review a product</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Recommend a product</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">I can\'t see the product stock</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Back Order</a></li>\n													</ul>\n												</div>\n											</div>\n											<div class=\"col-md-5 col-md-offset-1\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Shipping<span class=\"pull-right\">14</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Shipping Cost</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Shipping &amp; Warranty</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Where do we ship?</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How can I find my shipping code?</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How to track my shipping?</a></li>\n													</ul>\n												</div>\n											</div>\n										</div>\n										<div class=\"row\">\n											<div class=\"col-md-5\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Downloads <span class=\"pull-right\">6</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Find out downloadable products type.</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Where can I find the link for my digital product</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Link Expiration</a></li>\n													</ul>\n												</div>\n											</div>\n											<div class=\"col-md-5 col-md-offset-1\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Technical Support<span class=\"pull-right\">17</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Turn on my browser cookies</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">The page keeps reloading</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Report a broken link</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Contact Technical Support</a></li>\n													</ul>\n												</div>\n											</div>\n										</div>\n\n										<div class=\"well well-lg knowledge-recent-popular\">\n											<div class=\"row\">\n												<div class=\"col-md-6\">\n													<h4>Most Popular</h4>\n													<ol>\n														<li><a href=\"#\">I can\'t add otem to Shopping Cart, what should I do?</a></li>\n														<li><a href=\"#\">Error When Uploading File</a></li>\n														<li><a href=\"#\">How to Deposit Money?</a></li>\n													</ol>\n												</div>\n												<div class=\"col-md-6\">\n													<h4>Recent Articles</h4>\n													<ol>\n														<li><a href=\"#\">Avoid Any Type of Scam, Now!</a></li>\n														<li><a href=\"#\">Update to Terms &amp; Agreements</a></li>\n														<li><a href=\"#\">A Step-by-Step Guide to Participate in CSR Program</a></li>\n														<li><a href=\"#\">Where Can I Find My Order History?</a></li>\n													</ol>\n												</div>\n											</div>\n										</div>\n									</div>\n									<!-- end left side, main content -->\n\n									<!-- right sidebar -->\n									<div class=\"col-lg-3\">\n										<h3>Categories</h3>\n										<ul class=\"nav nav-pills nav-stacked nav-categories\">\n											<li><a href=\"#\">General <span class=\"badge pull-right\">22</span></a></li>\n											<li><a href=\"#\">Customer Support <span class=\"badge pull-right\">15</span></a></li>\n											<li><a href=\"#\">Downloads <span class=\"badge pull-right\">6</span></a></li>\n											<li><a href=\"#\">Products <span class=\"badge pull-right\">27</span></a></li>\n											<li><a href=\"#\">Buying <span class=\"badge pull-right\">20</span></a></li>\n											<li><a href=\"#\">Shipping <span class=\"badge pull-right\">14</span></a></li>\n											<li><a href=\"#\">Email <span class=\"badge pull-right\">8</span></a></li>\n											<li><a href=\"#\">Technical Support <span class=\"badge pull-right\">17</span></a></li>\n										</ul>\n										<div class=\"ticket-box\">\n											<p>Please submit a ticket only if you can\'t find a solution to your problem in our knowledge base</p>\n											<a href=\"#\" class=\"btn btn-primary\">Open a Ticket</a>\n										</div>\n									</div>\n									<!-- end right sidebar -->\n								</div>\n\n							</div>\n							<!-- /main-content -->\n						</div>\n\n\n	\n{/block}\n\n{block name=\"footer-js\"}\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(19,0,'campaign-create','2014-07-29 00:11:03','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n    <link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Campaigns</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Campaign</h2>\n								<em>Create A New Campaign</em>\n							</div>\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>New Campaign</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  id=\"newCampaign\" name=\"newCampaign\" method=\"post\" action=\"/campaigns/create/new\" role=\"form\">\n{if $alert.error}\n<div class=\"alert alert-danger alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> {$alert.error}\n</div>\n{/if}	\n					<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n					<input type=\"hidden\" id=\"flightStart\" name=\"flightStart\" value=\"\">\n					<input type=\"hidden\" id=\"flightEnd\" name=\"flightEnd\" value=\"\">\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Client</label>\n																		<div class=\"col-sm-10 col-lg-8 col-md-10\" >\n\n								<select name=\"clientID\" id=\"client-select\" style=\"width: 100%;\">\n									{foreach $clients as $client} \n																					<option value=\"{$client.id}\" {if $client.id == $campaign.clientID}selected{/if}>{$client.name}</option>\n\n									{/foreach}\n\n								</select>\n						</div>\n																	</div>\n\n					<div class=\"form-group\" id=\"campaign-name\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Campaign Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"campaignName\" id=\"campaignName\" value=\"{$campaign.name}\" class=\"form-control\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Job Number</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" id=\"jobNumber\" name=\"jobNumber\" value=\"{$campaign.jobNumber}\" class=\"form-control\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Flight Date Range</label>\n																		<div class=\"col-sm-8\">\n							<div id=\"flightRange\" class=\"pull-left report-range\">\n																				<i class=\"fa fa-calendar\"></i>\n																				<span class=\"range-value\"></span><b class=\"caret\"></b>\n						\n							</div>										</div>				\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Agency Commission</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2 pull-left\">\n																			<input type=\"text\" id=\"agencyCommission\" name=\"agencyCommission\" value=\"{$campaign.commission}\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Remarks</p>\n							<textarea id=\"textarea\" name=\"remarks\" id=\"remarks\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: none;\">{$campaign.remarks}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"createCampaign();\">Create Campaign</button>\n							</p>\n						</div>\n					</div>										</form>\n		</div>\n\n		<div class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n</div>\n\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-datepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/daterangepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/moment.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n\n			$(\"#client-select\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n	\n		$(\'#flightRange\').daterangepicker({\n			startDate: moment().add(\'days\', 1),\n			endDate: moment().add(\'days\', 30),\n			minDate: \'01/01/2012\',\n			maxDate: \'12/31/2019\',\n			dateLimit: { days: 365 },\n			showDropdowns: true,\n			showWeekNumbers: true,\n			timePicker: false,\n			timePickerIncrement: 1,\n			timePicker12Hour: true,\n			ranges: {\n				\'Today\': [moment(), moment()],\n				\'Tomorrow\': [moment().add(\'days\', 1), moment().add(\'days\', 1)],\n				\'Next 7 Days\': [moment().add(\'days\', 1),moment().add(\'days\', 7)],\n				\'Next 30 Days\': [moment().add(\'days\', 1), moment().add(\'days\', 30)],\n				\'This Month\': [moment().startOf(\'month\'), moment().endOf(\'month\')],\n				\'Next Month\': [moment().add(\'month\', 1).startOf(\'month\'), moment().add(\'month\', 1).endOf(\'month\')]\n				},\n			opens: \'left\',\n			buttonClasses: [\'btn btn-default\'],\n			applyClass: \'btn-small btn-primary\',\n			cancelClass: \'btn-small\',\n			format: \'MM/DD/YYYY\',\n			separator: \' to \',\n			locale: {\n					applyLabel: \'Submit\',\n					fromLabel: \'From\',\n					toLabel: \'To\',\n					customRangeLabel: \'Custom Range\',\n					daysOfWeek: [\'Su\', \'Mo\', \'Tu\', \'We\', \'Th\', \'Fr\',\'Sa\'],\n					monthNames: [\'January\', \'February\', \'March\', \'April\', \'May\', \'June\', \'July\', \'August\', \'September\', \'October\', \'November\', \'December\'],\n					firstDay: 1\n				}\n			},\n\n			function(start, end) {\n\n				var startDate = new Date(start);\n				$(\'#flightRange span\').html(start.format(\'MMMM D, YYYY\') + \' - \' + end.format(\'MMMM D, YYYY\'));\n			\n			}\n		);\n\n		$(\'#flightRange span\').html(moment().add(\'days\', 1).format(\'MMMM D, YYYY\') + \' - \' + moment().add(\'days\', 30).format(\'MMMM D, YYYY\'));\n\n		});\n\n\n		function getDateRange(datepicker, fromField, toField) {\n\n			$(fromField).val($(\'#flightRange\').data(\'daterangepicker\').startDate.format(\'YYYY-MM-DD\'));\n			$(toField).val($(\'#flightRange\').data(\'daterangepicker\').endDate.format(\'YYYY-MM-DD\'));\n						\n		}\n\n	  	function createCampaign() {\n	\n			getDateRange(\"#flightRange\", \"#flightStart\", \"#flightEnd\");\n	  \n			$(\"#newCampaign\").submit();\n		  		 		  \n	\n	  	}\n\n	  	function deleteCampaign() {\n		  \n			  bootbox.confirm(\'Are you sure?\', function(result) { console.log(\"Confirm result: \"+result); });\n	  	}\n	</script>\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(20,0,'campaign-edit','2015-03-18 06:37:34','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n   \n<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n<style>\n\n.form-control .select2-choice {\n    border: 0;\n    border-radius: 2px;\n}\n\n.form-control .select2-choice .select2-arrow {\n    border-radius: 0 2px 2px 0;   \n}\n\n.form-control.select2-container {\n    height: auto !important;\n    padding: 0px;\n}\n\n.form-control.select2-container.select2-dropdown-open {\n    border-color: #5897FB;\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control .select2-container.select2-dropdown-open .select2-choices {\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control.select2-container .select2-choices {\n    border: 0 !important;\n    border-radius: 3px;\n}\n</style>\n\n<style>\n\n.dropdown-menu {\n	border: 1px solid #555;\n	padding-bottom: 10px;\n}\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/all\">All Campaigns</a></li>\n			<li class=\"active\">Test Campaign</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Campaign</h2>\n								<em>Summary and Worksheets</em>\n							</div>\n<div class=\"col-lg-6 col-sm-12 col-md-10\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Campaign Summary</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-rocket\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"campaignActive\" {if $campaign.isActive}checked{/if} class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  id=\"campaign-form\" name=\"campaign\" role=\"form\">\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n\n{if $alert.error}\n<div class=\"alert alert-danger alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> {$alert.error}\n</div>\n{/if}	\n				<input type=\"hidden\" name=\"campaignID\" value=\"{$campaign.id}\">\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n				<input type=\"hidden\" id=\"campaign-active\" name=\"isActive\" value=\"{$campaign.isActive}\">\n				<input type=\"hidden\" id=\"flightStart\" name=\"flightStart\" value=\"{$campaign.flightStart}\">\n				<input type=\"hidden\" id=\"flightEnd\" name=\"flightEnd\" value=\"{$campaign.flightEnd}\">\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Client</label>\n			\n						<div class=\"col-sm-12 col-lg-12 col-md-12\" >\n\n								<select name=\"clientID\" id=\"client-select\" style=\"width: 100%;\">\n									{foreach $clients as $client}										<option value=\"{$client.id}\" {if $client.id==$campaign.clientID}selected{/if}>{$client.name}</option>\n									{/foreach}\n\n								</select>\n						</div>\n																	</div>\n\n					<div class=\"form-group\" id=\"campaign-name\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Campaign Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"campaignName\" id=\"campaignName\" value=\"{$campaign.name|@htmlspecialchars}\" class=\"form-control\" required>\n								<span id=\"campaign-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Campaign Name Already Exists!</span>						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Job Number</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" id=\"jobNumber\" name=\"jobNumber\" value=\"{$campaign.jobNumber}\" class=\"form-control\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Flight Date Range</label>\n																		<div class=\"col-sm-10\">\n							<div id=\"flightRange\" class=\"pull-left report-range\">\n																				<i class=\"fa fa-calendar\"></i>\n																				<span class=\"range-value\"></span><b class=\"caret\"></b>\n						\n							</div>										</div>				\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Agency Commission</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2 pull-left\">\n																			<input type=\"text\" id=\"agencyCommission\" name=\"agencyCommission\" value=\"{$campaign.commission}\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Remarks</p>\n							<textarea id=\"textarea\" name=\"remarks\" id=\"remarks\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: none;\">{$campaign.remarks}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveCampaign();\">Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteCampaign();\">Delete</button>\n							</p>\n						</div>\n					</div>										</form>\n\n		</div>\n\n		<div id=\"campaign-footer\" class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n\n\n	\n</div>\n\n<div class=\"col-lg-12 col-sm-12 col-md-12 hide\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Worksheet Summary</h3>	\n		</div>\n		<div class=\"widget-content\">\n\n\n												<table class=\"table table-bordered\">\n													<thead>\n														<tr>\n															<th>Media Type</th>\n															<th>GRPs</th>\n															<th>CPP</th>\n															<th>CPM</th>\n															<th>Spend ($)</th>\n														</tr>\n													</thead>\n													<tbody>\n		{foreach $summaries as $summary}						<tr>\n															<td>{$summary.vendorDescription}</td>\n															<td>{$summary.totalGRPs}</td>\n															<td>{$summary.totalCPP}</td>\n															<td>{$summary.totalCPM}/td>\n															<td>{$summary.totalSpend}</td>\n														</tr>\n		{/foreach}\n										</tbody>\n												</table>\n											</div>\n										</div>\n\n\n\n\n</div>\n\n\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3><i class=\"fa fa-table\"></i>Add A New Worksheet</h3>\n				<div class=\"btn-group widget-header-toolbar\">					<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n				</div>\n			</div>\n			<div class=\"widget-content\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"addWorksheet\" name=\"addWorksheet\" role=\"form\">\n\n<div  id=\"worksheet-alert-success\" class=\"alert alert-success alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> <span id=\"worksheet-alert-success-message\"></span>\n</div>\n\n<div id=\"worksheet-alert-error\" class=\"alert alert-danger alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> <span id=\"worksheet-alert-error-message\"></span>\n</div>\n\n				<input type=\"hidden\" name=\"campaignID\" value=\"{$campaign.id}\">\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n				<input type=\"hidden\" id=\"useBroadcastWeeks\" name=\"useBroadcastWeeks\" value=\"1\">\n				<input type=\"hidden\" id=\"isAutoComm\" name=\"isAutoComm\" value=\"1\">\n\n							<div class=\"form-group\" id=\"worksheet-name\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Worksheet Name</label>\n																				<div class=\"col-sm-6\">\n										<input type=\"text\" name=\"worksheetName\" id=\"worksheetName\" value=\"{$worksheet.name}\" class=\"form-control\" required>\n										<span id=\"worksheet-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Worksheet Name Already Exists!</span>								</div>\n																			</div>\n		\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Market Type</label>\n																				<div class=\"col-sm-6\">\n\n								<select id=\"marketType\" name=\"rated\" class=\"form-control\">\n																					<option value=\"unrated\" selected>Unrated</option>\n	\n									<option value=\"rated\" disabled>Rated</option>\n	\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor Type</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"marketTypes\" name=\"marketType\" class=\"form-control\">\n\n									{foreach $marketTypes as $marketType}\n										<option value=\"{$marketType.id}\" {if $marketType.isDisabled}disabled{/if}>{$marketType.description}</option>\n									{/foreach}\n									\n								</select>\n\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Market</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"markets\" name=\"market\" class=\"form-control\">\n									{foreach $markets as $market}										<option value=\"{$market.name}\">{$market.name}</option>\n									{/foreach}\n									<option value=\"\"></option>\n\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor(s)</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"vendors\" name=\"vendors[]\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n									{foreach $vendors as $vendor}										<option value=\"{$vendor.id}\">{$vendor.name}</option>\n									{/foreach}\n																					<option value=\"0\">Other</option>\n\n								</select>\n	\n							</div>\n\n						</div>\n\n						<div id=\"vendorReps\">\n												\n\n						</div>\n				\n						<div id=\"grpGoal\">\n\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Total GRP Goal</label>\n\n							<div class=\"col-sm-2 col-md-3 col-lg-2\">\n																				<input type=\"text\" id=\"grpGoal\" name=\"grpGoal\" class=\"form-control\">\n																			</div>\n\n												\n						     </div>\n\n						</div>\n\n						<div id=\"demoPrimary\">\n\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\"> Primary Demographic</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"demographics-primary\" name=\"demographic[]\" class=\"form-control\">\n									<option value=\"\"></option>\n									{foreach $demographics as $demo}										<option value=\"{$demo.id}\">{if $demo.description}{$demo.description}{else}{$demo.gender} {$demo.ageFrom}{if $demo.ageTo == 0}+{else} - {$demo.ageTo}{/if}{/if}</option>\n									{/foreach}\n										<option value=\"\">None</option>\n								</select>\n	\n							</div>\n\n						    </div>\n\n						</div>\n\n						<div id=\"demoSecondary\">\n\n						    <div class=\"form-group\" >\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\"> Secondary Demographic</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"demographics-secondary\" name=\"demographic[]\" class=\"form-control\">\n									<option value=\"\"></option>\n									{foreach $demographics as $demo}										<option value=\"{$demo.id}\">{if $demo.description}{$demo.description}{else}{$demo.gender} {$demo.ageFrom}{if $demo.ageTo == 0}+{else} - {$demo.ageTo}{/if}{/if}</option>\n									{/foreach}\n										<option value=\"\">None</option>\n								</select>\n	\n							</div>\n\n						    </div>\n\n						</div>\n\n					<div class=\"form-group\" >\n							<label for=\"commission\" class=\"col-sm-4 control-label\"> Commission</label>																					<div class=\"col-xs-4 col-sm-3 col-md-2 col-lg-2\">\n											<input type=\"text\" id=\"worksheetCommission\" name=\"commission\" value=\"{$campaign.commission}\" class=\"form-control\">\n									</div>	\n									<div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-2\" id=\"autoCommGroup\">											<input type=\"checkbox\" id=\"autoComm\" name=\"autoComm\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Auto\" data-off-label=\"Man\" checked >\n									</div>\n																	</div>\n\n					<div class=\"form-group\" id=\"broadcastWeeksGroup\">\n																		<label for=\"broadcastWeeks\" class=\"col-sm-4 control-label\">Use Broadcast Weeks?</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2\">\n																			<input type=\"checkbox\" id=\"broadcastWeeks\" name=\"broadcastWeeks\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\"  checked>\n						</div>\n																	</div>\n\n					<div class=\"form-group\" id=\"autoPopulateGroup\">\n																		<label for=\"autoPopulate\" class=\"col-sm-4 control-label\">Auto Populate?</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2\">\n																			<input type=\"checkbox\" id=\"autoPopulate\" name=\"autoPopulate\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" {if ! $user.useInventory}disabled{/if} >\n						</div>\n																	</div>\n\n				<div class=\"form-group\">\n							<div class=\"col-sm-12 col-md-12 col-lg-10\">\n								<div class=\"pull-right\">\n									<button type=\"button\" class=\"btn btn-success\" onclick=\"createWorksheet();\">Add Worksheet</button>\n								</div>\n							</div>\n						</div>				\n				</div>\n							\n					</div>\n\n\n			</div>\n			<div id=\"addWorksheet-footer\" class=\"widget-footer\">\n			\n			</div>\n		</div>\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-folder\"></i> Worksheets</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"worksheets\" class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Wksht #</th>\n\n	<th>Status</th>\n\n	<th>Name</th>\n													<th>Media Type</th>\n													<th>Market</th>\n													<th>Total Spots</th>\n													<th>Total Spend</th>\n\n	<th></th>\n\n	<th></th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $worksheets as $worksheet}\n												<tr id=\"worksheet-{$worksheet.id}\">\n													<td><a href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\" style=\"a { color: #333;}\">{$worksheet.id}</a></td>\n			\n	<td>{if $worksheet.isOrdered}{if $worksheet.isCancelled}Cancelled{else}Ordered{/if}{else}Pending{/if}</td>\n	\n	<td><a href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\" style=\"a { color: #333;}\">{$worksheet.name}</a></td>\n													<td>{$worksheet.vendorType}</td>\n													<td>{$worksheet.marketName}</td>\n\n	<td>{$worksheet.totalSpots}</td>\n													<td>{$worksheet.totalSpend}</td>\n\n	<td><a href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><a href=\"javascript:copyBox(\'{$worksheet.id}\');\" style=\"a { color: #333;}\"> <i class=\"fa fa-copy fa-lg\"></i></a></td>\n\n	<td><a href=\"javascript:deleteWorksheet(\'{$worksheet.id}\');\" style=\"a { color: #333;}\"><i class=\"fa fa-trash-o fa-lg\"></i></a></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n			<div id=\"worksheet-footer\" class=\"widget-footer\">\n			\n			</div>	\n							</div>\n\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-datepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/daterangepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/moment.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script>\n\n		function getVendors(marketType, market) {\n\n			$.post( \"/vendors/ajax/search/marketandtype/\" + marketType + \"/\" + encodeURI(market) + \"?PHPSESSID={$sessionID}\" ,  $( \"#addWorksheet\" ).serialize(), function() {\n				$(\"#addWorksheet-footer\").html(\"Searching For Vendors...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n//					$(\"#\"+response.field).addClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").show();\n				}\n				else {\n//					$(\"#worksheet-name\").removeClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").hide();\n				        $(\'#vendors\').select2(\"val\", \"\").on(\"select2-removed\", function(vendorRep) { removeVendorRep(vendorRep.val)});\n				        var select = $(\'#vendors\').empty();\n					  $.each(response.vendors, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function getDemographics(marketType, marketTypes) {\n\n			$.post( \"/demographics/ajax/search/\"+marketType+\"/\" + marketTypes + \"/\" + \"?PHPSESSID={$sessionID}\" ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Loading Demographics...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n//					$(\"#\"+response.field).addClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").show();\n				}\n				else {\n//					$(\"#worksheet-name\").removeClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").hide();\n\n//				        $(\'#demographics-primary\').select2(\"val\", \"\");\n				        var select = $(\'#demographics-primary\').empty();\n					 select.append( \'<option value=\"\"></option>\' ); \n					 $.each(response.demographics, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                          			      + item.id\n                            			      + \'\">\'\n                          			      + item.description\n                            			      + \'</option>\' ); \n   				          });\n				        var select = $(\'#demographics-secondary\').empty();\n					 select.append( \'<option value=\"\"></option>\' ); \n					 $.each(response.demographics, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                          			      + item.id\n                            			      + \'\">\'\n                          			      + item.description\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function removeVendorRep(vendorID) {\n			$(\'#vendor-\'+vendorID).remove();\n			$(\'#vendorReps-\'+vendorID).remove();\n		}\n\n		function getVendorReps(vendorID, marketName) {\n\n			$.post( \"/vendors/ajax/search/reps/\" + vendorID+ \"/\" + encodeURI(marketName) + \"?PHPSESSID={$sessionID}\"  , $( \"#addWorksheet\" ).serialize(), function() {\n				$(\"#addWorksheet-footer\").html(\"Searching For Vendor Reps...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n\n				}\n				else {\n\n				        //$(\'#vendorReps-\'+vendorID).select2(\"val\", \"\");\n				        var select = $(\'#vendorReps-\'+vendorID).select2();\n					  $.each(response.vendorReps, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.contactName\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n		function updateWorksheetFields(vendorType) {\n\n			$.post( \"/vendors/ajax/type/\" + vendorType + \"?PHPSESSID={$sessionID}\"  ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Updating Vendor Type...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n					\n				}\n				else {\n					if (response.vendorType.isAutoComm >= 1) {\n						$(\"#autoCommGroup\").show();\n					}\n					else {\n						$(\"#autoCommGroup\").hide();\n					}\n					if (response.vendorType.isGoalGRP >= 1) {\n						$(\"#grpGoal\").show();		\n					}\n					else {\n						$(\"#grpGoal\").hide();\n					}\n					if (response.vendorType.isBroadcastWeeks >= 1) {\n						$(\"#broadcastWeeksGroup\").show();\n					}\n					else {\n						$(\"#broadcastWeeksGroup\").hide();\n					}\n					if (response.vendorType.isDemographics >= 1) {\n						$(\"#demoPrimary\").show();\n						$(\"#demoSecondary\").show();\n					}\n					else {\n						$(\"#demoPrimary\").hide();\n						$(\"#demoSecondary\").hide();\n					}\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n		$(document).ready(function(){\n\n			$(\"#broadcastWeeks\").change(function () {\n			    broadcastWeeks();\n			}); \n\n			$(\"#autoPopulate\").change(function () {\n			    autoPopulate();\n			}); \n\n			$(\"#autoComm\").change(function () {\n			    autoComm();\n			}); 	\n\n			$(\"#client-select\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n//			$(\"#demographics-primary\").select2({\n//			    placeholder: \"Search Demographics\",\n//			    allowClear: true\n//			});\n\n//			$(\"#demographics-secondary\").select2({\n//			    placeholder: \"Search Demographics\",\n//			    allowClear: true\n//			});\n\n			$(\"#campaign-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#campaignActive\").change(function () {\n			    resetFooter();\n			   campaignActive(); \n			}); \n\n			$(\"#markets\").change(function () {\n				getVendors($(\"#marketTypes\").val(), $(\"#markets\").val());\n				$(\"#vendorReps\").html(\"\");\n			}); \n\n			$(\"#marketType\").change(function () {\n				$(\"#vendorReps\").html(\"\");\n				getVendors($(\"#marketTypes\").val(), $(\"#markets\").val());\n				getDemographics($(\"#marketType\").val(), $(\"#marketTypes\").val());\n			}); \n\n			$(\"#marketTypes\").change(function () {\n				$(\"#vendorReps\").html(\"\");\n				getDemographics($(\"#marketType\").val(), $(\"#marketTypes\").val());\n				getVendors($(\"#marketTypes\").val(), $(\"#markets\").val());\n				updateWorksheetFields($(\"#marketTypes\").val());\n			}); \n\n		var startDate = new moment(\"{$campaign.flightStart}\");\n		var endDate = new moment(\"{$campaign.flightEnd}\");\n\n		$(\'#flightRange\').daterangepicker({\n			startDate:  startDate,\n			endDate: endDate,\n			minDate: \'01/01/1999\',\n			maxDate: \'12/31/2019\',\n			dateLimit: { days: 365 },\n			showDropdowns: true,\n			showWeekNumbers: true,\n			timePicker: false,\n			timePickerIncrement: 1,\n			timePicker12Hour: true,\n			ranges: {\n				\'Today\': [moment(), moment()],\n				\'Tomorrow\': [moment().add(\'days\', 1), moment().add(\'days\', 1)],\n				\'Next 7 Days\': [moment().add(\'days\', 1),moment().add(\'days\', 7)],\n				\'Next 30 Days\': [moment().add(\'days\', 1), moment().add(\'days\', 30)],\n				\'This Month\': [moment().startOf(\'month\'), moment().endOf(\'month\')],\n				\'Next Month\': [moment().add(\'month\', 1).startOf(\'month\'), moment().add(\'month\', 1).endOf(\'month\')]\n				},\n			opens: \'left\',\n			buttonClasses: [\'btn btn-default\'],\n			applyClass: \'btn-small btn-primary\',\n			cancelClass: \'btn-small\',\n			format: \'MM/DD/YYYY\',\n			separator: \' to \',\n			locale: {\n					applyLabel: \'Submit\',\n					fromLabel: \'From\',\n					toLabel: \'To\',\n					customRangeLabel: \'Custom Range\',\n					daysOfWeek: [\'Su\', \'Mo\', \'Tu\', \'We\', \'Th\', \'Fr\',\'Sa\'],\n					monthNames: [\'January\', \'February\', \'March\', \'April\', \'May\', \'June\', \'July\', \'August\', \'September\', \'October\', \'November\', \'December\'],\n					firstDay: 1\n				}\n			},\n\n			function(start, end) {\n\n				var startDate = new Date(start);\n				var endDate = new Date(end);\n				$(\'#flightRange span\').html(start.format(\'MMMM D, YYYY\') + \' - \' + end.format(\'MMMM D, YYYY\'));\n			\n			}\n		);\n\n		$(\'#flightRange span\').html(startDate.format(\'MMMM D, YYYY\') + \' - \' + endDate.format(\'MMMM D, YYYY\'));\n/*\n		$(\'#multiselect4-filter\').multiselect({\n			enableFiltering: true,\n			enableCaseInsensitiveFiltering: true,\n			numberDisplayed: 5,\n      			includeSelectAllOption: true,\n		        includeSelectAllIfMoreThan: 10\n		});\n*/\n\n			$(\"#vendors\").select2({\n			    placeholder: \"Search Vendors\",\n			    allowClear: true\n			}).on(\"select2-removed\", function(vendorRep) { removeVendorRep(vendorRep.val)});\n\n			$(\"#vendors\").change(function () {\n			   refreshVendorReps(); \n			}); \n\n			getDemographics($(\"#marketType\").val(), $(\"#marketTypes\").val());\n			getVendors($(\"#marketTypes\").val(), $(\"#markets\").val());\n			updateWorksheetFields($(\"#marketTypes\").val());\n		});\n\n		$(\'#campaignActive\').bootstrapSwitch();\n		$(\'#broadcastWeeks\').bootstrapSwitch();\n		$(\'#autoPopulate\').bootstrapSwitch();\n		$(\'#autoComm\').bootstrapSwitch();\n\n		getVendors($(\"#marketTypes\").val(), $(\"#markets\").val());\n\n	</script>\n\n	<script>\n\n\n		function createWorksheet() {\n\n			$(\"#addWorksheet-footer\").html(\"Saving.\");\n\n			$.post( \"/worksheets/ajax/add/\", $( \"#addWorksheet\" ).serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#worksheet-name-help\").html(\'\');\n					$(\"#worksheet-name-help\").show();\n				}\n				else {\n					$(\"#worksheet-name\").removeClass(\"has-error error\");\n					$(\"#worksheet-name-help\").hide();\n					var newRow = $(\'#worksheets\').dataTable().fnAddData( [\"<a href=\'\"+response.newWorksheet.type+\"/edit/\"+response.newWorksheet.id+\"\' style=\'a { color: #333;}\'>\"+response.newWorksheet.id+\"</a>\",\"<a href=\'\"+response.newWorksheet.type+\"/edit/\"+response.newWorksheet.id+\"\' style=\'a { color: #333;}\'>\"+response.newWorksheet.name+\"</a>\",response.newWorksheet.vendorType,\"\",\"\",\"\",\"\",\"\", \"<a href=\'\"+response.newWorksheet.type+\"/edit/\" + response.newWorksheet.id + \"\' style=\'a { color: #333;}\'><i class=\'fa fa-pencil fa-lg\'></i></a>\",  \"<a href=\'javascript:copyBox(\" + response.newWorksheet.id + \");\' style=\'a { color: #333;}\'><i class=\'fa fa-copy fa-lg\'></i></a>\",\"<a href=\'javascript:deleteWorksheet(\" + response.newWorksheet.id + \");\' style=\'a { color: #333;}\'><i class=\'fa fa-trash-o fa-lg\'></i></a>\"] );\n	\n					var wsDataTable = $(\'#worksheets\').dataTable();\n					var newRowTR = wsDataTable.fnSettings().aoData[ newRow[0] ].nTr;\n					newRowTR.setAttribute(\"id\", \"worksheet-\" + response.newWorksheet.id);\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#addWorksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#addWorksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function resetFooter() {\n				$(\"#campaign-footer\").html(\"Not Saved\");\n		}\n\n		function campaignActive() {\n\n			if ($(\"#campaignActive\").is(\":checked\")) {\n				$(\"#campaign-active\").val(\"1\");\n			}\n			else {\n				$(\"#campaign-active\").val(\"0\");\n			}\n		}\n\n		function getDateRange(datepicker, fromField, toField) {\n\n			$(fromField).val($(\'#flightRange\').data(\'daterangepicker\').startDate.format(\'YYYY-MM-DD\'));\n			$(toField).val($(\'#flightRange\').data(\'daterangepicker\').endDate.format(\'YYYY-MM-DD\'));\n						\n		}\n\n		function saveCampaign() {\n\n			getDateRange(\"#flightRange\", \"#flightStart\", \"#flightEnd\");\n			\n			$(\"#campaign-footer\").html(\"Saving.\");\n\n			campaignActive();\n\n			$.post( \"/campaigns/ajax/save/{$campaign.id}\", $( \"#campaign-form\" ).serialize(), function() {\n				$(\"#campaign-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#campaign-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#campaign-name-help\").show();\n\n				}\n				else {\n					$(\"#campaign-name\").removeClass(\"has-error error\");\n					$(\"#campaign-name-help\").hide();\n				}\n				$(\"#breadcrumb-campaign-name\").html($(\"#campaignName\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#campaign-footer\").html(\"Error!\");\n			})\n		}\n	  \n	  	function deleteCampaign() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#campaign-footer\").html(\"Deleting..\");\n\n					$.post( \"/campaigns/ajax/delete/{$campaign.id}\", $( \"#campaign-form\" ).serialize(), function() {\n						$(\"#campaign-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/all\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n	 	 }\n\n		function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/worksheets/ajax/delete/\"+worksheetID, $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var wsDataTable = $(\'#worksheets\').dataTable();\n							wsDataTable.fnDeleteRow(  wsDataTable.$(\'#worksheet-\'+worksheetID)[0] );\n//							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet(\" + worksheetID + \", $(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(worksheetID, campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/\" + worksheetID + \"/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n		function refreshVendorReps() {\n\n		         var vendors = $(\"#vendors\").val();\n		         var vendorNames = $(\"#vendors\").text();\n\n 			$(\'#vendors :selected\').each(function(i,sel){\n			   if ($(\"#vendorReps-\"+$(sel).val()).length) {\n			   }\n			   else {\n				var repHTML = \'<div class=\"form-group\"  id=\"vendor-\'+$(sel).val()+\'\"><label for=\"text-input\" class=\"col-sm-offset-2 col-sm-2 control-label\">\'+$(sel).text()+\'</label>\\\n			 				<div class=\"col-sm-6 col-md-5 col-lg-4\">\\\n								<select id=\"vendorReps-\'+$(sel).val()+\'\" name=\"vendorReps[]\" class=\"form-control\">\\\n								</select>\\\n							</div></div>\';\n\n				$(\'#vendorReps\').append(repHTML);\n	\n				$(\"#vendorReps-\"+$(sel).val()).select2({\n				    placeholder: \"Search \"+$(sel).text()+\" Reps\",\n				    allowClear: true\n				});\n				getVendorReps($(sel).val(),$(\"#markets\").val()); \n			   }\n		       });\n\n		}\n\n		function broadcastWeeks() {\n\n			if ($(\"#broadcastWeeks\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Broadcast Weeks Turned On.\");\n				$(\"#useBroadcastWeeks\").val(\"1\");\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Broadcast Weeks Turned Off.\");\n				$(\"#useBroadcastWeeks\").val(\"0\");\n			}\n		}\n\n		function autoPopulate() {\n\n			if ($(\"#autoPopulate\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Auto Populate Turned On.\");\n				$(\"#autoPopulate\").val(\"1\");\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Auto Populate Turned Off.\");\n				$(\"#autoPopulate\").val(\"0\");\n			}\n		}\n\n		function autoComm() {\n\n			if ($(\"#autoComm\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Auto Commission Turned On.\");\n				$(\"#isAutoComm\").val(\"1\");\n				$(\"#worksheetCommission\").attr(\"disabled\",false);\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Auto Commission Turned Off.\");\n				$(\"#isAutoComm\").val(\"0\");\n				$(\"#worksheetCommission\").attr(\"disabled\",\"disabled\");\n			}\n		}\n\n	</script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(21,0,'campaigns','2015-03-18 06:32:30','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Campaigns</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Campaigns</h2>\n								<em>List of {$listType|default:\"All\"} Campaigns</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-rocket\"></i> Campaigns</h3>\n										<em>- <a href=\"campaigns/create\">Create A New Campaign</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n																								\n	<th>Campaign #</th>\n\n	<th>Name</th>\n\n	<th>Client</th>\n	\n	<th>Job Number</th>\n													<th>Flight Start</th>\n													<th>Flight End</th>\n													<th>Total Spend</th>\n\n	<th></th>\n\n	<th></th>\n\n	<th></th>\n\n												</tr>\n											</thead>\n											<tbody>\n{foreach $campaigns as $campaign}\n												<tr>\n													<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.id}</a></td>\n													<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></td>\n													<td><a href=\"/clients/edit/{$campaign.clientID}\">{$campaign.clientName}</a></td>\n													<td>{$campaign.jobNumber}</td>\n													<td>{$campaign.flightStart}</td>\n\n	<td>{$campaign.flightEnd}</td>\n													<td>{$campaign.totalSpend}</td>		\n\n	<td><a href=\"campaigns/edit/{$campaign.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n	<td><i class=\"fa fa-copy fa-lg\"></i></td>\n	<td><i class=\"fa fa-trash-o fa-lg\"></i></td>																										</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\">\n\n\n\n		function copyBox(campaignID) {\n			 \n			var campaignIDStr = \"\'\"+campaignID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Client-</option><option>-This Client-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyCampaign(\"+campaignID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Campaign to: \' + worksheets);\n\n	  	}\n\n		function copyCampaign(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/campaigns/ajax/copy/campaignID\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#campaign-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n  		}\n\n		function deleteCampaign(campaignID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/campaigns/ajax/delete/\"+campaignID, null, function() {\n						$(\"#campaign-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var campaignDataTable = $(\'#campaigns\').dataTable();\n							campaignDataTable.fnDeleteRow(  wsDataTable.$(\'#campaign-\'+campaignID)[0] );\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	</script>\n	\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(22,0,'worksheet-info','2014-06-20 15:01:11','','		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3><i class=\"fa fa-table\"></i>Add A New Worksheet</h3>\n				<div class=\"btn-group widget-header-toolbar\">					<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n				</div>\n			</div>\n			<div class=\"widget-content\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"addWorksheet\" name=\"addWorksheet\" role=\"form\">\n\n<div  id=\"worksheet-alert-success\" class=\"alert alert-success alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> <span id=\"worksheet-alert-success-message\"></span>\n</div>\n\n<div id=\"worksheet-alert-error\" class=\"alert alert-danger alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> <span id=\"worksheet-alert-error-message\"></span>\n</div>\n\n				<input type=\"hidden\" name=\"campaignID\" value=\"{$campaign.id}\">\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n				<input type=\"hidden\" id=\"useBroadcastWeeks\" name=\"useBroadcastWeeks\" value=\"1\">\n\n							<div class=\"form-group\" id=\"worksheet-name\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Worksheet Name</label>\n																				<div class=\"col-sm-6\">\n										<input type=\"text\" name=\"worksheetName\" id=\"worksheetName\" value=\"{$worksheet.name}\" class=\"form-control\" required>\n										<span id=\"worksheet-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Worksheet Name Already Exists!</span>								</div>\n																			</div>\n		\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Market Type</label>\n																				<div class=\"col-sm-6\">\n\n								<select name=\"marketType\" class=\"form-control\">\n																					<option value=\"unrated\" selected>Unrated</option>\n	\n									<option value=\"rated\" disabled>Rated</option>\n	\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor Type</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"marketTypes\" name=\"marketType\" class=\"form-control\">\n\n									{foreach $marketTypes as $marketType}\n										<option value=\"{$marketType.id}\" {if $marketType.isDisabled}disabled{/if}>{$marketType.description}</option>\n									{/foreach}\n									\n								</select>\n\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Market</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"markets\" name=\"market\" class=\"form-control\">\n									{foreach $markets as $market}										<option value=\"{$market.name}\">{$market.name}</option>\n									{/foreach}\n									<option value=\"\">Unassigned</option>\n\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor(s)</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"vendors\" name=\"vendors\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n									{foreach $vendors as $vendor}										<option value=\"{$vendor.id}\">{$vendor.name}</option>\n									{/foreach}\n																					<option value=\"0\">Other</option>\n\n								</select>\n	\n							</div>\n\n						</div>\n\n						<div id=\"vendorReps\">\n												\n\n						</div>\n				\n						<div id=\"grpGoal\">\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Total GRP Goal</label>\n\n							<div class=\"col-sm-2 col-md-3 col-lg-2 pull-left\">\n																				<input type=\"text\" id=\"grpGoal\" name=\"grpGoal\" class=\"form-control\">\n																			</div>\n\n												\n						     </div>\n\n						</div>\n\n						<div id=\"demoPrimary\">\n\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Demographic</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"demographic\" name=\"demographic\" class=\"form-control\">\n									{foreach $demos as $demo}										<option value=\"{$demo.id}\">{$demo.description}</option>\n									{/foreach}\n										<option value=\"\">None</option>\n								</select>\n	\n							</div>\n\n						    </div>\n\n						</div>\n\n					<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Commission</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2 pull-left\">\n																			<input type=\"text\" id=\"worksheetCommission\" name=\"commission\" value=\"{$campaign.commission}\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Use Broadcast Weeks?</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2 pull-left\">\n																			<input type=\"checkbox\" id=\"broadcastWeeks\" name=\"broadcastWeeks\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\"  checked>\n						</div>\n																	</div>\n				<div class=\"form-group\">\n							<div class=\"col-sm-12 col-md-12 col-lg-10\">\n								<div class=\"pull-right\">\n									<button type=\"button\" class=\"btn btn-success\" onclick=\"createWorksheet();\">Update Worksheet</button>\n								</div>\n							</div>\n						</div>				\n				</div>\n							\n					</div>\n\n\n			</div>\n			<div id=\"addWorksheet-footer\" class=\"widget-footer\">\n			\n			</div>\n		</div>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(23,0,'markets-edit','2014-10-20 13:14:43','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"/home\">Home</a>\n			</li>\n			<li><a href=\"/markets\">Markets</a></li>\n			<li class=\"active\" id=\"breadcrumb-market-name\">{$market.name}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Markets</h2>\n								<em>Edit Market Information</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3><i class=\"fa fa-paper-plane\"></i>Edit A Market</h3>\n\n			</div>\n			<div class=\"widget-content\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"market-form\" name=\"editMarket\" role=\"form\">\n							<input type=\"hidden\" name=\"vendorID\" value=\"{$market.vendorID}\">\n							<input type=\"hidden\" name=\"agencyID\" value=\"{$market.agencyID}\">\n							<input type=\"hidden\" name=\"marketID\" value=\"{$market.id}\">\n							<div class=\"form-group\" id=\"market-name\">\n																				<label for=\"addMarketName\" class=\"col-sm-4 control-label\">Market Name</label>\n																				<div class=\"col-sm-8\">\n																					<input type=\"text\" id=\"marketName\" name=\"marketName\" value=\"{$market.name}\" class=\"form-control\">\n									<span id=\"market-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Market Name Already Exists!</span>\n	\n								</div>\n																			</div>\n\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor(s)</label>\n																			<div class=\"col-sm-10 col-md-10 col-lg-8\">\n\n								<select id=\"vendor-filter\" name=\"vendorID\"  style=\"width: 100%;\">\n									\n									{foreach $vendors as $vendor}\n										<option value=\"{$vendor.id}\" {if $vendor.id == $market.vendorID}selected{/if}>{$vendor.name}</option>\n									{/foreach}\n								</select>\n	\n							</div>\n\n						</div>\n\n	\n							<div class=\"form-group\">\n																					<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																					<div class=\"col-sm-8\">\n										<input type=\"text\" id=\"text-input\" class=\"form-control\" name=\"contactName\" value=\"{$market.contactName}\">\n									</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																				<div class=\"col-sm-8\">\n									<input type=\"text\" id=\"text-input\" class=\"form-control\" name=\"emailAddress\" value=\"{$market.emailAddress}\" required>\n								</div>\n																			</div>\n																			<div class=\"form-group\">\n																				<label for=\"addMarketRepPhone\" class=\"col-sm-4 control-label\">Phone Number\n																				<br>\n																				<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addMarketRepPhone\" name=\"phoneNumber\" value=\"{$market.phoneNumber}\" class=\"form-control\">\n																				</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																				<label for=\"addMarketRepFax\" class=\"col-sm-4 control-label\">Fax Number\n																					<br>\n																					<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addMarketRepFax\" name=\"faxNumber\" value=\"{$market.faxNumber}\" class=\"form-control\">\n																				</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Station(s)</label>\n																				<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n									<input type=\"text\" id=\"addMarketStations\" name=\"stations\" value=\"{$market.stations}\" class=\"form-control\">\n\n								</div>\n\n							</div\n\n						<form>\n\n					</div>\n\n							<div class=\"form-group\">\n								<div class=\"col-sm-12\">\n									<p class=\"pull-right\">\n										<button type=\"button\" class=\"btn btn-success\" onclick=\"saveMarket();\">Save Market</button>\n										<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteMarket();\">Delete Market</button>\n									</p>\n								</div>\n							</div>\n				</div>\n\n			</div>\n		<div id=\"market-footer\" class=\"widget-footer\">\n			Not Saved\n		</div>\n\n		</div>\n\n	</div>\n\n<div class=\"col-lg-6\">\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Worksheets</h3>\n										<em>- <a href=\"campaigns/create\">Add A New Campaign</a> or Search Existing Campaign Worksheets</em>\n									</div>\n									<div class=\"widget-content\">\n\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Campaign #</th>\n\n	<th>Name</th>\n													<th>Job Number</th>\n													<th>Flight Start</th>\n													<th>Flight End</th>\n													<th>Total Spend</th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $worksheets as $worksheet}\n												<tr>\n													<td>{$worksheet.id}</td>\n													<td>{$worksheet.name}</td>\n													<td>{$worksheet.jobNumber}</td>\n													<td>{$worksheet.flightStart}</td>\n\n	<td>{$worksheet.flightEnd}</td>\n													<td>{$worksheet.totalAmount}</td>\n\n	<td><a href=\"campaigns/pending\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n\n\n									</div>\n								</div>\n\n</div>\n\n\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n			$(\'#fax\').mask(\'(999) 999-9999\');\n\n			$(\'#addMarketRepPhone\').mask(\'(999) 999-9999? x99999\');\n			$(\'#addMarketRepFax\').mask(\'(999) 999-9999\');\n\n			$(\"#vendor-filter\").select2({\n			    placeholder: \"Search Vendors\",\n			    allowClear: true\n			});\n\n			$(\"#market-form\").change(function () {\n			    resetFooter(); \n			}); \n\n		});\n\n		function resetFooter() {\n				$(\"#market-footer\").html(\"Not Saved\");\n		}\n\n		function saveMarket() {\n			\n			$(\"#market-footer\").html(\"Saving.\");\n\n			$.post( \"/markets/ajax/save/{$market.id}\", $( \"#market-form\" ).serialize(), function() {\n				$(\"#market-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#market-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#market-name-help\").show();\n\n				}\n				else {\n					$(\"#market-name\").removeClass(\"has-error error\");\n					$(\"#market-name-help\").hide();\n				}\n				$(\"#breadcrumb-market-name\").html($(\"#marketName\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#market-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#market-footer\").html(\"Error!\");\n			})\n		}\n\n\n	  	function deleteMarket() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#market-footer\").html(\"Deleting..\");\n\n					$.post( \"/markets/ajax/delete/{$market.id}\", $( \"#market-form\" ).serialize(), function() {\n						$(\"#market-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#market-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/markets\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#market-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#market-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(24,0,'markets','2014-10-20 13:28:10','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Markets</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Markets</h2>\n								<em>Vendors & Markets</em>\n							</div>\n<div class=\"row\">\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-map-marker\"></i> Markets</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"vendorMarkets\" class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Vendor</th>\n\n	<th>Market</th>\n\n	<th>Rep</th>\n													<th>Phone</th>\n													<th>Fax</th>\n													<th>Email</th>\n													<th>Station(s)</th>						\n\n	<th></th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $markets as $market}\n												<tr id=\"market-{$market.id}\">\n													<td><a href=\"/vendors/edit/{$market.vendorID}\">{$market.vendorName}</a></td>\n													<td>{$market.name}</td>\n													<td>{$market.contactName}</td>\n													<td>{$market.phoneNumber}</td>\n													<td>{$market.faxNumber}</td>\n\n	<td>{$market.emailAddress}</td>\n\n	<td>{$market.stations}</td>\n\n	<td><a href=\"markets/edit/{$market.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><a href=\"javascript:deleteMarket(\'{$market.id}\');\" style=\"a { color: #333;}\"><i class=\"fa fa-trash-o fa-lg\"></i></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n\n</div>\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n			$(\'#fax\').mask(\'(999) 999-9999\');\n\n			$(\'#addMarketRepPhone\').mask(\'(999) 999-9999? x99999\');\n			$(\'#addMarketRepFax\').mask(\'(999) 999-9999\');\n		});\n\n\n		function deleteMarket(marketID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#vendorMarkets-footer\").html(\"Deleting..\");\n\n					$.post( \"/markets/ajax/delete/\"+marketID, $( \"#vendorMarkets-form\" ).serialize(), function() {\n						$(\"#vendorMarkets-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#vendorMarkets-footer\").html(response.message);\n						if (response.error) {\n							$(\"#vendorMarkets-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var wsDataTable = $(\'#vendorMarkets\').dataTable();\n							wsDataTable.fnDeleteRow(  wsDataTable.$(\'#market-\'+marketID)[0] );\n//							window.location.href=\"/marketss/edit/{$market.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#vendorMarkets-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#vendorMarkets-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(25,0,'user-edit','2014-08-25 13:01:51','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"agency\">Agency</a></li>\n			<li class=\"active\">User</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Agency</h2>\n								<em>User Information</em>\n							</div>\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>User Information</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-users\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"userActive\" checked class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n\n				<form class=\"form-horizontal label-left\" role=\"form\">\n\n							<div class=\"form-group\">\n																				<label for=\"userRole\" class=\"col-sm-4 control-label\">Role</label>\n																				<div class=\"col-sm-8\">\n									<select class=\"form-control input\" name=\"userRole\">\n										\n										<option value=\"agency-user\">Agency User</option>\n										<option value=\"agency-admin\">Agency Admin</option>\n\n									</select>\n	\n								</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"addUserFirstName\" class=\"col-sm-4 control-label\">First Name</label>\n																				<div class=\"col-sm-8\">\n																					<input type=\"text\" id=\"firstName\" name=\"firstName\" value=\"{$user.firstName}\" class=\"form-control\">\n	\n								</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																					<label for=\"addUserLastName\" class=\"col-sm-4 control-label\">Last Name</label>\n																					<div class=\"col-sm-8\">\n										<input type=\"text\" id=\"lastName\" name=\"lastName\" value=\"{$user.lastName}\" class=\"form-control\" required>\n									</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"addUserEmailAddress\" class=\"col-sm-4 control-label\">Email Address</label>\n																				<div class=\"col-sm-8\">\n									<input type=\"text\" id=\"emailAddress\" name=\"emailAddress\" value=\"{$user.emailAddress}\" class=\"form-control\" required>\n								</div>\n																			</div>\n																			<div class=\"form-group\">\n																				<label for=\"addUserPhone\" class=\"col-sm-4 control-label\">Phone Number\n																				<br>\n																				<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"phoneNumber\" name=\"phoneNumber\" value=\"{$user.phoneNumber}\" class=\"form-control\">\n																				</div>\n																			</div>\n\n							<div class=\"form-group hidden\">\n																				<label for=\"password\" class=\"col-sm-4 control-label\">Password\n											\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"password\" id=\"password\" name=\"password\" class=\"form-control\">\n																				</div>\n																			</div>\n							<div class=\"form-group hidden\">\n																				<label for=\"confirm\" class=\"col-sm-4 control-label\">Confirm\n\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"password\" id=\"confirm\" name=\"confirm\" class=\"form-control\">\n																				</div>\n																			</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveUser();\">Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteUser();\">Delete</button>\n							</p>\n						</div>\n					</div>		\n															</form>\n\n		</div>\n\n		<div class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phoneNumber\').mask(\'(999) 999-9999\');\n			$(\'#userActive\').bootstrapSwitch();\n\n		});\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(26,0,'ajax-response','2014-06-01 20:55:42','','{$response}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(27,0,'worksheet-cable','2015-05-05 05:07:08','','<script>\n$( function() {\n\n	$(\'#calendar\').fullCalendar({\n\n    eventSources: [\n\n        // your event source\n        {\n            url: \'/calendar/ajax/campaign\',\n	    borderColor : \'#fff\'\n        }\n\n    ]\n\n	});\n});\n\n</script>\r\n\r\n\r\n								<!-- WIDGET MAIN CHART WITH TABBED CONTENT -->\r\n\r\n										<!-- WIDGET TABLE -->\r\n										<div class=\"widget widget-table\">\r\n											<div class=\"widget-header\">\r\n												<h3><i class=\"fa fa-rocket\"></i> Calendar Placeholder</h3>\r\n												<div class=\"btn-group widget-header-toolbar\">\r\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\r\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\r\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\r\n												</div>\r\n												<div class=\"btn-group widget-header-toolbar\">\r\n											\r\n												</div>\r\n											</div>\r\n											<div class=\"widget-content\">\r\n												<div id=\'calendar\'></div>\r\n											</div>\r\n										</div>\r\n										<!-- END WIDGET TABLE -->\r\n\r\n\r\n    \r\n    \r\n    \r\n  <style>\r\n#calendar {\r\n		margin: 0 auto;\r\n	}\r\n</style> \r\n    \r\n\r\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(28,0,'worksheet-radio','2014-06-18 11:44:53','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-TV | BluHorn{/block}\n\n{block name=\"header-js\"}\n	\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n	td {\n	   text-align: center;\n	}\n	td:nth-child(2) {\n	   text-align: center;\n	}\n	td:nth-child(23) {\n	   text-align: center;\n	}\n	td:nth-child(24) {\n	   text-align: center;\n	}\n	td:nth-child(25) {\n	   text-align: center;\n	}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\n</style>\n\n\n{/block}\n\n{block name=\"sidebar-clicked\"}onclick=\"refreshWorksheet();\"{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Broadcast TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Broadcast TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{include file=\"db:worksheet-info\"}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-lg-6\">\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$campaign.advertiser|default:\'none\'}   <strong>Campaign:</strong> {$campaign.name|default:\'none\'}    <strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Station(s):</strong> {$campaign.stations|default:\'none\'}</div>\n												<div style=\"width: 100%; padding-bottom: 30px;\"><strong>Demo(s):</strong> {$campaign.demographics|default:\'none\'}   <strong>Contract #:</strong> {$campaign.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-lg-6\">\n												   <div class=\"pull-right\">\n												      <button class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n												      <button class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n												   </div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendorss as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPPerStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$order.revision}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$order.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$order.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-4 col-lg-2 col-sm-6\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName}\n\n												    <div class=\"summary-daypart\" id=\"summary-daypart-{$daypart}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypart}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypart}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypart}\">0.0</div></td></tr>\n												      </table>\n												    </div>\n\n												     {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-8 col-lg-10\" id=\"dataTable-container\">\n\n								<div class=\"main-content\" id=\"main-content\" style=\"overflow: hidden; padding-bottom: 300px;\">\n					\n\n\n									<div id=\"dataTable\"></div>\n\n							\n							\n								</div>\n							</div>\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n	\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:0};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  var data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"null\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: 0, daypart: null, vendor: null, timeOfDay: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: null, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false }\n\n	{/if}\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	$( document ).ready(function() {\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n	  $(\"#dataTable\").handsontable({\n	    data: data,\n	    colHeaders: [\"Day Part\",\"Vendor\",\"Station\",\"Time Period\",\"Program Name\",\"M\", \"T\", \"W\", \"R\", \"F\", \"Sa\", \"Su\",\"Length\",\"Rate\",\"AQH RTG\",\"CPP\",\"000\",\"CPM\",{foreach $weekNames as $weekName}\"{$weekName}\",{/foreach} \"Comments\",\"Copy\",\"Bold\",\"Delete\"],\n	    minSpareRows: 1,\n	    manualColumnResize: true,\n	    colWidths: [60, 60, 100, 100, 100,25,25,25,25,25,25,25,60,80,90,70,40,60,{foreach $weeks as $week} 50, {/foreach}80,50,50,50],\n	    columns: [\n	  	  {\n		    data: \'daypart\',\n	  	    type: \'dropdown\',\n	  	    source: [\"EM\", \"DA\", \"EF\", \"EN\", \"PA\", \"PR\", \"LF\", \"LN\", \"OV\", \"SP\", \"RO\"]\n	  	  },	  \n	  	  {\n		    data: \'vendor\',\n	  	    type: \'dropdown\',\n	  	    source: vendorNames\n	  	  },	\n		  { data: \'station\'}, // station call letters\n	  	  { data: \'timeOfDay\', validator: nielsen_time_validator_fn, allowInvalid: true}, // time period\n	  	  { data: \'program\'}, // program name\n	  	  { data: \'mon\', type: \'checkbox\'}, // mon\n	  	  { data: \'tue\', type: \'checkbox\'}, // tues\n	  	  { data: \'wed\', type: \'checkbox\'}, // wed\n	  	  { data: \'thu\', type: \'checkbox\'}, // thurs\n	  	  { data: \'fri\', type: \'checkbox\'}, // fri\n	  	  { data: \'sat\', type: \'checkbox\'}, // sat\n	  	  { data: \'sun\', type: \'checkbox\'}, // sun\n	  	  { data: \'length\', type: \'numeric\'},  // length\n	  	  { data: \'rate\', type: \'numeric\', format: \'$0,0.00\'},  // rate\n	  	  { data: \'aqh\', type: \'numeric\', format: \'0.00\'},  // AQH RTG\n	  	  { data: \'cpp\', type: \'numeric\', readOnly: true, format: \'0,0.00\'},  // CPP\n	  	  { data: \'impact\', type: \'numeric\'},  // 000\n	  	  { data: \'cpm\', type: \'numeric\', readOnly: true, format: \'0,0.00\'},  // CPM\n		{foreach $weeks as $week}\n		  { data: \'week.{$week@iteration}\', type: \'numeric\'},  // Week {$week@iteration} \n                {/foreach}\n	  	  { data: \'comments\'},  // Comments\n	  	  { data: \'copy\', renderer: copyButtonRenderer, readOnly: false},  // Copy\n	  	  { data: \'bold\', renderer: copyButtonRenderer, readOnly: false},  // Bold\n	  	  { data: \'delete\', renderer: copyButtonRenderer,  readOnly: false} // Delete\n	    ],\n	    currentRowClassName: \'currentRow\',\n            currentColClassName: \'currentCol\',\n	    minRows: 1,\n	    autoWrapRow: true,\n	    rowHeaders: true,\n	    contextMenu: [\'row_above\', \'row_below\', \'remove_row\'],\n	    columnSorting: true,\n	    stretchH: \'all\',\n	    persistentState: true,\n	    afterChange: function(changes, source) {\n		if (changes != null) {\n			for (var i = changes.length - 1; i >= 0; i--) {\n\n			     if (changes[i]) {\n			\n				if (changes[i][1] == \"aqh\") {\n					data[ changes[i][0] ][\"cpp\"] = (data[ changes[i][0] ][\"rate\"] / changes[i][3]).toFixed(3); \n					data[ changes[i][0] ][\"cpm\"] =   ((data[ changes[i][0] ][\"rate\"]) / (data[ changes[i][0] ][\"impact\"] / 1000)).toFixed(3); \n\n					this.render();\n				}\n				if (changes[i][1] == \"rate\") {\n					data[ changes[i][0] ][\"cpp\"] =  (changes[i][3] / data[ changes[i][0] ][\"aqh\"]).toFixed(3); \n					data[ changes[i][0] ][\"cpm\"] =   (changes[i][3] / (data[ changes[i][0] ][\"impact\"] / 1000)).toFixed(3); \n\n					this.render();\n				}\n				if (changes[i][1] == \"impact\") {\n					data[ changes[i][0] ][\"cpm\"] =  (data[ changes[i][0] ][\"rate\"] / (changes[i][3] / 1000) ).toFixed(3); \n					data[ changes[i][0] ][\"cpp\"] =  (data[ changes[i][0] ][\"rate\"] / data[ changes[i][0] ][\"aqh\"]).toFixed(3); \n					\n					this.render();\n				}\n				if (changes[i][1] == \"station\") {\n	\n					updateStations();				\n				}\n				if (changes[i][1] == \"delete\") {    \n					var instance = this;\n//					setColumnToCheckBox(changes[i][2], instance);	\n				}\n				if (changes[i][1] == \"vendor\") {\n	\n					data[ changes[i][0] ][\"vendorID\"] = vendors[data[ changes[i][0] ][\"vendor\"]];				\n				}\n		 	    }\n			}\n	\n			saveChanges(changes);\n\n		  }\n\n//		console.log(changes);\n		logData();\n//   		$.post({\n//     		url: \"save.php\",\n//		        data: changes\n//	        });\n// 		alert(countColumn(data,0));\n		summarySpots = sumColumnAssocIfNot(data,\"week\",\"daypart\",null);\n		$(\'#totalSpots\').html(summarySpots);\n//		$(\'#totalSpend\').html(\"$\" + sumColumn(data,\'lineSpendTotal\').toFixed(2));\n		$(\'#totalSpend\').html(\"$\" + sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'rate\', \'lineSpendTotal\').toFixed(2));\n		summaryGRPs = sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'aqh\', \'lineAQHTotal\');\n		$(\'#totalGRPs\').html(summaryGRPs.toFixed(1));\n		if (summarySpots > 0) {\n			$(\'#overallCPP\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpp\', \'lineCPPTotal\') / summarySpots + .001).toFixed(2));\n			$(\'#totalCPM\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpm\', \'lineCPMTotal\') / summarySpots + .001).toFixed(2));\n		}\n		updateSummary();\n		updateStations();\n	    },\n	    beforeChange: function (changes, source) {\n		for (var i = changes.length - 1; i >= 0; i--) {\n			if (changes[i][1] == \"timeOfDay\") {\n				changes[i][3]=nielsen_time_format(changes[i][3]);\n			}\n			if (changes[i][1] == \"copy\") {\n				//changes[i][3]=\"<input type=checkbox>\";\n			}\n		}\n	    },\n	    afterCreateRow: function(index, amount) {\n		maxLineNumber++;\n		data[index][\"lineNumber\"]=maxLineNumber;\n	    },\n	    beforeRemoveRow: function(row, amount) {\n			removeLines(row,amount);\n	    },\n	    afterRemoveRow: function(row, amount) {\n			console.log(\"Remove Row: \" + row + \" and \" + amount + \" after\");\n			data.splice(row,amount-1);\n			summarySpots = sumColumnAssocIfNot(data,\"week\",\"daypart\",null);\n			$(\'#totalSpots\').html(summarySpots);\n//			$(\'#totalSpend\').html(\"$\" + sumColumn(data,\'lineSpendTotal\').toFixed(2));\n			$(\'#totalSpend\').html(\"$\" + sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'rate\', \'lineSpendTotal\').toFixed(2));\n			summaryGRPs = sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'aqh\', \'lineAQHTotal\');\n			$(\'#totalGRPs\').html(summaryGRPs.toFixed(1));\n			if (summarySpots > 0) {\n				$(\'#overallCPP\').html(\"$\" + (sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpp\', \'lineCPPTotal\') / summarySpots +.001).toFixed(2));\n				$(\'#totalCPM\').html(\"$\" +(sumColumnAssocIfNotByRowWithMultiplier(data,\"week\",\"daypart\",null,\'cpm\', \'lineCPMTotal\') / summarySpots + .001).toFixed(2));\n			}\n			updateSummary();\n	    }\n	  });\n      });\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][2] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/worksheets/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/worksheets/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/worksheets/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/worksheets/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.orderID + \"/pdf\";\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	</script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(29,0,'reports-summary','2015-01-20 21:49:38','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/reports/\">Reports</a></li>\n			<li><a href=\"/reports/summary/\">Summary</a></li>\n			<li class=\"active\" id=\"breadcrumb-report-type\">{$reportType|upper}</li>\n			</ul>\n{/block}\n\n{block name=\"pdf\"}\n\n<div id=\"pdfFrame\" style=\"display:none; width: 100%; height: 700px;\">\n    <div>\n    <iframe src=\"reports/show/78/pdf\" style=\"width: 100%; height: 700px;\"></iframe>\n    </div>\n</div> \n\n{/block}\n\n{block name=\"main\"}\n\n<div id=\"mainContent\">\n\n							<div class=\"main-header\">\n								<h2>Reports {if $reportTitle}({$reportTitle}){/if}</h2>\n								<em>{$reportDescription}</em>\n							</div>\n<div class=\"col-lg-10\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Parameters</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n		<form id=\"report-form\" class=\"form-horizontal label-left\" role=\"form\" method=\"post\">\n			<input type=\"hidden\" name=\"reportID\" value=\"{$reportID}\">\n			<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n			<input type=\"hidden\" id=\"category\" name=\"category\" value=\"{$reportCategory}\">\n			<input type=\"hidden\" id=\"reportType\" name=\"reportType\" value=\"{$reportType}\">\n			<input type=\"hidden\" name=\"templateID\" value=\"{$templateID}\">\n			<input type=\"hidden\" id=\"isGrossCost\" name=\"isGrossCost\" value=\"{$isGrossCost}\">\n			<input type=\"hidden\" id=\"isNetCost\" name=\"isNetCost\" value=\"{$isNetCost}\">\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Client(s)</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"clients\" name=\"clients[]\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n									{foreach $clients as $client}										<option value=\"{$client.id}\">{$client.name}</option>\n									{/foreach}\n\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Campaign(s)</label>\n\n							<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"campaigns\" name=\"campaigns[]\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n						\n\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor(s)</label>\n\n							<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"vendors\" name=\"vendors[]\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n						\n\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Market(s)</label>\n\n							<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"markets\" name=\"markets[]\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n						\n\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Include Gross Cost?</label>\n\n							<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<input type=\"checkbox\" id=\"includeGross\" name=\"includeNet\" {if $isGrossCost}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Include Net Cost?</label>\n	\n							<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<input type=\"checkbox\" id=\"includeNet\" name=\"includeNet\" {if $isNetCost}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Type?</label>\n\n							<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"type\" name=\"type\"  style=\"width: 100%;\">\n									{foreach $types as $type}										<option value=\"{$type.id}\">{$type.name}</option>\n									{foreachelse}\n										<option value=\"\" selected>Default</option>\n									{/foreach}\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Format?</label>\n\n							<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"format\" name=\"format\"  style=\"width: 100%;\">\n									{foreach $formats as $format}										<option value=\"{$format.id}\">{$format.name}</option>\n									{foreachelse}\n										<option value=\"pdf\" selected>PDF</option>\n										<option value=\"csv\" >XLS/CSV</option>\n										<option value=\"web\" disabled>Web</option>\n									{/foreach}\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" id=\"createReportButton\" class=\"btn btn-success\" onclick=\"createReport();\">Create</button>\n							</p>\n						</div>\n					</div>		\n															</form>\n\n		</div>\n\n		<div id=\"report-footer\" class=\"widget-footer\">\n		</div>\n\n\n\n\n</div>\n</div>\n\n\n<div class=\"modal fade\" id=\"reportWait\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Please Wait</h4>\n      </div>\n      <div class=\"modal-body\">\n		<div class=\"progress progress-striped active\">\n		  <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n		  </div>\n		</div>\n		<span class=\"reportStatus\">Creating Report...</span>\n      </div>\n\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n\n\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/pdfObject/pdfobject.js\"></script>\n\n	<script>\n\n	\n\n		$(document).ready(function(){\n\n			$(\'#includeGross\').bootstrapSwitch();\n			$(\'#includeNet\').bootstrapSwitch();\n\n			$(\"#clients\").change(function () {\n				getCampaigns($(\"#clients\").val());\n			        $(\'#vendors\').select2(\"val\", \"\");\n			        $(\'#vendors\').empty();\n			        $(\'#markets\').select2(\"val\", \"\");\n			        $(\'#markets\').empty();\n			}); \n\n			$(\"#campaigns\").change(function () {\n				getVendors($(\"#campaigns\").val());\n			        $(\'#markets\').select2(\"val\", \"\");\n			        $(\'#markets\').empty();\n			}); \n\n			$(\"#vendors\").change(function () {\n				getMarkets($(\"#vendors\").val());\n			}); \n\n			$(\"#clients\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n			$(\"#campaigns\").select2({\n			    placeholder: \"Search Campaigns\",\n			    allowClear: true\n			});\n\n			$(\"#vendors\").select2({\n			    placeholder: \"Search Vendors\",\n			    allowClear: true\n			});	\n\n			$(\"#markets\").select2({\n			    placeholder: \"Search Markets\",\n			    allowClear: true\n			});\n\n			$(\"#format\").select2({\n			    placeholder: \"Report Format\",\n			    allowClear: false\n			});\n\n			$(\"#type\").select2({\n			    placeholder: \"Report Type\",\n			    allowClear: false\n			});\n\n			$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n			$(\"#vendors\").attr(\"disabled\",\"disabled\");\n			$(\"#markets\").attr(\"disabled\",\"disabled\");\n\n			if ($(\"#clients\").val() != \"\") {\n				getCampaigns($(\"#clients\").val());\n			}\n\n			$(\"#includeGross\").change(function () {\n				includeGross();\n			}); \n\n			$(\"#includeNet\").change(function () {\n				includeNet();\n			}); \n\n		});\n\n	</script>\n\n	<script type=\"text/javascript\">\n\n		function resetFooter() {\n				$(\"#client-footer\").html(\"Not Saved\");\n		}\n\n		function clientActive() {\n\n			if ($(\"#clientActive\").is(\":checked\")) {\n				$(\"#client-active\").val(\"1\");\n			}\n			else {\n				$(\"#client-active\").val(\"0\");\n			}\n		}\n\n	 	 function createClient() {\n	  \n	  		alert(\"saving client\");\n			  		 		  \n	  	}\n\n		function saveClient() {\n			\n			$(\"#client-footer\").html(\"Saving.\");\n\n			clientActive();\n\n			$.post( \"/clients/ajax/save/{$client.id}\"+ \"?PHPSESSID={$sessionID}\", $( \"#client-form\" ).serialize(), function() {\n				$(\"#client-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#client-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#client-name-help\").show();\n\n				}\n				else {\n					$(\"#client-name\").removeClass(\"has-error error\");\n					$(\"#client-name-help\").hide();\n				}\n				$(\"#breadcrumb-client-name\").html($(\"#client-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#client-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n	\n		function getCampaigns(client) {\n\n			if (client === null) {\n				return false;\n			}\n\n			$.post( \"/campaigns/ajax/search/campaigns/clientID/\" + client + \"/type/{$reportType}\" +\"?PHPSESSID={$sessionID}\" ,  function() {\n				$(\"#report-footer\").html(\"Searching For Campaigns...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#campaigns\").attr(\"disabled\", false);\n				        $(\'#campaigns\').select2(\"val\", \"\");\n				        var select = $(\'#campaigns\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n	\n		function getVendors(campaign) {\n\n			$.post( \"/vendors/ajax/search/campaigns\"+ \"?PHPSESSID={$sessionID}\", { \"campaigns\": campaign }  ,  function() {\n				$(\"#report-footer\").html(\"Searching For Vendors...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#vendors\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#vendors\").attr(\"disabled\", false);\n				        $(\'#vendors\').select2(\"val\", \"\");\n				        var select = $(\'#vendors\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n	\n		function getMarkets(vendor) {\n\n			$.post( \"/markets/ajax/search/vendors\"+ \"?PHPSESSID={$sessionID}\", { \"vendors\": vendor },  function() {\n				$(\"#report-footer\").html(\"Searching For Markets...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#markets\").attr(\"disabled\", false);\n				        $(\'#markets\').select2(\"val\", \"\");\n				        var select = $(\'#markets\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n		function runReport() {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$.post( \"/reports/ajax/create/\"+$(\"#category\").val()+\"/\"+$(\"#reportType\").val() + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#report-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createReportButton\").text(\"Create\");\n					$(\"#createReportButton\").attr(\"disabled\", false);					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						$(\"#createReportButton\").text(\"Create\");\n						$(\"#createReportButton\").attr(\"disabled\", false);\n						console.log(\"SID: {$smarty.cookies.PHPSESSID}\");\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#createReportButton\").text(\"Create\");\n						$(\"#createReportButton\").attr(\"disabled\", false);\n						$(\"#report-footer\").html(\"Unable to display order at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createReportButton\").text(\"Create\");\n				$(\"#createReportButton\").attr(\"disabled\", false);				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#createReportButton\").text(\"Create\");\n				$(\"#createReportButton\").attr(\"disabled\", false);				$(\"#report-footer\").html(\"Error!\");\n			})\n\n		}	\n	\n		function createReport() {\n			$(\"#createReportButton\").text(\"Creating...\");\n			$(\"#createReportButton\").attr(\"disabled\", \"disabled\");\n			runReport();\n		}\n		\n		function pollStatus(reportID) {\n			(function poll(){\n			    $.ajax({ url: \"/reports/ajax/status/\"+reportID, success: function(data){\n			        $(\"#reportStatus\").html(data.statusMessage);\n			    }, dataType: \"json\", complete: poll, timeout: 1000 });\n			})();\n		}\n\n		function includeGross() {\n\n			if ($(\"#includeGross\").is(\":checked\")) {\n				$(\"#isGrossCost\").val(\"1\");\n			}\n			else {\n				$(\"#isGrossCost\").val(\"0\");\n			}\n		}\n\n		function includeNet() {\n\n			if ($(\"#includeNet\").is(\":checked\")) {\n				$(\"#isNetCost\").val(\"1\");\n			}\n			else {\n				$(\"#isNetCost\").val(\"0\");\n			}\n		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(30,0,'reports-tracking','2014-12-01 02:40:43','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n<style>\n\n.form-control .select2-choice {\n    border: 0;\n    border-radius: 2px;\n}\n\n.form-control .select2-choice .select2-arrow {\n    border-radius: 0 2px 2px 0;   \n}\n\n.form-control.select2-container {\n    height: auto !important;\n    padding: 0px;\n}\n\n.form-control.select2-container.select2-dropdown-open {\n    border-color: #5897FB;\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control .select2-container.select2-dropdown-open .select2-choices {\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control.select2-container .select2-choices {\n    border: 0 !important;\n    border-radius: 3px;\n}\n</style>\n\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/reports/\">Reports</a></li>\n			<li><a href=\"/reports/summary/\">Summary</a></li>\n			<li class=\"active\" id=\"breadcrumb-report-type\">{$reportType}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Reports {if $reportTitle}({$reportTitle}){/if}</h2>\n								<em>{$reportDescription}</em>\n							</div>\n<div class=\"col-lg-10\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Parameters</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n		<form id=\"report-form\" class=\"form-horizontal label-left\" role=\"form\">\n			<input type=\"hidden\" name=\"reportID\" value=\"{$reportID}\">\n			<input type=\"hidden\" name=\"reportType\" value=\"{$reportType}\">\n			<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n			<input type=\"hidden\" id=\"category\" name=\"category\" value=\"{$reportCategory}\">\n			<input type=\"hidden\" id=\"reportType\" name=\"reportType\" value=\"{$reportType}\">\n			<input type=\"hidden\" name=\"templateID\" value=\"{$templateID}\">\n			<input type=\"hidden\" id=\"startDate\" name=\"startDate\" value=\"\">\n			<input type=\"hidden\" id=\"endDate\" name=\"endDate\" value=\"\">\n			<input type=\"hidden\" name=\"isBilling\" value=\"{$isBilling}\">\n			<input type=\"hidden\" name=\"isPending\" value=\"{$isPending}\">\n			<input type=\"hidden\" name=\"isOrdered\" value=\"{$isOrdered}\">\n			<input type=\"hidden\" id=\"isNetCost\" name=\"isNetCost\" value=\"{$isNetCost}\">\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-3 control-label\">Date Range</label>\n																		<div class=\"col-xs-12 col-sm-8 col-md-8 col-lg-8\" >\n							<div id=\"reportDates\" class=\"pull-left report-range\">\n																				<i class=\"fa fa-calendar\"></i>\n																				<span class=\"range-value\"></span><b class=\"caret\"></b>\n						\n							</div>										</div>				\n																	</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Client(s)</label>\n																			<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"clients\" name=\"clients[]\" class=\"form-control input multiselect\" multiple=\"multiple\"\">\n									{foreach $clients as $client}										<option value=\"{$client.id}\">{$client.name}</option>\n									{/foreach}\n\n								</select>\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"allClients\" name=\"allClients\" {if $report.allClients}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n							</div>\n\n					</div>\n\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Type?</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"marketType\" name=\"marketTypes[]\" class=\"form-control input multiselect\" multiple=\"multiple\" >\n									{foreach $vendorTypes as $vendorType}										<option value=\"{$vendorType.id}\">{$vendorType.description}</option>\n									{/foreach}\n								</select>\n\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"allTypes\" name=\"allMarketTypes\" {if $report.allTypes}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n	\n							</div>\n\n					</div>\n\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Campaign(s)</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"campaigns\" name=\"campaigns[]\" class=\"form-control input multiselect\" multiple=\"multiple\" >\n						\n\n								</select>\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n\n								<input type=\"checkbox\" id=\"allCampaigns\" name=\"allCampaigns\" {if $report.allCampaigns}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Vendor(s)</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"vendors\" name=\"vendors[]\" class=\"form-control input multiselect\" multiple=\"multiple\" >\n						\n\n								</select>\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n\n								<input type=\"checkbox\" id=\"allVendors\" name=\"allVendors\" {if $report.allVendors}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Include Net Cost?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeNet\" name=\"includeNet\" {if $report.includeNet}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Format?</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" style=\"white-space: nowrap;\" nowrap>\n\n								<select id=\"format\" name=\"format\"  class=\"form-control\" >\n									{foreach $formats as $format}										<option value=\"{$format.id}\">{$format.name}</option>\n									{foreachelse}\n										<option value=\"pdf\" selected>PDF</option>\n										<option value=\"csv\" disabled>XLS/SV</option>\n										<option value=\"web\" disabled>Web</option>\n									{/foreach}\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" id=\"createReportButton\" class=\"btn btn-success\" onclick=\"createReport();\">Create</button>\n							</p>\n						</div>\n					</div>		\n															</form>\n\n		</div>\n\n		<div id=\"report-footer\" class=\"widget-footer\">\n		</div>\n\n	</div>\n\n<div class=\"modal fade\" id=\"reportWait\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Please Wait</h4>\n      </div>\n      <div class=\"modal-body\">\n		<div class=\"progress progress-striped active\">\n		  <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n		  </div>\n		</div>\n		<span class=\"reportStatus\">Creating Report...</span>\n      </div>\n\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n\n\n\n\n\n</div>\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-datepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/daterangepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/moment.min.js\"></script>\n\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n\n			$(\'#allClients\').bootstrapSwitch();\n			$(\'#allTypes\').bootstrapSwitch();\n			$(\'#allCampaigns\').bootstrapSwitch();\n			$(\'#includeNet\').bootstrapSwitch();\n			$(\'#allVendors\').bootstrapSwitch();\n	\n			$(\'#reportDates\').daterangepicker({\n				startDate: moment().add(\'days\', 1),\n				endDate: moment().add(\'days\', 30),\n				minDate: \'01/01/1900\',\n				maxDate: \'12/31/2019\',\n				dateLimit: false,\n				showDropdowns: true,\n				showWeekNumbers: true,\n				timePicker: false,\n				timePickerIncrement: 1,\n				timePicker12Hour: true,\n				ranges: {\n					\'Today\': [moment(), moment()],\n					\'Tomorrow\': [moment().add(\'days\', 1), moment().add(\'days\', 1)],\n					\'Next 7 Days\': [moment().add(\'days\', 1),moment().add(\'days\', 7)],\n					\'Next 30 Days\': [moment().add(\'days\', 1), moment().add(\'days\', 30)],\n					\'Last Month\': [moment().subtract(\'month\', 1).startOf(\'month\'), moment().subtract(\'month\', 1).endOf(\'month\')],\n					\'This Month\': [moment().startOf(\'month\'), moment().endOf(\'month\')],\n					\'Next Month\': [moment().add(\'month\', 1).startOf(\'month\'), moment().add(\'month\', 1).endOf(\'month\')],\n					\'This Year To Date\': [moment().startOf(\'year\'), moment()],\n					\'Last Year\': [moment().subtract(\'year\', 1).startOf(\'year\'), moment().subtract(\'year\', 1).endOf(\'year\')]\n					},\n				opens: \'left\',\n				buttonClasses: [\'btn btn-default\'],\n				applyClass: \'btn-small btn-primary\',\n				cancelClass: \'btn-small\',\n				format: \'MM/DD/YYYY\',\n				separator: \' to \',\n				locale: {\n						applyLabel: \'Submit\',\n						fromLabel: \'From\',\n						toLabel: \'To\',\n						customRangeLabel: \'Custom Range\',\n						daysOfWeek: [\'Su\', \'Mo\', \'Tu\', \'We\', \'Th\', \'Fr\',\'Sa\'],\n						monthNames: [\'January\', \'February\', \'March\', \'April\', \'May\', \'June\', \'July\', \'August\', \'September\', \'October\', \'November\', \'December\'],\n						firstDay: 1\n					}\n				},\n	\n				function(start, end) {\n	\n					var startDate = new Date(start);\n					$(\'#reportDates span\').html(start.format(\'MMMM D, YYYY\') + \' - \' + end.format(\'MMMM D, YYYY\'));\n				\n				}\n			);\n\n			$(\'#reportDates span\').html(moment().add(\'days\', 1).format(\'MMMM D, YYYY\') + \' - \' + moment().add(\'days\', 30).format(\'MMMM D, YYYY\'));\n\n			$(\"#allClients\").change(function () {\n				allClients();\n			}); \n\n			$(\"#allTypes\").change(function () {\n				allTypes();\n			}); \n\n			$(\"#allCampaigns\").change(function () {\n				allCampaigns();\n			}); \n\n			$(\"#includeNet\").change(function () {\n				includeNet();\n			}); \n\n			$(\"#allVendors\").change(function () {\n				allVendors();\n			}); \n\n			$(\"#clients\").change(function () {\n				getCampaigns($(\"#clients\").val());\n			        $(\'#vendors\').select2(\"val\", \"\");\n			        $(\'#vendors\').empty();\n			        $(\'#markets\').select2(\"val\", \"\");\n			        $(\'#markets\').empty();\n			}); \n\n			$(\"#campaigns\").change(function () {\n				getVendors($(\"#campaigns\").val());\n			        $(\'#markets\').select2(\"val\", \"\");\n			        $(\'#markets\').empty();\n			}); \n\n			$(\"#vendors\").change(function () {\n				getMarkets($(\"#vendors\").val());\n			}); \n\n			$(\"#clients\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n			$(\"#vendors\").select2({\n			    placeholder: \"Search Vendors\",\n			    allowClear: true\n			});\n\n			$(\"#campaigns\").select2({\n			    placeholder: \"Search Campaigns\",\n			    allowClear: true\n			});\n\n			$(\"#format\").select2({\n			    placeholder: \"Report Format\",\n			    allowClear: false\n			});\n\n			$(\"#marketType\").select2({\n			    placeholder: \"Report Type\",\n			    allowClear: false\n			});\n\n			$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n			$(\"#types\").attr(\"disabled\",\"disabled\");\n\n			if ($(\"#clients\").val() != \"\") {\n				getCampaigns($(\"#clients\").val());\n			}\n		});\n\n	</script>\n\n	<script type=\"text/javascript\">\n\n		function resetFooter() {\n				$(\"#client-footer\").html(\"Not Saved\");\n		}\n\n		function clientActive() {\n\n			if ($(\"#clientActive\").is(\":checked\")) {\n				$(\"#client-active\").val(\"1\");\n			}\n			else {\n				$(\"#client-active\").val(\"0\");\n			}\n		}\n\n	 	 function createClient() {\n	  \n	  		alert(\"saving client\");\n			  		 		  \n	  	}\n\n		function saveClient() {\n			\n			$(\"#client-footer\").html(\"Saving.\");\n\n			clientActive();\n\n			$.post( \"/clients/ajax/save/{$client.id}\"+ \"?PHPSESSID={$sessionID}\", $( \"#client-form\" ).serialize(), function() {\n				$(\"#client-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#client-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#client-name-help\").show();\n\n				}\n				else {\n					$(\"#client-name\").removeClass(\"has-error error\");\n					$(\"#client-name-help\").hide();\n				}\n				$(\"#breadcrumb-client-name\").html($(\"#client-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#client-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n	\n		function getCampaigns(client) {\n\n			$.post( \"/campaigns/ajax/search/campaigns/clientID/\" + client + \"?PHPSESSID={$sessionID}\",  function() {\n				$(\"#report-footer\").html(\"Searching For Campaigns...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#campaigns\").attr(\"disabled\", false);\n				        $(\'#campaigns\').select2(\"val\", \"\");\n				        var select = $(\'#campaigns\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n	\n		function getVendors(campaign) {\n\n			$.post( \"/campaigns/ajax/search/vendors/campaignID/\" + campaign + \"?PHPSESSID={$sessionID}\" ,  function() {\n				$(\"#report-footer\").html(\"Searching For Vendors...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#vendors\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#vendors\").attr(\"disabled\", false);\n				        $(\'#vendors\').select2(\"val\", \"\");\n				        var select = $(\'#vendors\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n	\n		function getMarkets(vendor) {\n\n			$.post( \"/campaigns/ajax/search/markets/marketVendorID/\" + vendor + \"?PHPSESSID={$sessionID}\",  function() {\n				$(\"#report-footer\").html(\"Searching For Markets...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#markets\").attr(\"disabled\", false);\n				        $(\'#markets\').select2(\"val\", \"\");\n				        var select = $(\'#markets\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n		function runReport() {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$.post( \"/reports/ajax/create/\"+$(\"#category\").val()+\"/\"+$(\"#reportType\").val() + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#report-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createReportButton\").text(\"Create\");\n					$(\"#createReportButton\").attr(\"disabled\", false);					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						$(\"#createReportButton\").text(\"Create\");\n						$(\"#createReportButton\").attr(\"disabled\", false);\n						window.location.href=\"/reports/show/\" + response.reportID + \"/pdf\" + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n//						$(\"#reportWait\").modal(\'hide\');\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#createReportButton\").text(\"Create\");\n						$(\"#createReportButton\").attr(\"disabled\", false);\n						$(\"#report-footer\").html(\"Unable to display order at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createReportButton\").text(\"Create\");\n				$(\"#createReportButton\").attr(\"disabled\", false);				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#createReportButton\").text(\"Create\");\n				$(\"#createReportButton\").attr(\"disabled\", false);				$(\"#report-footer\").html(\"Error!\");\n			})\n\n		}	\n	\n		function createReport() {\n			getDateRange(\"#reportDates\", \"#startDate\", \"#endDate\");\n			allClients();\n			allTypes();\n			allCampaigns();\n\n			$(\"#createReportButton\").text(\"Creating...\");\n			$(\"#createReportButton\").attr(\"disabled\", \"disabled\");\n			runReport();\n		\n		}\n\n		function getDateRange(datepicker, fromField, toField) {\n\n			$(fromField).val($(\'#reportDates\').data(\'daterangepicker\').startDate.format(\'YYYY-MM-DD\'));\n			$(toField).val($(\'#reportDates\').data(\'daterangepicker\').endDate.format(\'YYYY-MM-DD\'));\n						\n		}\n\n		function allClients() {\n\n			if ($(\"#allClients\").is(\":checked\")) {\n				$(\"#allClients\").val(\"1\");\n				$(\"#clients\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allClients\").val(\"0\");\n				$(\"#clients\").attr(\"disabled\",false);\n			}\n		}\n\n		function allTypes() {\n\n			if ($(\"#allTypes\").is(\":checked\")) {\n				$(\"#allTypes\").val(\"1\");\n				$(\"#marketType\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allTypes\").val(\"0\");\n				$(\"#marketType\").attr(\"disabled\",false);\n			}\n		}\n\n		function allCampaigns() {\n\n			if ($(\"#allCampaigns\").is(\":checked\")) {\n				$(\"#allCampaigns\").val(\"1\");\n				$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allCampaigns\").val(\"0\");\n				$(\"#campaigns\").attr(\"disabled\",false);\n			}\n		}\n\n		function allVendors() {\n\n			if ($(\"#allVendors\").is(\":checked\")) {\n				$(\"#allVendors\").val(\"1\");\n				$(\"#vendors\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allVendors\").val(\"0\");\n				$(\"#vendors\").attr(\"disabled\",false);\n			}\n		}\n\n		function includeNet() {\n\n			if ($(\"#includeNet\").is(\":checked\")) {\n				$(\"#isNetCost\").val(\"1\");\n			}\n			else {\n				$(\"#isNetCost\").val(\"0\");\n			}\n		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(31,0,'worksheet-tv-alt','2015-01-07 20:51:02','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-TV | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 2px 5px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Broadcast TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Broadcast TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet </h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar hidden-xs\">\n<div class=\"control-inline toolbar-item-group \">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style-\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} {$vendor.name} {/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"margin-top: 20px; overflow-x: scroll; overflow-y: hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n{if $worksheet.isOrdered} 	\n\n								<div class=\"widget\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar col-xs-4 col-sm-6\" style=\"border-left-color: #4ba84b;\">\n												    <h3>{$orderInfo.orderCreated}</h3>\n												</div>\n											</div>\n								</div>\n{/if}\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3> \n												<div class=\"btn-group widget-header-toolbar col-xs-4 col-sm-6\">\n												    <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Vendor(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPPerStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\"  id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName}\n\n												    <div class=\"summary-daypart\" id=\"summary-daypart-{$daypart}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypart}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypart}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypart}\">0.0</div></td></tr>\n												      </table>\n												    </div>\n\n												     {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n{*\n<div class=\"\" id=\"worksheet-loading\" _style=\"display: none;\">Loading...</div>\n*}\n\n<div class=\"form\" id=\"worksheet-form\" _style=\"display: none;\">\n\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"daypart\">DP</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"station\">Station</th>\n                <th data-index=\"timePeriod\">Time Period</th>\n                <th data-index=\"programName\">Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th data-index=\"seconds\">Len</th>\n                <th data-index=\"rate\">Rate</th>\n                <th data-index=\"aqhRating\">AQH RTG</th>\n                <th data-index=\"cpp\">CPP</th>\n                <th data-index=\"impact\">000</th>\n                <th data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n\n	{foreach $wsLines as $line}\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-program-new\" value=\"\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\"\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Time Period</th>\n                <th>Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th>AQH RTG</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n 								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": false,\n					  \"scrollX\": true,\n//      					  \"order\": [{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}],\n     					  \"order\": [ [ 1, \"asc\" ] ],\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"100px\",\"orderDataType\": \"dom-text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n//					  \"autoWidth\": false,			\n					  \"displayLength\": 10,\n					  \"paginate\": true,\n					  \"initComplete\": function() { $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort();},\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n\n			  } );\n\n\n\n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n\n		reSort();\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n\n		\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:0};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"null\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments|escape:\'javascript\'}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n\n	\n	{else}\n		data = [\n				{ lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false }\n\n		];\n\n	{/if}\n\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach (beta)\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency (beta)\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	$( document ).ready(function() {\n\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n});\n\n			$(document).ready(function(){\n\n		$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/tv/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/tv/ajax/lines/remove/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/tv/ajax/line/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/tv/ajax/line/add/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/tv/ajax/lines/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/tv/edit/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/tv/ajax/delete/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option>-This Campaign-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet(\"+ worksheetID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n	function copyWorksheet(worksheetID) {\n				if (worksheetID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/tv/ajax/copy/{$worksheetID}\", $( \"#worksheet-form\" )+ \"?PHPSESSID={$sessionID}\".serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/tv/edit/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"\", em:\"EM\", da:\"DA\", ef:\"EF\", en:\"EN\", pa:\"PA\", pr:\"PR\", lf:\"LF\", ln:\"LN\", ov:\"OV\", sp:\"SP\", ro:\"RO\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$0.00\");\n			}	\n		}\n\n	  }\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name|escape:\'javascript\'}</option>{/foreach}</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw();\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], station: data[maxRow-1][\"station\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n})\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(33,0,'worksheet-radio-alt','2014-07-31 01:38:43','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-Radio | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 1px 2px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Radio</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Radio)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar\">\n<div class=\"control-inline toolbar-item-group\">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style-\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} {$vendor.name} {/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px; z-index: 9999;\"\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px; z-index: 9999;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" ><i class=\"fa fa-edit\"></i></button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\"><i class=\"fa fa-plus\"></i></button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled><i class=\"fa fa-save\"></i></button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\"><i class=\"fa fa-gavel\"></i></button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n{if $worksheet.isOrdered} 	\n\n								<div class=\"widget\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar col-xs-4 col-sm-6\" style=\"border-left-color: #4ba84b;\">\n												    <h3>{$orderInfo.orderCreated}</h3>\n												</div>\n											</div>\n								</div>\n{/if}\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPPerStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\" id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName}\n\n												    <div class=\"summary-daypart\" id=\"summary-daypart-{$daypart}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypart}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypart}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypart}\">0.0</div></td></tr>\n												      </table>\n												    </div>\n\n												     {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n<div class=\"form\">\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th  data-index=\"daypart\">DP</th>\n                <th  data-index=\"vendorID\">Vendor</th>\n                <th  data-index=\"station\">Station</th>\n                <th  data-index=\"program\">Program</th>\n                <th  data-index=\"timePeriod\">Time Period</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th  data-index=\"seconds\">Len</th>\n                <th  data-index=\"rate\">Rate</th>\n                <th  data-index=\"aqhRating\">AQH</th>\n                <th  data-index=\"cume\">Cume</th>\n                <th  data-index=\"cpp\">CPP</th>\n                <th  data-index=\"impact\">000</th>\n                <th  data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                 <td><input type=\"checkbox\" name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cume}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-cume-{$line.worksheetLine}\" value=\"{$line.cume}\" size=\"4\" name=\"cume[]\" data-index=\"cume\" data-name=\"cume\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-program-new\"  name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=\"checkbox\" name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=\"checkbox\" id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-cume-new\" value=\"\" size=\"4\" name=\"cume[]\" data-index=\"cume\" data-name=\"cume\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Program</th>\n                <th>Time Period</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th>AQH</th>\n                <th>Cume</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n})\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": false,\n					  \"scrollX\": true,\n      					  \"order\": [[ 1, \'asc\' ]],\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-checkbox\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-checkbox\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-checkbox\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-checkbox\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-checkbox\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-checkbox\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-checkbox\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n					  \"autoWidth\": false,			\n					  \"displayLength\": -1,\n					  \"paginate\": true,\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n			  } );\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n		reSort();\n\n\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );111\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:0};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLinesA as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"null\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false }\n\n	{/if}\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }	   ];\n\n	$( document ).ready(function() {\n\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n});\n\n			$(document).ready(function(){\n\n		$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/radio/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/radio/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/radio/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/radio/ajax/line/add/{$worksheet.id}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/radio/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/radio/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/radio/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/radio/ajax/delete/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option>-This Campaign-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet(\"+ worksheetID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n	function copyWorksheet(worksheetID) {\n				if (worksheetID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/radio/ajax/copy/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/tv/edit/{$worksheetID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"cume\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"cume\"] = newValue\n				$(\"#field-cume-\"+line).val(data[row][\"cume\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"\", am:\"AM\", md:\"MD\", pm:\"PM\", ev:\"EV\", we:\"WE\", ov:\"OV\", ro:\"RO\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$0.00\");\n			}	\n		}\n\n	  }\n\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \"checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \"checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"program\"]+\'\" id=\"field-program-\'+maxLineNumber+\'\"  name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-cume-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cume\"]+\'\" size=\"4\" name=\"cume[]\" data-index=\"cume\" data-name=\"cume\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw();\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], station: data[maxRow-1][\"station\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cume: data[maxRow-1][\"cume\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cume-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(34,0,'worksheet-prnt-alt','2015-01-07 20:47:43','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-Print | BluHorn{/block}\n{block name=\"header-js\"}\n\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n	<link href=\"/lib/datetimepicker/css/bootstrap-datetimepicker.min.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n	text-align: center;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 1px 2px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Print</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Print)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar\">\n<div class=\"control-inline toolbar-item-group\">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"container\">\n											   	<div class=\"col-lg-6\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'}   <strong>Campaign:</strong> {$campaign.name|default:\'none\'}    <strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong>  {foreach $vendors as $vendor} <a href=\"/vendors/edit/{$vendor.id}\">{$vendor.name}</a>{/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Contract #:</strong> {$campaign.contractNumber|default:\'none\'}</div>\n												</div>\n\n												<div class=\"col-md-12 col-lg-6 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 17, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n												</div>\n												</div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"17\">\n												     </form>\n												</div>\n\n											</div>\n											<div class=\"widget-footer\" id=\"worksheet-footer\">\n												Worksheet Loaded.\n											</div>\n								</div>\n\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Insertion Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"Prnt\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printDayOfWeek\" value=\"1\" {if $order.printDayOfWeek}checked{elseif !$order.id}checked{/if} > Day Of Week</label><br>\n												        <label><input type=\"checkbox\" name=\"printInsertionDate\"  value=\"1\" {if $order.printInsertionDate}checked{elseif !$order.id}checked{/if} > Insertion Date</label><br>\n												        <label><input type=\"checkbox\" name=\"printSizeAndType\" value=\"1\" {if $order.printSizeAndType}checked{elseif !$order.id}checked{/if} > Size & Type</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCaption\"  value=\"1\" {if $order.printCaption}checked{elseif !$order.id}checked{/if} > Caption</label><br>\n												        <label><input type=\"checkbox\" name=\"printPosition\"  value=\"1\" {if $order.printPosition}checked{elseif !$order.id}checked{/if}  > Position</label><br>\n												        <label><input type=\"checkbox\" name=\"printDeadline\"  value=\"1\" {if $order.printDeadline}checked{/if}> Deadline</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printCPI\"  value=\"1\" {if $order.printCPI}checked{elseif !$order.id}checked{/if} > Cost Per Inch</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollars\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if} > Gross Dollars</label><br>\n												        <label><input type=\"checkbox\" name=\"printNetDollars\"  value=\"1\" {if $order.printNetDollars}checked{elseif !$order.id}checked{/if} > Net Dollars</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\" id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs hide\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"date\" id=\"summary-switch-date\" onchange=\"javascript:summarySwitchPrnt();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"vendor\" id=\"summary-switch-vendor\" onchange=\"javascript:summarySwitchPrnt();\"> V\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitchPrnt();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												<tbody id=\"summaryTotals\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Inserts: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Gross: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalGrossSpend\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Net: </strong></td><td style=\"text-align: right;\"><div id=\"totalNetSpend\">$0.00</div></td></tr>\n												</tbody>\n												</table>	\n{if $userID==1}\n												<div class=\"vendor-summary-widget\" id=\"vendor-summary-widget\" ></div>\n{/if}\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n<div class=\"form\">\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n          <tr>\n                            <th colspan=\"9\">&nbsp;</th>\n                            <th colspan=\"3\" style=\"text-align: center;\">Gross</th>\n                            <th colspan=\"3\" style=\"text-align: center;\">Net</th>\n                            <th colspan=\"6\">&nbsp;</th>\n  	   </tr>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"caption\">Caption</th>\n                <th data-index=\"insertionDate\">Insertion Date</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"printSize\">Size</th>\n                <th data-index=\"numberOfColumns\">Columns</th>\n                <th data-index=\"inches\">Inches</th>\n                <th data-index=\"color\">Color</th>\n                <th data-index=\"grossCPI\">CPI</th>\n                <th data-index=\"grossColor\">Color</th>\n                <th data-index=\"grossCost\">Cost</th>\n                <th data-index=\"netCPI\">CPI</th>\n                <th data-index=\"netColor\">Color</th>\n                <th data-index=\"netCost\">Cost</th>\n                <th data-index=\"positionRequest\">Position</th>\n                <th data-index=\"creativeDeadline\">Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n            <tr style=\"text-align: center;\">\n		<td style=\"text-align: center;\"></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-caption-{$line.worksheetLine}\" name=\"caption[]\" data-index=\"caption\" data-name=\"caption\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"{$line.caption|escape:\'html\'}\"></td>\n              <td><div class=\'input-group input-sm date date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-{$line.worksheetLine}\" value=\"{if $line.insertionDate != \"0000-00-00\"}{$line.insertionDate|escape:\'html\'}{/if}\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  style=\"min-width: 120px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name|escape:\'html\'}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-{$line.worksheetLine}\" value=\"{$line.printSize|escape:\'html\'}\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n            <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-cols-{$line.worksheetLine}\" size=3 value=\"{$line.numberOfColumns}\" name=\"cols[]\" data-index=\"cols\" data-name=\"cols\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\"  size=3 id=\"field-inches-{$line.worksheetLine}\" value=\"{$line.inches}\" name=\"inches[]\" data-index=\"inches\" data-name=\"inches\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-color-{$line.worksheetLine}\" value=\"{$line.color|escape:\'html\'}\" size=\"10\" name=\"color[]\"  data-index=\"color\" data-name=\"color\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-{$line.worksheetLine}\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.grossCPI}\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" {if $line.inches<=0} tabindex=\"-1\" readonly {elseif $line.numberOfColumns <= 0}  tabindex=\"-1\"  readonly {/if}></div></td>\n              <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscolor-{$line.worksheetLine}\" value=\"{$line.grossColor}\" size=\"6\" name=\"grossColor[]\" data-index=\"grossColor\" data-name=\"grossColor\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-{$line.worksheetLine}\" value=\"{$line.grossCost}\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" {if $line.inches > 0} {if $line.numberOfColumns > 0}  tabindex=\"-1\"  readonly {/if} {/if}></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-{$line.worksheetLine}\" value=\"{$line.netCPI}\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" {if $line.inches<=0} readonly {elseif $line.numberOfColumns <= 0} readonly {/if} {if $worksheet.isAutoComm}  tabindex=\"-1\" readonly {/if} ></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcolor-{$line.worksheetLine}\" value=\"{$line.netColor}\" size=\"6\" name=\"netColor[]\"   data-name=\"netColor\" data-line=\"{$line.worksheetLine}\" data-index=\"netColor\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-{$line.worksheetLine}\" value=\"{$line.netCost}\" size=\"6\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"{$line.worksheetLine}\" data-index=\"netTotal\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-position-{$line.worksheetLine}\" value=\"{$line.positionRequest|escape:\'html\'}\" size=\"20\" name=\"position[]\" data-index=\"position\" data-name=\"position\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-{$line.worksheetLine}\" value=\"{if $line.creativeDeadline != \"0000-00-00 00:00:00\"}{$line.creativeDeadline|escape:\'html\'}{/if}\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=30 value=\"{$line.comments|escape:\'html\'}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-{$line.worksheetLine}\" value=\"{$line.vendorName}\" name=\"vendorName[]\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n             <td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-caption-new\" name=\"caption[]\" data-index=\"caption\" data-name=\"caption\" data-line=\"new\" data-row=\"new\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"\"></td>\n              <td><div class=\'input-group input-sm date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-new\" value=\"{$campaign.flightStart}\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>         \n	 <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  style=\"min-width: 120px;\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-new\" value=\"\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n            <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-cols-new\" size=3 value=\"\" name=\"cols[]\" data-index=\"cols\" data-name=\"cols\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\"  size=3 id=\"field-inches-new\" value=\"\" name=\"inches[]\" data-index=\"inches\" data-name=\"inches\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-color-new\" value=\"\" size=\"10\" name=\"color[]\"  data-index=\"color\" data-name=\"color\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-new\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscolor-new\" value=\"\" size=\"6\" name=\"grossColor[]\" data-index=\"grosscolor\" data-name=\"grossColor\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-new\" value=\"\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-new\" value=\"\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"  readonly {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcolor-new\" value=\"\" size=\"6\" name=\"netColor[]\"  data-name=\"netColor\" data-line=\"new\" data-index=\"netColor\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if} onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-new\" value=\"\" size=\"6\" name=\"netTotal[]\"  data-name=\"netTotal\" data-line=\"new\" data-index=\"netTotal\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if} onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-position-new\" value=\"\" size=\"20\" name=\"position[]\" data-index=\"position\" data-name=\"position\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-new\" value=\"\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=30  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                 <th>Line</th>\n                <th>Line #</th>\n                <th>Caption</th>\n                <th>Insertion Date</th>\n                <th>Vendor</th>\n                <th>Size</th>\n                <th>Columns</th>\n                <th>Inches</th>\n                <th>Color</th>\n                <th>Gross CPI</th>\n                <th>Color</th>\n                <th>Total</th>\n                <th>Net CPI</th>\n                <th>Color</th>\n                <th>Total</th>\n                <th>Position</th>\n                <th>Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/moment/moment-2.7.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/datetimepicker/js/bootstrap-datetimepicker.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-datepicker.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	  var vendorList = {};\n\n          {foreach $vendors as $vendor} \n	   	vendorList[ \"{$vendor.id}\" ]=\"{$vendor.name}\";\n 	   {/foreach}\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n//		    minDate: moment()\n		    default: moment(),\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n\n		$(document).ready(function() {\n\n		   updateSummaryPrnt();\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n      					  \"order\": [[ 1, \'asc\' ]],\n\n\"columns\": [\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"120px\", \"orderDataType\": \"dom-text\", \"type\":\"numeric\"},\n     { width: \"120px\", \"searchable\": false, \"orderDataType\": \"dom-select\"},\n     { width: \"70px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"70px\", sortable: false },\n     { width: \"100px\", sortable: false },\n     { width: \"50px\", \"orderDataType\": \"dom-text\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n					  \"autoWidth\": false,			\n					  \"displayLength\": -1,\n					  \"paginate\": true,\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n			  } );\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n		reSort();\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = [];\n\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n	  var maxLineNumber = {$maxLineNumber|default:1};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", vendor: \"{$line.vendorName|escape:\'javascript\'}\", vendorName: \"{$line.vendorName|escape:\'javascript\'}\", vendorID: \"{$line.vendorID}\", insertionDate: \"{$line.insertionDate|escape:\'javascript\'}\", caption: \"{$line.caption|escape:\'javascript\'}\", cols: \"{$line.numberOfColumns}\", grossTotal: \"{$line.grossCost}\", netTotal: \"{$line.netCost}\",  inches: \"{$line.inches|escape:\'javascript\'}\", grossCPI: \"{$line.grossCPI}\", grossColor: \"{$line.grossColor}\", netColor: \"{$line.netColor}\",  netCPI: \"{$line.netCPI}\", deadline: \"{$line.creativeDeadline}\", position: \"{$line.positionRequest|escape:\'javascript\'}\", size: \"{$line.printSize|escape:\'javascript\'}\", color: \"{$line.color|escape:\'javascript\'}\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments|escape:\'javascript\'}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: maxLineNumber, vendorName: \"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", caption: \"\",  size: \"\", cols: \"\", grossTotal: \"\", grossColor: \"\", netColor: \"\", netTotal: \"\",  inches: \"\", grossCPI: \"\",  netCPI: \"\", deadline: \"\", position: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments}\", copy: false, bold: false, delete: false }\n\n	{/if}\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: \"\", vendorName:\"\", vendor: \"\", vendorID: \"\", insertionDate: \"{$campaign.flightStart}\", caption: \"\",  cols: \"\", grossTotal: \"\", netTotal: \"\",  inches: \"\", grossColor: \"\", netColor: \"\",  grossCPI: \"\", size: \"\", netCPI: \"\", deadline: \"\", position: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"\", copy: false, bold: false, delete: false  };\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/prnt/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/prnt/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/prnt/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/prnt/ajax/line/add/{$worksheet.id}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", \"disabled\");\n			$.post( \"/prnt/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/prnt/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/prnt/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/prnt/ajax/delete/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n		data[row] = { lineNumber: \"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", caption: \"\",  cols: \"\", grossTotal: \"\", grossColor: \"\", netColor: \"\", netTotal: \"\",  size: \"\", inches: \"\", grossCPI: \"\", netCPI: \"\", deadline: \"\", position: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments}\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			data[row][\"vendorName\"] = $(\"#field-vendorID-\"+line + \" option:selected\").text();\n			$(\"#field-vendorName-\"+line).val(data[row][\"vendorName\"]);\n			var table =  $(\'#worksheet-{$worksheet.id}\').DataTable();			table.draw();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"caption\") {\n			newValue = $(field).val();\n			data[row][\"caption\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n\n		else if (fieldName == \"size\") {\n			newValue = $(field).val();\n			data[row][\"size\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"insertionDate\") {\n			newValue = $(field).val();\n			data[row][\"insertionDate\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName ==\"deadline\") {\n			newValue = $(field).val();\n			data[row][\"deadline\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"cols\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if ((oldValue == \"\") || (newValue == 0)) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-netcpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-grosstotal-\"+line).attr(\"disabled\",false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",false);\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"-1\");\n\n				data[row][\"grossTotal\"] = \"\";\n				data[row][\"grossCPI\"] = \"\";\n				data[row][\"netCPI\"] = \"\";\n				$(\"#field-grosscpi-\"+line).val(\"\");\n				$(\"#field-netcpi-\"+line).val(\"\");\n\n				{if $worksheet.isAutoComm < 1}  \n					$(\"#field-nettotal-\"+line).attr(\"disabled\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\", false);\n					$(\"#field-nettotal-\"+line).attr(\"tabindex\", \"\");\n				{/if}\n				var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,fieldName,oldValue,newValue]];\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosscpi-\"+line).attr(\"readonly\", false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",\"readonly\");\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"-1\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"\");\n\n				{if $worksheet.isAutoComm < 1} \n					$(\"#field-netcpi-\"+line).attr(\"disabled\",false);\n					$(\"#field-netcpi-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n				{/if}\n\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"cols\"] = newValue;\n				data[row][\"grossTotal\"] =  ( data[row][\"cols\" ] * data[row][\"inches\"] * data[row][\"grossCPI\"] + parseFloat(data[row][\"grossColor\"]) ).toFixed(2); \n				$(\"#field-cols-\"+line).val(data[row][\"cols\"]);\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commissiom\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else}\n					var changes = [[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"inches\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if ((oldValue == \"\")  || (newValue == 0)) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-netcpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-grosstotal-\"+line).attr(\"disabled\",false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",false);\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"-1\");\n\n				{if $worksheet.isAutoComm < 1} \n					$(\"#field-nettotal-\"+line).attr(\"disabled\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"tabindex\", \"\");\n				{/if}\n\n				data[row][\"grossTotal\"] = \"\";\n				data[row][\"grossCPI\"] = \"\";\n				data[row][\"netCPI\"] = \"\";\n				$(\"#field-grosscpi-\"+line).val(\"\");\n				$(\"#field-netcpi-\"+line).val(\"\");\n				var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,fieldName,oldValue,newValue]];\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosscpi-\"+line).attr(\"readonly\", false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",\"readonly\");\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"-1\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"\");\n\n				{if !$worksheet.isAutoComm} \n					$(\"#field-netcpi-\"+line).attr(\"disabled\",false);\n					$(\"#field-netcpi-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n				{/if}\n\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"inches\"] = newValue;\n				data[row][\"grossTotal\"] =  ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) + parseFloat(data[row][\"grossColor\"])).toFixed(2); \n				$(\"#field-inches-\"+line).val(data[row][\"inches\"]);\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else}\n					var changes = [[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossCPI\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n				data[row][\"grossCPI\"] = \"0.00\";\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n				data[row][\"grossCPI\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",\"readonly\");\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossCPI\"] = newValue;\n				data[row][\"grossTotal\"] =  ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) + parseFloat(data[row][\"grossColor\"])).toFixed(2); \n				$(\"#field-grosscpi-\"+line).val(data[row][\"grossCPI\"]);\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossColor\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossColor\"] = \"0.00\";\n			}\n\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				oldValue = data[row][\"grossColor\"];\n				data[row][\"grossColor\"] = newValue;\n				if ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) > 0) {\n					data[row][\"grossTotal\"] =  ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) + parseFloat(data[row][\"grossColor\"])).toFixed(2); \n				}\n				else {\n					data[row][\"grossTotal\"] =  parseFloat(data[row][\"grossColor\"] - parseFloat(oldValue) + parseFloat(data[row][\"grossTotal\"])).toFixed(2); \n				}\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				$(\"#field-grosscolor-\"+line).val(data[row][\"grossColor\"]);\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n					data[row][\"netColor\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossColor\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					$(\"#field-netcolor-\"+line).val(data[row][\"netColor\"]);\n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netColor\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netColor\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netColor\"] = newValue;\n//				data[row][\"grossTotal\"] =  ( data[row][\"cols\"] * data[row][\"inches\"] * data[row][\"grossCPI\"] + data[row][\"netColor\"] ).toFixed(2); \n				$(\"#field-netcolor-\"+line).val(data[row][\"netColor\"]);\n				{if $worksheet.isAutoComm} \n//					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n//					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossTotal\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"grossTotal\"] = newValue;\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netCPI\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPI\"] = \"0.00\";\n				$(\"#field-netcpi-\"+line).val(data[row][\"netCPl\"]);\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPI\"] = \"0.00\";\n				$(\"#field-netcpi-\"+line).val(data[row][\"netCPl\"]);\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"netCPI\"] = newValue;\n				$(\"#field-netcpi-\"+line).val(newValue);\n\n				{if !$worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((data[row][\"cols\"])*(data[row][\"inches\"])*(data[row][\"netCPI\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netTotal\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netTotal\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"netTotal\"] = newValue;\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n\n				{if !$worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ( (data[row][\"netTotal\"]) / ( (data[row][\"cols\"])*(data[row][\"inches\"]) ) ).toFixed(2);\n					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"cume\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"cume\"] = newValue\n				$(\"#field-cume-\"+line).val(data[row][\"cume\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"color\") {\n			newValue = $(field).val();\n			data[row][\"color\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"position\") {\n			newValue = $(field).val();\n			data[row][\"position\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n			console.log(\"building new line \" + row);\n			console.log(data[row]);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummaryPrnt();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n\n		console.log(data[maxRow-1]);\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td style=\"text-align: center;\"></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n                \'<td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-caption-\'+maxLineNumber+\'\" name=\"caption[]\" data-index=\"caption\" data-name=\"caption\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" value=\"\'+data[maxRow-1][\"caption\"]+\'\"></td>\',\n               \'<td><div class=\"input-group input-sm date date datetimepicker-dateonly\" data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"insertionDate\"]+\'\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n               \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  style=\"min-width: 120px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\">{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name|escape:\'javascript\'}</option>{/foreach}</select></td>\',\n              \'<td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"size\"]+\'\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"{$line.worksheetLine}\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n              \'<td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-cols-\'+maxLineNumber+\'\" size=3 value=\"\'+data[maxRow-1][\"cols\"]+\'\" name=\"cols[]\" data-index=\"cols\" data-name=\"cols\" data-line=\"{$line.worksheetLine}\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n               \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\"  size=3 id=\"field-inches-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"inches\"]+\'\" name=\"inches[]\" data-index=\"inches\" data-name=\"inches\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-color-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"color\"]+\'\" size=\"10\" name=\"color[]\"  data-index=\"color\" data-name=\"color\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-{$line.worksheetLine}\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"grossCPI\"]+\'\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" {if $line.inches<=0} tabindex=\"-1\" readonly {elseif $line.numberOfColumns <= 0}  tabindex=\"-1\"  readonly {/if}></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscolor-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"grossColor\"]+\'\" size=\"6\" name=\"grossColor[]\" data-index=\"grossColor\" data-name=\"grossColor\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" ></td>\',\n \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"grossTotal\"]+\'\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" {if $line.inches > 0} {if $line.numberOfColumns > 0}  tabindex=\"-1\"  readonly {/if} {/if}></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-\'+maxLineNumber+\'}\" value=\"\'+data[maxRow-1][\"netCPI\"]+\'\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\' onchange=\"updateField(this);\" {if $line.inches<=0} tabindex=\"-1\" readonly {elseif $line.numberOfColumns <= 0}  {if $worksheet.isAutoComm}  tabindex=\"-1\" readonly {/if} {/if}></td>\',\n                \'<td><input type=text class=\"form-control input-sm\" id=\"field-netcolor-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"netColor\"]+\'\" size=\"6\" name=\"netColor[]\"   data-name=\"netColor\" data-line=\"\'+maxLineNumber+\'\" data-index=\"netColor\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\',\n                \'<td><input type=text class=\"form-control input-sm\" id=\"field-nettotal-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"netTotal\"]+\'\" size=\"6\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"\'+maxLineNumber+\'\" data-index=\"netTotal\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-position-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"position\"]+\'\" size=\"20\" name=\"position[]\" data-index=\"position\" data-name=\"position\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"input-group input-sm date datetimepicker-datetime\" data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"deadline\"]+\'\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n\n\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=30  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"vendorName\"]+\'\" name=\"vendorName[]\"></td>\',\n\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, vendor: data[maxRow-1][\"vendor\"], vendorID: data[maxRow-1][\"vendorID\"], insertionDate: data[maxRow-1][\"insertionDate\"], caption: data[maxRow-1][\"caption\"], size: data[maxRow-1][\"size\"], cols: data[maxRow-1][\"cols\"], grossTotal: data[maxRow-1][\"grossTotal\"], netTotal: data[maxRow-1][\"netTotal\"],  inches: data[maxRow-1][\"inches\"], grossCPI: data[maxRow-1][\"grossCPI\"], netCPI: data[maxRow-1][\"netCPI\"], deadline: data[maxRow-1][\"deadline\"], position: data[maxRow-1][\"position\"], color: data[maxRow-1][\"color\"], commission: \"{$worksheet.commission|default:0}\", comments: data[maxRow-1][\"comments\"],  vendorName: data[maxRow-1][\"vendorName\"], copy: false, bold: false, delete: false };\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n//		    minDate: moment(),\n		    default: moment()\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n//   $(\"#summaryTotals\").width();    \n//   $(\"#widget-summary\").width($(\"#summaryTotals\").width()+50);\n\n})\n\n	function updateDaypartSummary() {\n	\n		return false;\n	}\n\n	function clearNewLine() {\n		$(\'#field-caption-new\').val(\'\');\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-insertionDate-new\').val(\'\');\n		$(\'#field-deadline-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-color-new\').val(\'\');\n		$(\'#field-size-new\').val(\'\');\n		$(\'#field-position-new\').val(\'\');\n		$(\'#field-cols-new\').val(\'\');\n		$(\'#field-inches-new\').val(\'\');\n		$(\'#field-grossCPI-new\').val(\'\');\n		$(\'#field-grossCost-new\').val(\'\');\n		$(\'#field-netCost-new\').val(\'\');\n		$(\'#field-netCPI-new\').val(\'\');\n\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location = \"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n		function exportWorksheet(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/worksheet/csv\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to export worksheet at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n	$(document).ready(function () {\n	\n	    	$(\'.toggle-col\').change(function(box) {\n	            var colName = $(this).data(\"name\");\n	    	    if ($(this).is(\':checked\')) {\n	//		console.log(\"Box is checked\");\n			saveCols(colName, 0);\n		    }\n	            else {\n	//		console.log(\"Box is unchecked\");\n			saveCols(colName, 1);\n		    }\n	    	});\n	});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/prnt/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/prnt/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/prnt/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n	</script>\n	\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(36,0,'worksheet-cable-alt','2014-07-30 21:08:06','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Cable Worksheet | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 2px 5px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Cable TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Cable TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar\">\n<div class=\"control-inline toolbar-item-group\">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style-\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} {$vendor.name} {/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n{if $worksheet.isOrdered} 	\n\n								<div class=\"widget\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar col-xs-4 col-sm-6\" style=\"border-left-color: #4ba84b;\">\n												    <h3>{$orderInfo.orderCreated}</h3>\n												</div>\n											</div>\n								</div>\n{/if}\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Vendor(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPPerStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$order.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\" id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName}\n\n												    <div class=\"summary-daypart\" id=\"summary-daypart-{$daypart}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypart}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypart}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypart}\">0.0</div></td></tr>\n												      </table>\n												    </div>\n\n												     {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\">\n<div class=\"\" id=\"worksheet-loading\">Loading...</div>\n<div class=\"form\" id=\"worksheet-form\" style=\"display: none;\">\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"daypart\">DP</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"station\">Station</th>\n                <th data-index=\"timePeriod\">Time Period</th>\n                <th data-index=\"programName\">Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th data-index=\"seconds\">Len</th>\n                <th data-index=\"rate\">Rate</th>\n                <th data-index=\"aqhRating\">AQH RTG</th>\n                <th data-index=\"cpp\">CPP</th>\n                <th data-index=\"impact\">000</th>\n                <th data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-program-new\" value=\"\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\"\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Time Period</th>\n                <th>Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th>AQH RTG</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n      					  \"order\": [[ 1, \'asc\' ]],\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"100px\",\"orderDataType\": \"dom-text\"},\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n					  \"autoWidth\": true,			\n					  \"displayLength\": 10,\n					  \"paginate\": true,\n					  \"initComplete\": function() { $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort();},\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n			  } );\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n		reSort();\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:0};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"null\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false }\n\n	{/if}\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }	   ];\n\n	$( document ).ready(function() {\n\n\n$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n});\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/cable/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/cable/ajax/lines/remove/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/cable/ajax/line/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/cable/ajax/line/add/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/cable/ajax/lines/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/cable/edit/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/cable/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/cable/ajax/delete/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option>-This Campaign-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet(\"+ worksheetID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n	function copyWorksheet(worksheetID) {\n				if (worksheetID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/cable/ajax/copy/{$worksheetID}\", $( \"#worksheet-form\" )+ \"?PHPSESSID={$sessionID}\".serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/cable/edit/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"\", em:\"EM\", da:\"DA\", ef:\"EF\", en:\"EN\", pa:\"PA\", pr:\"PR\", lf:\"LF\", ln:\"LN\", ov:\"OV\", sp:\"SP\", ro:\"RO\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}	\n		}\n\n	  }\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw();\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], station: data[maxRow-1][\"station\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n})\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(39,0,'worksheet-digital-alt','2015-03-09 13:41:30','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-Digital | BluHorn{/block}\n{block name=\"header-js\"}\n\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n	<link href=\"/lib/datetimepicker/css/bootstrap-datetimepicker.min.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n	text-align: center;\n \n   }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 1px 2px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Digital</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Digital)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar\">\n<div class=\"control-inline toolbar-item-group\">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"container\">\n											   	<div class=\"col-lg-6\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'}   <strong>Campaign:</strong> {$campaign.name|default:\'none\'}    <strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong>  {foreach $vendors as $vendor} <a href=\"/vendors/edit/{$vendor.id}\">{$vendor.name}</a>{/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Contract #:</strong> {$campaign.contractNumber|default:\'none\'}</div>\n												</div>\n\n												<div class=\"col-md-12 col-lg-6 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 19, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n												</div>\n												</div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"17\">\n												     </form>\n												</div>\n\n											</div>\n											<div class=\"widget-footer\" id=\"worksheet-footer\">\n												Worksheet Loaded.\n											</div>\n								</div>\n\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Insertion Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"Digital\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printDayOfWeek\" value=\"1\" {if $order.printDayOfWeek}checked{elseif !$order.id}checked{/if} > Day Of Week</label><br>\n												        <label><input type=\"checkbox\" name=\"printInsertionDate\"  value=\"1\" {if $order.printInsertionDate}checked{elseif !$order.id}checked{/if} > Insertion Date</label><br>\n												        <label><input type=\"checkbox\" name=\"printSizeAndType\" value=\"1\" {if $order.printSizeAndType}checked{elseif !$order.id}checked{/if} > Size & Type</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCaption\"  value=\"1\" {if $order.printCaption}checked{elseif !$order.id}checked{/if} > Caption</label><br>\n												        <label><input type=\"checkbox\" name=\"printPosition\"  value=\"1\" {if $order.printPosition}checked{elseif !$order.id}checked{/if}  > Position</label><br>\n												        <label><input type=\"checkbox\" name=\"printDeadline\"  value=\"1\" {if $order.printDeadline}checked{/if}> Deadline</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printCPI\"  value=\"1\" {if $order.printCPI}checked{elseif !$order.id}checked{/if} > Cost Per Inch</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollars\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if} > Gross Dollars</label><br>\n												        <label><input type=\"checkbox\" name=\"printNetDollars\"  value=\"1\" {if $order.printNetDollars}checked{elseif !$order.id}checked{/if} > Net Dollars</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\" id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs hide\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"date\" id=\"summary-switch-date\" onchange=\"javascript:summarySwitchDigital();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"vendor\" id=\"summary-switch-vendor\" onchange=\"javascript:summarySwitchDigital();\"> V\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitchDigital();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												<tbody id=\"summaryTotals\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Inserts: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Gross: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalGrossSpend\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Net: </strong></td><td style=\"text-align: right;\"><div id=\"totalNetSpend\">$0.00</div></td></tr>\n												</tbody>\n												</table>	\n{if $userID==1}\n												<div class=\"vendor-summary-widget\" id=\"vendor-summary-widget\" ></div>\n{/if}\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n<div class=\"form\">\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n          <tr>\n                            <th colspan=\"9\">&nbsp;</th>\n                            <th colspan=\"3\" style=\"text-align: center;\">Gross</th>\n                            <th colspan=\"3\" style=\"text-align: center;\">Net</th>\n                            <th colspan=\"6\">&nbsp;</th>\n  	   </tr>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"caption\">Caption</th>\n                <th data-index=\"insertionDate\">Insertion Date</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"printSize\">Size</th>\n                <th data-index=\"numberOfColumns\">Columns</th>\n                <th data-index=\"inches\">Inches</th>\n                <th data-index=\"color\">Color</th>\n                <th data-index=\"grossCPI\">CPI</th>\n                <th data-index=\"grossColor\">Color</th>\n                <th data-index=\"grossCost\">Cost</th>\n                <th data-index=\"netCPI\">CPI</th>\n                <th data-index=\"netColor\">Color</th>\n                <th data-index=\"netCost\">Cost</th>\n                <th data-index=\"positionRequest\">Position</th>\n                <th data-index=\"creativeDeadline\">Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-caption-{$line.worksheetLine}\" name=\"caption[]\" data-index=\"caption\" data-name=\"caption\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"{$line.caption|escape:\'html\'}\"></td>\n              <td><div class=\'input-group input-sm date date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-{$line.worksheetLine}\" value=\"{$line.insertionDate|escape:\'html\'}\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  style=\"min-width: 120px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name|escape:\'javascript\'}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-{$line.worksheetLine}\" value=\"{$line.printSize|escape:\'html\'}\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n            <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-cols-{$line.worksheetLine}\" size=3 value=\"{$line.numberOfColumns}\" name=\"cols[]\" data-index=\"cols\" data-name=\"cols\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\"  size=3 id=\"field-inches-{$line.worksheetLine}\" value=\"{$line.inches}\" name=\"inches[]\" data-index=\"inches\" data-name=\"inches\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-color-{$line.worksheetLine}\" value=\"{$line.color|escape:\'html\'}\" size=\"10\" name=\"color[]\"  data-index=\"color\" data-name=\"color\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-{$line.worksheetLine}\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.grossCPI}\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" {if $line.inches<=0} tabindex=\"-1\" readonly {elseif $line.numberOfColumns <= 0}  tabindex=\"-1\"  readonly {/if}></div></td>\n              <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscolor-{$line.worksheetLine}\" value=\"{$line.grossColor}\" size=\"6\" name=\"grossColor[]\" data-index=\"grossColor\" data-name=\"grossColor\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-{$line.worksheetLine}\" value=\"{$line.grossCost}\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" {if $line.inches > 0} {if $line.numberOfColumns > 0}  tabindex=\"-1\"  readonly {/if} {/if}></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-{$line.worksheetLine}\" value=\"{$line.netCPI}\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" {if $line.inches<=0} readonly {elseif $line.numberOfColumns <= 0} readonly {/if} {if $worksheet.isAutoComm}  tabindex=\"-1\" readonly {/if} ></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcolor-{$line.worksheetLine}\" value=\"{$line.netColor}\" size=\"6\" name=\"netColor[]\"   data-name=\"netColor\" data-line=\"{$line.worksheetLine}\" data-index=\"netColor\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-{$line.worksheetLine}\" value=\"{$line.netCost}\" size=\"6\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"{$line.worksheetLine}\" data-index=\"netTotal\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-position-{$line.worksheetLine}\" value=\"{$line.positionRequest|escape:\'html\'}\" size=\"20\" name=\"position[]\" data-index=\"position\" data-name=\"position\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-{$line.worksheetLine}\" value=\"{$line.creativeDeadline|escape:\'html\'}\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=30 value=\"{$line.comments|escape:\'html\'}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-{$line.worksheetLine}\" value=\"{$line.vendorName}\" name=\"vendorName[]\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n             <td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-caption-new\" name=\"caption[]\" data-index=\"caption\" data-name=\"caption\" data-line=\"new\" data-row=\"new\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"\"></td>\n              <td><div class=\'input-group input-sm date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-new\" value=\"\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>         \n	 <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  style=\"min-width: 120px;\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-new\" value=\"\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n            <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-cols-new\" size=3 value=\"\" name=\"cols[]\" data-index=\"cols\" data-name=\"cols\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\"  size=3 id=\"field-inches-new\" value=\"\" name=\"inches[]\" data-index=\"inches\" data-name=\"inches\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-color-new\" value=\"\" size=\"10\" name=\"color[]\"  data-index=\"color\" data-name=\"color\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-new\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscolor-new\" value=\"\" size=\"6\" name=\"grossColor[]\" data-index=\"grosscolor\" data-name=\"grossColor\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-new\" value=\"\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-new\" value=\"\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"  readonly {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcolor-new\" value=\"\" size=\"6\" name=\"netColor[]\"  data-name=\"netColor\" data-line=\"new\" data-index=\"netColor\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if} onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-new\" value=\"\" size=\"6\" name=\"netTotal[]\"  data-name=\"netTotal\" data-line=\"new\" data-index=\"netTotal\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if} onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-position-new\" value=\"\" size=\"20\" name=\"position[]\" data-index=\"position\" data-name=\"position\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-new\" value=\"\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=30  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                 <th>Line</th>\n                <th>Line #</th>\n                <th>Caption</th>\n                <th>Insertion Date</th>\n                <th>Vendor</th>\n                <th>Size</th>\n                <th>Columns</th>\n                <th>Inches</th>\n                <th>Color</th>\n                <th>Gross CPI</th>\n                <th>Color</th>\n                <th>Total</th>\n                <th>Net CPI</th>\n                <th>Color</th>\n                <th>Total</th>\n                <th>Position</th>\n                <th>Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/moment/moment-2.7.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/datetimepicker/js/bootstrap-datetimepicker.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-datepicker.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	  var vendorList = {};\n\n          {foreach $vendors as $vendor} \n	   	vendorList[ \"{$vendor.id}\" ]=\"{$vendor.name}\";\n 	   {/foreach}\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n//		    minDate: moment()\n		    default: moment(),\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n\n		$(document).ready(function() {\n\n		   updateSummaryDigital();\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n      					  \"order\": [[ 1, \'asc\' ]],\n\n\"columns\": [\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"120px\", \"orderDataType\": \"dom-text\", \"type\":\"numeric\"},\n     { width: \"120px\", \"searchable\": false, \"orderDataType\": \"dom-select\"},\n     { width: \"70px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"70px\", sortable: false },\n     { width: \"100px\", sortable: false },\n     { width: \"50px\", \"orderDataType\": \"dom-text\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n					  \"autoWidth\": false,			\n					  \"displayLength\": -1,\n					  \"paginate\": true,\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n			  } );\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n		reSort();\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = [];\n\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n	  var maxLineNumber = {$maxLineNumber|default:1};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", vendor: \"{$line.vendorName|escape:\'javascript\'}\", vendorName: \"{$line.vendorName|escape:\'javascript\'}\", vendorID: \"{$line.vendorID}\", insertionDate: \"{$line.insertionDate|escape:\'javascript\'}\", caption: \"{$line.caption|escape:\'javascript\'}\", cols: \"{$line.numberOfColumns}\", grossTotal: \"{$line.grossCost}\", netTotal: \"{$line.netCost}\",  inches: \"{$line.inches|escape:\'javascript\'}\", grossCPI: \"{$line.grossCPI}\", grossColor: \"{$line.grossColor}\", netColor: \"{$line.netColor}\",  netCPI: \"{$line.netCPI}\", deadline: \"{$line.creativeDeadline}\", position: \"{$line.positionRequest|escape:\'javascript\'}\", size: \"{$line.printSize|escape:\'javascript\'}\", color: \"{$line.color|escape:\'javascript\'}\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments|escape:\'javascript\'}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: maxLineNumber, vendorName: \"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", caption: \"\",  size: \"\", cols: \"\", grossTotal: \"\", grossColor: \"\", netColor: \"\", netTotal: \"\",  inches: \"\", grossCPI: \"\",  netCPI: \"\", deadline: \"\", position: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments}\", copy: false, bold: false, delete: false }\n\n	{/if}\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: \"\", vendorName:\"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", caption: \"\",  cols: \"\", grossTotal: \"\", netTotal: \"\",  inches: \"\", grossColor: \"\", netColor: \"\",  grossCPI: \"\", size: \"\", netCPI: \"\", deadline: \"\", position: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"\", copy: false, bold: false, delete: false  };\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/digital/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/digital/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/digital/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/digital/ajax/line/add/{$worksheet.id}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", \"disabled\");\n			$.post( \"/digital/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/digital/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/digital/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/digital/ajax/delete/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n		data[row] = { lineNumber: \"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", caption: \"\",  cols: \"\", grossTotal: \"\", grossColor: \"\", netColor: \"\", netTotal: \"\",  size: \"\", inches: \"\", grossCPI: \"\", netCPI: \"\", deadline: \"\", position: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments}\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			data[row][\"vendorName\"] = $(\"#field-vendorID-\"+line + \" option:selected\").text();\n			$(\"#field-vendorName-\"+line).val(data[row][\"vendorName\"]);\n			var table =  $(\'#worksheet-{$worksheet.id}\').DataTable();			table.draw();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"caption\") {\n			newValue = $(field).val();\n			data[row][\"caption\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n\n		else if (fieldName == \"size\") {\n			newValue = $(field).val();\n			data[row][\"size\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"insertionDate\") {\n			newValue = $(field).val();\n			data[row][\"insertionDate\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName ==\"deadline\") {\n			newValue = $(field).val();\n			data[row][\"deadline\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"cols\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if ((oldValue == \"\") || (newValue == 0)) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-netcpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-grosstotal-\"+line).attr(\"disabled\",false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",false);\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"-1\");\n\n				data[row][\"grossTotal\"] = \"\";\n				data[row][\"grossCPI\"] = \"\";\n				data[row][\"netCPI\"] = \"\";\n				$(\"#field-grosscpi-\"+line).val(\"\");\n				$(\"#field-netcpi-\"+line).val(\"\");\n\n				{if $worksheet.isAutoComm < 1}  \n					$(\"#field-nettotal-\"+line).attr(\"disabled\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\", false);\n					$(\"#field-nettotal-\"+line).attr(\"tabindex\", \"\");\n				{/if}\n				var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,fieldName,oldValue,newValue]];\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosscpi-\"+line).attr(\"readonly\", false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",\"readonly\");\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"-1\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"\");\n\n				{if $worksheet.isAutoComm < 1} \n					$(\"#field-netcpi-\"+line).attr(\"disabled\",false);\n					$(\"#field-netcpi-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n				{/if}\n\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"cols\"] = newValue;\n				data[row][\"grossTotal\"] =  ( data[row][\"cols\" ] * data[row][\"inches\"] * data[row][\"grossCPI\"] + parseFloat(data[row][\"grossColor\"]) ).toFixed(2); \n				$(\"#field-cols-\"+line).val(data[row][\"cols\"]);\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commissiom\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else}\n					var changes = [[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"inches\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if ((oldValue == \"\")  || (newValue == 0)) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-netcpi-\"+line).attr(\"disabled\", \"disabled\");\n				$(\"#field-grosstotal-\"+line).attr(\"disabled\",false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",false);\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"-1\");\n\n				{if $worksheet.isAutoComm < 1} \n					$(\"#field-nettotal-\"+line).attr(\"disabled\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"tabindex\", \"\");\n				{/if}\n\n				data[row][\"grossTotal\"] = \"\";\n				data[row][\"grossCPI\"] = \"\";\n				data[row][\"netCPI\"] = \"\";\n				$(\"#field-grosscpi-\"+line).val(\"\");\n				$(\"#field-netcpi-\"+line).val(\"\");\n				var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,fieldName,oldValue,newValue]];\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosscpi-\"+line).attr(\"readonly\", false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",\"readonly\");\n\n				$(\"#field-grosstotal-\"+line).attr(\"tabindex\", \"-1\");\n				$(\"#field-grosscpi-\"+line).attr(\"tabindex\", \"\");\n\n				{if !$worksheet.isAutoComm} \n					$(\"#field-netcpi-\"+line).attr(\"disabled\",false);\n					$(\"#field-netcpi-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n				{/if}\n\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"inches\"] = newValue;\n				data[row][\"grossTotal\"] =  ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) + parseFloat(data[row][\"grossColor\"])).toFixed(2); \n				$(\"#field-inches-\"+line).val(data[row][\"inches\"]);\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else}\n					var changes = [[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossCPI\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n				data[row][\"grossCPI\"] = \"0.00\";\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n				data[row][\"grossCPI\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",\"readonly\");\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossCPI\"] = newValue;\n				data[row][\"grossTotal\"] =  ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) + parseFloat(data[row][\"grossColor\"])).toFixed(2); \n				$(\"#field-grosscpi-\"+line).val(data[row][\"grossCPI\"]);\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossColor\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossColor\"] = \"0.00\";\n			}\n\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				oldValue = data[row][\"grossColor\"];\n				data[row][\"grossColor\"] = newValue;\n				if ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) > 0) {\n					data[row][\"grossTotal\"] =  ((data[row][\"cols\"]*data[row][\"inches\"]) * (data[row][\"grossCPI\"]) + parseFloat(data[row][\"grossColor\"])).toFixed(2); \n				}\n				else {\n					data[row][\"grossTotal\"] =  parseFloat(data[row][\"grossColor\"] - parseFloat(oldValue) + parseFloat(data[row][\"grossTotal\"])).toFixed(2); \n				}\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				$(\"#field-grosscolor-\"+line).val(data[row][\"grossColor\"]);\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n					data[row][\"netColor\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossColor\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					$(\"#field-netcolor-\"+line).val(data[row][\"netColor\"]);\n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netColor\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netColor\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netColor\"] = newValue;\n//				data[row][\"grossTotal\"] =  ( data[row][\"cols\"] * data[row][\"inches\"] * data[row][\"grossCPI\"] + data[row][\"netColor\"] ).toFixed(2); \n				$(\"#field-netcolor-\"+line).val(data[row][\"netColor\"]);\n				{if $worksheet.isAutoComm} \n//					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n//					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossTotal\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"grossTotal\"] = newValue;\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netCPI\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPI\"] = \"0.00\";\n				$(\"#field-netcpi-\"+line).val(data[row][\"netCPl\"]);\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPI\"] = \"0.00\";\n				$(\"#field-netcpi-\"+line).val(data[row][\"netCPl\"]);\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"netCPI\"] = newValue;\n				$(\"#field-netcpi-\"+line).val(newValue);\n\n				{if !$worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((data[row][\"cols\"])*(data[row][\"inches\"])*(data[row][\"netCPI\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netTotal\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netTotal\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"netTotal\"] = newValue;\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n\n				{if !$worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ( (data[row][\"netTotal\"]) / ( (data[row][\"cols\"])*(data[row][\"inches\"]) ) ).toFixed(2);\n					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"cume\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"cume\"] = newValue\n				$(\"#field-cume-\"+line).val(data[row][\"cume\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"color\") {\n			newValue = $(field).val();\n			data[row][\"color\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"position\") {\n			newValue = $(field).val();\n			data[row][\"position\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n			console.log(\"building new line \" + row);\n			console.log(data[row]);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummaryDigital();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n\n		console.log(data[maxRow-1]);\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n                \'<td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-caption-\'+maxLineNumber+\'\" name=\"caption[]\" data-index=\"caption\" data-name=\"caption\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" value=\"\'+data[maxRow-1][\"caption\"]+\'\"></td>\',\n               \'<td><div class=\"input-group input-sm date date datetimepicker-dateonly\" data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"insertionDate\"]+\'\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n               \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  style=\"min-width: 120px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\">{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\',\n              \'<td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"size\"]+\'\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"{$line.worksheetLine}\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n              \'<td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-cols-\'+maxLineNumber+\'\" size=3 value=\"\'+data[maxRow-1][\"cols\"]+\'\" name=\"cols[]\" data-index=\"cols\" data-name=\"cols\" data-line=\"{$line.worksheetLine}\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n               \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\"  size=3 id=\"field-inches-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"inches\"]+\'\" name=\"inches[]\" data-index=\"inches\" data-name=\"inches\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-color-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"color\"]+\'\" size=\"10\" name=\"color[]\"  data-index=\"color\" data-name=\"color\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-{$line.worksheetLine}\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"grossCPI\"]+\'\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" {if $line.inches<=0} tabindex=\"-1\" readonly {elseif $line.numberOfColumns <= 0}  tabindex=\"-1\"  readonly {/if}></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscolor-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"grossColor\"]+\'\" size=\"6\" name=\"grossColor[]\" data-index=\"grossColor\" data-name=\"grossColor\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" ></td>\',\n \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"grossTotal\"]+\'\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" {if $line.inches > 0} {if $line.numberOfColumns > 0}  tabindex=\"-1\"  readonly {/if} {/if}></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-\'+maxLineNumber+\'}\" value=\"\'+data[maxRow-1][\"netCPI\"]+\'\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\' onchange=\"updateField(this);\" {if $line.inches<=0} tabindex=\"-1\" readonly {elseif $line.numberOfColumns <= 0}  {if $worksheet.isAutoComm}  tabindex=\"-1\" readonly {/if} {/if}></td>\',\n                \'<td><input type=text class=\"form-control input-sm\" id=\"field-netcolor-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"netColor\"]+\'\" size=\"6\" name=\"netColor[]\"   data-name=\"netColor\" data-line=\"\'+maxLineNumber+\'\" data-index=\"netColor\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\',\n                \'<td><input type=text class=\"form-control input-sm\" id=\"field-nettotal-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"netTotal\"]+\'\" size=\"6\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"\'+maxLineNumber+\'\" data-index=\"netTotal\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-position-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"position\"]+\'\" size=\"20\" name=\"position[]\" data-index=\"position\" data-name=\"position\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"input-group input-sm date datetimepicker-datetime\" data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"deadline\"]+\'\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n\n\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=30  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"vendorName\"]+\'\" name=\"vendorName[]\"></td>\',\n\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, vendor: data[maxRow-1][\"vendor\"], vendorID: data[maxRow-1][\"vendorID\"], insertionDate: data[maxRow-1][\"insertionDate\"], caption: data[maxRow-1][\"caption\"], size: data[maxRow-1][\"size\"], cols: data[maxRow-1][\"cols\"], grossTotal: data[maxRow-1][\"grossTotal\"], netTotal: data[maxRow-1][\"netTotal\"],  inches: data[maxRow-1][\"inches\"], grossCPI: data[maxRow-1][\"grossCPI\"], netCPI: data[maxRow-1][\"netCPI\"], deadline: data[maxRow-1][\"deadline\"], position: data[maxRow-1][\"position\"], color: data[maxRow-1][\"color\"], commission: \"{$worksheet.commission|default:0}\", comments: data[maxRow-1][\"comments\"],  vendorName: data[maxRow-1][\"vendorName\"], copy: false, bold: false, delete: false };\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n//		    minDate: moment(),\n		    default: moment()\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n//   $(\"#summaryTotals\").width();    \n//   $(\"#widget-summary\").width($(\"#summaryTotals\").width()+50);\n\n})\n\n	function updateDaypartSummary() {\n	\n		return false;\n	}\n\n	function clearNewLine() {\n		$(\'#field-caption-new\').val(\'\');\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-insertionDate-new\').val(\'\');\n		$(\'#field-deadline-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-color-new\').val(\'\');\n		$(\'#field-size-new\').val(\'\');\n		$(\'#field-position-new\').val(\'\');\n		$(\'#field-cols-new\').val(\'\');\n		$(\'#field-inches-new\').val(\'\');\n		$(\'#field-grossCPI-new\').val(\'\');\n		$(\'#field-grossCost-new\').val(\'\');\n		$(\'#field-netCost-new\').val(\'\');\n		$(\'#field-netCPI-new\').val(\'\');\n\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location = \"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n		function exportWorksheet(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/worksheet/csv\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to export worksheet at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n	$(document).ready(function () {\n	\n	    	$(\'.toggle-col\').change(function(box) {\n	            var colName = $(this).data(\"name\");\n	    	    if ($(this).is(\':checked\')) {\n	//		console.log(\"Box is checked\");\n			saveCols(colName, 0);\n		    }\n	            else {\n	//		console.log(\"Box is unchecked\");\n			saveCols(colName, 1);\n		    }\n	    	});\n	});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/digital/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/digital/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/digital/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n	</script>\n	\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(40,0,'worksheet-outdoor-alt','2015-03-18 08:46:45','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-Outdoor | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n	<link href=\"/lib/datetimepicker/css/bootstrap-datetimepicker.min.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n	text-align: center;\n\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 1px 2px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Outdoor</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Outdoor)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar\">\n<div class=\"control-inline toolbar-item-group\">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"container\">\n											   	<div class=\"col-lg-6\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'}   <strong>Campaign:</strong> {$campaign.name|default:\'none\'}    <strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong>  {foreach $vendors as $vendor} <a href=\"/vendors/edit/{$vendor.id}\">{$vendor.name}</a>{/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Contract #:</strong> {$campaign.contractNumber|default:\'none\'}</div>\n												</div>\n\n												<div class=\"col-md-12 col-lg-6 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 18, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n												</div>\n												</div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"18\">\n												     </form>\n												</div>\n											</div>\n											<div class=\"widget-footer\" id=\"worksheet-footer\">\n												Worksheet Loaded.\n											</div>\n								</div>\n\n\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i>Outdoor Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"Outdoor\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printLocation\" value=\"1\" {if $order.printDayOfWeek}checked{elseif !$order.id}checked{/if}> Location</label><br>\n												        <label><input type=\"checkbox\" name=\"printInsertionDate\"  value=\"1\" {if $order.printInsertionDate}checked{elseif !$order.id}checked{/if}> Insertion Date</label><br>\n												        <label><input type=\"checkbox\" name=\"printSizeAndType\" value=\"1\" {if $order.printSizeAndType}checked{elseif !$order.id}checked{/if}> Size & Type</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printBoardCost\"  value=\"1\" {if $order.printCPI}checked{elseif !$order.id}checked{/if}> Board Cost</label><br>\n												        <label><input type=\"checkbox\" name=\"printProductionCost\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Production Cost</label><br>\n												        <label><input type=\"checkbox\" name=\"printNetCost\"  value=\"1\" {if $order.printNetDollars}checked{elseif !$order.id}checked{/if}> Net Cost</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$order.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$order.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$order.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-3 col-sm-12 col-xs-12\" id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs hide\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"date\" id=\"summary-switch-date\" onchange=\"javascript:summarySwitchPrnt();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"vendor\" id=\"summary-switch-vendor\" onchange=\"javascript:summarySwitchPrnt();\"> V\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitchPrnt();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-3 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												<tbody id=\"summaryTotals\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Boards: </strong></td><td style=\"text-align: right;\"><div id=\"totalBoards\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Locations: </strong></td><td style=\"text-align: right;\"><div id=\"totalLocations\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Board Cost: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalBoardCost\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Production Cost: </strong></td><td style=\"text-align: right;\"><div id=\"totalProductionCost\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Cost: </strong></td><td style=\"text-align: right;\"><div id=\"totalCost\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Net Cost: </strong></td><td style=\"text-align: right;\"><div id=\"totalNetCost\">$0.00</div></td></tr>\n												</tbody>\n												</table>	\n\n												<div class=\"outdoor-summary-widget\" id=\"outdoor-summary-widget\" ></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-9\" id=\"worksheet-div\" >\n<div class=\"form\">\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"name\">Name</th>\n                <th data-index=\"insertionDate\">Insertion Date</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"\">Size</th>\n                <th>Type</th>\n                <th>Qty</th>\n                <th>Board Cost</th>\n                <th>Prod Cost</th>\n                <th>Total Cost</th>\n                <th>Net Cost</th>\n                <th>Location</th>\n                <th>Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n            <tr >\n		<td style=\"text-align: center;\"></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><input type=\"text\"   style=\"min-width: 200px;\"   class=\"form-control input-sm worksheet-field\" id=\"field-name-{$line.worksheetLine}\" name=\"name[]\" data-index=\"name\" data-name=\"name\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"{$line.name}\"></td>\n              <td><div class=\'input-group input-sm date date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-{$line.worksheetLine}\" value=\"{if $line.insertionDate != \"0000-00-00\"}{$line.insertionDate}{/if}\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  style=\"min-width: 200px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-{$line.worksheetLine}\" value=\"{$line.boardSize}\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-type-{$line.worksheetLine}\" value=\"{$line.type}\" size=\"10\" name=\"type[]\"  data-index=\"type\" data-name=\"type\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-qty-{$line.worksheetLine}\" value=\"{$line.numberOfBoards}\" size=\"5\" name=\"qty[]\"  data-index=\"qty\" data-name=\"qty\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-boardcost-{$line.worksheetLine}\" data-index=\"boardCost\" data-name=\"boardCost\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.boardCost}\" size=\"10\" name=\"boardCost[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-productioncost-{$line.worksheetLine}\" value=\"{$line.productionCost}\" size=\"10\" name=\"productionCost[]\" data-index=\"productionCost\" data-name=\"productionCost\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-totalcost-{$line.worksheetLine}\" value=\"{$line.totalCost}\" size=\"10\" name=\"totalCost[]\" data-index=\"totalCost\" data-name=\"totalCost\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" tabindex=\"-1\" readonly ></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-{$line.worksheetLine}\" value=\"{$line.netCost}\" size=\"10\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"{$line.worksheetLine}\" data-index=\"netTotal\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-location-{$line.worksheetLine}\" value=\"{$line.location}\" size=\"40\" name=\"location[]\" data-index=\"location\" data-name=\"location\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD HH:mm\" data-target-id=\"field-deadline-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-{$line.worksheetLine}\" value=\"{if $line.artworkDeadline != \"0000-00-00 00:00:00\"}{$line.artworkDeadline}{/if}\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=30 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-{$line.worksheetLine}\" value=\"{$line.vendorName}\" name=\"vendorName[]\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n             <td><input type=\"text\"   style=\"min-width: 200px;\"  class=\"form-control input-sm worksheet-field\" id=\"field-name-new\" name=\"name[]\" data-index=\"name\" data-name=\"name\" data-line=\"new\" data-row=\"new\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"\"></td>\n              <td><div class=\'input-group input-sm date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-new\" value=\"\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>         \n	 <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  style=\"min-width: 200px;\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-new\" value=\"\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n           \n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-type-new\" value=\"\" size=\"10\" name=\"type[]\"  data-index=\"type\" data-name=\"type\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                   <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-qty-new\" value=\"\" size=\"5\" name=\"qty[]\"  data-index=\"qty\" data-name=\"qty\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-boardcost-new\" data-index=\"boardCost\" data-name=\"boardCost\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"6\" name=\"boardCost[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-productioncost-new\" value=\"\" size=\"6\" name=\"productionCost[]\" data-index=\"productionCost\" data-name=\"productionCost\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-totalcost-new\" value=\"\" size=\"6\" name=\"totalCost[]\" data-index=\"totalCost\" data-name=\"totalCost\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" tabindex=\"-1\" readonly></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-new\" value=\"\" size=\"6\" name=\"netTotal[]\"  data-name=\"netTotal\" data-line=\"new\" data-index=\"netTotal\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if} onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-location-new\" value=\"\" size=\"40\" name=\"location[]\" data-index=\"location\" data-name=\"location\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD HH:mm\" data-target-id=\"field-deadline-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-new\" value=\"\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=30  value=\"\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>Name</th>\n                <th>Insertion Date</th>\n                <th>Vendor</th>\n                <th>Size</th>\n                <th>Type</th>\n                <th>Qty</th>\n                <th>Board Cost</th>\n                <th>Prod Cost</th>\n                <th>Total Cost</th>\n                <th>Net Cost</th>\n                <th>Location</th>\n                <th>Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/moment/moment-2.7.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/datetimepicker/js/bootstrap-datetimepicker.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-datepicker.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n\n	  var vendorList = {};\n\n          {foreach $vendors as $vendor} \n	   	vendorList[ \"{$vendor.id}\" ]=\"{$vendor.name}\";\n 	   {/foreach}\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n		    default: moment(),\n		    minDate: moment()\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n\n		$(document).ready(function() {\n\n		   updateSummaryOutdoor();\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n      					  \"order\": [[ 1, \'asc\' ]],\n\n\"columns\": [\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false, visible: false },\n     { width: \"250px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"120px\", \"orderDataType\": \"dom-text\", \"type\":\"numeric\"},\n     { width: \"200px\", \"searchable\": false, \"orderDataType\": \"dom-select\"},\n     { width: \"70px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"50px\", \"orderDataType\": \"dom-text\" },\n     { width: \"70px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n					  \"autoWidth\": false,			\n					  \"displayLength\": -1,\n					  \"paginate\": true,\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n			  } );\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n		reSort();\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:1};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", vendor: \"{$line.vendorName}\", vendorName: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", insertionDate: \"{$line.insertionDate}\", name: \"{$line.name}\",  totalCost: \"{$line.totalCost}\", netTotal: \"{$line.netCost}\", boardCost: \"{$line.boardCost}\", productionCost: \"{$line.productionCost}\", qty: \"{$line.numberOfBoards}\", deadline: \"{$line.artworkDeadline}\", location: \"{$line.location}\", size: \"{$line.size}\", type: \"{$line.type}\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: maxLineNumber, vendorName: \"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", qty: 0, name: \"\",  size: \"\",  totalCost: \"\", netTotal: \"\",  boardCost: \"\",  productionCost: \"\", deadline: \"\", location: \"\", type: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"\", copy: false, bold: false, delete: false }\n\n	{/if}\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: maxLineNumber, vendorName: \"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", qty: 0, name: \"\",  size: \"\",  totalCost: \"\", netTotal: \"\",  boardCost: \"\",  productionCost: \"\", deadline: \"\", location: \"\", type: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"\", copy: false, bold: false, delete: false };\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/outdoor/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/outdoor/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/outdoor/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/outdoor/ajax/line/add/{$worksheet.id}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/outdoor/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/outdoor/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/outdoor/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/outdoor/ajax/delete/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n		data[row] = { lineNumber: maxLineNumber, vendorName: \"\", vendor: \"\", vendorID: \"\", insertionDate: \"\", qty: \"\", name: \"\",  size: \"\",  totalCost: \"\", netTotal: \"\",  boardCost: \"\",  productionCost: \"\", deadline: \"\", location: \"\", type: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			data[row][\"vendorName\"] = $(\"#field-vendorID-\"+line + \" option:selected\").text();\n			$(\"#field-vendorName-\"+line).val(data[row][\"vendorName\"]);\n			var table =  $(\'#worksheet-{$worksheet.id}\').DataTable();			table.draw();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"name\") {\n			newValue = $(field).val();\n			data[row][\"name\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n\n		else if (fieldName == \"size\") {\n			newValue = $(field).val();\n			data[row][\"size\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"insertionDate\") {\n			newValue = $(field).val();\n			data[row][\"insertionDate\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName ==\"deadline\") {\n			newValue = $(field).val();\n			data[row][\"deadline\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n\n		else if (fieldName == \"qty\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"qty\"] = \"0\";\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-qty-\"+line).val(data[row][\"qty\"]);\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"totalCostl\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"qty\"] = \"0\";\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-qty-\"+line).val(data[row][\"qty\"]);\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"qty\"] =  newValue;\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-qty-\"+line).val(data[row][\"qty\"]);\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"totalCost\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"boardCost\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"boardCost\"] = \"0.00\";\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-boardcost-\"+line).val(parseFloat(data[row][\"boardCost\"]).toFixed(2));\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"totalCost\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"boardCost\"] = \"0.00\";\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-boardcost-\"+line).val(parseFloat(data[row][\"boardCost\"]).toFixed(2));\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"boardCost\"] =  newValue;\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-boardcost-\"+line).val(parseFloat(data[row][\"boardCost\"]).toFixed(2));\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"totalCost\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"productionCost\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"productionCost\"] = \"0.00\";\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-productioncost-\"+line).val(data[row][\"productionCost\"]);\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"totalCost\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"totalCost\",0,data[row][\"totalCostl\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"productionCost\"] = \"0.00\";\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-productioncost-\"+line).val(data[row][\"productionCost\"]);\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"productionCost\"] = newValue;\n				data[row][\"totalCost\"] = parseFloat(data[row][\"productionCost\"]) + (parseFloat(data[row][\"boardCost\"]) * parseInt(data[row][\"qty\"]));\n				$(\"#field-productioncost-\"+line).val(parseFloat(data[row][\"productionCost\"]).toFixed(2));\n				$(\"#field-totalcost-\"+line).val(parseFloat(data[row][\"totalCost\"]).toFixed(2));\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"totalCost\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(parseFloat(data[row][\"netTotal\"]).toFixed(2));\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"totalCost\",0,data[row][\"totalCost\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n\n		else if (fieldName == \"netTotal\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netTotal\"] = \"0.00\";\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netTotal\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"netTotal\"] = newValue;\n				$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"cume\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"cume\"] = newValue\n				$(\"#field-cume-\"+line).val(data[row][\"cume\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"type\") {\n			newValue = $(field).val();\n			data[row][\"type\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"location\") {\n			newValue = $(field).val();\n			data[row][\"location\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n			console.log(\"building new line \" + row);\n			console.log(data[row]);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummaryOutdoor();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n\n		console.log(data[maxRow-1]);\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td style=\"text-align: center;\"></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n                \'<td><input type=\"text\"  style=\"min-width: 200px;\"   class=\"form-control input-sm worksheet-field\" id=\"field-name-\'+maxLineNumber+\'\" name=\"name[]\" data-index=\"name\" data-name=\"name\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" value=\"\'+data[maxRow-1][\"name\"]+\'\"></td>\',\n               \'<td><div class=\"input-group input-sm date date datetimepicker-dateonly\" data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-insertionDate-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-insertionDate-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"insertionDate\"]+\'\" name=\"insertionDate[]\" data-index=\"insertionDate\" data-name=\"insertionDate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n               \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  style=\"min-width: 200px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\">{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name|escape:\'javascript\'}</option>{/foreach}</select></td>\',\n              \'<td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-size-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"size\"]+\'\" name=\"size[]\" data-index=\"size\" data-name=\"size\" data-line=\"{$line.worksheetLine}\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n               \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-type-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"type\"]+\'\" size=\"10\" name=\"type[]\"  data-index=\"type\" data-name=\"type\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n               \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-qty-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"qty\"]+\'\" size=\"5\" name=\"qty[]\"  data-index=\"qty\" data-name=\"qty\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-boardcost-{$line.worksheetLine}\" data-index=\"boardCost\" data-name=\"boardCost\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"boardCost\"]+\'\" size=\"10\" name=\"boardCost[]\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-productioncost-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"productionCost\"]+\'\" size=\"10\" name=\"productionCost[]\" data-index=\"productionCost\" data-name=\"productionCost\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" ></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-totalcost-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"totalCost\"]+\'\" size=\"10\" name=\"totalCost[]\" data-index=\"totalCost\" data-name=\"totalCost\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\' onchange=\"updateField(this);\"  tabindex=\"-1\" readonly></td>\',\n                \'<td><input type=text class=\"form-control input-sm\" id=\"field-nettotal-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"netTotal\"]+\'\" size=\"10\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"\'+maxLineNumber+\'\" data-index=\"netTotal\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-location-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"location\"]+\'\" size=\"40\" name=\"location[]\" data-index=\"location\" data-name=\"location\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"input-group input-sm date datetimepicker-datetime\" data-date-format=\"YYYY/MM/DD HH:mm\" data-target-id=\"field-deadline-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"deadline\"]+\'\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n\n\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=30  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"vendorName\"]+\'\" name=\"vendorName[]\"></td>\',\n\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, vendor: data[maxRow-1][\"vendor\"], vendorID: data[maxRow-1][\"vendorID\"], insertionDate: data[maxRow-1][\"insertionDate\"], name: data[maxRow-1][\"name\"], qty: data[maxRow-1][\"qty\"], size: data[maxRow-1][\"size\"], boardCost: data[maxRow-1][\"boardCost\"], netTotal: data[maxRow-1][\"netTotal\"],  productionCost: data[maxRow-1][\"productionCost\"], totalCost: data[maxRow-1][\"totalCost\"], deadline: data[maxRow-1][\"deadline\"], location: data[maxRow-1][\"location\"], color: data[maxRow-1][\"color\"], commission: \"{$worksheet.commission|default:0}\", comments: data[maxRow-1][\"comments\"],  vendorName: data[maxRow-1][\"vendorName\"], copy: false, bold: false, delete: false };\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n		    default: moment(),\n		    minDate: moment()\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n//   $(\"#summaryTotals\").width();    \n//   $(\"#widget-summary\").width($(\"#summaryTotals\").width()+50);\n\n})\n\n	function updateDaypartSummary() {\n	\n		return false;\n	}\n\n	function clearNewLine() {\n		$(\'#field-name-new\').val(\'\');\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-insertionDate-new\').val(\'\');\n		$(\'#field-deadline-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-qty-new\').val(\'\');\n		$(\'#field-type-new\').val(\'\');\n		$(\'#field-size-new\').val(\'\');\n		$(\'#field-location-new\').val(\'\');\n		$(\'#field-boardCost-new\').val(\'\');\n		$(\'#field-productionCost-new\').val(\'\');\n		$(\'#field-totalCost-new\').val(\'\');\n		$(\'#field-netCPI-new\').val(\'\');\n\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n	$(document).ready(function () {\n	\n	    	$(\'.toggle-col\').change(function(box) {\n	            var colName = $(this).data(\"name\");\n	    	    if ($(this).is(\':checked\')) {\n	//		console.log(\"Box is checked\");\n			saveCols(colName, 0);\n		    }\n	            else {\n	//		console.log(\"Box is unchecked\");\n			saveCols(colName, 1);\n		    }\n	    	});\n	});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/outdoor/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/outdoor/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/outdoor/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n	</script>\n	\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(41,0,'worksheet-edit','2015-02-04 17:23:49','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n{/block}\n\n{block name=\"header-css\"}\n   \n<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n<style>\n\n.form-control .select2-choice {\n    border: 0;\n    border-radius: 2px;\n}\n\n.form-control .select2-choice .select2-arrow {\n    border-radius: 0 2px 2px 0;   \n}\n\n.form-control.select2-container {\n    height: auto !important;\n    padding: 0px;\n}\n\n.form-control.select2-container.select2-dropdown-open {\n    border-color: #5897FB;\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control .select2-container.select2-dropdown-open .select2-choices {\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control.select2-container .select2-choices {\n    border: 0 !important;\n    border-radius: 3px;\n}\n</style>\n\n<style>\n\n.dropdown-menu {\n	border: 1px solid #555;\n	padding-bottom: 10px;\n}\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li><a href=\"{$worksheet.type}/edit/{$worksheet.id}\">{$worksheet.name}</a></li>\n			<li class=\"active\">Edit</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Worksheet</h2>\n								<em>Edit Worksheet</em>\n							</div>\n<div class=\"col-lg-12 col-sm-12 col-md-10\">\n\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3><i class=\"fa fa-table\"></i>Worksheet Summary</h3>\n			</div>\n			<div class=\"widget-content\">\n				<div class=\"row\">\n					<div class=\"col-xs-12 col-sm-12 col-md-12 col-lg-10\">\n						<form class=\"form-horizontal label-left\"  id=\"editWorksheet\" name=\"editWorksheet\" role=\"form\">\n\n<div  id=\"worksheet-alert-success\" class=\"alert alert-success alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> <span id=\"worksheet-alert-success-message\"></span>\n</div>\n\n<div id=\"worksheet-alert-error\" class=\"alert alert-danger alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> <span id=\"worksheet-alert-error-message\"></span>\n</div>\n\n				<input type=\"hidden\" name=\"campaignID\" value=\"{$campaign.id}\">\n				<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n				<input type=\"hidden\" id=\"useBroadcastWeeks\" name=\"useBroadcastWeeks\" value=\"1\">\n				<input type=\"hidden\" id=\"isAutoComm\" name=\"isAutoComm\">\n\n							<div class=\"form-group\" id=\"worksheet-name\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Worksheet Name</label>\n																				<div class=\"col-sm-6\">\n										<input type=\"text\" name=\"worksheetName\" id=\"worksheetName\" value=\"{$worksheet.name}\" class=\"form-control\" required>\n										<span id=\"worksheet-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Worksheet Name Already Exists!</span>								</div>\n																			</div>\n		\n							<div class=\"form-group hide\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Market Type</label>\n																				<div class=\"col-sm-6\">\n\n								<select name=\"marketType\" class=\"form-control\" readonly>\n																					<option value=\"unrated\" selected>Unrated</option>\n	\n									<option value=\"rated\" disabled>Rated</option>\n	\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group hide\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor Type</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"marketTypes\" name=\"marketType\" class=\"form-control\" readonly>\n\n									{foreach $marketTypes as $marketType}\n										<option value=\"{$marketType.id}\" {if $marketType.isDisabled}disabled{/if}>{$marketType.description}</option>\n									{/foreach}\n									\n								</select>\n\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Market</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"markets\" name=\"market\" class=\"form-control\">\n									{foreach $markets as $mkt}										<option value=\"{$mkt.name}\">{$mkt.name}</option>\n									{/foreach}\n									<option value=\"\"></option>\n\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor(s)</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"vendors\" name=\"vendors\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n									{foreach $vendors as $vendor}										<option value=\"{$vendor.id}\">{$vendor.name}</option>\n									{/foreach}\n																					<option value=\"0\">Other</option>\n\n								</select>\n	\n							</div>\n\n						</div>\n\n						<div id=\"vendorReps\">\n							{foreach $marketReps as $marketRep}\n								<div class=\"form-group\" id=\"vendor-{$marketRep.vendorID}\"><label for=\"text-input\" class=\"col-sm-offset-2 col-sm-2 control-label\">{$marketRep.vendorName}</label>\n					 				<div class=\"col-sm-6 col-md-5 col-lg-4\">\n										<select id=\"vendorReps-{$marketRep.vendorID}\" name=\"vendorReps[]\" class=\"form-control\">\n											<option value=\"{$marketRep.id}\">{$marketRep.contactName}</option>\n										</select>\n									</div>\n								</div>\n							{/foreach}											\n						</div>\n\n{if $vendorType.isGoalGRP >= 1}				\n						<div id=\"grpGoal\">\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Total GRP Goal</label>\n\n							<div class=\"col-sm-2 col-md-3 col-lg-2\">\n																				<input type=\"text\" id=\"grpGoal\" name=\"grpGoal\" class=\"form-control\" value=\"{$worksheet.grpGoal}\">\n																			</div>\n\n												\n						     </div>\n\n						</div>\n{/if}\n{if $vendorType.isDemographics >= 1}\n						<div id=\"demoPrimary\">\n\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\"> Primary Demographic</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"demographics-primary\" name=\"demographic[]\" class=\"form-control\">\n									<option value=\"\"></option>\n									{foreach $demos as $demo}										<option value=\"{$demo.id}\">{if $demo.description}{$demo.description}{else}{$demo.gender} {$demo.ageFrom}{if $demo.ageTo == 0}+{else} - {$demo.ageTo}{/if}{/if}</option>\n									{/foreach}\n										<option value=\"\">None</option>\n								</select>\n	\n							</div>\n\n						    </div>\n\n						</div>\n\n						<div id=\"demoSecondary\">\n\n						    <div class=\"form-group\" >\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\"> Secondary Demographic</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"demographics-secondary\" name=\"demographic[]\" class=\"form-control\">\n									<option value=\"\"></option>\n									{foreach $demos as $demo}										<option value=\"{$demo.id}\">{if $demo.description}{$demo.description}{else}{$demo.gender} {$demo.ageFrom}{if $demo.ageTo == 0}+{else} - {$demo.ageTo}{/if}{/if}</option>\n									{/foreach}\n										<option value=\"\">None</option>\n								</select>\n	\n							</div>\n\n						    </div>\n\n						</div>\n{/if}\n\n					<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Commission</label>\n																<div class=\"col-sm-8 col-md-6 col-lg-6\">\n							<input type=\"text\" size=4 id=\"worksheetCommission\" name=\"commission\" value=\"{$campaign.commission}\" class=\"form-control\" style=\"width: 100px;\">\n{if $vendorType.isAutoComm >= 1}\n									<input type=\"checkbox\" id=\"autoComm\" name=\"autoComm\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Auto\" data-off-label=\"Man\"  {if $worksheet.isAutoComm}checked{/if}>\n{/if}																			</div>				\n															\n																	</div>\n{if $vendorType.isBroadcastWeeks >= 1}\n					<div class=\"form-group\">\n																		<label for=\"broadcastWeeks\" class=\"col-sm-4 control-label\">Use Broadcast Weeks?</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2 pull-left\">\n																			<input type=\"checkbox\" id=\"broadcastWeeks\" name=\"broadcastWeeks\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" {if $worksheet.useBroadcastWeeks}checked{/if} >\n						</div>\n																	</div>\n{/if}\n\n\n					<div class=\"form-group\">\n																		<label for=\"freezeCols\" class=\"col-sm-4 control-label\">Freeze Columns?</label>\n																			<div class=\"col-sm-8\">												<input type=\"checkbox\" id=\"freezeCols\" name=\"freezeCols\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" {if $worksheet.freezeCols > 0}checked{/if}>\n							after <input type=\"text\" size=2 id=\"freezeColsCnt\" name=\"freezeColsCnt\" value=\"{$worksheet.freezeCols}\" class=\"\" style=\"width: 30px;\"  {if $worksheet.freezeCols == 0}disabled{/if}> columns.\n							</div>\n																													</div>\n\n{if $userID == 1}\n					<div class=\"form-group\">\n																		<label for=\"importExisting\" class=\"col-sm-4 control-label\">Import Existing?</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2 pull-left\">\n							<input type=\"file\" class=\"\" name=\"importExisting\">\n						</div>\n																	</div>\n{/if}\n				<div class=\"form-group\">\n							<div class=\"col-sm-12 col-md-12 col-lg-10\">\n								<div class=\"pull-right\">\n									<button type=\"button\" class=\"btn btn-success\" onclick=\"saveWorksheet();\">Save Changes</button>\n								</div>\n							</div>\n						</div>				\n				</div>\n							\n					</div>\n\n\n			</div>\n			<div id=\"addWorksheet-footer\" class=\"widget-footer\">\n			\n			</div>\n		</div>\n\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-datepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/daterangepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/moment.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script>\n\n		function getVendors(marketType, market) {\n\n			$.post( \"/vendors/ajax/search/marketandtype/\" + marketType + \"/\" + encodeURI(market) ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Searching For Vendors...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n//					$(\"#\"+response.field).addClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").show();\n				}\n				else {\n//					$(\"#worksheet-name\").removeClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").hide();\n				        $(\'#vendors\').select2(\"val\", \"\").on(\"select2-removed\", function(vendorRep) { removeVendorRep(vendorRep.val) });\n				        var select = $(\'#vendors\').empty();\n					  $.each(response.vendors, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n					\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function removeVendorRep(vendorID) {\n			$(\'#vendor-\'+vendorID).remove();\n			$(\'#vendorReps-\'+vendorID).remove();\n		}\n\n		function getVendorReps(vendorID, marketName) {\n\n			$.post( \"/vendors/ajax/search/reps/\" + vendorID+ \"/\" + encodeURI(marketName) ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Searching For Vendor Reps...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n\n				}\n				else {\n\n				        //$(\'#vendorReps-\'+vendorID).select2(\"val\", \"\");\n				        var select = $(\'#vendorReps-\'+vendorID).select2();\n					  $.each(response.vendorReps, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.contactName\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n		function getDemographics(marketType, marketTypes) {\n\n			$.post( \"/demographics/ajax/search/\"+marketType+\"/\" + marketTypes + \"/\" + \"?PHPSESSID={$sessionID}\" ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Loading Demographics...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n//					$(\"#\"+response.field).addClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").show();\n				}\n				else {\n//					$(\"#worksheet-name\").removeClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").hide();\n\n//				        $(\'#demographics-primary\').select2(\"val\", \"\");\n				        var select = $(\'#demographics-primary\').empty();\n					 select.append( \'<option value=\"\"></option>\' ); \n					 $.each(response.demographics, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                          			      + item.id\n                            			      + \'\">\'\n                          			      + item.description\n                            			      + \'</option>\' ); \n   				          });\n				        var select = $(\'#demographics-secondary\').empty();\n					 select.append( \'<option value=\"\"></option>\' ); \n					 $.each(response.demographics, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                          			      + item.id\n                            			      + \'\">\'\n                          			      + item.description\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n\n		$(document).ready(function(){\n\n			$(\"#broadcastWeeks\").change(function () {\n			    broadcastWeeks();\n			}); \n\n			$(\"#autoComm\").change(function () {\n			    autoComm();\n			}); 	\n\n			$(\"#freezeCols\").change(function () {\n			    freezeCols();\n			}); \n\n			$(\"#client-select\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n			$(\"#campaign-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#campaignActive\").change(function () {\n			    resetFooter();\n			   campaignActive(); \n			}); \n\n			$(\"#markets\").change(function () {\n				getVendors(\"{$worksheet.typeID}\", $(\"#markets\").val());\n				$(\"#vendorReps\").html(\"\");\n			}); \n\n			$(\"#marketTypes\").change(function () {\n				getVendors(\"{$worksheet.typeID}\", $(\"#markets\").val());\n			}); \n\n\n			$(\"#vendors\").select2({\n			    placeholder: \"Search Vendors\",\n			    allowClear: true\n			});\n\n			$(\"#vendors\").change(function () {\n			   refreshVendorReps(); \n			}); \n\n			{foreach $marketReps as $marketRep}\n				$(\"#vendorReps-{$marketRep.vendorID}\").select2({\n				    allowClear: true\n				});				\n				$(\"#vendorReps-{$marketRep.vendorID}\").select2(\"val\",\"{$marketRep.id}\");\n			{/foreach}\n\n			$(\"#vendors\").select2(\"val\", [ {foreach $wsVendors as $vendor} \"{$vendor.id}\"{if ! $vendor@last},{/if} {/foreach}] ).on(\"select2-removed\", function(vendorRep) { removeVendorRep(vendorRep.val)});\n\n			{foreach $vendors as $vendor} \n			{/foreach}\n		});\n\n		$(\'#campaignActive\').bootstrapSwitch();\n		$(\'#broadcastWeeks\').bootstrapSwitch();\n		$(\'#autoComm\').bootstrapSwitch();\n		$(\'#freezeCols\').bootstrapSwitch();\n\n		$(\"#markets\").val(\"{$market}\");\n		//getVendors(\"{$worksheet.typeID}\", \"{$market.name}\");\n		{if $vendorType.isDemographics >= 1}\n			//getDemographics(\"unrated\", \"{$worksheet.typeID}\");\n			$(\"#demographics-primary\").val(\"{$demographics[0][\"id\"]}\");\n			$(\"#demographics-secondary\").val(\"{$demographics[1][\"id\"]}\");\n		{/if}\n	</script>\n\n	<script>\n\n\n		function resetFooter() {\n				$(\"#campaign-footer\").html(\"Not Saved\");\n		}\n\n		function campaignActive() {\n\n			if ($(\"#campaignActive\").is(\":checked\")) {\n				$(\"#campaign-active\").val(\"1\");\n			}\n			else {\n				$(\"#campaign-active\").val(\"0\");\n			}\n		}\n\n		function getDateRange(datepicker, fromField, toField) {\n\n			$(fromField).val($(\'#flightRange\').data(\'daterangepicker\').startDate.format(\'YYYY-MM-DD\'));\n			$(toField).val($(\'#flightRange\').data(\'daterangepicker\').endDate.format(\'YYYY-MM-DD\'));\n						\n		}\n\n\n		function refreshVendorReps() {\n\n		         var vendors = $(\"#vendors\").val();\n		         var vendorNames = $(\"#vendors\").text();\n\n 			$(\'#vendors :selected\').each(function(i,sel){\n			   if ($(\"#vendorReps-\"+$(sel).val()).length) {\n			   }\n			   else {\n				var repHTML = \'<div class=\"form-group\" id=\"vendor-\'+$(sel).val()+\'\"><label for=\"text-input\" class=\"col-sm-offset-2 col-sm-2 control-label\">\'+$(sel).text()+\'</label>\\\n			 				<div class=\"col-sm-6 col-md-5 col-lg-4\">\\\n								<select id=\"vendorReps-\'+$(sel).val()+\'\" name=\"vendorReps[]\" class=\"form-control\">\\\n								</select>\\\n							</div></div>\';\n\n				$(\'#vendorReps\').append(repHTML);\n	\n				$(\"#vendorReps-\"+$(sel).val()).select2({\n				    placeholder: \"Search \"+$(sel).text()+\" Reps\",\n				    allowClear: true\n				});\n				getVendorReps($(sel).val(),$(\"#markets\").val()); \n			   }\n		       });\n\n		}\n\n		function broadcastWeeks() {\n\n			if ($(\"#broadcastWeeks\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Broadcast Weeks Turned On.\");\n				$(\"#useBroadcastWeeks\").val(\"1\");\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Broadcast Weeks Turned Off.\");\n				$(\"#useBroadcastWeeks\").val(\"0\");\n			}\n		}\n\n		function autoComm() {\n\n			if ($(\"#autoComm\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Auto Commission Turned On.\");\n				$(\"#isAutoComm\").val(\"1\");\n				$(\"#worksheetCommission\").attr(\"disabled\",false);\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Auto Commission Turned Off.\");\n				$(\"#isAutoComm\").val(\"0\");\n				$(\"#worksheetCommission\").attr(\"disabled\",\"disabled\");\n			}\n		}\n\n		function freezeCols() {\n\n			if ($(\"#freezeCols\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Freeze Columns Turned On.\");\n				$(\"#freezeCols\").val(\"1\");\n				$(\"#freezeColsCnt\").val(\"7\");\n				$(\"#freezeColsCnt\").attr(\"disabled\",false);\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Freeze Columns Turned Off.\");\n				$(\"#freezeCols\").val(\"0\");\n				$(\"#freezeColsCnt\").attr(\"disabled\",\"disabled\");\n			}\n		}\n\n		function saveWorksheet() {\n\n			$(\"#addWorksheet-footer\").html(\"Saving.\");\n\n			$.post( \"/worksheet/ajax/edit/{$worksheet.id}\", $( \"#editWorksheet\" ).serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#worksheet-name-help\").html(\'\');\n					$(\"#worksheet-name-help\").show();\n				}\n				else {\n					$(\"#worksheet-name\").removeClass(\"has-error error\");\n					$(\"#worksheet-name-help\").hide();\n\n			 		window.location.href=\"/{$worksheet.type|default:\"worksheets\"}/edit/{$worksheet.id}\";\n				\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#addWorksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#addWorksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n\n	</script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(42,0,'admin-users','2015-05-06 02:12:38','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n	<link type=\"text/css\" rel=\"stylesheet\" href=\"/assets/css/jquery.simplecolorpicker.css\">\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/clients/\">Clients</a></li>\n			<li class=\"active\" id=\"breadcrumb-client-name\">{$client.name}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Clients</h2>\n								<em>Information & Campaigns</em>\n							</div>\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Client Information</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-users\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"clientActive\" name=\"isActive\" {if $client.isActive}checked{/if} class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n		<form id=\"client-form\" class=\"form-horizontal label-left\" role=\"form\">\n			<input type=\"hidden\" name=\"clientID\" value=\"{$client.id}\">\n			<input type=\"hidden\" name=\"agencyID\" value=\"{$client.agencyID}\">\n			<input type=\"hidden\" id=\"client-active\" name=\"isActive\" value=\"{$client.isActive}\">\n\n					<div class=\"form-group\" id=\"client-name\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Client Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"clientName\" id=\"client-name-input\" class=\"form-control\"  value=\"{$client.name}\" required>\n								<span id=\"client-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Client Name Already Exists!</span>						</div>\n					</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" class=\"form-control\"  value=\"{$client.contactName}\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"emailAddress\" id=\"text-input\" class=\"form-control\"  value=\"{$client.emailAddress}\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\" name=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\">{$client.address}</textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" name=\"phoneNumber\" id=\"phone\" value=\"{$client.phoneNumber}\"  class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\"  name=\"faxNumber\" value=\"{$client.faxNumber}\" class=\"form-control\">\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<label for=\"website\" class=\"col-sm-4 control-label\">Website\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			<input type=\"text\" id=\"website\" value=\"{$client.website}\" name=\"website\" class=\"form-control\">\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"bgColor\" class=\"col-sm-4 control-label\">Calendar Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																			\n																			<select id=\"bgColor\" value=\"{$client.bgColor}\" name=\"bgColor\" class=\"form-control\">\n																				  <option value=\"#fff\">#fff</option>\n																				  <option value=\"#ac725e\">#ac725e</option>\n																				  <option value=\"#d06b64\">#d06b64</option>\n																				  <option value=\"#f83a22\">#f83a22</option>\n																				  <option value=\"#fa573c\">#fa573c</option>\n																				  <option value=\"#ff7537\">#ff7537</option>\n																				  <option value=\"#ffad46\">#ffad46</option>\n																				  <option value=\"#42d692\">#42d692</option>\n																				  <option value=\"#16a765\">#16a765</option>\n																				  <option value=\"#7bd148\">#7bd148</option>\n																				  <option value=\"#b3dc6c\">#b3dc6c</option>\n																				  <option value=\"#fbe983\">#fbe983</option>\n																				  <option value=\"#fad165\">#fad165</option>\n																				  <option value=\"#92e1c0\">#92e1c0</option>\n																				  <option value=\"#9fe1e7\">#9fe1e7</option>\n																				  <option value=\"#9fc6e7\">#9fc6e7</option>\n																				  <option value=\"#4986e7\">#4986e7</option>\n																				  <option value=\"#9a9cff\">#9a9cff</option>\n																				  <option value=\"#b99aff\">#b99aff</option>\n																				  <option value=\"#c2c2c2\">#c2c2c2</option>\n																				  <option value=\"#cabdbf\">#cabdbf</option>\n																				  <option value=\"#cca6ac\">#cca6ac</option>\n																				  <option value=\"#f691b2\">#f691b2</option>\n																				  <option value=\"#cd74e6\">#cd74e6</option>\n																				  <option value=\"#a47ae2\">#a47ae2</option>\n																			</select>\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<label for=\"fontColor\" class=\"col-sm-4 control-label\">Calendar text Color\n																		</label>\n																		<div class=\"col-sm-8 pull-left\">\n																		\n																			<select  id=\"fontColor\" value=\"{$client.fontColor}\" name=\"fontColor\" class=\"form-control\">\n																				  <option value=\"#fff\">#fff</option>	\n																				  <option value=\"#ac725e\">#ac725e</option>\n																				  <option value=\"#d06b64\">#d06b64</option>\n																				  <option value=\"#f83a22\">#f83a22</option>\n																				  <option value=\"#fa573c\">#fa573c</option>\n																				  <option value=\"#ff7537\">#ff7537</option>\n																				  <option value=\"#ffad46\">#ffad46</option>\n																				  <option value=\"#42d692\">#42d692</option>\n																				  <option value=\"#16a765\">#16a765</option>\n																				  <option value=\"#7bd148\">#7bd148</option>\n																				  <option value=\"#b3dc6c\">#b3dc6c</option>\n																				  <option value=\"#fbe983\">#fbe983</option>\n																				  <option value=\"#fad165\">#fad165</option>\n																				  <option value=\"#92e1c0\">#92e1c0</option>\n																				  <option value=\"#9fe1e7\">#9fe1e7</option>\n																				  <option value=\"#9fc6e7\">#9fc6e7</option>\n																				  <option value=\"#4986e7\">#4986e7</option>\n																				  <option value=\"#9a9cff\">#9a9cff</option>\n																				  <option value=\"#b99aff\">#b99aff</option>\n																				  <option value=\"#c2c2c2\">#c2c2c2</option>\n																				  <option value=\"#cabdbf\">#cabdbf</option>\n																				  <option value=\"#cca6ac\">#cca6ac</option>\n																				  <option value=\"#f691b2\">#f691b2</option>\n																				  <option value=\"#cd74e6\">#cd74e6</option>\n																				  <option value=\"#a47ae2\">#a47ae2</option>\n																			</select>\n																		</div>	\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Notes</p>\n							<textarea id=\"textarea\" class=\"form-control\" name=\"notes\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: none;\">{$client.notes}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveClient();\">Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteClient();\">Delete</button>\n							</p>\n						</div>\n					</div>		\n															</form>\n\n		</div>\n\n		<div id=\"client-footer\" class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Offices</h3>\n										<div class=\"btn-group widget-header-toolbar\">												<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n										</div>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Name</th>\n													<th>Department</th>\n													<th>City/State</th>\n													<th>Contact Name</th>\n													<th>Phone Number</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $offices as $office}\n												<tr>\n													<td>{$office.name}</td>\n													<td>{$office.dept}</td>\n													<td>{$office.city}{if $office.city},{/if} {$office.state}</td>\n													<td>{$office.contactName}</td>\n													<td>{$office.phoneNumber}</td>\n												</tr>\n{/foreach}\n												</tbody>\n										</table>\n									</div>\n								</div>\n\n\n</div>\n\n<div class=\"col-lg-6\">\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-rocket\"></i> Campaigns</h3>\n										<em>- <a href=\"campaigns/create\">Add A New Campaign</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>#</th>\n\n	<th>Name</th>\n													<th>Job Number</th>\n													<th>Start</th>\n													<th>End</th>\n													<th>Total ($)</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $campaigns as $campaign}\n												<tr>\n													<td>{$campaign.id}</td>\n													<td><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></td>\n													<td>{$campaign.jobNumber}</td>\n													<td nowrap>{$campaign.flightStart}</td>\n\n	<td nowrap>{$campaign.flightEnd}</td>\n													<td nowrap style=\"min-width: 50px;\">{$campaign.totalSpend|default:\"\"}</td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n<!-- Calendar -->\n{include file=\"db:full-calendar\"}\n\n<!-- END Calendar -->\n</div>\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n    <script type=\'text/javascript\' src=\'http://fullcalendar.io/js/fullcalendar-2.1.1/gcal.js\'></script>\n    <script>\n    $( function() {\n    \n    	$(\'#calendar\').fullCalendar({\n    \n        eventSources: [\n    \n            // your event source\n            {\n    		url: \'/calendar/ajax/clients/edit/{$client.id}\',\n            }\n    \n        ]\n    \n    	});\n\n	$(\'select[name=\"fontColor\"]\').simplecolorpicker();\n	$(\'select[name=\"fontColor\"]\').simplecolorpicker(\'selectColor\', \'{$client.fontColor}\');\n	$(\'select[name=\"bgColor\"]\').simplecolorpicker();\n	$(\'select[name=\"bgColor\"]\').simplecolorpicker(\'selectColor\', \'{$client.bgColor}\');\n\n    });\n    \n\n\n    </script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.simplecolorpicker.js\"></script>\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n			$(\'#fax\').mask(\'(999) 999-9999\');\n			$(\'#clientActive\').bootstrapSwitch();\n\n			$(\"#client-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#clientActive\").change(function () {\n			    resetFooter();\n			    clientActive(); \n			}); \n\n		});\n\n	</script>\n\n	<script type=\"text/javascript\">\n\n		function resetFooter() {\n				$(\"#client-footer\").html(\"Not Saved\");\n		}\n\n		function clientActive() {\n\n			if ($(\"#clientActive\").is(\":checked\")) {\n				$(\"#client-active\").val(\"1\");\n			}\n			else {\n				$(\"#client-active\").val(\"0\");\n			}\n		}\n\n	 	 function createClient() {\n	  \n	  		alert(\"saving client\");\n			  		 		  \n	  	}\n\n		function saveClient() {\n			\n			$(\"#client-footer\").html(\"Saving.\");\n\n			clientActive();\n\n			$.post( \"/clients/ajax/save/{$client.id}\", $( \"#client-form\" ).serialize(), function() {\n				$(\"#client-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#client-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#client-name-help\").show();\n\n				}\n				else {\n					$(\"#client-name\").removeClass(\"has-error error\");\n					$(\"#client-name-help\").hide();\n				}\n				$(\"#breadcrumb-client-name\").html($(\"#client-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#client-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n	  \n	  	function deleteClient() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#client-footer\").html(\"Deleting..\");\n\n					$.post( \"/clients/ajax/delete/{$client.id}\", $( \"#client-form\" ).serialize(), function() {\n						$(\"#client-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#client-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/clients/all\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#client-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#client-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(43,0,'register','2014-09-24 19:18:43','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Signup</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/lib/parsley/2.0.3/parsley.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-login text-center\">\n\n		<div class=\"inner-page\">\n\n			<div class=\"logo\">\n				<a href=\"/login\">\n					<img src=\"assets/img/kingboard-logo.png\" alt=\"\" />\n				</a>\n			</div>\n\n			<div class=\"login-box center-block\">\n\n\n		{if $alertError}\n			<div class=\"alert alert-danger\">\n                		<a class=\"close\" data-dismiss=\"alert\" href=\"#\">Ã—</a>{$errorMsg}\n                		</div>\n  		{/if}\n          	{if $alertSuccess}\n			<div class=\"alert alert-success\">\n                		{$successMsg}\n                		</div>\n  		{/if}	\n\n			<form action=\"/login/register\" method=\"post\" data-parsley-validate>\n					<div class=\"form-group\">\n				<label>Email Address</label>\n				<input type=\"email\" id=\"emailAddress\" class=\"form-control\" name=\"emailAddress\" value=\"{$emailAddress}\" placeholder=\"Email Address\" data-parsley-trigger=\"change\" required>\n</div>\n					<div class=\"form-group\">\n				<label>First Name</label>\n				<input type=\"text\" id=\"firstName\" class=\"form-control\" name=\"firstName\" value=\"{$firstName}\" placeholder=\"First Name\" required>\n</div>\n<div class=\"form-group\">\n				<label>Last Name</label>\n			 	<input type=\"text\" id=\"lastName\" class=\"form-control\" name=\"lastName\" value=\"{$lastName}\" placeholder=\"Last Name\" required>\n</div>\n					<div class=\"form-group\">\n				<label>Agency or Company Name</label>\n			 	<input type=\"text\" id=\"agency\" class=\"form-control\" name=\"organization\" value=\"{$organization}\" placeholder=\"Organization / Agency\" required>\n</div>\n					<div class=\"form-group\">\n				<label>Address</label>\n			 	<textarea id=\"agency\" class=\"form-control\" name=\"address\"  rows=4 required>{$address}</textarea>\n</div>\n					<div class=\"form-group\">\n\n				<label>Phone Number</label>\n			 	<input type=\"text\" id=\"phoneNumber\" class=\"form-control\" name=\"phoneNumber\" value=\"{$phoneNumber}\" placeholder=\"Phone Number\" required>\n</div>\n				<button class=\"btn btn-custom-primary btn-lg btn-block btn-login\"><i class=\"fa fa-arrow-circle-o-right\"></i> Sign Up For An Account</button>\n				</form>\n\n				<div class=\"links\">\n					<p><a href=\"/login/forgot\">Forgot Username or Password?</a></p>\n					<p><a href=\"/login\">Return To Login</a></p>\n				</div>\n			</div>\n\n		</div>\n	</div>\n</div>\n\n\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/parsley/2.0.3/parsley.min.js\"></script>\n\n	<script type=\"text/javascript\"> \n\n		$(document).ready(function(){\n	\n			$(\'#phoneNumber\').mask(\'(999) 999-9999? x99999\');\n\n		});\n\n	</script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(45,0,'activate','2014-08-11 06:36:02','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Dashboard</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-login text-center\">\n\n		<div class=\"inner-page\">\n\n			<div class=\"logo\">\n				<a href=\"/\">\n					<img src=\"assets/img/kingboard-logo.png\" alt=\"\" />\n				</a>\n			</div>\n\n			<div class=\"login-box center-block\">\n\n\n\n          	{if $alertError}\n		<div class=\"alert alert-error\">\n                <a class=\"close\" data-dismiss=\"alert\" href=\"#\">Ã—</a>{$errorMsg}\n                </div>\n  		{/if}\n\n\n			<form action=\"/home/activate/go\" method=\"post\">\n					<div class=\"input-group\">\n				<label>Email Address?</label><small class=\"pull-right\">(Same one you registered with)</small>\n				<input type=\"text\" id=\"emailAddress\" class=\"form-control\" name=\"emailAddress\" value=\"{$emailAddress}\" placeholder=\"Email Address\" required>\n</div>\n					<div class=\"input-group\">\n				<label>Password?</label>\n				<input type=\"text\" id=\"password\" class=\"form-control\" name=\"password\"  placeholder=\"Must be at least 6 characters long\" required>\n</div>\n<div class=\"input-group\">\n				<label>Activation Code</label>\n			 	<input type=\"text\" id=\"activationCode\" class=\"form-control\" name=\"activationCode\" value=\"{$activationCode}\" placeholder=\"Required\" required>\n</div>\n				<button class=\"btn btn-custom-primary btn-lg btn-block btn-login\"><i class=\"fa fa-arrow-circle-o-right\"></i> Activate Account</button>\n				</form>\n\n		\n			</div>\n\n		</div>\n	</div>\n</div>\n\n\n\n\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(46,0,'forgot','2014-08-11 04:59:11','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Dashboard</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-login text-center\">\n\n		<div class=\"inner-page\">\n\n			<div class=\"logo\">\n				<a href=\"index.html\">\n					<img src=\"assets/img/kingboard-logo.png\" alt=\"\" />\n				</a>\n			</div>\n\n			<div class=\"login-box center-block\">\n				<form action=\"/login/forgot\" method=\"post\">\n					<p class=\"title\">Email Address?</p>\n					<div class=\"input-group\">\n						<input type=\"text\" name=\"username\" placeholder=\"Email Address\" class=\"form-control\">\n						<span class=\"input-group-addon\"><i class=\"fa fa-user\"></i></span>\n					</div>\n\n					<button class=\"btn btn-custom-primary btn-lg btn-block btn-login\"><i class=\"fa fa-arrow-circle-o-right\"></i> Reset Password</button>\n				</form>\n\n				<div class=\"links\">\n					<p><a href=\"/login/register\">Create New Account</a></p>\n					<p><a href=\"/login\">Return To Login</a></p>\n				</div>\n			</div>\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(47,0,'reset','2014-09-25 14:00:48','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Dashboard</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n	<style>\n\n.input-group-focus {\n  border-radius:4px;\n\n  -webkit-transition: box-shadow ease-in-out .15s;\n          transition: box-shadow ease-in-out .15s;\n}\n.input-group-addon {\n\n  -webkit-transition: border-color ease-in-out .15s;\n          transition: border-color ease-in-out .15s;\n}\n.input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, .6) !important;\n          box-shadow: inset 0 0px 0px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, .6) !important;  \n}\n.has-error.input-group.input-group-focus,\n.has-error .input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #ce8483 !important;\n          box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #ce8483 !important;\n}\n.has-warning.input-group.input-group-focus,\n.has-warning .input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #67b168 !important;\n          box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #67b168 !important;\n\n}\n.has-success .input-group.input-group-focus,\n.has-success .input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #c0a16b !important;\n          box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #c0a16b !important;\n\n}\n.input-group-focus input:focus {\n  -webkit-box-shadow: none !important;\n          box-shadow: none !important;\n\n}\n\n.input-group-addon input:focus .has-error {\n	border: 0px solid #fff;\n	border-color: #ccc;\n}\n\n\n	</style>\n\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-login text-center\">\n\n		<div class=\"inner-page\">\n\n			<div class=\"logo\">\n				<a href=\"/\">\n					<img src=\"assets/img/kingboard-logo.png\" alt=\"\" />\n				</a>\n			</div>\n\n			<div class=\"login-box center-block\">\n\n          	{if $alertError}\n		<div class=\"alert alert-error\">\n                <a class=\"close\" data-dismiss=\"alert\" href=\"#\">Ã—</a>Please enter a valid username or email address.\n                </div>\n  		{/if}\n\n\n				<form action=\"/login/reset\" method=\"post\" accept-charset=\"UTF-8\" onsubmit=\"return validate();\">\n					<div class=\"form-group\" id=\"emailAddressGroup\">\n						<label class=\"control-label\" for=\"emailAddress\">Email Address?</label>\n							<input type=\"text\" id=\"emailAddress\" name=\"emailAddress\"  class=\"form-control\" onchange=\"javascript:checkEmailAddress();\">\n						<div class=\"pull-right\" style=\"margin-bottom: 10px;\" id=\"emailHelp\"></div>\n					</div>\n					<div class=\"form-group\" id=\"passwordGroup\">\n						<label class=\"control-label\" for=\"password\">Password?</label>\n							<input type=\"password\" id=\"password\" name=\"password\" class=\"form-control\"  onchange=\"javascript:comparePasswords();\">\n					</div>\n					<div class=\"form-group\" id=\"confirmGroup\">\n						<label class=\"control-label\" for=\"confirm\">Confirm?</label>\n							<input type=\"password\"  id=\"confirm\" _name=\"confirm\"  class=\"form-control\" onkeyup=\"javascript:comparePasswords();\" style=\"box-shadow: none;\">\n						<div class=\"pull-right\" style=\"margin-bottom: 10px;\" id=\"passwordHelp\"></div>\n					</div>\n					<button id=\"resetButton\" class=\"btn btn-custom-default btn-lg btn-block btn-login\" disabled><i class=\"fa fa-arrow-circle-o-right\" ></i> Reset Password</button>\n					<input type=\"hidden\" id=\"resetCode\" class=\"span4\" name=\"resetCode\" value=\"{$resetCode}\"> \n				</form>\n\n				<div class=\"links\">\n					<p><a href=\"#\">Forgot Username or Password?</a></p>\n					<p><a href=\"/\">Return To Login</a></p>\n				</div>\n			</div>\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n</body>\n\n<script type=\"text/javascript\">\n\n	function checkEmailAddress() {\n\n		return true;\n	}\n\n	function comparePasswords() {\n\n		var password = document.getElementById(\"password\").value;\n		var confirm = document.getElementById(\"confirm\").value;\n\n		if (confirm == \"\") {\n			document.getElementById(\"passwordHelp\").innerHTML = \"\";\n			return false;\n\n		}\n		else if (password.length < 6) {\n			$(\"#passwordGroup\").addClass(\"has-error\");\n			document.getElementById(\"passwordHelp\").innerHTML = \"Password is too short.\";\n			return false;\n		}\n		else if (password == confirm) {\n			$(\"#confirmGroup\").removeClass(\"has-error\");\n			$(\"#passwordGroup\").removeClass(\"has-error\");\n\n			document.getElementById(\"passwordHelp\").innerHTML = \"Great! Passwords Match.\";\n\n			$(\"#resetButton\").removeClass(\"btn-custom-default\");\n			$(\"#resetButton\").addClass(\"btn-custom-primary\");\n			$(\"#resetButton\").attr(\"disabled\", false);\n\n			return true;\n		}\n		else {\n			$(\"#passwordGroup\").addClass(\"has-error\");\n			$(\"#confirmGroup\").addClass(\"has-error\");\n\n			document.getElementById(\"passwordHelp\").innerHTML = \"Passwords do not match\";\n			return false;\n		}\n	}\n\n$(document).ready(function() {\n    $(\".input-group > input\").focus(function(e){\n        $(this).parent().addClass(\"input-group-focus\");\n    }).blur(function(e){\n        $(this).parent().removeClass(\"input-group-focus\");\n    });\n});\n\n</script>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0);
INSERT  IGNORE INTO `FLX_TEMPLATE` (`id`, `templateID`, `name`, `modified`, `title`, `source`, `template`, `sequence`, `media`, `version`, `editWith`, `doctype`, `status`, `expireStamp`, `beginStamp`, `views`, `isDefault`, `themeID`) VALUES (48,0,'worksheet-tv-alt-test','2014-07-30 21:57:36','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-TV | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 2px 5px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Broadcast TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Broadcast TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet </h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar hidden-xs\">\n<div class=\"control-inline toolbar-item-group \">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style-\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} {$vendor.name} {/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"margin-top: 20px; overflow-x: scroll; overflow-y: hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n{if $worksheet.isOrdered} 	\n\n								<div class=\"widget\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar col-xs-4 col-sm-6\" style=\"border-left-color: #4ba84b;\">\n												    <h3>{$orderInfo.orderCreated}</h3>\n												</div>\n											</div>\n								</div>\n{/if}\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3> \n												<div class=\"btn-group widget-header-toolbar col-xs-4 col-sm-6\">\n												    <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Vendor(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPPerStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\"  id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName}\n\n												    <div class=\"summary-daypart\" id=\"summary-daypart-{$daypart}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypart}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypart}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypart}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypart}\">0.0</div></td></tr>\n												      </table>\n												    </div>\n\n												     {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n<div class=\"\" id=\"worksheet-loading\">Loading...</div>\n\n<div class=\"form\" id=\"worksheet-form\" style=\"display: none;\">\n\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"daypart\">DP</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"station\">Station</th>\n                <th data-index=\"timePeriod\">Time Period</th>\n                <th data-index=\"programName\">Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th data-index=\"seconds\">Len</th>\n                <th data-index=\"rate\">Rate</th>\n                <th data-index=\"aqhRating\">AQH RTG</th>\n                <th data-index=\"cpp\">CPP</th>\n                <th data-index=\"impact\">000</th>\n                <th data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-program-new\" value=\"\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\"\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Time Period</th>\n                <th>Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th>AQH RTG</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n 								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n{*\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": false,\n					  \"scrollX\": true,\n//      					  \"order\": [{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}],\n     					  \"order\": [ [ 1, \"asc\" ] ],\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"100px\",\"orderDataType\": \"dom-text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n//					  \"autoWidth\": false,			\n					  \"displayLength\": -1,\n					  \"paginate\": true,\n					  \"initComplete\": function() { $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort();},\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n\n			  } );\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n\n		reSort();\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n*}\n		\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber|default:0};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"null\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false }\n\n	{/if}\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach (beta)\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency (beta)\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	$( document ).ready(function() {\n\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n});\n\n			$(document).ready(function(){\n\n		$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/tv/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/tv/ajax/lines/remove/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/tv/ajax/line/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/tv/ajax/line/add/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/tv/ajax/lines/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/tv/edit/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/tv/ajax/delete/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option>-This Campaign-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet(\"+ worksheetID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n	function copyWorksheet(worksheetID) {\n				if (worksheetID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/tv/ajax/copy/{$worksheetID}\", $( \"#worksheet-form\" )+ \"?PHPSESSID={$sessionID}\".serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/tv/edit/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(1);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"\", em:\"EM\", da:\"DA\", ef:\"EF\", en:\"EN\", pa:\"PA\", pr:\"PR\", lf:\"LF\", ln:\"LN\", ov:\"OV\", sp:\"SP\", ro:\"RO\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$0.00\");\n			}	\n		}\n\n	  }\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw();\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], station: data[maxRow-1][\"station\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n})\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(49,0,'worksheet-tv-alt-simple','2015-03-19 18:00:39','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-TV | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 2px 5px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n\n.table td:nth-last-child(n-5)\n{\n\n text-align:center !important;\n}\n\n.table td:first-child\n{\nwidth: 75px;\n text-align:center !important;\n}\n\n\n.DTFC_LeftBodyLiner thead {\n	display: none;\n}\n\n.DTFC_LeftBodyWrapper {\n	margin-bottom: 20px;\n}\n\n.DTFC_LeftFootWrapper tfoot {\n	background-color: #efefef;\n}\n\n\n.DTFC_LeftBodyWrapper {\n	top: 20px;\n	background-color: #ececec;\n}\n\n.line-number { \n	width: 30px;\n}\n\n</style>\n\n{*\n	<link rel=\"stylesheet\" media=\"screen\" href=\"https://cdn.datatables.net/1.10.4/css/jquery.dataTables.min.css\">\n*}\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Broadcast TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Broadcast TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet </h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar hidden-xs\">\n<div class=\"control-inline toolbar-item-group \">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style-\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} <a href=\"/vendors/edit/{$vendor.id}\">{$vendor.name}</a>{/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:viewSchedule(\'{$worksheet.id}\',11, \'pdf\');\">Show Schedule</a></li>\n    <li><a href=\"javascript:viewPrograms(\'{$worksheet.id}\', 21, \'pdf\');\">View Programming</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 14, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"margin-top: 20px; overflow-x: hidden; overflow-y: hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"11\">\n												     </form>\n												     <form id=\"report-form-programs\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"programs\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"21\">\n												     </form>\n												</div>\n\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n								<div id=\"worksheet-status\">\n\n\n\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3> \n												<div class=\"btn-group widget-header-toolbar\">\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Vendor(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												        <label><input type=\"checkbox\" name=\"printSummary\"  value=\"1\" {if $order.printSummary}checked{elseif !$order.id}checked{/if}> Show Summary</label><br>\n												      </div>\n\n												</div>\n												</div>\n\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n\n												   <div style=\"width: 100%;\"><strong>Show/Hide Columns?</strong><em> (<a href=\"javascript:showAllColumns(20);\">Show All Columns</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"1\" id=\"col-1\" name=\"showLineNumber\" data-name=\"lineNumber\" value=\"1\"> Worksheet Line #</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"2\" id=\"col-2\" name=\"showDaypart\" data-name=\"daypart\" value=\"1\" checked> Daypart </label>\n												        </div>												        <div class=\"col-lg-3\">\n											                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"3\" id=\"col-3\" name=\"showVendor\" data-name=\"vendor\" value=\"1\" checked> Vendor </label>\n												         </div>												        <div class=\"col-lg-3\">												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"4\" id=\"col-4\" name=\"showStation\" data-name=\"station\" value=\"1\" checked> Station </label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"5\" id=\"col-5\" name=\"showTimePeriod\" data-name=\"timePeriod\" value=\"1\" checked> Time Period</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"6\" id=\"col-7\" name=\"showProgramName\"  data-name=\"program\" value=\"1\" checked> Program Name</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"14\" id=\"col-14\" name=\"showLength\"  data-name=\"seconds\" value=\"1\" checked> Length</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"15\" id=\"col-15\" name=\"showRate\"  data-name=\"rate\" value=\"1\" checked> Rate</label>\n												         </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"16\" id=\"col-16\" name=\"showAQH\"  data-name=\"aqh\" value=\"1\" checked> Rating</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"17\" id=\"col-17\" name=\"showCPP\" data-name=\"cpp\" value=\"1\" checked> CPP</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"18\" id=\"col-18\" name=\"showImpact\"  data-name=\"impact\" value=\"1\" checked> Impact</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"19\" id=\"col-19\" name=\"showCPM\"  data-name=\"cpm\" value=\"1\" checked> CPM</label>\n												        </div>\n												      </div>\n												      {counter name=\"colCounter\" start=20 skip=1 assign=\"colCounter\" print=FALSE}\n												      {counter name=\"totalWeeks\" start=20 skip={$weekNames|@count} assign=\"totalWeeks\" print=FALSE}\n												      {counter name=\"weekCounter\" start=1 skip=1 assign=\"weekCounter\" print=FALSE}\n												    </div>\n											         </div>\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   {counter name=\"totalWeeks\"}\n												   <div style=\"width: 100%;\"><strong>Show/Hide Weeks?</strong><em> (<a href=\"javascript:showAllWeeks(20,{$totalWeeks});\">Show All Weeks</a> | <a href=\"javascript:hideAllWeeks(20,{$totalWeeks});\">Hide All Weeks</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												           {foreach $weekNames as $weekName}\n												              <div class=\"col-lg-3\">												                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"{$colCounter}\" id=\"col-{$colCounter}\" name=\"showWeek-{$weekCounter}\"  value=\"1\" checked> {$weekName}</label>\n											                         {counter name=\"colCounter\"}\n											                         {counter name=\"weekCounter\"}\n												              </div>\n												           {/foreach}\n												      </div>\n\n												</div>\n\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"|escape:\'html\'}\" class=\"form-control input input-sm\" id=\"revisionNumber\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>	\n												    <div class=\"col-lg-3\" style=\"overflow; hidden;\">\n<div class=\"panel panel-default\">\n  <div class=\"panel-heading\">\n    <strong>Order Settings</strong>\n  </div>\n  <div class=\"panel-body\">\n  </div>\n</div>\n												</div>\n											</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\"  id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"totalReach\">0.00%</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"totalFreq\">0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName} {if $daypart != \"none\"}\n												    <div class=\"summary-daypartName\" id=\"summary-daypart-{$daypartName}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypartName}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-reach-{$daypartName}\">0.00%</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-freq-{$daypartName}\">0.00</div></td></tr>\n												      </table>\n												    </div>\n\n												    {/if} {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none; with: 95%; overflow: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n\n<div class=\"form\" id=\"worksheet-form\">\n\n<table id=\"worksheet-{$worksheet.id}\" class=\"table table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th style=\"width: 30px;\">Line</th>\n                <th>Line #</th>\n                <th data-index=\"daypart\">DP</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"station\">Station</th>\n                <th data-index=\"timePeriod\">Time Period</th>\n                <th data-index=\"programName\">Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th data-index=\"seconds\">Len</th>\n                <th data-index=\"rate\">Rate</th>\n                <th style=\"text-align: center;\" data-index=\"aqhRating\">{$demographic|default:\"Rating\"}</th>\n                <th data-index=\"cpp\">CPP</th>\n                <th data-index=\"impact\">000</th>\n                <th data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Trade</th>\n                <th style=\"text-align: center;\">Skip</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n{if $isInlineForm}\n            <tr >\n		<td style=\"width: 30px;\"></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n		<td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-trade-{$line.worksheetLine}\" data-index=\"trade\" data-name=\"trade\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTrade[]\" {if $line.isTrade}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-skip-{$line.worksheetLine}\" data-index=\"skip\" data-name=\"skip\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSkipped[]\" {if $line.isSkipped}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n\n{elseif $isInlineText}\n\n            <tr >\n		<td></td>\n                <td>{$line.worksheetLine}</td>\n                <td>{$line.daypart}</td>\n                <td>{$line.vendorID}</td>\n                <td>{$line.station}</td>\n                <td>{$line.timePeriod}</td>\n                <td>{$line.programName}</td>\n                <td>{$line.isMonday}</td>\n                <td>{$line.isTuesday}</td>\n                <td>{$line.isWednesday}</td>\n                <td>{$line.isThursday}</td>\n                <td>{$line.isFriday}</td>\n                <td>{$line.isSaturday}</td>\n                <td>{$line.isSunday}</td>\n                <td>{$line.seconds}</td>\n                <td>{$line.rate}</td>\n                <td>{$line.aqhRating}</td>\n                <td>{$line.cpp}</td>\n                <td>{$line.impact}</td>\n                <td>{$line.cpm}</td>\n                                \n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td>{$weekValue}</td>\n{/foreach}\n                <td>{$line.comments}</td>\n                <td></td>\n                <td></td>\n                <td></td>\n                <td></td>\n                <td></td>\n            </tr>\n\n{/if}\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-program-new\" value=\"\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\"\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"5\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Time Period</th>\n                <th>Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th style=\"text-align: center;\">{$demographic|default:\"Rating\"}</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Trade</th>\n                <th style=\"text-align: center;\">Skip</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n 								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n<div class=\"modal fade\" id=\"reportWait\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Please Wait</h4>\n      </div>\n      <div class=\"modal-body\">\n		<div class=\"progress progress-striped active\">\n		  <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n		  </div>\n		</div>\n		<span class=\"reportStatus\">Creating Report...</span>\n      </div>\n\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n\n\n{/block}\n\n\n	{block name=\"scripts\"}\n		<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n		<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n\n		<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n{*\n		<script type=\"text/javascript\" src=\"/assets/js/king-table.js\"></script>\n*}\n	{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/f2c75b7247b/sorting/numeric-comma.js\"></script>\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/f2c75b7247b/sorting/time.js\"></script>\n	{/block}\n\n\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn-alt.js\"></script>\n\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n	var pageNumber = 0;\n	var remember = false;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\nfunction bindKeyEvents() {\n\n$(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\nconsole.log(\"key down\");\nconsole.log($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\'));\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n\n}\n\n$(document).ready(function(){\n	bindKeyEvents();\n});\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n\n\n		$(document).ready(function() {\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n{if $worksheet.freezeCols > 0}\n					\"scrollY\": \"100%\",\n				        \"scrollCollapse\": true,\n{/if}\n//      					  \"order\": [{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}],\n     					  \"order\": [ [ 1, \"asc\" ] ],\n{if $isInlineForm}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isInlineText}\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\"},\n     { width: \"120px\", \"searchable\":false},\n     { width: \"120px\"},\n     { width: \"300px\"},\n     { width: \"100px\"},\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isAjaxSource}\n\n        \"ajax\": \"/tv/ajax/worksheet/{$worksheet.id}\",\n\"columns\": [\n     { \"data\" : null, width: \"120px\", sortable: false },\n     { \"data\": \"worksheetLine\", width: \"120px\", sortable: false, visible: false },\n     { \"data\": \"daypart\", width: \"120px\",\"orderDataType\": \"dom-select\" },\n     { \"data\": \"vendor\", width: \"120px\",\"orderDataType\": \"dom-select\", \"searchable\":false},\n     { \"data\": \"station\", width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"timeOfDay\", width: \"120px\", \"type\":\"numeric\"},\n     { \"data\": \"program\", width: \"160px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"isMonday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isTuesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isWednesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isThursday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isFriday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSaturday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSunday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"length\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"rate\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"aqhRating\", width: \"20px\", sortable: false },\n     { \"data\": \"cpp\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"impact\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"cpm\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { \"data\": \"week.{$week@iteration}\", width: \"20px\", sortable: false },\n{/foreach}\n     { \"data\": \"comments\", width: \"200px\", sortable: false },\n     { \"data\": \"copy\",  width: \"20px\", sortable: false },\n     { \"data\": \"bold\", width: \"20px\", sortable: false },\n     { \"data\": \"trade\", width: \"20px\", sortable: false },\n     { \"data\": \"skip\", width: \"20px\", sortable: false },\n     { \"data\": \"delete\", width: \"20px\", sortable: false }\n],\n\n{else}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"300px\", \"orderDataType\": \"dom-text\", \"type\": \"time\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric-comma\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{/if}\n					  \"lengthMenu\": [[10, 25, 50, 100, 200], [10, 25, 50, 100, 200]],\n//					  \"autoWidth\": false,			\n					  \"displayLength\": 10,\n					  //\"deferRender\": true,\n					  \"processing\": true,\n					  \"paginate\": true,\n					  \"drawCallback\": function( settings ) {\n						 console.log(\"redraw\");\n					         bindKeyEvents();\n					   },\n//					  \"initComplete\": function() { mapDataAttributes(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents();  },\n//					  \"initComplete\": function() { loadWorksheetData(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents(); updateSelectValues();  },\n					  \"initComplete\": function() { $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); },\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n	        		 bindKeyEvents();\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n\n		}\n\n\n			  } );\n\n    $(\'.toggle-col\').change( function (e) {\n        e.preventDefault();\n \n        // Get the column API object\n        var column = table.column( $(this).attr(\'data-column\') );\n \n        // Toggle the visibility\n        column.visible( ! column.visible() );\n    } );\n\n\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n\n{if $isInline}\n{/if}\n\n{if $worksheet.freezeCols > 0}\n\nnew $.fn.dataTable.FixedColumns( table, {\n        leftColumns: {$worksheet.freezeCols|default:\'7\'}\n});\n\n{/if}\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the input boxes in a column, parsed as numbers */\n$.fn.dataTable.ext.order[\'dom-text-numeric\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val() * 1;\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n\n{/literal}\n\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw(false);\n*/\n\n\n		//reSort();\n\n			$(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { \n				  console.log(\"sort\"); fGetSortInfo(); } );\n			});\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n		\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var savesCounter = 0;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n\n	function calculateLines() {\n			var row=0;\n			$.each(data, function( index, src ) {\n					data[index][\"cpp\"] =  (data[index][\"rate\"] / data[index][\"aqh\"]).toFixed(3); \n					data[index][\"cpm\"] =   ((data[index][\"rate\"]) / (data[index][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	{if $wsLines|@count>0}\n	data = {};	\n		{foreach $wsLines as $line}\n	  		{if $line.worksheetLine > 0} \n	 		 data[\'{$line.worksheetLine}\'] = \n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", timeOfDayStd: \"{$line.timePeriodStd|default:$line.timePeriod}\", station: \"{$line.station|escape:\'javascript\'}\",  program: \"{$line.programName|escape:\'javascript\'}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"0\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments|escape:\'javascript\'}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, skip: {if $line.isSkipped}true{else}false{/if}, trade: {if $line.isTrade}true{else}false{/if},delete: {if $line.isDeleted}true{else}false{/if} };\n			{/if}\n		{/foreach}\n	\n	{else}\n		data[\'1\'] = { lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null,  timeOfDayStd: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, skip: false, trade: false, delete: false };\n\n	{/if}\n\n//	console.log(data);\n\n	var maxRow = {$maxLineNumber};\n\n		data[\'{$maxLineNumber}\'] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, skip: false, trade: false, delete: false };\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	function mapDataAttributes() {\n\n		$.each(data, function( index, src ) {\n			var timeOfDayStd = src.timeOfDay;\n\n			$(\"#field-program-\"+src.lineNumber).closest(\"td\").attr(\"data-order\",src.program);\n			$(\"#field-timeOfDay-\"+src.lineNumber).closest(\"td\").attr(\"data-order\", timeOfDayStd);\n		});\n	}\n\n\n	function loadWorksheetData() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n\n				{if $filter == 1}\n					if (data[src.lineNumber][\"lineSpendTotal\"] > 0) {\n						addRow(src.lineNumber);	\n\n						console.log(\"Added \" + src.lineNumber + \" = \" + data[src.lineNumber][\"lineSpendTotal\"]);\n\n						$(\"#worksheet-footer\").html(\"Line \" + src.lineNumber + \" added!\");\n					}\n					else {\n						console.log(\"Skipped \" + src.lineNumber);\n					}\n\n				{else if $filter == \"station\"}\n					if (data[src.lineNumber][\"station\"] == \"{$extra}\") {\n						addRow(src.lineNumber);	\n\n						console.log(\"Added \" + src.lineNumber + \" = \" + data[src.lineNumber][\"station\"]);\n\n						$(\"#worksheet-footer\").html(\"Line (station) \" + src.lineNumber + \" added!\");\n					}\n					else {\n						console.log(\"Skipped \" + src.lineNumber);\n					}\n\n				{else}\n\n						addRow(src.lineNumber);\n						\n						$(\"#worksheet-footer\").html(\"Line \" + src.lineNumber + \" added!\");\n		\n				{/if}\n			}\n		});\n\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.draw();\n\n//		console.log(\"Datatable loaded\");\n/*\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n\n				}\n		});\n\n*/\n	}\n\n\n	function updateSelectValues() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n			}\n		});\n	}\n\n	$( document ).ready(function() {\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n\n});\n\n			$(document).ready(function(){\n\n		$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n\n			savesCounter++;\n\n			$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n			$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n\n			$.post( \"/tv/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n\n				savesCounter--;\n\n				$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n		\n				if (savesCounter < 1) {\n					savesCounter = 0;\n					$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n					$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n				}\n\n			})\n			.fail(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n\n				savesCounter--;\n\n			})\n			.error(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n\n				savesCounter--;\n\n			})\n		    }\n		}\n	    }\n	} \n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		if (dt) {\n			dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"] {if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n			dt.draw(false);\n		\n			$(\"#worksheet-footer\").html(\"Sorted!\");\n		}\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/tv/ajax/lines/remove/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/tv/ajax/line/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/tv/ajax/line/add/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/tv/ajax/lines/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/tv/edit/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		$(\"#createOrderButtonDropDown\").attr(\"disabled\", \"disabled\");\n\n\n		{if $worksheet.isOrdered}\n			console.log(\"Checking Rev #: \" + $(\"#revisionNumber\").val() +  \" = {$orderInfo.revision|escape:\'javascript\'}\");\n\n			if ($(\"#revisionNumber\").val() == \"{$orderInfo.revision|escape:\'javascript\'}\") {\n				checkRevision();\n			}\n	\n			else {\n				saveOrder();\n			}\n		{else}\n			saveOrder();\n		{/if}\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/tv/ajax/delete/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\");\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, skip: false, trade: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue.trim();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue.trim()]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n\n			if (isNaN(newValue)) {\n				newValue = 0;\n			}\n			if (newValue >= 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"trade\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"trade\"] = newValue;\n			var changes = [[row,\"trade\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"skip\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"skip\"] = newValue;\n			var changes = [[row,\"skip\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"-\", EM:\"EM\", DA:\"DA\", EF:\"EF\", EN:\"EN\", PA:\"PA\", PR:\"PR\", LF:\"LF\", LN:\"LN\", OV:\"OV\", SP:\"SP\", RO:\"RO\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n//				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				overallCPP = totalSpend / totalGRPs;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n				var totalReach = ((1 - Math.pow( 1 - (totalGRPs / totalSpots / 100),totalSpots)) * .85 * 100);\n				$(\'#daypart-reach-\'+daypart).html(totalReach.toFixed(2) + \"%\");\n				$(\'#daypart-freq-\'+daypart).html((totalGRPs / totalReach).toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$0.00\");\n			}	\n		}\n\n	  }\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		console.log(data);\n		console.log(\"Add New Line: \" + maxRow);\n		console.log(data[maxRow-1]);\n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[maxRow-1][\"daypart\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name|escape:\'javascript\'}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\" selected\');\n\n		rememberPage();\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n\n		dt.row.add([\n		\'<td class=\"line-number\"></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\" onchange=\"updateField(this);\"></center></td>\',		\'<td><center><input type=checkbox class=\"centered\" id=\"field-trade-\'+maxLineNumber+\'\" data-index=\"trade\" data-name=\"trade\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTrade[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-skip-\'+maxLineNumber+\'\" data-index=\"skip\" data-name=\"skip\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSkipped[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], timeOfDayStd: data[maxRow-1][\"timeOfDayStd\"], station: data[maxRow-1][\"station\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, skip: false, trade: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n\n	}\n\n\n	function addRow(line) {\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		var isBold = \"\";\n		var isTrade = \"\";\n		var isSkipped = \"\";\n\n		lineNumber = line;\n\n		if(data[lineNumber][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[lineNumber][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[lineNumber][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[lineNumber][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[lineNumber][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[lineNumber][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[lineNumber][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		if(data[lineNumber][\"bold\"]) {\n			isBold = \" checked\";\n		} \n\n		if(data[lineNumber][\"trade\"]) {\n			isTrade = \" checked\";\n		} \n\n		if(data[lineNumber][\"skip\"]) {\n			isSkipped = \" checked\";\n		} \n\n\n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[lineNumber][\"daypart\"]+\'\"\', \'value=\"\'+data[lineNumber][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name|escape:\'javascript\'}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[lineNumber][\"vendorID\"]+\'\"\', \'value=\"\'+data[lineNumber][\"vendorID\"]+\'\" selected\');\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td class=\"line-number\"></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+lineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+lineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+lineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\" onload=\"$(this).val(\'+data[lineNumber][\"vendorID\"]+\');\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td data-order=\"\'+data[lineNumber][\"station\"]+\'\"><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[lineNumber][\"station\"]+\'\" id=\"field-station-\'+lineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td ><input type=hidden value=\"\'+data[lineNumber][\"timeOfDayStd\"]+\'\" ><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+lineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+lineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+lineNumber+\'\" data-name=\"wed\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+lineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+lineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+lineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+lineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+lineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+lineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+lineNumber+\'\"\" value=\"\'+data[lineNumber][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpm\"]+\'\" id=\"field-cpm-\'+lineNumber+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+lineNumber+\'-{$weekCounter}\"  value=\"\'+data[lineNumber][\"week\"][{$weekCounter}]+\'\" name=\"week\'+lineNumber+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+lineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+lineNumber+\'\" size=40  value=\"\'+data[lineNumber][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+lineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+lineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isBold[]\" onchange=\"updateField(this);\"\'+isBold+\'></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-trade-\'+lineNumber+\'\" data-index=\"trade\" data-name=\"trade\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isTrade[]\" onchange=\"updateField(this);\"\'+isTrade+\'></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-skip-\'+lineNumber+\'\" data-index=\"skip\" data-name=\"skip\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSkipped[]\" onchange=\"updateField(this);\"\'+isSkipped+\'></center></td>\',		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+lineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]);\n		\n		\n		$(\'#field-vendorID-\'+lineNumber).val(data[lineNumber][\"vendorID\"]);\n		$(\'#field-daypart-\'+lineNumber).val(data[lineNumber][\"daypart\"]);\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n	loadWorksheetData(); \n	bindKeyEvents();\n	checkCols();\n\n});\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n\n// toggle function\n$.fn.clickToggle = function( f1, f2 ) {\n	return this.each( function() {\n		var clicked = false;\n		$(this).bind(\'click\', function() {\n			if(clicked) {\n				clicked = false;\n				return f2.apply(this, arguments);\n			}\n\n			clicked = true;\n			return f1.apply(this, arguments);\n		});\n	});\n\n}\n\n\n\nfunction showAllColumns(maxCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\n \nfor ( var i=2 ; i<=maxCol ; i++ ) {\n    table.column( i ).visible( true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction showAllWeeks(startCol, endCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\nfor ( var i=startCol ; i<cols[0].length; i++ ) {\n    table.column( i ).visible(true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction hideAllWeeks(startCol, endCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\nfor ( var i=startCol ; i <= endCol; i++ ) {\n    table.column( i ).visible(false, false );\n    $(\"#col-\"+i).prop(\"checked\", false);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction checkCols() {\n\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\n\nfor ( var i=0 ; i<cols[0].length; i++ ) {\n    if (table.column( i ).visible()) {\n	    $(\"#col-\"+i).prop(\"checked\", true);\n    }\n    else {\n	    $(\"#col-\"+i).prop(\"checked\", false); \n    }\n}\n\n}\n\n		function viewPrograms(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/programs/pdf\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form-programs\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to display schedule at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n\n		function viewSchedule(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/schedule/pdf\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to display schedule at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n		function exportWorksheet(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/worksheet/csv\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to export worksheet at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n	$(document).ready(function () {\n	\n	    	$(\'.toggle-col\').change(function(box) {\n	            var colName = $(this).data(\"name\");\n	    	    if ($(this).is(\':checked\')) {\n	//		console.log(\"Box is checked\");\n			saveCols(colName, 0);\n		    }\n	            else {\n	//		console.log(\"Box is unchecked\");\n			saveCols(colName, 1);\n		    }\n	    	});\n	});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/tv/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function checkRevision() {\n\nbootbox.dialog({\n  message: \'<h4>This worksheet was previously ordered.<br>Do you want to set a new revision #?</h4>\',\n  title: \"Change Revision?\",\n  buttons: {\n    success: {\n      label: \"No\",\n      className: \"btn-danger\",\n      callback: function() {\n		saveOrder();\n      }\n    },\n    main: {\n      label: \"Yes\",\n      className: \"btn-success\",\n      callback: function() {\n		// increase revision #\n		var revNum = $(\"#revisionNumber\").val();\n		console.log(\"Rev # \" + revNum);\n		var newRevNum = parseInt(revNum) + 1;\n		console.log(\"New Rev # \" + newRevNum);\n		$(\"#revisionNumber\").val(newRevNum);\n		saveOrder();\n      }\n    }\n  }\n});\n			 \n{*\n		  	bootbox.confirm(\'<h4>This worksheet was previously ordered.<br>Do you want to set a new revision #?</h4>\', function(response) {\n				if (response) {\n					// increase revision #\n					var revNum = $(\"#revisionNumber\").val();\n					console.log(\"Rev # \" + revNum);\n					var newRevNum = parseInt(revNum) + 1;\n					console.log(\"New Rev # \" + newRevNum);\n					$(\"#revisionNumber\").val(newRevNum);\n					saveOrder();\n				}\n				else {\n					// do nothing\n				}\n			});\n\n*}\n\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n	function goToPage(pageNum) {\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n	\n		dt.page(pageNum).draw(false);\n\n		console.log(\"GoToPage: \" + pageNum);\n	}\n\n	function currentPage() {\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n\n		console.log(\"Current Page: \" + dt.page());\n\n		return dt.page();\n\n	}\n\n	function rememberPage() {\n		\n		remember = true;\n		pageNumber = currentPage();\n		console.log(\"Remember Page: \" + pageNumber);\n		if (remember) {\n			goToPage(pageNumber);\n			return pageNumber;\n		}\n		return false;\n	}\n\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(50,0,'worksheet-grid-simple','2014-07-31 09:00:37','','<div class=\"container\">\n        <div>\n            <div class=\"row\">\n                <div>Line</div>\n                <div>Line #</div>\n                <div data-index=\"daypart\">DP</div>\n                <div data-index=\"vendorID\">Vendor</div>\n                <div data-index=\"station\">Station</div>\n                <div data-index=\"timePeriod\">Time Period</div>\n                <div data-index=\"programName\">Program Name</div>\n                <div>M</div>\n                <div>T</div>\n                <div>W</div>\n                <div>R</div>\n                <div>F</div>\n                <div>Sa</div>\n                <div>Su</div>\n                <div data-index=\"seconds\">Len</div>\n                <div data-index=\"rate\">Rate</div>\n                <div data-index=\"aqhRating\">AQH RTG</div>\n                <div data-index=\"cpp\">CPP</div>\n                <div data-index=\"impact\">000</div>\n                <div data-index=\"cpm\">CPM</div>\n{foreach $weekNames as $weekName}\n		<div>{$weekName}</div>\n{/foreach}\n\n                <div class=\"hidden-sm hidden-xs\">Comments</div>\n                <div style=\"text-align: center;\">Copy</div>\n                <div style=\"text-align: center;\">Bold</div>\n                <div style=\"text-align: center;\">Delete</div>\n\n            </div>\n        </div>\n 	<div id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n{if $isInline}\n            <div class=\"row\">\n		<div></div>\n                <div><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></div>\n                <div><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></div>\n                <div><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></div>\n                <div><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></div>\n                <div><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <div><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></div>\n                <div><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></div>\n                <div><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></div>\n                <div><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div>\n                <div><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></div>\n                <div><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <div><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></div>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <div><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></div>\n{/foreach}\n                <div class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></div>\n                <div style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n                <div style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></div>\n            </div>\n\n{else}\n\n            <tr >\n		<td></td>\n                <td>{$line.worksheetLine}</td>\n                <td>{$line.daypart}</td>\n                <td>{$line.vendorID}</td>\n                <td>{$line.station}</td>\n                <td>{$line.timePeriod}</td>\n                <td>{$line.programName}</td>\n                <td>{$line.isMonday}</td>\n                <td>{$line.isTuesday}</td>\n                <td>{$line.isWednesday}</td>\n                <td>{$line.isThursday}</td>\n                <td>{$line.isFriday}</td>\n                <td>{$line.isSaturday}</td>\n                <td>{$line.isSunday}</td>\n                <td>{$line.seconds}</td>\n                <td>{$line.rate}</td>\n                <td>{$line.aqhRating}</td>\n                <td>{$line.cpp}</td>\n                <td>{$line.impact}</td>\n                <td>{$line.cpm}</td>\n                                \n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td>{$weekValue}</td>\n{/foreach}\n                <td>{$line.comments}</td>\n                <td></td>\n                <td></td>\n                <td></td>\n            </tr>\n\n{/if}\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n    </div>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(51,0,'inventory-imports','2014-10-15 09:24:19','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Inventory</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Inventory</h2>\n								<em>Imports</em>\n							</div>\n<div class=\"row\">\n	<div class=\"col-lg-6\">\n\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-cloud-upload\"></i> Import Inventory</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n										<form class=\"dropzone\" id=\"dropzone\" enctype=\"multipart/form-data\"></form>\n									</div>\n								</div>\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-image-o\"></i> Pending Imports</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n\n									</div>\n								</div>\n	</div>\n\n</div>\n\n\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-cloud\"></i> Completed Imports</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th></th>\n													<th>Type</th>\n													<th>Filename</th>\n													<th>Date & Time</th>\n													<th># of Lines</th>\n													<th>Status</th>\n													<th></th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $imports as $import}\n												<tr>\n													<td>{$agencyUser.role}</td>\n													<td>{$agencyUser.firstName}</td>\n													<td>{$agencyUser.lastName}</td>\n													<td>{$agencyUser.emailAddress}</td>\n													<td>{$agencyUser.lastLogin}</td>\n													<td>{$agencyUser.status}</td>\n\n	<td><center><a href=\"inventory/import/{$import.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n	<td><center><a href=\"inventory/import/delete/{$import.id}\"><i class=\"fa fa-trash-o fa-lg\" ></i></a></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/dropzone/dropzone.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				var dz = new Dropzone(\"form#dropzone\", {					url: \"/inventory/import/upload\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'.csv, .xls, .xlsx, application/xls, text/csv, application/pdf, .txt, .xml, .scx\',\n					dictResponseError: \'File Upload Error.\',\n//					success: function(file, responseText) { console.log(file); console.log(responseText); },\n					createImageThumbnails: false\n				});\n\n				dz.on(\"success\", function(file, responseText) { console.log(file); console.log(responseText); });\n\n			} // end if dropzone exist\n\n\n		});\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(52,0,'programs','2014-10-15 12:05:27','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Programs</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Programs</h2>\n								<em>List of {$listType|default:\"All\"} Programs</em>\n								<div class=\"pull-right\"><a class=\"btn btn-default\" href=\"/inventory/export/programs\">Export Inventory</a></div>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-cube\"></i> Programs</h3>\n										<em>- <a href=\"programs/create\">Add A New Program</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n																								\n	<th>Vendor</th>\n\n	<th>Station</th>\n\n	<th>Program Name</th>\n													<th>Days</th>\n													<th>Times</th>\n						\n	<th>Rates</th>				\n\n	<th></th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $programs as $program}\n												<tr>\n													<td>{$program.vendor}</td>\n													<td>{$program.station}</td>\n													<td>{$program.name}</td>\n													<td>{$program.daysOfWeek}</td>\n													<td>{$program.timePeriod}</td>\n\n	<td>{$program.rateRange}</td>\n\n	<td><a href=\"programs/edit/{$program.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><i class=\"fa fa-trash-o fa-lg\"></i></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\">\n\n\n\n		function copyBox(campaignID) {\n			 \n			var campaignIDStr = \"\'\"+campaignID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Client-</option><option>-This Client-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyCampaign(\"+campaignID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Campaign to: \' + worksheets);\n\n	  	}\n\n		function copyCampaign(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/campaigns/ajax/copy/campaignID\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#campaign-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n  		}\n\n		function deleteCampaign(campaignID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/campaigns/ajax/delete/\"+campaignID, null, function() {\n						$(\"#campaign-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var campaignDataTable = $(\'#campaigns\').dataTable();\n							campaignDataTable.fnDeleteRow(  wsDataTable.$(\'#campaign-\'+campaignID)[0] );\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	</script>\n	\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(53,0,'program-edit','2014-10-15 11:17:30','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/programs/\">Programs</a></li>\n			<li class=\"active\" id=\"breadcrumb-vendor-name\">{$program.name}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Programs</h2>\n								<em>Avails, Rates & Ratings</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Program Information</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-cube\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"programActive\" name=\"isActive\" {if $program.isAvailable}checked{/if} class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>	\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  method=\"post\" action=\"/programs/edit/{$program.id}\" id=\"program-form\" name=\"editProgram\" role=\"form\" data-parsley-validate novalidate >\n\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n\n{if $alert.error}\n<div class=\"alert alert-danger alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> {$alert.error}\n</div>\n{/if}	\n				<input type=\"hidden\" name=\"vendorID\" value=\"{$program.id}\">\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$program.agencyID}\">\n				<input type=\"hidden\" id=\"program-active\" name=\"isActive\" value=\"{$program.isActive}\">\n\n\n					<div class=\"form-group\"  id=\"station\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Station</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"station\" value=\"{$program.station}\" id=\"station\" class=\"form-control\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Program Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"programName\" value=\"{$program.name}\" id=\"programName\" class=\"form-control\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Days?</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" id=\"daysOfWeek\" name=\"daysOfWeek\" value=\"{$program.daysOfWeek}\" class=\"form-control\">\n						</div>\n																	</div>\n\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Times?</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text id=\"timePeriod\" name=\"daysOfWeek\" value=\"{$program.timePeriod}\" class=\"form-control\" >\n						</div>\n																	</div>\n												\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Comments</p>\n							<textarea id=\"textarea\" name=\"comments\" id=\"comments\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: none;\">{$program.comments}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveVendor();\" disabled>Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteVendor();\" disabled>Delete</button>\n							</p>\n						</div>\n					</div>\n\n				</form>\n\n		</div>\n\n		<div id=\"vendor-footer\" class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n</div>\n\n</div>\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12 hidden\">\n\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3><i class=\"fa fa-paper-plane\"></i>Add A New Market</h3>\n				<div class=\"btn-group widget-header-toolbar\">					<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n				</div>\n			</div>\n			<div class=\"widget-content\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"addMarket\" name=\"addMarket\" role=\"form\">\n							<input type=\"hidden\" name=\"vendorID\" value=\"{$vendor.id}\">\n							<input type=\"hidden\" name=\"agencyID\" value=\"{$vendor.agencyID}\">\n							<div class=\"form-group\" id=\"market-name\">\n																				<label for=\"addMarketName\" class=\"col-sm-4 control-label\">Market Name</label>\n																				<div class=\"col-sm-8\">\n																					<input type=\"text\" id=\"marketName\"  name=\"marketName\" class=\"form-control\">\n									<span id=\"market-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Market Name Already Exists!</span>\n								</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																					<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																					<div class=\"col-sm-8\">\n										<input type=\"text\" id=\"text-input\"  name=\"contactName\"  value=\"{$vendor.contactName}\" class=\"form-control\" required>\n									</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																				<div class=\"col-sm-8\">\n									<input type=\"text\" id=\"text-input\" name=\"emailAddress\" value=\"{$vendor.emailAddress}\" class=\"form-control\" required>\n								</div>\n																			</div>\n																			<div class=\"form-group\">\n																				<label for=\"addMarketRepPhone\" class=\"col-sm-4 control-label\">Phone Number\n																				<br>\n																				<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addMarketRepPhone\" name=\"phoneNumber\" value=\"{$vendor.phoneNumber}\" class=\"form-control\">\n																				</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																				<label for=\"addMarketRepFax\" class=\"col-sm-4 control-label\">Fax Number\n																					<br>\n																					<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addMarketRepFax\" name=\"faxNumber\" value=\"{$vendor.faxNumber} class=\"form-control\">\n																				</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Station(s)</label>\n																				<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n									<input type=\"text\" id=\"addMarketStations\" name=\"stations\" class=\"form-control\">\n\n								</div>\n\n							</div\n\n						<form>\n\n					</div>\n\n							<div class=\"form-group\">\n								<div class=\"col-sm-12\">\n									<p class=\"pull-right\">\n										<button type=\"button\" class=\"btn btn-success\" onclick=\"createMarket();\">Add Market</button>\n									</p>\n								</div>\n							</div>\n				</div>\n\n			</div>\n			<div id=\"market-footer\" class=\"widget-footer\">\n			Not Saved\n			</div>\n		</div>\n\n	</div>\n\n</div>\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-dollar\"></i> Rates</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"vendorMarkets\" class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>Name</th>\n													<th>Amount</th>\n													<th>Rate Begins</th>\n													<th>Rate Ends</th>\n													<th></th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $rates as $rate}\n												<tr>\n													<td>{$rate.name}</td>\n													<td>{$rate.rate}</td>\n													<td>{$rate.startDate}</td>\n													<td>{$rate.endDate}</td>\n\n	<td><a href=\"/programs/rates/edit/{$rate.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><i class=\"fa fa-trash-o fa-lg\"></i></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n\n</div>\n</div>\n\n\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Ratings</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table id=\"vendorPrograms\" class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n												\n	<th>DMA</th>\n\n	<th>Rating</th>\n													<th>Impact</th>\n													<th>Rating Period</th>\n						\n	<th></th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $ratings as $rating}\n												<tr>\n													<td>{$rating.description}</td>\n													<td>{$rating.aqhRating}</td>\n													<td>{$rating.impressions}</td>\n													<td>{$rating.ratingPeriod}</td>\n\n	<td><a href=\"programs/ratings/edit/{$rating.id}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n\n	<td><i class=\"fa fa-trash-o fa-lg\"></i></td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n\n</div>\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#programActive\').bootstrapSwitch();\n\n			$(\"#vendor-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#vendorActive\").change(function () {\n			    resetFooter();\n			    vendorActive(); \n			}); \n		});\n\n	</script>\n	<script>\n		function createMarket() {\n\n			$(\"#market-footer\").html(\"Saving.\");\n\n			$.post( \"/markets/ajax/add/\", $( \"#addMarket\" ).serialize(), function() {\n				$(\"#market-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#market-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#market-name-help\").show();\n\n				}\n				else {\n					$(\"#market-name\").removeClass(\"has-error error\");\n					$(\"#market-name-help\").hide();\n					$(\'#vendorMarkets\').dataTable().fnAddData( [response.newMarket.name,response.newMarket.contactName,response.newMarket.emailAddress,response.newMarket.phoneNumber,response.newMarket.faxNumber,response.newMarket.stations, \"<a href=\'markets/edit/\" + response.newMarket.id + \"\' style=\'a { color: #333;}\'><i class=\'fa fa-pencil fa-lg\'></i></a>\", \"<i class=\'fa fa-trash-o fa-lg\'></i>\"] );\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#market-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#market-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function resetFooter() {\n				$(\"#vendor-footer\").html(\"Not Saved\");\n		}\n\n		function programActive() {\n\n			if ($(\"#vendorActive\").is(\":checked\")) {\n				$(\"#vendor-active\").val(\"1\");\n			}\n			else {\n				$(\"#vendor-active\").val(\"0\");\n			}\n		}\n\n		function saveVendor() {\n			\n			$(\"#vendor-footer\").html(\"Saving.\");\n\n			vendorActive();\n\n			$.post( \"/vendors/ajax/save/{$vendor.id}\", $( \"#vendor-form\" ).serialize(), function() {\n				$(\"#vendor-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#vendor-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#vendor-name-help\").show();\n\n				}\n				else {\n					$(\"#vendor-name\").removeClass(\"has-error error\");\n					$(\"#vendor-name-help\").hide();\n				}\n				$(\"#breadcrumb-vendor-name\").html($(\"#vendorName\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#vendor-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#vendor-footer\").html(\"Error!\");\n			})\n		}\n	  \n	  	function deleteVendor() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#vendor-footer\").html(\"Deleting..\");\n\n					$.post( \"/vendors/ajax/delete/{$vendor.id}\", $( \"#vendor-form\" ).serialize(), function() {\n						$(\"#vendor-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#vendor-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/vendors/all\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#vendor-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#vendor-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n\n\n\n	</script>\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(54,0,'program-create','2014-08-14 14:26:26','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/programs/\">Programs</a></li>\n			<li class=\"active\" id=\"breadcrumb-vendor-name\">{$program.name}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Programs</h2>\n								<em>Avails, Rates & Ratings</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Program Information</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-cube\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"programActive\" name=\"isActive\" {if $program.isAvailable}checked{/if} class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>	\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  method=\"post\" action=\"/programs/edit/{$program.id}\" id=\"program-form\" name=\"editProgram\" role=\"form\" data-parsley-validate novalidate >\n\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n\n{if $alert.error}\n<div class=\"alert alert-danger alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> {$alert.error}\n</div>\n{/if}	\n				<input type=\"hidden\" name=\"vendorID\" value=\"{$program.id}\">\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$program.agencyID}\">\n				<input type=\"hidden\" id=\"program-active\" name=\"isActive\" value=\"{$program.isActive}\">\n\n\n					<div class=\"form-group\"  id=\"station\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Station</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"station\" value=\"{$program.station}\" id=\"station\" class=\"form-control\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Program Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"programName\" value=\"{$program.name}\" id=\"programName\" class=\"form-control\" required>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Days?</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" id=\"daysOfWeek\" name=\"daysOfWeek\" value=\"{$program.daysOfWeek}\" class=\"form-control\">\n						</div>\n																	</div>\n\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Times?</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text id=\"timePeriod\" name=\"daysOfWeek\" value=\"{$program.timePeriod}\" class=\"form-control\" >\n						</div>\n																	</div>\n												\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Comments</p>\n							<textarea id=\"textarea\" name=\"comments\" id=\"comments\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: none;\">{$program.comments}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveVendor();\" disabled>Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteVendor();\" disabled>Delete</button>\n							</p>\n						</div>\n					</div>\n\n				</form>\n\n		</div>\n\n		<div id=\"vendor-footer\" class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n</div>\n\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#programActive\').bootstrapSwitch();\n\n			$(\"#vendor-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#vendorActive\").change(function () {\n			    resetFooter();\n			    vendorActive(); \n			}); \n		});\n\n	</script>\n	<script>\n		function createMarket() {\n\n			$(\"#market-footer\").html(\"Saving.\");\n\n			$.post( \"/markets/ajax/add/\", $( \"#addMarket\" ).serialize(), function() {\n				$(\"#market-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#market-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#market-name-help\").show();\n\n				}\n				else {\n					$(\"#market-name\").removeClass(\"has-error error\");\n					$(\"#market-name-help\").hide();\n					$(\'#vendorMarkets\').dataTable().fnAddData( [response.newMarket.name,response.newMarket.contactName,response.newMarket.emailAddress,response.newMarket.phoneNumber,response.newMarket.faxNumber,response.newMarket.stations, \"<a href=\'markets/edit/\" + response.newMarket.id + \"\' style=\'a { color: #333;}\'><i class=\'fa fa-pencil fa-lg\'></i></a>\", \"<i class=\'fa fa-trash-o fa-lg\'></i>\"] );\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#market-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#market-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function resetFooter() {\n				$(\"#vendor-footer\").html(\"Not Saved\");\n		}\n\n		function programActive() {\n\n			if ($(\"#vendorActive\").is(\":checked\")) {\n				$(\"#vendor-active\").val(\"1\");\n			}\n			else {\n				$(\"#vendor-active\").val(\"0\");\n			}\n		}\n\n		function saveVendor() {\n			\n			$(\"#vendor-footer\").html(\"Saving.\");\n\n			vendorActive();\n\n			$.post( \"/vendors/ajax/save/{$vendor.id}\", $( \"#vendor-form\" ).serialize(), function() {\n				$(\"#vendor-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#vendor-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#vendor-name-help\").show();\n\n				}\n				else {\n					$(\"#vendor-name\").removeClass(\"has-error error\");\n					$(\"#vendor-name-help\").hide();\n				}\n				$(\"#breadcrumb-vendor-name\").html($(\"#vendorName\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#vendor-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#vendor-footer\").html(\"Error!\");\n			})\n		}\n	  \n	  	function deleteVendor() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#vendor-footer\").html(\"Deleting..\");\n\n					$.post( \"/vendors/ajax/delete/{$vendor.id}\", $( \"#vendor-form\" ).serialize(), function() {\n						$(\"#vendor-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#vendor-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/vendors/all\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#vendor-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#vendor-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n\n\n\n	</script>\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(56,0,'MAIL_THANKYOU','2014-04-06 21:33:20','','------={$boundary}\nContent-type: text/plain; charset=iso-8859-1\nContent-Transfer-Encoding: quoted-printable\n\nSorry- this email requires it be viewed using HTML.\n\n------={$boundary}\nContent-type: text/html; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n{include file=\"db:MAIL_SIMPLE\"}\n\n\n------={$boundary}--','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(57,0,'MAIL_SIMPLE','2014-04-06 20:57:02','','{literal}\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta name=\"viewport\" content=\"width=device-width\" />\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n<title>Really Simple HTML Email Template</title>\n<style>\n/* -------------------------------------\n		GLOBAL\n------------------------------------- */\n* {\n	margin: 0;\n	padding: 0;\n	font-family: \"Helvetica Neue\", \"Helvetica\", Helvetica, Arial, sans-serif;\n	font-size: 100%;\n	line-height: 1.6;\n}\n\nimg {\n	max-width: 100%;\n}\n\nbody {\n	-webkit-font-smoothing: antialiased;\n	-webkit-text-size-adjust: none;\n	width: 100%!important;\n	height: 100%;\n}\n\n\n/* -------------------------------------\n		ELEMENTS\n------------------------------------- */\na {\n	color: #348eda;\n}\n\n.btn-primary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #348eda;\n	border: solid #348eda;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.btn-secondary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #aaa;\n	border: solid #aaa;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.last {\n	margin-bottom: 0;\n}\n\n.first {\n	margin-top: 0;\n}\n\n.padding {\n	padding: 10px 0;\n}\n\n\n/* -------------------------------------\n		BODY\n------------------------------------- */\ntable.body-wrap {\n	width: 100%;\n	padding: 20px;\n}\n\ntable.body-wrap .container {\n	border: 1px solid #f0f0f0;\n}\n\n\n/* -------------------------------------\n		FOOTER\n------------------------------------- */\ntable.footer-wrap {\n	width: 100%;	\n	clear: both!important;\n}\n\n.footer-wrap .container p {\n	font-size: 12px;\n	color: #666;\n\n}\n\ntable.footer-wrap a {\n	color: #999;\n}\n\n\n/* -------------------------------------\n		TYPOGRAPHY\n------------------------------------- */\nh1, h2, h3 {\n	font-family: \"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif;\n	line-height: 1.1;\n	margin-bottom: 15px;\n	color: #000;\n	margin: 40px 0 10px;\n	line-height: 1.2;\n	font-weight: 200;\n}\n\nh1 {\n	font-size: 36px;\n}\nh2 {\n	font-size: 28px;\n}\nh3 {\n	font-size: 22px;\n}\n\np, ul, ol {\n	margin-bottom: 10px;\n	font-weight: normal;\n	font-size: 14px;\n}\n\nul li, ol li {\n	margin-left: 5px;\n	list-style-position: inside;\n}\n\n/* ---------------------------------------------------\n		RESPONSIVENESS\n		Nuke it from orbit. It\'s the only way to be sure.\n------------------------------------------------------ */\n\n/* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\n.container {\n	display: block!important;\n	max-width: 600px!important;\n	margin: 0 auto!important; /* makes it centered */\n	clear: both!important;\n}\n\n/* Set the padding on the td rather than the div for Outlook compatibility */\n.body-wrap .container {\n	padding: 20px;\n}\n\n/* This should also be a block element, so that it will fill 100% of the .container */\n.content {\n	max-width: 600px;\n	margin: 0 auto;\n	display: block;\n}\n\n/* Let\'s make sure tables in the content area are 100% wide */\n.content table {\n	width: 100%;\n}\n\n</style>\n</head>\n\n<body bgcolor=\"#f6f6f6\">\n\n<!-- body -->\n<table class=\"body-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\" bgcolor=\"#FFFFFF\">\n\n			<!-- content -->\n			<div class=\"content\">\n			<table>\n				<tr>\n					<td>\n						<p>Hi there,</p>\n						<p>Sometimes all you want is to send a simple HTML email with a basic design.</p>\n						<h1>Really simple HTML email template</h1>\n						<p>This is a really simple email template. It\'s sole purpose is to get you to click the button below.</p>\n						<h2>How do I use it?</h2>\n						<p>All the information you need is on GitHub.</p>\n						<table>\n							<tr>\n								<td class=\"padding\">\n									<p><a href=\"https://github.com/leemunroe/html-email-template\" class=\"btn-primary\">View the source and instructions on GitHub</a></p>\n								</td>\n							</tr>\n						</table>\n						<p>Feel free to use, copy, modify this email template as you wish.</p>\n						<p>Thanks, have a lovely day.</p>\n						<p><a href=\"http://twitter.com/leemunroe\">Follow @leemunroe on Twitter</a></p>\n					</td>\n				</tr>\n			</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /body -->\n\n<!-- footer -->\n<table class=\"footer-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\">\n\n			<!-- content -->\n			<div class=\"content\">\n				<table>\n					<tr>\n						<td align=\"center\">\n							<p>Don\'t like these annoying emails? <a href=\"#\"><unsubscribe>Unsubscribe</unsubscribe></a>.\n							</p>\n						</td>\n					</tr>\n				</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /footer -->\n\n</body>\n</html>\n{/literal}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(59,0,'MAIL_IMAGE','2014-04-06 21:29:12','','{literal}\n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\n{/literal}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(60,0,'MAIL_DEFAULT','2014-04-06 22:55:24','','{foreach $messages as $message}\n{if !empty($message.content)}\n------={$boundary}\nContent-type: {$message.type}; charset={$message.charset}\nContent-Transfer-Encoding: {$message.encoding}\n	\n{$message.content}\n{/if}\n{/foreach}\n\n------={$boundary}--','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(61,0,'MAIL_INTRO','2014-08-08 21:15:19','','<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<head style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<meta name=\"viewport\" content=\"width=device-width\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<title style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">Really Simple HTML Email Template</title>\n\n</head>\n\n<body bgcolor=\"#f6f6f6\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;-webkit-font-smoothing: antialiased;-webkit-text-size-adjust: none;height: 100%;width: 100%;\">\n\n<!-- body -->\n<table class=\"body-wrap\" style=\"margin: 0;padding: 20px;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n<tbody>\n<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n	<td class=\"container\" bgcolor=\"#FFFFFF\" style=\"margin: 0 auto;padding: 20px;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;border: 1px solid #f0f0f0;display: block;max-width: 600px;clear: both;\">\n		<!-- content -->\n		<p class=\"content\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;max-width: 600px;display: block;\">\n		</p>\n		<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n		<tbody>\n		<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n			<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Hi,\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Thanks for signing up with BluHorn, we are excited to help you get started!\n				</p>\n				<p>\n					<strong>Your Account Information</strong>\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Username: {$email.username} and activation code is: {$email.activationCode}\n				</p>\n				<p>\n					<strong>Just click the link below to finish activating your account.</strong>\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Once active, everything you need will be available inside the calendar management portal.\n				</p>\n				<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n				<tbody>\n				<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n					<td class=\"padding\" style=\"margin: 0;padding: 10px 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n						<p style=\"margin: 0px 0px 10px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 14px; line-height: 1.6; font-weight: normal; text-align: center;\">\n							<a href=\"http://bluhorn.filelogix.com/activate/{$email.activationCode}\" class=\"btn-primary\" style=\"margin: 0px 10px 0px 0px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 100%; color: rgb(255, 255, 255); text-decoration: none; background-color: rgb(52, 142, 218); border-style: solid; border-color: rgb(52, 142, 218); border-width: 10px 20px; font-weight: bold; text-align: center; cursor: pointer; display: inline-block; border-top-left-radius: 25px; border-top-right-radius: 25px; border-bottom-right-radius: 25px; border-bottom-left-radius: 25px;\">Activate Your BluHorn Account</a>\n						</p>\n					</td>\n				</tr>\n				</tbody>\n				</table>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					For any immediate questions, please call 1-800-818-7647\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Or email us at support@bluhorn.com\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Thanks, and have a great day!\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					<a href=\"http://twitter.com/iwantabuzz\" style=\"margin: 0px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 100%; color: rgb(52, 142, 218);\">Follow us&nbsp;@bluhorn on Twitter</a>\n				</p>\n			</td>\n		</tr>\n		</tbody>\n		</table>\n		<!-- /content -->\n	</td>\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n</tr>\n</tbody>\n</table>\n<!-- /body -->\n<!-- footer -->\n<table class=\"footer-wrap\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;clear: both;\">\n<tbody>\n<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n	<td class=\"container\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;display: block;max-width: 600px;clear: both;\">\n		<!-- content -->\n		<p class=\"content\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;max-width: 600px;display: block;\">\n		</p>\n		<br>\n		<br>\n		<!-- /content -->\n	</td>\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n</tr>\n</tbody>\n</table>\n<!-- /body -->\n\n<!-- footer -->\n<table class=\"footer-wrap\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;clear: both;\">\n	<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n		<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\"></td>\n		<td class=\"container\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;display: block;max-width: 600px;clear: both;\">\n\n			<!-- content -->\n			<div class=\"content\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;max-width: 600px;display: block;\">\n				<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n					<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n						<td align=\"center\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n							<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 12px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;color: #666;\">Don\'t like these annoying emails? <a href=\"http://onecal.co/calendar/unsubscribe/{$email.id}\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;color: #999;\"><unsubscribe style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">Unsubscribe</unsubscribe></a>.\n							</p>\n						</td>\n					</tr>\n				</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\"></td>\n	</tr>\n</table>\n<!-- /footer -->\n\n</body>\n</html>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(62,0,'MAIL_FORGOT','2014-08-08 22:20:44','','<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<head style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<meta name=\"viewport\" content=\"width=device-width\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n<title style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">Really Simple HTML Email Template</title>\n\n</head>\n\n<body bgcolor=\"#f6f6f6\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;-webkit-font-smoothing: antialiased;-webkit-text-size-adjust: none;height: 100%;width: 100%;\">\n\n<table class=\"body-wrap\" style=\"margin: 0;padding: 20px;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n<tbody>\n<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n	<td class=\"container\" bgcolor=\"#FFFFFF\" style=\"margin: 0 auto;padding: 20px;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;border: 1px solid #f0f0f0;display: block;max-width: 600px;clear: both;\">\n		<!-- content -->\n		<p class=\"content\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;max-width: 600px;display: block;\">\n		</p>\n		<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n		<tbody>\n		<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n			<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Hey there,\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Heard you were having problems logging into BluHorn today...\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					No worries, though, we\'ve got you covered.\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					<b style=\"font-family: Arial, Helvetica, Verdana, Tahoma, sans-serif; text-align: center;\">Password Reset -&nbsp;</b>It\'s easy to reset your password.\n				</p>\n				<p>\n					<em>Just click the link below and you can create a new one.</em>\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					For security purposes, you only have a short period of time, before this expires.\n				</p>\n				<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n				<tbody>\n				<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n					<td class=\"padding\" style=\"margin: 0;padding: 10px 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n						<p style=\"margin: 0px 0px 10px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 14px; line-height: 1.6; font-weight: normal; text-align: center;\">\n							<a href=\"https://bluhorn.filelogix.com/login/reset/{$email.resetCode}\" class=\"btn-primary\" style=\"margin: 0px 10px 0px 0px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 100%; color: rgb(255, 255, 255); text-decoration: none; background-color: rgb(52, 142, 218); border-style: solid; border-color: rgb(52, 142, 218); border-width: 10px 20px; font-weight: bold; text-align: center; cursor: pointer; display: inline-block; border-top-left-radius: 25px; border-top-right-radius: 25px; border-bottom-right-radius: 25px; border-bottom-left-radius: 25px;\">Reset Your BluHorn&nbsp;Password</a>\n						</p>\n					</td>\n				</tr>\n				</tbody>\n				</table>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					For any immediate questions, please call 1-800-818-7647\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					 or email us at support@bluhorn.com\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					Thanks, and have a great day!\n				</p>\n				<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">\n					<a href=\"http://twitter.com/iwantabuzz\" style=\"margin: 0px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 100%; color: rgb(52, 142, 218);\">Follow @bluhorn on Twitter</a>\n				</p>\n			</td>\n		</tr>\n		</tbody>\n		</table>\n		<!-- /content -->\n	</td>\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n</tr>\n</tbody>\n</table>\n<!-- /body -->\n<!-- footer -->\n<table class=\"footer-wrap\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;clear: both;\">\n<tbody>\n<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n	<td class=\"container\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;display: block;max-width: 600px;clear: both;\">\n		<!-- content -->\n		<p class=\"content\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;max-width: 600px;display: block;\">\n		</p>\n		<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n		<tbody>\n		<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n			<td align=\"center\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n			</td>\n		</tr>\n		</tbody>\n		</table>\n		<!-- /content -->\n	</td>\n	<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n	</td>\n</tr>\n</tbody>\n</table>\n</body>\n</html>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(63,0,'user','2014-09-24 12:34:24','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n	<link href=\"/lib/bootstrap-switch/3.0/css/bootstrap3/bootstrap-switch.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/lib/parsley/2.0.3/parsley.css\" rel=\"stylesheet\" type=\"text/css\">\n\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">User</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>User</h2>\n								<em>Profile</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-10 col-md-12 col-sm-12 col-xs-12\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>User Information</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  id=\"userInfo\" name=\"userProfile\" role=\"form\"  data-parsley-validate >\n\n					<div class=\"form-group\">\n																		<label for=\"agencyName\" class=\"col-sm-4 control-label\">Username</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"username\" id=\"username\" class=\"form-control\"  value=\"{$user.username}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Name</label>\n																		<div class=\"col-sm-4\">\n								<input type=\"text\" name=\"firstName\" id=\"firstName\" class=\"form-control\" value=\"{$user.firstName}\" required {if $readOnly} readonly{/if}>\n						</div>											<div class=\"col-sm-4\">\n								<input type=\"text\" name=\"lastName\" id=\"lastName\" class=\"form-control\" value=\"{$user.lastName}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" name=\"emailAddress\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$user.emailAddress}\" {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" name=\"phoneNumber\" class=\"form-control\" value=\"{$user.phoneNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Current Password?</label>\n																		<div class=\"col-sm-5\">\n								<input type=\"password\" id=\"oldPassword\" name=\"oldPassword\" class=\"form-control\" placeholder=\"Current Password\" data-parsley-minlength=\"6\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">New Password?</label>\n																		<div class=\"col-sm-5\">\n								<input type=\"password\" id=\"password\" name=\"newPassword\" class=\"form-control\" placeholder=\"New Password\" data-parsley-minlength=\"6\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Confirm Password?</label>\n																		<div class=\"col-sm-5\">\n								<input type=\"password\" id=\"confirmPassword\" name=\"confirmPassword\" class=\"form-control\" placeholder=\"\" data-parsley-equalto=\"#password\">\n						</div>\n																	</div>\n\n				       <div class=\"invalid-form-error-message\"></div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-warning validate\" onclick=\"changePassword();\">Change Password</button>\n							</p>\n						</div>\n					</div>\n\n{if ! $readOnly} \n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveUser();\">Save</button>\n							</p>\n						</div>\n					</div>	\n{/if}\n				</form>\n\n		</div>\n\n		<div id=\"user-footer\" class=\"widget-footer\">\n\n		</div>\n\n	</div>\n</div>\n\n</div>\n\n{if $agencies|@count>0}\n<div class=\"row\">\n\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-building-o\"></i> {if $agencies|@count > 1}Agencies{else}Agency{/if}</h3>\n										<em> {$agencies|@count} {if $agencies|@count > 1}Agencies{else}Agency{/if} found.</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n																									<th>User Role</th>\n\n	<th>Agency Name</th>\n													<th>Address</th>\n													<th>Phone Number</th>\n													<th>License</th>\n													<th style=\"text-align: center;\">Active?</th>\n													<th></th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $agencies as $agency}\n												<tr>\n													<td>{if $agency.isAgencyAdmin}Administrator{else}User{/if}</td>\n													<td>{$agency.name}</td>\n													<td>{$agency.address}</td>\n													<td>{$agency.phoneNumber}</td>\n													<td>{$agency.license}</td>\n													<td><center><input type=\"radio\" id=\"agency-{$agency.agencyID}\" data-wrapper-class=\"bootstrap-switch-small\" class=\"switch-small bootstrap-switch-small\" data-radio-all-off name=\"activeAgencyID\" value=\"{$agency.agencyID}\" {if $agency.agencyID == $agencyID}checked{/if}></center></td>\n\n	<td><center><i class=\"fa fa-pencil fa-lg\" ></i></center></td>\n\n	<td><center><i class=\"fa fa-trash-o fa-lg\" ></i></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n{/if}\n\n\n{/block}\n\n{block name=\"scripts\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n	\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/lib/bootstrap-switch/3.0/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/parsley/2.0.3/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/dropzone.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		var activeAgencyID = \"{$agencyID}\";\n\n		$(document).ready(function(){\n\n  $(\'#userInfo\').parsley().subscribe(\'parsley:form:validate\', function (formInstance) {\n\n    // if one of these blocks is not failing do not prevent submission\n    // we use here group validation with option force (validate even non required fields)\n    if (formInstance.isValid(\'block1\', true) || formInstance.isValid(\'block2\', true)) {\n      $(\'.invalid-form-error-message\').html(\'\');\n      return;\n    }\n    // else stop form submission\n    formInstance.submitEvent.preventDefault();\n\n    // and display a gentle message\n    $(\'.invalid-form-error-message\')\n      .html(\"You must correctly fill the fields of at least one of these two blocks!\")\n      .addClass(\"filled\");\n    return;\n  });\n\n			$(\'#phoneNumber\').mask(\'(999) 999-9999? x99999\');\n\n			$(\"[name=\'activeAgencyID\']\").bootstrapSwitch();\n			$(\".bootstrap-switch\").addClass(\"bootstrap-switch-mini\");\n\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				$(\".dropzone\").dropzone({\n					url: \"php/dropzone-upload.php\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'image/*, application/pdf, .txt\',\n					dictResponseError: \'File Upload Error.\'\n				});\n			} // end if dropzone exist\n		});\n\n		$(\"[name=\'activeAgencyID\']\").on(\'switchChange.bootstrapSwitch\', function(event, state) { \n			activeAgency(event.currentTarget.value);\n		 });\n\n//		$(\"[name=\'activeAgencyID\']\").on(\'change\', function(event, state) { \n//			activeAgency(event.currentTarget.value);\n//		 });\n\n		function activeAgency(toAgencyID) {\n			\n			$(\"#user-footer\").html(\"Switching Active Agency...\");\n\n			$.post( \"/user/ajax/agency/active/\" + toAgencyID, function() {\n				$(\"#user-footer\").html(\"Switching to Agency \" + toAgencyID);\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#user-footer\").html(response.message);\n				if (response.error) {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", true);\n				        //$(\"#agency-\" + toAgencyID).prop(\"checked\", false);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',false, true);\n					$(\"#agency-\" + response.agencyID).bootstrapSwitch(\'state\',true, false);\n				}\n				else {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", false);\n				       // $(\"#agency-\" + toAgencyID).prop(\"checked\", true);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',true, true);\n				}\n			})\n			.fail(function(data) {\n				$(\"#user-footer\").html(\"Connection Failed! Not Switched.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n\n\n		function changePassword() {\n			\n			$(\"#userInfo\").parsley().validate();\n\n			return true;\n\n		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(64,0,'user-settings','2014-08-11 08:25:11','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n	<link href=\"/lib/bootstrap-switch/3.0/css/bootstrap3/bootstrap-switch.min.css\" rel=\"stylesheet\" type=\"text/css\">\n\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li>User</li>\n			<li class=\"active\">Settings</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Settings</h2>\n								<em>System Configuration and Options</em>\n							</div>\n\n<div class=\"row\">\n\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-gears\"></i> Settings</h3>\n										<em> </em>\n									</div>\n									<div class=\"widget-content\">\nThere are no settings available to view currently.\n									</div>\n								</div>\n\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/lib/bootstrap-switch/3.0/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/dropzone.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		var activeAgencyID = \"{$agencyID}\";\n\n		$(document).ready(function(){\n	\n			$(\'#phoneNumber\').mask(\'(999) 999-9999? x99999\');\n\n			$(\"[name=\'activeAgencyID\']\").bootstrapSwitch();\n			$(\".bootstrap-switch\").addClass(\"bootstrap-switch-mini\");\n\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				$(\".dropzone\").dropzone({\n					url: \"php/dropzone-upload.php\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'image/*, application/pdf, .txt\',\n					dictResponseError: \'File Upload Error.\'\n				});\n			} // end if dropzone exist\n		});\n\n		$(\"[name=\'activeAgencyID\']\").on(\'switchChange.bootstrapSwitch\', function(event, state) { \n			activeAgency(event.currentTarget.value);\n		 });\n\n//		$(\"[name=\'activeAgencyID\']\").on(\'change\', function(event, state) { \n//			activeAgency(event.currentTarget.value);\n//		 });\n\n		function activeAgency(toAgencyID) {\n			\n			$(\"#user-footer\").html(\"Switching Active Agency...\");\n\n			$.post( \"/user/ajax/agency/active/\" + toAgencyID, function() {\n				$(\"#user-footer\").html(\"Switching to Agency \" + toAgencyID);\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#user-footer\").html(response.message);\n				if (response.error) {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", true);\n				        //$(\"#agency-\" + toAgencyID).prop(\"checked\", false);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',false, true);\n					$(\"#agency-\" + response.agencyID).bootstrapSwitch(\'state\',true, false);\n				}\n				else {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", false);\n				       // $(\"#agency-\" + toAgencyID).prop(\"checked\", true);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',true, true);\n				}\n			})\n			.fail(function(data) {\n				$(\"#user-footer\").html(\"Connection Failed! Not Switched.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(65,0,'admin-inbox','2014-08-11 12:51:27','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li>Admin</li>\n			<li class=\"active\">Inbox</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Inbox</h2>\n								<em> Pending User Requests</em>\n								\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> New User Requests</h3>\n										<em>- <a href=\"/users/create\">Add A New User</a> or <a href=\"/admin/users\">Search Existing</a></em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Name</th>\n													<th>Organization</th>\n													<th>Phone Number</th>\n													<th>Email Address</th>\n													<th>Last Activity</th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n\n{foreach $users as $user}\n												<tr>\n													<td><a href=\"/admin/user/edit/{$user.userID}\">{$user.name}</a></td>\n													<td>{$user.organizationName}</td>\n													<td>{$user.phoneNumber}</td>\n													<td>{$user.emailAddress}</td>\n													<td>{$user.lastModified}</td>\n\n	<td><center><a href=\"/admin/user/edit/{$user.userID}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n	\n												</tr>\n{/foreach}\n												</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(66,0,'admin-user-edit','2014-08-11 13:08:10','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n	<link href=\"/lib/bootstrap-switch/3.0/css/bootstrap3/bootstrap-switch.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/lib/parsley/2.0.3/parsley.css\" rel=\"stylesheet\" type=\"text/css\">\n\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">User</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>User</h2>\n								<em>Profile</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-10 col-md-12 col-sm-12 col-xs-12\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>User Information</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  id=\"userInfo\" name=\"userProfile\" role=\"form\"  data-parsley-validate >\n\n					<div class=\"form-group\">\n																		<label for=\"agencyName\" class=\"col-sm-4 control-label\">Username</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"username\" id=\"username\" class=\"form-control\"  value=\"{$user.username}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Name</label>\n																		<div class=\"col-sm-4\">\n								<input type=\"text\" name=\"firstName\" id=\"firstName\" class=\"form-control\" value=\"{$user.firstName}\" required {if $readOnly} readonly{/if}>\n						</div>											<div class=\"col-sm-4\">\n								<input type=\"text\" name=\"lastName\" id=\"lastName\" class=\"form-control\" value=\"{$user.lastName}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" name=\"emailAddress\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$user.emailAddress}\" {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" name=\"phoneNumber\" class=\"form-control\" value=\"{$user.phoneNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">New Password?</label>\n																		<div class=\"col-sm-5\">\n								<input type=\"password\" id=\"password\" name=\"newPassword\" class=\"form-control\" placeholder=\"New Password\" data-parsley-minlength=\"6\">\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Confirm Password?</label>\n																		<div class=\"col-sm-5\">\n								<input type=\"password\" id=\"confirmPassword\" name=\"confirmPassword\" class=\"form-control\" placeholder=\"\" data-parsley-equalto=\"#password\">\n						</div>\n																	</div>\n\n				       <div class=\"invalid-form-error-message\"></div>\n{if $readOnly} \n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-warning validate\" onclick=\"changePassword();\">Change Password</button>\n							</p>\n						</div>\n					</div>\n\n{else}\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-warning validate\" onclick=\"changePassword();\">Change Password</button>\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveUser();\">Save</button>\n							</p>\n						</div>\n					</div>	\n{/if}\n				</form>\n\n		</div>\n\n		<div id=\"user-footer\" class=\"widget-footer\">\n\n		</div>\n\n	</div>\n</div>\n\n</div>\n\n{if $agencies|@count>0}\n<div class=\"row\">\n\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-building-o\"></i> {if $agencies|@count > 1}Agencies{else}Agency{/if}</h3>\n										<em> {$agencies|@count} {if $agencies|@count > 1}Agencies{else}Agency{/if} found.</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n\n	<th>Agency Name</th>\n													<th>Address</th>\n													<th>Phone Number</th>\n													<th style=\"text-align: center;\">Active?</th>\n													<th style=\"text-align: center;\">Admin?</th>\n													<th style=\"text-align: center;\">Billing?</th>\n													<th></th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $agencies as $agency}\n												<tr>\n													<td>{if $agency.isAgencyAdmin}Administrator{else}User{/if}</td>\n													<td>{$agency.name}</td>\n													<td>{$agency.address}</td>\n													<td>{$agency.phoneNumber}</td>\n													<td><center><input type=\"radio\" id=\"isActive-{$agency.agencyID}\" data-wrapper-class=\"bootstrap-switch-small\" class=\"switch-small bootstrap-switch-small\" data-radio-all-off name=\"isActive[]\" value=\"{$agency.agencyID}\" {if $agency.agencyID == $agencyID}checked{/if}></center></td>\n\n	<td><center><input type=\"radio\" id=\"isAdmin-{$agency.agencyID}\" data-wrapper-class=\"bootstrap-switch-small\" class=\"switch-small bootstrap-switch-small\" data-radio-all-off name=\"isAdmin[]\" value=\"{$agency.agencyID}\" {if $agency.agencyID == $agencyID}checked{/if}></center></td>\n\n	<td><center><input type=\"radio\" id=\"isBilling-{$agency.agencyID}\" data-wrapper-class=\"bootstrap-switch-small\" class=\"switch-small bootstrap-switch-small\" data-radio-all-off name=\"isBilling[]\" value=\"{$agency.agencyID}\" {if $agency.agencyID == $agencyID}checked{/if}></center></td>\n\n	<td><center><i class=\"fa fa-pencil fa-lg\" ></i></center></td>\n\n	<td><center><i class=\"fa fa-trash-o fa-lg\" ></i></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n{/if}\n\n\n{/block}\n\n{block name=\"scripts\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n	\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/lib/bootstrap-switch/3.0/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/parsley/2.0.3/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/dropzone.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		var activeAgencyID = \"{$agencyID}\";\n\n		$(document).ready(function(){\n\n  $(\'#userInfo\').parsley().subscribe(\'parsley:form:validate\', function (formInstance) {\n\n    // if one of these blocks is not failing do not prevent submission\n    // we use here group validation with option force (validate even non required fields)\n    if (formInstance.isValid(\'block1\', true) || formInstance.isValid(\'block2\', true)) {\n      $(\'.invalid-form-error-message\').html(\'\');\n      return;\n    }\n    // else stop form submission\n    formInstance.submitEvent.preventDefault();\n\n    // and display a gentle message\n    $(\'.invalid-form-error-message\')\n      .html(\"You must correctly fill the fields of at least one of these two blocks!\")\n      .addClass(\"filled\");\n    return;\n  });\n\n			$(\'#phoneNumber\').mask(\'(999) 999-9999? x99999\');\n\n			$(\"[name=\'activeAgencyID\']\").bootstrapSwitch();\n			$(\".bootstrap-switch\").addClass(\"bootstrap-switch-mini\");\n\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				$(\".dropzone\").dropzone({\n					url: \"php/dropzone-upload.php\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'image/*, application/pdf, .txt\',\n					dictResponseError: \'File Upload Error.\'\n				});\n			} // end if dropzone exist\n		});\n\n		$(\"[name=\'activeAgencyID\']\").on(\'switchChange.bootstrapSwitch\', function(event, state) { \n			activeAgency(event.currentTarget.value);\n		 });\n\n//		$(\"[name=\'activeAgencyID\']\").on(\'change\', function(event, state) { \n//			activeAgency(event.currentTarget.value);\n//		 });\n\n		function activeAgency(toAgencyID) {\n			\n			$(\"#user-footer\").html(\"Switching Active Agency...\");\n\n			$.post( \"/user/ajax/agency/active/\" + toAgencyID, function() {\n				$(\"#user-footer\").html(\"Switching to Agency \" + toAgencyID);\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#user-footer\").html(response.message);\n				if (response.error) {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", true);\n				        //$(\"#agency-\" + toAgencyID).prop(\"checked\", false);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',false, true);\n					$(\"#agency-\" + response.agencyID).bootstrapSwitch(\'state\',true, false);\n				}\n				else {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", false);\n				       // $(\"#agency-\" + toAgencyID).prop(\"checked\", true);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',true, true);\n				}\n			})\n			.fail(function(data) {\n				$(\"#user-footer\").html(\"Connection Failed! Not Switched.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n\n\n		function changePassword() {\n			\n			$(\"#userInfo\").parsley().validate();\n\n			return true;\n\n		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(67,0,'worksheet-cable-alt-simple','2015-03-19 18:38:33','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-Cable | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 2px 5px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n\n.table td:nth-last-child(n-3)\n{\n\n text-align:center !important;\n}\n\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Cable TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Cable)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet </h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar hidden-xs\">\n<div class=\"control-inline toolbar-item-group \">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-spots\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style-\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} <a href=\"/vendors/edit/{$vendor.id}\">{$vendor.name}</a> {/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:viewSchedule(\'{$worksheet.id}\',12, \'pdf\');\">Show Schedule</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 15, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"margin-top: 20px; overflow-x: hidden; overflow-y: hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"12\">\n												     </form>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order / Worksheet Settings</h3> \n												<div class=\"btn-group widget-header-toolbar hidden-xs\">\n												    <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"Cable\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Vendor(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n 												    </div>\n												    </div>\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printCPPStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printCPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												        <label><input type=\"checkbox\" class=\"toggle-order-col\" name=\"printSummary\"  value=\"1\" {if $order.printSummary}checked{elseif !$order.id}checked{/if}> Show Summary</label><br>\n												      </div>\n												</div>\n												</div>\n												</div>\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n\n												   <div style=\"width: 100%;\"><strong>Show/Hide Columns?</strong><em> (<a href=\"javascript:showAllColumns(20);\">Show All Columns</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"1\" id=\"col-1\" name=\"showLineNumber\" data-name=\"lineNumber\" value=\"1\"> Worksheet Line #</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"2\" id=\"col-2\" name=\"showDaypart\" value=\"1\" data-name=\"daypart\" checked> Daypart </label>\n												        </div>												        <div class=\"col-lg-3\">\n											                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"3\" id=\"col-3\" name=\"showVendor\" value=\"1\" data-name=\"vendor\" checked> Vendor </label>\n												         </div>												        <div class=\"col-lg-3\">												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"4\" id=\"col-4\" name=\"showStation\" value=\"1\" data-name=\"station\" checked> Station </label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"5\" id=\"col-5\" name=\"showZone\" value=\"1\" data-name=\"zone\" checked> Zone </label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"6\" id=\"col-6\" name=\"showTimePeriod\" data-name=\"timePeriod\" value=\"1\" checked> Time Period</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"7\" id=\"col-7\" name=\"showProgramName\" data-name=\"program\"  value=\"1\" checked> Program Name</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"15\" id=\"col-15\" name=\"showLength\"  data-name=\"seconds\" value=\"1\" checked> Length</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"16\" id=\"col-16\" name=\"showRate\"  data-name=\"rate\" value=\"1\" checked> Rate</label>\n												         </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"17\" id=\"col-17\" name=\"showAQH\"  data-name=\"aqh\" value=\"1\" checked> Rating</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"18\" id=\"col-18\" name=\"showCPP\"  data-name=\"cpp\" value=\"1\" checked> CPP</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"19\" id=\"col-19\" name=\"showImpact\" data-name=\"impact\" value=\"1\" checked> Impact</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"20\" id=\"col-20\" name=\"showCPM\" data-name=\"cpm\"  value=\"1\" checked> CPM</label>\n												        </div>\n												      </div>\n												      {counter name=\"colCounter\" start=21 skip=1 assign=\"colCounter\" print=FALSE}\n												      {counter name=\"totalWeeks\" start=21 skip={$weekNames|@count} assign=\"totalWeeks\" print=FALSE}\n												      {counter name=\"weekCounter\" start=1 skip=1 assign=\"weekCounter\" print=FALSE}\n												    </div>\n											         </div>\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n										                   {counter name=\"totalWeeks\"}\n												   <div style=\"width: 100%;\"><strong>Show/Hide Weeks?</strong><em> (<a href=\"javascript:showAllWeeks(21,{$totalWeeks});\">Show All Weeks</a> | <a href=\"javascript:hideAllWeeks(21,{$totalWeeks});\">Hide All Weeks</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												           {foreach $weekNames as $weekName}\n												              <div class=\"col-lg-3\">												                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"{$colCounter}\" id=\"col-{$colCounter}\" data-name=\"week-{$weekName|replace:\' \':\'-\'}\" name=\"showWeek-{$weekCounter}\"  value=\"1\" checked> {$weekName}</label>\n											                         {counter name=\"colCounter\"}\n											                         {counter name=\"weekCounter\"}\n												              </div>\n												           {/foreach}\n												      </div>\n\n												</div>\n\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\"  id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"totalReach\">0.00%</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"totalFreq\">0.00</div></td></tr>												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName} {if $daypart != \"none\"}\n												    <div class=\"summary-daypartName\" id=\"summary-daypart-{$daypartName}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypartName}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-reach-{$daypartName}\">0.00%</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-freq-{$daypartName}\">0.00</div></td></tr>												      </table>\n												    </div>\n\n												    {/if} {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none; with: 95%; overflow: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n\n<div class=\"form\" id=\"worksheet-form\">\n\n<table id=\"worksheet-{$worksheet.id}\" class=\"table table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"daypart\">DP</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"station\">Station</th>\n                <th data-index=\"zone\">Zone</th>\n                <th data-index=\"timePeriod\">Time Period</th>\n                <th data-index=\"programName\">Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th data-index=\"seconds\">Len</th>\n                <th data-index=\"rate\">Rate</th>\n                <th style=\"text-align: center;\" data-index=\"aqhRating\">{$demographic|default:\"Rating\"}</th>\n                <th data-index=\"cpp\">CPP</th>\n                <th data-index=\"impact\">000</th>\n                <th data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n{if $isInlineForm}\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>      \n	         <td><label class=\"sr-only\">{$line.zone}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-zone-{$line.worksheetLine}\" value=\"{$line.zone}\" name=\"zone[]\" data-index=\"zone\" data-name=\"zone\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n\n{elseif $isInlineText}\n\n            <tr >\n		<td></td>\n                <td>{$line.worksheetLine}</td>\n                <td>{$line.daypart}</td>\n                <td>{$line.vendorID}</td>\n                <td>{$line.station}</td>\n                <td>{$line.zone}</td>\n                <td>{$line.timePeriod}</td>\n                <td>{$line.programName}</td>\n                <td>{$line.isMonday}</td>\n                <td>{$line.isTuesday}</td>\n                <td>{$line.isWednesday}</td>\n                <td>{$line.isThursday}</td>\n                <td>{$line.isFriday}</td>\n                <td>{$line.isSaturday}</td>\n                <td>{$line.isSunday}</td>\n                <td>{$line.seconds}</td>\n                <td>{$line.rate}</td>\n                <td>{$line.aqhRating}</td>\n                <td>{$line.cpp}</td>\n                <td>{$line.impact}</td>\n                <td>{$line.cpm}</td>\n                                \n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td>{$weekValue}</td>\n{/foreach}\n                <td>{$line.comments}</td>\n                <td></td>\n                <td></td>\n                <td></td>\n            </tr>\n\n{/if}\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-zone-new\"  name=\"zone[]\" data-index=\"zone\" data-name=\"zone\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-program-new\" value=\"\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\"\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Zone</th>\n                <th>Time Period</th>\n                <th>Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th>{$demographic|default:\"Rating\"}</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n 								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n<div class=\"modal fade\" id=\"reportWait\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Please Wait</h4>\n      </div>\n      <div class=\"modal-body\">\n		<div class=\"progress progress-striped active\">\n		  <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n		  </div>\n		</div>\n		<span class=\"reportStatus\">Creating Report...</span>\n      </div>\n\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n\n\n{/block}\n\n\n	{block name=\"scripts\"}\n		<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n		<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n\n		<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n{*\n		<script type=\"text/javascript\" src=\"/assets/js/king-table.js\"></script>\n*}\n	{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/extensions/FixedHeader/js/dataTables.fixedHeader.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/extensions/ColVis/js/dataTables.colVis.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n	{/block}\n\n\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn-alt.js\"></script>\n\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\nfunction bindKeyEvents() {\n\n$(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\nconsole.log(\"key down\");\nconsole.log($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\'));\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n\n}\n\n$(document).ready(function(){\n	bindKeyEvents();\n});\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n\n\n		$(document).ready(function() {\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n//					  \"scrollY\": \"300px\",\n//      					  \"order\": [{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}],\n     					  \"order\": [ [ 1, \"asc\" ] ],\n{if $isInlineForm}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"160px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isInlineText}\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"160px\", sortable: false, visible: false },\n     { width: \"120px\"},\n     { width: \"120px\", \"searchable\":false},\n     { width: \"120px\"},\n     { width: \"120px\"},\n     { width: \"300px\"},\n     { width: \"100px\"},\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isAjaxSource}\n\n        \"ajax\": \"/cable/ajax/worksheet/{$worksheet.id}\",\n\"columns\": [\n     { \"data\" : null, width: \"120px\", sortable: false },\n     { \"data\": \"lineNumber\", width: \"160px\", sortable: false, visible: false },\n     { \"data\": \"daypart\", width: \"120px\",\"orderDataType\": \"dom-select\" },\n     { \"data\": \"vendor\", width: \"120px\",\"orderDataType\": \"dom-select\", \"searchable\":false},\n     { \"data\": \"station\", width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"zone\", width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"timeOfDay\", width: \"120px\", \"type\":\"numeric\"},\n     { \"data\": \"program\", width: \"160px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"isMonday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isTuesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isWednesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isThursday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isFriday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSaturday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSunday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"length\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"rate\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"aqhRating\", width: \"20px\", sortable: false },\n     { \"data\": \"cpp\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"impact\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"cpm\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { \"data\": \"week.{$week@iteration}\", width: \"20px\", sortable: false },\n{/foreach}\n     { \"data\": \"comments\", width: \"200px\", sortable: false },\n     { \"data\": \"copy\",  width: \"20px\", sortable: false },\n     { \"data\": \"bold\", width: \"20px\", sortable: false },\n     { \"data\": \"delete\", width: \"20px\", sortable: false }\n],\n\n{else}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"160px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"300px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{/if}\n					  \"lengthMenu\": [[10, 25, 50, 100, 200], [10, 25, 50, 100, 200]],\n//					  \"autoWidth\": false,			\n					  \"displayLength\": 10,\n					  //\"deferRender\": true,\n					  \"processing\": true,\n					  \"paginate\": true,\n//					  \"initComplete\": function() { mapDataAttributes(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents();  },\n//					  \"initComplete\": function() { loadWorksheetData(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents(); updateSelectValues();  },\n					  \"initComplete\": function() { $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); },\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n//					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>tS<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n			  } );\n\n    $(\'.toggle-col\').change( function (e) {\n        e.preventDefault();\n \n        // Get the column API object\n        var column = table.column( $(this).attr(\'data-column\') );\n \n        // Toggle the visibility\n        column.visible( ! column.visible() );\n    } );\n\n{*\n\n$(document).ready(function() {\n    var table = $(\'#worksheet-{$worksheet.id}\').DataTable();\n \n    new $.fn.dataTable.FixedHeader( table );\n} );\n \n*}\n\n//			   new $.fn.dataTable.FixedColumns( table );\n\n\n{if $isInline}\n{/if}\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the input boxes in a column, parsed as numbers */\n$.fn.dataTable.ext.order[\'dom-text-numeric\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val() * 1;\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n\n{/literal}\n\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n\n		//reSort();\n\n			$(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { \n				  console.log(\"sort\"); fGetSortInfo(); } );\n			});\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n		\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var savesCounter = 0;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n\n	function calculateLines() {\n			var row=0;\n			$.each(data, function( index, src ) {\n					data[index][\"cpp\"] =  (data[index][\"rate\"] / data[index][\"aqh\"]).toFixed(3); \n					data[index][\"cpm\"] =   ((data[index][\"rate\"]) / (data[index][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	{if $wsLines|@count>0}\n	data = {};	\n		{foreach $wsLines as $line}\n	  		{if $line.worksheetLine > 0} \n	 		 data[\'{$line.worksheetLine}\'] = \n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", timeOfDayStd: \"{$line.timePeriodStd|default:$line.timePeriod}\", station: \"{$line.station}\", zone: \"{$line.zone}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"0\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments|escape:\'javascript\'}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} };\n			{/if}\n		{/foreach}\n	\n	{else}\n		data[\'1\'] = { lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null,  timeOfDayStd: null, station: null, zone: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false };\n\n	{/if}\n\n//	console.log(data);\n\n	var maxRow = {$maxLineNumber};\n\n		data[\'{$maxLineNumber}\'] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\", zone: \"\",   program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	function mapDataAttributes() {\n\n		$.each(data, function( index, src ) {\n			var timeOfDayStd = src.timeOfDay;\n\n			$(\"#field-program-\"+src.lineNumber).closest(\"td\").attr(\"data-order\",src.program);\n			$(\"#field-timeOfDay-\"+src.lineNumber).closest(\"td\").attr(\"data-order\", timeOfDayStd);\n		});\n	}\n\n\n	function loadWorksheetData() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n\n				{if $filter == 1}\n					if (data[src.lineNumber][\"lineSpendTotal\"] > 0) {\n						addRow(src.lineNumber);	\n\n						console.log(\"Added \" + src.lineNumber + \" = \" + data[src.lineNumber][\"lineSpendTotal\"]);\n\n						$(\"#worksheet-footer\").html(\"Line \" + src.lineNumber + \" added!\");\n					}\n					else {\n						console.log(\"Skipped \" + src.lineNumber);\n					}\n				{else}\n\n						addRow(src.lineNumber);\n						\n						$(\"#worksheet-footer\").html(\"Line \" + src.lineNumber + \" added!\");\n		\n				{/if}\n			}\n		});\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.draw();\n\n//		console.log(\"Datatable loaded\");\n/*\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n\n				}\n		});\n\n*/\n	}\n\n\n	function updateSelectValues() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n			}\n		});\n	}\n\n	$( document ).ready(function() {\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n\n});\n\n			$(document).ready(function(){\n\n		$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n\n			savesCounter++;\n\n			$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n			$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n\n			$.post( \"/cable/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n\n				savesCounter--;\n\n				$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n		\n				if (savesCounter < 1) {\n					savesCounter = 0;\n					$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n					$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n				}\n\n			})\n			.fail(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n\n				savesCounter--;\n\n			})\n			.error(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n\n				savesCounter--;\n\n			})\n		    }\n		}\n	    }\n	} \n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		if (dt) {\n			dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"] {if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n			dt.draw();\n		\n			$(\"#worksheet-footer\").html(\"Sorted!\");\n		}\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/cable/ajax/lines/remove/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/cable/ajax/line/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/cable/ajax/line/add/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/cable/ajax/lines/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/cable/edit/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/cable/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		$(\"#createOrderButtonDropDown\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/cable/ajax/delete/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\");\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\",  zone: \"\", program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue.trim();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue.trim()]];\n		}\n\n		else if (fieldName == \"zone\") {\n			newValue = $(field).val();\n			data[row][\"zone\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				newValue = 0;\n			}\n			if (newValue >= 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"-\", EM:\"EM\", DA:\"DA\", EF:\"EF\", EN:\"EN\", PA:\"PA\", PR:\"PR\", LF:\"LF\", LN:\"LN\", OV:\"OV\", SP:\"SP\", RO:\"RO\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n				var totalReach = ((1 - Math.pow( 1 - (totalGRPs / totalSpots / 100),totalSpots)) * .85 * 100);\n				$(\'#daypart-reach-\'+daypart).html(totalReach.toFixed(2) + \"%\");\n				$(\'#daypart-freq-\'+daypart).html((totalGRPs / totalReach).toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$0.00\");\n			}	\n		}\n\n	  }\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		console.log(data);\n		console.log(\"Add New Line: \" + maxRow);\n		console.log(data[maxRow-1]);\n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[maxRow-1][\"daypart\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name|escape:\'javascript\'}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\" selected\');\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"zone\"]+\'\" id=\"field-zone-\'+maxLineNumber+\'\"  name=\"zone[]\" data-index=\"zone\" data-name=\"zone\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], timeOfDayStd: data[maxRow-1][\"timeOfDayStd\"], station: data[maxRow-1][\"station\"], zone: data[maxRow-1][\"zone\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n\n	function addRow(line) {\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		lineNumber = line;\n\n		if(data[lineNumber][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[lineNumber][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[lineNumber][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[lineNumber][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[lineNumber][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[lineNumber][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[lineNumber][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[lineNumber][\"daypart\"]+\'\"\', \'value=\"\'+data[lineNumber][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name|escape:\'javascript\'}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[lineNumber][\"vendorID\"]+\'\"\', \'value=\"\'+data[lineNumber][\"vendorID\"]+\'\" selected\');\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+lineNumber+\'\" name=\"worksheetLine[]\">\'+data[lineNumber][\"lineNumber\"]+\'</td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+lineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+lineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\" onload=\"$(this).val(\'+data[lineNumber][\"vendorID\"]+\');\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td data-order=\"\'+data[lineNumber][\"station\"]+\'\"><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[lineNumber][\"station\"]+\'\" id=\"field-station-\'+lineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td data-order=\"\'+data[lineNumber][\"zone\"]+\'\"><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[lineNumber][\"zone\"]+\'\" id=\"field-zone-\'+lineNumber+\'\"  name=\"zone[]\" data-index=\"zone\" data-name=\"zone\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td ><input type=hidden value=\"\'+data[lineNumber][\"timeOfDayStd\"]+\'\" ><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+lineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+lineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+lineNumber+\'\" data-name=\"wed\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+lineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+lineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+lineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+lineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+lineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+lineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+lineNumber+\'\"\" value=\"\'+data[lineNumber][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpm\"]+\'\" id=\"field-cpm-\'+lineNumber+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+lineNumber+\'-{$weekCounter}\"  value=\"\'+data[lineNumber][\"week\"][{$weekCounter}]+\'\" name=\"week\'+lineNumber+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+lineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+lineNumber+\'\" size=40  value=\"\'+data[lineNumber][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+lineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+lineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+lineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]);\n		\n		$(\'#field-daypart-\'+lineNumber).val(data[lineNumber][\"vendorID\"]);\n		$(\'#field-daypart-\'+lineNumber).val(data[lineNumber][\"daypart\"]);\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n    	$(\'.toggle-col\').change(function(box) {\n            var colName = $(this).data(\"name\");\n    	    if ($(this).is(\':checked\')) {\n//		console.log(\"Box is checked\");\n		saveCols(colName, 1);\n	    }\n            else {\n//		console.log(\"Box is unchecked\");\n		saveCols(colName, 0);\n	    }\n    	});\n\n	loadWorksheetData(); \n	bindKeyEvents();\n	checkCols();\n\n});\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-zone-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n\n// toggle function\n$.fn.clickToggle = function( f1, f2 ) {\n	return this.each( function() {\n		var clicked = false;\n		$(this).bind(\'click\', function() {\n			if(clicked) {\n				clicked = false;\n				return f2.apply(this, arguments);\n			}\n\n			clicked = true;\n			return f1.apply(this, arguments);\n		});\n	});\n\n}\n\nfunction showAllColumns(maxCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\n \nfor ( var i=2 ; i<=maxCol ; i++ ) {\n    table.column( i ).visible( true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction showAllWeeks(startCol, endCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\nfor ( var i=startCol ; i<cols[0].length; i++ ) {\n    table.column( i ).visible(true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\n\nfunction hideAllWeeks(startCol, endCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\nfor ( var i=startCol ; i <= endCol; i++ ) {\n    table.column( i ).visible(false, false );\n    $(\"#col-\"+i).prop(\"checked\", false);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction checkCols() {\n\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\n\nfor ( var i=0 ; i<cols[0].length; i++ ) {\n    if (table.column( i ).visible()) {\n	    $(\"#col-\"+i).prop(\"checked\", true);\n    }\n    else {\n	    $(\"#col-\"+i).prop(\"checked\", false); \n    }\n}\n\n}\n\n\n\n\n		function viewSchedule(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/schedule/pdf\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to display schedule at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n		function exportWorksheet(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/worksheet/csv\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to export worksheet at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n$(document).ready(function () {\n\n    	$(\'.toggle-col\').change(function(box) {\n            var colName = $(this).data(\"name\");\n    	    if ($(this).is(\':checked\')) {\n//		console.log(\"Box is checked\");\n		saveCols(colName, 0);\n	    }\n            else {\n//		console.log(\"Box is unchecked\");\n		saveCols(colName, 1);\n	    }\n    	});\n});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/cable/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/cable/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/cable/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n\nfunction hideRows() {\n\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar rows = table.rows();\n\nconsole.log(rows.length);\nconsole.log(data[1][\"lineSpendTotal\"]);\n\ntable\n    .row( 1 )\n    .nodes()\n    .to$()      // Convert to a jQuery object\n    .addClass( \'hidden\' );\n    \ntable.draw();\n}\n\nfunction showRows() {\n\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar rows = table.rows();\n\nconsole.log(rows.length);\nconsole.log(data[1][\"lineSpendTotal\"]);\n\ntable\n    .row( 1 )\n    .nodes()\n    .to$()      // Convert to a jQuery object\n    .removeClass( \'hidden\' );\n \ntable.draw();\n\n}\n\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(68,0,'worksheet-radio-alt-simple','2015-03-19 17:16:15','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-Radio | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 2px 5px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n\n.table td:nth-last-child(n-3)\n{\n\n text-align:center !important;\n}\n\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Radio</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Radio)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet </h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar hidden-xs\">\n<div class=\"control-inline toolbar-item-group \">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} {$vendor.name} {/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:viewSchedule(\'{$worksheet.id}\',13, \'pdf\');\">Show Schedule</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 16, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"margin-top: 20px; overflow-x: hidden; overflow-y: hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"13\">\n												     </form>\n												</div>\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3> \n												<div class=\"btn-group widget-header-toolbar\">\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"Radio\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Vendor(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												        <label><input type=\"checkbox\" name=\"printSummary\"  value=\"1\" {if $order.printSummary}checked{elseif !$order.id}checked{/if}> Show Summary</label><br>\n												      </div>\n\n												</div>\n												</div>\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n\n												   <div style=\"width: 100%;\"><strong>Show/Hide Columns?</strong><em> (<a href=\"javascript:showAllColumns(20);\">Show All Columns</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"1\" id=\"col-1\" name=\"showLineNumber\" data-name=\"lineNumber\" value=\"1\"> Worksheet Line #</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"2\" id=\"col-2\" name=\"showDaypart\" value=\"1\" data-name=\"daypart\" checked> Daypart </label>\n												        </div>												        <div class=\"col-lg-3\">\n											                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"3\" id=\"col-3\" name=\"showVendor\" value=\"1\" data-name=\"vendor\" checked> Vendor </label>\n												         </div>												        <div class=\"col-lg-3\">												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"4\" id=\"col-4\" name=\"showStation\" value=\"1\" data-name=\"station\" checked> Station </label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"5\" id=\"col-5\" name=\"showTimePeriod\" data-name=\"timePeriod\" value=\"1\" checked> Time Period</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"6\" id=\"col-6\" name=\"showProgramName\" data-name=\"program\"  value=\"1\" checked> Program Name</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"14\" id=\"col-14\" name=\"showLength\"  data-name=\"seconds\" value=\"1\" checked> Length</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"15\" id=\"col-15\" name=\"showRate\"  data-name=\"rate\" value=\"1\" checked> Rate</label>\n												         </div>\n												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"17\" id=\"col-17\" name=\"showCume\"  data-name=\"cume\" value=\"1\" checked> Cume</label>\n												        </div>\n												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"16\" id=\"col-16\" name=\"showAQH\"  data-name=\"aqh\" value=\"1\" checked> AQH</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"18\" id=\"col-18\" name=\"showCPP\"  data-name=\"cpp\" value=\"1\" checked> CPP</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"19\" id=\"col-19\" name=\"showImpact\" data-name=\"impact\" value=\"1\" checked> Impact</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"20\" id=\"col-20\" name=\"showCPM\" data-name=\"cpm\"  value=\"1\" checked> CPM</label>\n												        </div>\n												      </div>\n												      {counter name=\"colCounter\" start=21 skip=1 assign=\"colCounter\" print=FALSE}\n												      {counter name=\"totalWeeks\" start=20 skip={$weekNames|@count} assign=\"totalWeeks\" print=FALSE}\n												      {counter name=\"weekCounter\" start=1 skip=1 assign=\"weekCounter\" print=FALSE}\n												    </div>\n											         </div>\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   {counter name=\"totalWeeks\"}\n												   <div style=\"width: 100%;\"><strong>Show/Hide Weeks?</strong><em> (<a href=\"javascript:showAllWeeks(21,{$totalWeeks});\">Show All Weeks</a> | <a href=\"javascript:hideAllWeeks(21,{$totalWeeks});\">Hide All Weeks</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												           {foreach $weekNames as $weekName}\n												              <div class=\"col-lg-3\">												                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"{$colCounter}\" id=\"col-{$colCounter}\" name=\"showWeek-{$weekCounter}\"  value=\"1\" checked> {$weekName}</label>\n											                         {counter name=\"colCounter\"}\n											                         {counter name=\"weekCounter\"}\n												              </div>\n												           {/foreach}\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\"  id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"totalReach\">0.00%</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"totalFreq\">0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName} {if $daypart != \"none\"}\n												    <div class=\"summary-daypartName\" id=\"summary-daypart-{$daypartName}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypartName}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-reach-{$daypartName}\">0.00%</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-freq-{$daypartName}\">0.00</div></td></tr>												      </table>\n												    </div>\n\n												    {/if} {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none; with: 95%; overflow: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n\n<div class=\"form\" id=\"worksheet-form\">\n\n<table id=\"worksheet-{$worksheet.id}\" class=\"table table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"daypart\">DP</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"station\">Station</th>\n                <th data-index=\"timePeriod\">Time Period</th>\n                <th data-index=\"programName\">Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th data-index=\"seconds\">Len</th>\n                <th data-index=\"rate\">Rate</th>\n                <th data-index=\"aqhRating\">AQH RTG</th>\n                <th data-index=\"cume\">Cume</th>\n                <th data-index=\"cpp\">CPP</th>\n                <th data-index=\"impact\">000</th>\n                <th data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n{if $isInlineForm}\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>      \n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName|escape:\'html\'}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cume}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-cume-{$line.worksheetLine}\" value=\"{$line.cume}\" size=\"4\" name=\"aqh[]\" data-index=\"cume\" data-name=\"cume\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n\n{elseif $isInlineText}\n\n            <tr >\n		<td></td>\n                <td>{$line.worksheetLine}</td>\n                <td>{$line.daypart}</td>\n                <td>{$line.vendorID}</td>\n                <td>{$line.station}</td>\n                <td>{$line.zone}</td>\n                <td>{$line.timePeriod}</td>\n                <td>{$line.programName}</td>\n                <td>{$line.isMonday}</td>\n                <td>{$line.isTuesday}</td>\n                <td>{$line.isWednesday}</td>\n                <td>{$line.isThursday}</td>\n                <td>{$line.isFriday}</td>\n                <td>{$line.isSaturday}</td>\n                <td>{$line.isSunday}</td>\n                <td>{$line.seconds}</td>\n                <td>{$line.rate}</td>\n                <td>{$line.aqhRating}</td>\n                <td>{$line.cume}</td>\n                <td>{$line.cpp}</td>\n                <td>{$line.impact}</td>\n                <td>{$line.cpm}</td>\n                                \n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td>{$weekValue}</td>\n{/foreach}\n                <td>{$line.comments}</td>\n                <td></td>\n                <td></td>\n                <td></td>\n            </tr>\n\n{/if}\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-program-new\" value=\"\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-cume-new\" value=\"\" size=\"4\" name=\"cume[]\" data-index=\"cume\" data-name=\"cume\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\"\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Time Period</th>\n                <th>Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th>AQH RTG</th>\n                <th>Cume</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n 								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n<div class=\"modal fade\" id=\"reportWait\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Please Wait</h4>\n      </div>\n      <div class=\"modal-body\">\n		<div class=\"progress progress-striped active\">\n		  <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n		  </div>\n		</div>\n		<span class=\"reportStatus\">Creating Report...</span>\n      </div>\n\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n\n\n\n{/block}\n\n\n	{block name=\"scripts\"}\n		<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n		<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n\n		<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n{*\n		<script type=\"text/javascript\" src=\"/assets/js/king-table.js\"></script>\n*}\n	{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n	{/block}\n\n\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn-alt.js\"></script>\n\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\nfunction bindKeyEvents() {\n\n$(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\nconsole.log(\"key down\");\nconsole.log($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\'));\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n\n}\n\n$(document).ready(function(){\n	bindKeyEvents();\n});\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n\n\n		$(document).ready(function() {\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n//      					  \"order\": [{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}],\n     					  \"order\": [ [ 1, \"asc\" ] ],\n{if $isInlineForm}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isInlineText}\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\"},\n     { width: \"120px\", \"searchable\":false},\n     { width: \"120px\"},\n     { width: \"300px\"},\n     { width: \"100px\"},\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isAjaxSource}\n\n        \"ajax\": \"/radio/ajax/worksheet/{$worksheet.id}\",\n\"columns\": [\n     { \"data\" : null, width: \"120px\", sortable: false },\n     { \"data\": \"worksheetLine\", width: \"120px\", sortable: false, visible: false },\n     { \"data\": \"daypart\", width: \"120px\",\"orderDataType\": \"dom-select\" },\n     { \"data\": \"vendor\", width: \"120px\",\"orderDataType\": \"dom-select\", \"searchable\":false},\n     { \"data\": \"station\", width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"timeOfDay\", width: \"120px\", \"type\":\"numeric\"},\n     { \"data\": \"program\", width: \"160px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"isMonday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isTuesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isWednesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isThursday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isFriday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSaturday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSunday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"length\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"rate\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"aqhRating\", width: \"20px\", sortable: false },\n     { \"data\": \"cume\", width: \"20px\", sortable: false },\n     { \"data\": \"cpp\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"impact\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"cpm\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { \"data\": \"week.{$week@iteration}\", width: \"20px\", sortable: false },\n{/foreach}\n     { \"data\": \"comments\", width: \"200px\", sortable: false },\n     { \"data\": \"copy\",  width: \"20px\", sortable: false },\n     { \"data\": \"bold\", width: \"20px\", sortable: false },\n     { \"data\": \"delete\", width: \"20px\", sortable: false }\n],\n\n{else}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"300px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{/if}\n					  \"lengthMenu\": [[10, 25, 50, 100, 200], [10, 25, 50, 100, 200]],\n//					  \"autoWidth\": false,			\n					  \"displayLength\": 10,\n					  //\"deferRender\": true,\n					  \"processing\": true,\n					  \"paginate\": true,\n//					  \"initComplete\": function() { mapDataAttributes(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents();  },\n//					  \"initComplete\": function() { loadWorksheetData(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents(); updateSelectValues();  },\n					  \"initComplete\": function() { $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); },\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n		}\n\n\n			  } );\n\n    $(\'.toggle-col\').change( function (e) {\n        e.preventDefault();\n \n        // Get the column API object\n        var column = table.column( $(this).attr(\'data-column\') );\n \n        // Toggle the visibility\n        column.visible( ! column.visible() );\n    } );\n\n\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n\n{if $isInline}\n{/if}\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the input boxes in a column, parsed as numbers */\n$.fn.dataTable.ext.order[\'dom-text-numeric\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val() * 1;\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n\n{/literal}\n\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n\n		//reSort();\n\n			$(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { \n				  console.log(\"sort\"); fGetSortInfo(); } );\n			});\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n		\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var savesCounter = 0;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n\n	function calculateLines() {\n			var row=0;\n			$.each(data, function( index, src ) {\n					data[index][\"cpp\"] =  (data[index][\"rate\"] / data[index][\"aqh\"]).toFixed(3); \n					data[index][\"cpm\"] =   ((data[index][\"rate\"]) / (data[index][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	{if $wsLines|@count>0}\n	data = {};	\n		{foreach $wsLines as $line}\n	  		{if $line.worksheetLine > 0} \n	 		 data[\'{$line.worksheetLine}\'] = \n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", timeOfDayStd: \"{$line.timePeriodStd|default:$line.timePeriod}\", station: \"{$line.station}\", cume: \"{$line.cume}\",  program: \"{$line.programName|escape:\'javascript\'}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"0\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments|escape:\'javascript\'}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} };\n			{/if}\n		{/foreach}\n	\n	{else}\n		data[\'1\'] = { lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null,  timeOfDayStd: null, station: null, cume: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, delete: false };\n\n	{/if}\n\n//	console.log(data);\n\n	var maxRow = {$maxLineNumber};\n\n		data[\'{$maxLineNumber}\'] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\", cume: \"\",   program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	function mapDataAttributes() {\n\n		$.each(data, function( index, src ) {\n			var timeOfDayStd = src.timeOfDay;\n\n			$(\"#field-program-\"+src.lineNumber).closest(\"td\").attr(\"data-order\",src.program);\n			$(\"#field-timeOfDay-\"+src.lineNumber).closest(\"td\").attr(\"data-order\", timeOfDayStd);\n		});\n	}\n\n\n	function loadWorksheetData() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				addRow(src.lineNumber);\n					\n				$(\"#worksheet-footer\").html(\"Line \" + src.lineNumber + \" added!\");\n\n				}\n		});\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.draw();\n\n//		console.log(\"Datatable loaded\");\n/*\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n\n				}\n		});\n\n*/\n	}\n\n\n	function updateSelectValues() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n			}\n		});\n	}\n\n	$( document ).ready(function() {\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n\n});\n\n			$(document).ready(function(){\n\n		$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n\n			savesCounter++;\n\n			$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n			$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n\n			$.post( \"/radio/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n\n				savesCounter--;\n\n				$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n		\n				if (savesCounter < 1) {\n					savesCounter = 0;\n					$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n					$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n				}\n\n			})\n			.fail(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n\n				savesCounter--;\n\n			})\n			.error(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n\n				savesCounter--;\n\n			})\n		    }\n		}\n	    }\n	} \n\n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		if (dt) {\n			dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"] {if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n			dt.draw();\n		\n			$(\"#worksheet-footer\").html(\"Sorted!\");\n		}\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/radio/ajax/lines/remove/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/radio/ajax/line/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/radio/ajax/line/add/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines(gotoURL) {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/radio/ajax/lines/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					if (typeof gotoURL === \"undefined\") {\n						window.location.href=\"/radio/edit/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\";\n					}\n					else {\n						window.location.href=gotoURL;\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/radio/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines(\"/worksheet/edit/{$worksheetID}\");\n		// window.location=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		$(\"#createOrderButtonDropDown\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/radio/ajax/delete/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\");\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\",  cume: \"\", program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue.trim();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue.trim()]];\n		}\n\n		else if (fieldName == \"cume\") {\n			newValue = $(field).val();\n			data[row][\"cume\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				newValue = 0;\n			}\n			if (newValue >= 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"-\", AM:\"AM\", MD:\"MD\", PM:\"PM\", EV:\"EV\", WE:\"WE\", RO:\"RO\", OV: \"OV\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n				var totalReach = ((1 - Math.pow( 1 - (totalGRPs / totalSpots / 100),totalSpots)) * .85 * 100);\n				$(\'#daypart-reach-\'+daypart).html(totalReach.toFixed(2) + \"%\");\n				$(\'#daypart-freq-\'+daypart).html((totalGRPs / totalReach).toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$0.00\");\n			}	\n		}\n\n	  }\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		console.log(data);\n		console.log(\"Add New Line: \" + maxRow);\n		console.log(data[maxRow-1]);\n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[maxRow-1][\"daypart\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name|escape:\'javascript\'}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\" selected\');\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-cume-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cume\"]+\'\" size=\"4\" name=\"cume[]\" data-index=\"cume\" data-name=\"cume\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], timeOfDayStd: data[maxRow-1][\"timeOfDayStd\"], station: data[maxRow-1][\"station\"], cume: data[maxRow-1][\"cume\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n\n	function addRow(line) {\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		lineNumber = line;\n\n		if(data[lineNumber][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[lineNumber][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[lineNumber][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[lineNumber][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[lineNumber][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[lineNumber][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[lineNumber][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[lineNumber][\"daypart\"]+\'\"\', \'value=\"\'+data[lineNumber][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name|escape:\'javascript\'}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[lineNumber][\"vendorID\"]+\'\"\', \'value=\"\'+data[lineNumber][\"vendorID\"]+\'\" selected\');\n\n		console.log(data[lineNumber][\"program\"]);\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+lineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+lineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+lineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\" onload=\"$(this).val(\'+data[lineNumber][\"vendorID\"]+\');\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td data-order=\"\'+data[lineNumber][\"station\"]+\'\"><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[lineNumber][\"station\"]+\'\" id=\"field-station-\'+lineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td ><input type=hidden value=\"\'+data[lineNumber][\"timeOfDayStd\"]+\'\" ><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+lineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+lineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+lineNumber+\'\" data-name=\"wed\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+lineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+lineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+lineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+lineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+lineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-cume-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cume\"]+\'\" size=\"4\" name=\"cume[]\" data-index=\"cume\" data-name=\"cume\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+lineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+lineNumber+\'\"\" value=\"\'+data[lineNumber][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpm\"]+\'\" id=\"field-cpm-\'+lineNumber+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+lineNumber+\'-{$weekCounter}\"  value=\"\'+data[lineNumber][\"week\"][{$weekCounter}]+\'\" name=\"week\'+lineNumber+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+lineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+lineNumber+\'\" size=40  value=\"\'+data[lineNumber][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+lineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+lineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+lineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]);\n		\n		$(\'#field-vendorID-\'+lineNumber).val(data[lineNumber][\"vendorID\"]);\n		$(\'#field-daypart-\'+lineNumber).val(data[lineNumber][\"daypart\"]);	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n	loadWorksheetData(); \n	bindKeyEvents();\n	checkCols();\n\n});\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-cume-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n\n// toggle function\n$.fn.clickToggle = function( f1, f2 ) {\n	return this.each( function() {\n		var clicked = false;\n		$(this).bind(\'click\', function() {\n			if(clicked) {\n				clicked = false;\n				return f2.apply(this, arguments);\n			}\n\n			clicked = true;\n			return f1.apply(this, arguments);\n		});\n	});\n\n}\n\nfunction showAllColumns(maxCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\n \nfor ( var i=2 ; i<=maxCol ; i++ ) {\n    table.column( i ).visible( true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\n\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction showAllWeeks(startCol, endCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\nfor ( var i=startCol ; i<cols[0].length; i++ ) {\n    table.column( i ).visible(true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction hideAllWeeks(startCol, endCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\nfor ( var i=startCol ; i <= endCol; i++ ) {\n    table.column( i ).visible(false, false );\n    $(\"#col-\"+i).prop(\"checked\", false);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction checkCols() {\n\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\n\nfor ( var i=0 ; i<cols[0].length; i++ ) {\n    if (table.column( i ).visible()) {\n	    $(\"#col-\"+i).prop(\"checked\", true);\n    }\n    else {\n	    $(\"#col-\"+i).prop(\"checked\", false); \n    }\n}\n\n}\n\n		function viewSchedule(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/schedule/pdf\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to display schedule at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n		function exportWorksheet(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/worksheet/csv\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to export worksheet at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n	$(document).ready(function () {\n	\n	    	$(\'.toggle-col\').change(function(box) {\n	            var colName = $(this).data(\"name\");\n	    	    if ($(this).is(\':checked\')) {\n	//		console.log(\"Box is checked\");\n			saveCols(colName, 0);\n		    }\n	            else {\n	//		console.log(\"Box is unchecked\");\n			saveCols(colName, 1);\n		    }\n	    	});\n	});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/radio/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/radio/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/radio/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(69,0,'admin-agencies','2015-03-06 01:33:49','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li>Admin</li>\n			<li class=\"active\">Agencies</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Agencies</h2>\n								<em>All Agencies</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-building-o\"></i> Agencies</h3>\n										<em>- <a href=\"/admin/agency/create\">Add A New Agency</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>ID</th>\n													<th>Agency Name</th>\n													<th>Address</th>\n													<th>Phone #</th>\n													<th>Status</th>\n													<th>Plan</th>\n													<th>Term</th>\n													<th>Cmpgn/Wksht</th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n\n{foreach $agencies as $agency}\n												<tr>\n													<td><a href=\"/admin/agency/edit/{$agency.id}\">{$agency.id}</a></td>\n													<td>{$agency.name}</td>\n													<td>{$agency.address|truncate:30}</td>\n													<td>{$agency.phoneNumber}</td>\n													<td>{$agency.status}</td>\n													<td>{$agency.rate}</td>\n\n	<td>{$agency.term}</td>\n													<td>{$agency.campaignCount} / {$agency.worksheetCount}</td>\n\n	<td><center><a href=\"/admin/agency/edit/{$agency.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n	\n												</tr>\n{/foreach}\n												</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(70,0,'admin-agency-edit','2014-09-03 13:47:16','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li>Admin</li>\n			<li class=\"active\">Agency</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Agency</h2>\n								<em>Summary</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Agency Information</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  id=\"agency-form\" name=\"agencyInfo\" role=\"form\" data-parsley-validate novalidate >\n			\n					<input type=\"hidden\" name=\"agencyID\" value=\"{$agency.id}\">\n\n					<div class=\"form-group\">\n																		<label for=\"agencyName\" class=\"col-sm-4 control-label\">Agency Name</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"agencyName\" id=\"agencyName\" class=\"form-control\"  value=\"{$agency.name}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" id=\"contactName\" class=\"form-control\" value=\"{$agency.contactName}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" name=\"emailAddress\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$agency.emailAddress}\" {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\"  name=\"address\" id=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\" {if $readOnly} readonly{/if}>{$agency.address}</textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" name=\"phoneNumber\" class=\"form-control\" value=\"{$agency.phoneNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\" name=\"faxNumber\" class=\"form-control\" value=\"{$agency.faxNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"website\" class=\"col-sm-4 control-label\">Website</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"url\" id=\"website\" name=\"website\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$agency.emailAddress}\" {if $readOnly} readonly{/if}> \n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Default Comments</p>\n							<textarea id=\"textarea\" name=\"comments\" id=\"comments\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: vertical;\" {if $readOnly} readonly{/if}>{$agency.comments}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n{if ! $readOnly} \n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveAgency();\">Save</button>\n							</p>\n						</div>\n					</div>	\n{/if}\n			</form>\n					<div class=\"panel panel-default\">\n 						 <div class=\"panel-heading\">Payment & Credit Card Info</div>\n						 <div class=\"panel-body\">\n						\n							{include file=\"db:stripe-payment-form\"}\n\n						</div>\n					</div>\n\n		</div>\n\n		<div class=\"widget-footer\" id=\"agency-footer\">\n		</div>\n\n	</div>\n</div>\n\n{if $user.isAgencyAdmin} \n	<div class=\"col-lg-6\">\n\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-cloud-upload\"></i> Upload Logos & Other Media</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n										<form class=\"dropzone\" enctype=\"multipart/form-data\"></form>\n									</div>\n								</div>\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-image-o\"></i> Agency Logos & Media</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n\n									</div>\n								</div>\n	</div>\n\n</div>\n\n<div class=\"row\">\n\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n								<div class=\"widget\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-credit-card\"></i> Licenses & Subscriptions</h3>\n										<div class=\"btn-group widget-header-toolbar\">											<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\n											</div>									</div>\n									<div class=\"widget-content\">\n\n									</div>\n								</div>\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3></i>Add A New User</h3>\n				<div class=\"btn-group widget-header-toolbar\">					<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>\n				</div>\n			</div>\n			<div class=\"widget-content\" style=\"display:none;\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"addUser\" name=\"addUser\" role=\"form\">\n\n							<div class=\"form-group\">\n																				<label for=\"userRole\" class=\"col-sm-4 control-label\">Role</label>\n																				<div class=\"col-sm-8\">\n									<select class=\"form-control input\" name=\"userRole\">\n										\n										<option value=\"agency-user\">Agency User</option>\n										<option value=\"agency-admin\">Agency Admin</option>\n\n									</select>\n	\n								</div>\n																			</div>\n		\n							<div class=\"form-group\">\n																				<label for=\"addUserFirstName\" class=\"col-sm-4 control-label\">First Name</label>\n																				<div class=\"col-sm-8\">\n																					<input type=\"text\" id=\"addUserFirstName\" name=\"addUserFirstName\" class=\"form-control\">\n	\n								</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																					<label for=\"addUserLastName\" class=\"col-sm-4 control-label\">Last Name</label>\n																					<div class=\"col-sm-8\">\n										<input type=\"text\" id=\"addUserLastName\" name=\"addUserLastName\" class=\"form-control\" required>\n									</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"addUserEmailAddress\" class=\"col-sm-4 control-label\">Email Address</label>\n																				<div class=\"col-sm-8\">\n									<input type=\"text\" id=\"addUserEmailAddress\" name=\"addUserEmailAddress\" class=\"form-control\" required>\n								</div>\n																			</div>\n																			<div class=\"form-group\">\n																				<label for=\"addUserPhone\" class=\"col-sm-4 control-label\">Phone Number\n																				<br>\n																				<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addUserPhone\" name=\"addUserPhone\" class=\"form-control\">\n																				</div>\n																			</div>\n\n						<form>\n\n					</div>\n\n							<div class=\"form-group\">\n								<div class=\"col-sm-12\">\n									<p class=\"pull-right\">\n										<button type=\"button\" class=\"btn btn-success\" onclick=\"addMarket();\">Invite User</button>\n									</p>\n								</div>\n							</div>\n				</div>\n\n			</div>\n\n		</div>\n\n	</div>\n\n</div>\n{/if}\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Authorized Users</h3>\n										<em> </em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Role</th>\n													<th>First Name</th>\n													<th>Last Name</th>\n													<th>Email Address</th>\n													<th>Last Login</th>\n													<th>Status</th>\n													<th></th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $agencyUsers as $agencyUser}\n												<tr>\n													<td>{if $agencyUser.isAgencyAdmin}Admin{else}User{/if}</td>\n													<td>{$agencyUser.firstName}</td>\n													<td>{$agencyUser.lastName}</td>\n													<td>{$agencyUser.emailAddress}</td>\n													<td>{$agencyUser.lastLogin}</td>\n													<td>{$agencyUser.status}</td>\n\n{if $agencyUser.isAgencyAdmin} \n	<td><center><a href=\"/user/edit/{$agencyUser.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n	<td><center><a href=\"/user/delete/{$agencyUser.id}\"><i class=\"fa fa-trash-o fa-lg\" ></i></a></center></td>\n{else}\n	<td><center><i class=\"fa fa-pencil fa-lg\" ></i></center></td>\n\n	<td><center><i class=\"fa fa-trash-o fa-lg\" ></i></center></td>\n{/if}\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n\n</div>\n</div>\n<div class=\"row\">\n<div class=\"col-lg-6 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-institution\"></i> Invoices</h3>\n										<em> </em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>#</th>\n													<th>Date</th>\n													<th>Amount</th>\n													<th>Balance</th>\n													<th>Due Date</th>\n													<th>Status</th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $invoices as $invoice}\n												<tr>\n													<td>{$invoice.id}</td>\n													<td>{$invoice.date}</td>\n													<td>{$invoice.amount}</td>\n													<td>{$invoice.balance}</td>\n													<td>{$invoice.due}</td>\n													<td>{$invoice.status}</td>\n\n	<td><center><a href=\"/admin/invoice/edit/{$invoice.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n\n</div>\n\n<div class=\"row\">\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-umbrella\"></i> Subscription</h3>\n										<em> </em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>Plan</th>\n													<th>Description</th>\n													<th>Start Date</th>\n													<th>Renewal Date</th>\n													<th>Licenses</th>\n													<th>Rate/Period</th>\n													<th>Status</th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $plans as $plan}\n												<tr>\n													<td>{$plan.name}</td>\n													<td>{$plan.description}</td>\n													<td>{$plan.startDate}</td>\n													<td>{$plan.renewalDate}</td>\n													<td>{$plan.licenses}</td>\n													<td>{$plan.rate} / {$plan.period}</td>\n													<td>{$plan.status}</td>\n\n	<td><center><a href=\"/admin/subscription/edit/{$plan.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/dropzone.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/lib/bootstrap-validator/js/bootstrapValidator.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n        <script type=\"text/javascript\" src=\"https://js.stripe.com/v2/\"></script>\n\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				$(\".dropzone\").dropzone({\n					url: \"php/dropzone-upload.php\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'image/*, application/pdf, .txt\',\n					dictResponseError: \'File Upload Error.\'\n				});\n			} // end if dropzone exist\n\n\n            var select = $(\"#exp-year\"),\n            year = new Date().getFullYear();\n \n            for (var i = 0; i < 12; i++) {\n                select.append($(\"<option value=\'\"+(i + year)+\"\' \"+(i === 0 ? \"selected\" : \"\")+\">\"+(i + year)+\"</option>\"))\n            }\n	    select.val(\"Year\");\n\n  // This identifies your website in the createToken call below\n    Stripe.setPublishableKey(\'{$stripeKey|default:\"pk_test_YEGSIbAArH5vGBkDqlkf0AYo\"}\');\n 	  	   \n\n    var stripeResponseHandler = function(status, response) {\n      var $form = $(\'#payment-form\');\n \n      if (response.error) {\n        // Show the errors on the form\n//	console.log(\"Stripe Error: \" + response.error.message);\n//	console.log(response);\n        $(\'#payment-error\').html(response.error.message);\n        $(\'#payment-error\').show();\n        $form.find(\'button\').prop(\'disabled\', false);\n      } else {\n        $(\'#payment-error\').hide();\n        // token contains id, last4, and card type\n        var token = response.id;\n        // Insert the token into the form so it gets submitted to the server\n        $(\"agency-form\").append($(\'<input type=\"hidden\" name=\"stripeToken\" />\').val(token));\n	$(\"#cvv\").val(\"\")\n	var cardNumber = $(\"#card-number\").val();\n	$(\"#card-number\").val(cardNumber.replace(/\\d/g, \"*\").substr(0,cardNumber.length-4) + cardNumber.substr(cardNumber.length - 4));\n//console.log(\"Stripe: \" + token);\n//console.log(response);\n        // and re-submit\n//        $form.get(0).submit();\n	updateCard(token);\n      }\n    };\n \n    jQuery(function($) {\n      $(\'#payment-form\').submit(function(e) {\n        var $form = $(this);\n \n\n        // Disable the submit button to prevent repeated clicks\n        $form.find(\'button\').prop(\'disabled\', true);\n \n        Stripe.createToken($form, stripeResponseHandler);\n\n        // Prevent the form from submitting with the default action\n        return false;\n      });\n    });\n\n\n    $(\'#payment-form\').bootstrapValidator({\n        feedbackIcons: {\n            valid: \'glyphicon glyphicon-ok\',\n            invalid: \'glyphicon glyphicon-remove\',\n            validating: \'glyphicon glyphicon-refresh\'\n        },\n        submitButtons: \'button[type=\"submit\"]\',\n	threshold: 5,\n        fields: {\n	    cardholdername: {\n		threshold: 6,\n                validators: {\n                    notEmpty: {\n                        message: \'The card holder name is required and can\\\'t be empty\'\n                    },\n					stringLength: {\n                        min: 6,\n                        max: 70,\n                        message: \'The card holder name must be more than 6 and less than 70 characters long\'\n                    }\n                }\n            },\n            ccNumber: {\n		selector: \'[data-stripe=\"number\"]\',\n                validators: {\n                    creditCard: {\n                        message: \'The credit card number is not valid\'\n                    },\n                    notEmpty: {\n                        message: \'The credit card number is required\'\n                    }\n                }\n            },\n            cvvNumber: {\n		selector: \'[data-stripe=\"cvc\"]\',\n                validators: {\n                    cvv: {\n                        creditCardField: \'ccNumber\',\n                        message: \'The CVV number is not valid\'\n                    }, \n                    notEmpty: {\n                        message: \'The CVV number is required\'\n                    }\n                }\n            },\n	    expMonth: {\n                selector: \'[data-stripe=\"exp-month\"]\',\n		feedbackIcons: false,\n                validators: {\n                    notEmpty: {\n                        message: \'The expiration month is required\'\n                    },\n                    digits: {\n                        message: \'The expiration month can contain digits only\'\n                    },\n                    callback: {\n                        message: \'Expired\',\n                        callback: function(value, validator) {\n                            value = parseInt(value, 10);\n                            var year         = validator.getFieldElements(\'expYear\').val(),\n                                currentMonth = new Date().getMonth() + 1,\n                                currentYear  = new Date().getFullYear();\n                            if (value < 0 || value > 12) {\n                                return false;\n                            }\n                            if (year == \'\') {\n                                return true;\n                            }\n                            year = parseInt(year, 10);\n                            if (year > currentYear || (year == currentYear && value > currentMonth)) {\n                                validator.updateStatus(\'expYear\', \'VALID\');\n                                return true;\n                            } else {\n                                return false;\n                            }\n                        }\n                    }\n                }\n            },\n            expYear: {\n                selector: \'[data-stripe=\"exp-year\"]\',\n		feedbackIcons: false,\n                validators: {\n                    notEmpty: {\n                        message: \'The expiration year is required\'\n                    },\n                    digits: {\n                        message: \'The expiration year can contain digits only\'\n                    },\n                    callback: {\n                        message: \'Expired\',\n                        callback: function(value, validator) {\n                            value = parseInt(value, 10);\n                            var month        = validator.getFieldElements(\'expMonth\').val(),\n                                currentMonth = new Date().getMonth() + 1,\n                                currentYear  = new Date().getFullYear();\n                            if (value < currentYear || value > currentYear + 100) {\n                                return false;\n                            }\n                            if (month == \'\') {\n                                return false;\n                            }\n                            month = parseInt(month, 10);\n                            if (value > currentYear || (value == currentYear && month > currentMonth)) {\n                                validator.updateStatus(\'expMonth\', \'VALID\');\n                                return true;\n                            } else {\n                                return false;\n                            }\n                        }\n                    }\n                }\n            },\n        }\n    });\n\n		});\n\n\n		function saveAgency() {\n			\n			$(\"#agency-footer\").html(\"Saving.\");\n\n			$.post( \"/admin/ajax/agency/save/{$agency.id}\", $( \"#agency-form\" ).serialize(), function() {\n				$(\"#agency-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#agency-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#agency-name-help\").show();\n\n				}\n				else {\n					$(\"#agency-name\").removeClass(\"has-error error\");\n					$(\"#agency-name-help\").hide();\n				}\n				$(\"#breadcrumb-agency-name\").html($(\"#agency-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#agency-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#agency-footer\").html(\"Error!\");\n			})\n		}\n\n		function updateCard(token) {\n			\n			$(\"#agency-footer\").html(\"Saving.\");\n\n			$.post( \"/admin/ajax/agency/update/cc/{$agency.id}\", { \"token\": token }, function() {\n				$(\"#agency-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#agency-footer\").html(response.message);\n				if (response.error) {\n\n				}\n				else {\n\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#agency-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#agency-footer\").html(\"Error!\");\n			})\n		}\n\n	</script>\n\n\n<script type=\"text/javascript\">\n\n</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(71,0,'user-add','2014-05-15 14:39:49','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"agency\">Agency</a></li>\n			<li class=\"active\">User</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Agency</h2>\n								<em>User Information</em>\n							</div>\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>User Information</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n					<div class=\"control-inline toolbar-item-group\">\n																		<span class=\"control-title\"><i class=\"fa fa-users\"></i>Active?</span>\n								\n						<input type=\"checkbox\" id=\"userActive\" checked class=\"switch-demo switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >					</div>\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n\n				<form class=\"form-horizontal label-left\" role=\"form\">\n\n							<div class=\"form-group\">\n																				<label for=\"userRole\" class=\"col-sm-4 control-label\">Role</label>\n																				<div class=\"col-sm-8\">\n									<select class=\"form-control input\" name=\"userRole\">\n										\n										<option value=\"agency-user\">Agency User</option>\n										<option value=\"agency-admin\">Agency Admin</option>\n\n									</select>\n	\n								</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"addUserFirstName\" class=\"col-sm-4 control-label\">First Name</label>\n																				<div class=\"col-sm-8\">\n																					<input type=\"text\" id=\"addUserFirstName\" name=\"addUserFirstName\" class=\"form-control\">\n	\n								</div>\n																			</div>\n	\n							<div class=\"form-group\">\n																					<label for=\"addUserLastName\" class=\"col-sm-4 control-label\">Last Name</label>\n																					<div class=\"col-sm-8\">\n										<input type=\"text\" id=\"addUserLastName\" name=\"addUserLastName\" class=\"form-control\" required>\n									</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"addUserEmailAddress\" class=\"col-sm-4 control-label\">Email Address</label>\n																				<div class=\"col-sm-8\">\n									<input type=\"text\" id=\"addUserEmailAddress\" name=\"addUserEmailAddress\" class=\"form-control\" required>\n								</div>\n																			</div>\n																			<div class=\"form-group\">\n																				<label for=\"addUserPhone\" class=\"col-sm-4 control-label\">Phone Number\n																				<br>\n																				<small>(999) 999-9999</small>\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"text\" id=\"addUserPhone\" name=\"addUserPhone\" class=\"form-control\">\n																				</div>\n																			</div>\n\n							<div class=\"form-group\">\n																				<label for=\"password\" class=\"col-sm-4 control-label\">Password\n											\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"password\" id=\"password\" name=\"password\" class=\"form-control\">\n																				</div>\n																			</div>\n							<div class=\"form-group\">\n																				<label for=\"confirm\" class=\"col-sm-4 control-label\">Confirm\n\n																				</label>\n																				<div class=\"col-sm-4 pull-left\">\n																					<input type=\"password\" id=\"confirm\" name=\"confirm\" class=\"form-control\">\n																				</div>\n																			</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"saveUser();\">Save</button>\n								<button type=\"button\" class=\"btn btn-danger\" onclick=\"deleteUser();\">Delete</button>\n							</p>\n						</div>\n					</div>		\n															</form>\n\n		</div>\n\n		<div class=\"widget-footer\">\n			Not Saved\n		</div>\n\n	</div>\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#addUserPhone\').mask(\'(999) 999-9999\');\n			$(\'#userActive\').bootstrapSwitch();\n\n		});\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(72,0,'stripe-payment-form','2014-08-28 12:29:16','','<div class=\"container\">\n  <div class=\"alert alert-danger\" role=\"alert\" id=\"payment-error\" style=\"display: none;\"></div>\n  <form class=\"form-horizontal\" id=\"payment-form\" role=\"form\" autocomplete=\"off\" onsubmit=\"javascript: return false;\" method=\"post\">\n    <fieldset>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"card-holder-name\">Name on Card</label>\n        <div class=\"col-sm-9\">\n          <input type=\"text\" class=\"form-control\" name=\"cardholdername\" id=\"card-holder-name\" placeholder=\"Card Holder\'s Name\" value=\"{$cardHolderName}\" >\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"card-number\">Card Number</label>\n        <div class=\"col-sm-9\">\n          <input type=\"text\" class=\"form-control\" data-stripe=\"number\" id=\"card-number\" placeholder=\"Debit/Credit Card Number\" value=\"{$ccNumber}\" data-bv-stringlength-min=\"8\">\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"expiry-month\">Expiration Date</label>\n        <div class=\"col-sm-9\">\n          <div class=\"row\">\n            <div class=\"col-xs-3\">\n              <select class=\"form-control col-sm-2\" data-stripe=\"exp-month\" id=\"expiry-month\">\n                <option selected>Month</option>\n                <option value=\"01\">Jan (01)</option>\n                <option value=\"02\">Feb (02)</option>\n                <option value=\"03\">Mar (03)</option>\n                <option value=\"04\">Apr (04)</option>\n                <option value=\"05\">May (05)</option>\n                <option value=\"06\">June (06)</option>\n                <option value=\"07\">July (07)</option>\n                <option value=\"08\">Aug (08)</option>\n                <option value=\"09\">Sep (09)</option>\n                <option value=\"10\">Oct (10)</option>\n                <option value=\"11\">Nov (11)</option>\n                <option value=\"12\">Dec (12)</option>\n              </select>\n            </div> \n            <div class=\"col-xs-3\"> \n              <select class=\"form-control\" data-stripe=\"exp-year\" id=\"exp-year\">\n                <option selected>Year</option>\n\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"cvv\">Card CVV</label>\n        <div class=\"col-sm-3\">\n          <input type=\"text\" class=\"form-control\" id=\"cvv\" data-stripe=\"cvc\" size=\"6\" placeholder=\"CVV Code\" data-bv-stringlength-min=\"1\">\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <div class=\"pull-right\">\n          <button type=\"submit\" class=\"btn btn-primary\" id=\"updateCard\">Update Credit Card</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n</div>\n\n\n\n\n\n ','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(73,0,'orders','2014-10-18 10:31:26','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Orders</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Orders</h2>\n								<em>List of {$listType|default:\"All\"} Orders</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-gavel\"></i>{$listType} Orders</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n																								\n	<th>Client</th>\n\n	<th>Campaign</th>\n\n	<th>Worksheet</th>\n	\n	<th>Contract / Revision</th>\n													<th>Flight Start</th>\n													<th>Flight End</th>\n													<th>Spots</th>\n													<th>Amount</th>\n													<th>Status</th>\n\n	<th></th>\n\n												</tr>\n											</thead>\n											<tbody>\n{foreach $orders as $order}\n												<tr>\n													<td><a href=\"/clients/edit/{$order.clientID}\">{$order.clientName}</a></td>\n													<td><a href=\"/campaigns/edit/{$order.campaignID}\">{$order.campaignName}</a></td>\n													<td><a href=\"/{$order.type|lower}/edit/{$order.worksheetID}\">{$order.worksheetName}</a></td>\n													<td>{$order.contractNumber|default:\"-\"} / {$order.revision}</td>\n													<td>{$order.flightStart}</td>\n\n	<td>{$order.flightEnd}</td>\n													<td>{$order.totalSpots}</td>		\n													<td>{$order.orderAmount}</td>		\n													<td>{$order.status|default:\"Ordered\"}</td>		\n\n	<td><a href=\"/orders/show/{$order.worksheetID}/pdf?orderKey={$order.orderKey}\" style=\"a { color: #333;}\"><i class=\"fa fa-file-pdf-o fa-lg\" ></i></a></td>\n																									</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\">\n\n\n\n		function copyBox(campaignID) {\n			 \n			var campaignIDStr = \"\'\"+campaignID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Client-</option><option>-This Client-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyCampaign(\"+campaignID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Campaign to: \' + worksheets);\n\n	  	}\n\n		function copyCampaign(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/campaigns/ajax/copy/campaignID\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#campaign-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n  		}\n\n		function deleteCampaign(campaignID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/campaigns/ajax/delete/\"+campaignID, null, function() {\n						$(\"#campaign-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var campaignDataTable = $(\'#campaigns\').dataTable();\n							campaignDataTable.fnDeleteRow(  wsDataTable.$(\'#campaign-\'+campaignID)[0] );\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	</script>\n	\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(74,0,'worksheets','2014-09-20 16:51:00','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Worksheets</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Worksheets</h2>\n								<em>List of {$listType|default:\"All\"} Worksheets</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-table\"></i>{$listType} Worksheets</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n																								\n	<th>Client</th>\n\n	<th>Campaign</th>\n\n	<th>Type</th>\n\n	<th>Worksheet</th>\n	\n	<th>Job Number</th>\n													<th>Flight Start</th>\n													<th>Flight End</th>\n													<th>Spots</th>\n													<th>Amount</th>\n													<th>Status</th>\n\n	<th></th>\n\n												</tr>\n											</thead>\n											<tbody>\n{foreach $worksheets as $worksheet}\n												<tr>\n													<td><a href=\"/clients/edit/{$worksheet.clientID}\">{$worksheet.clientName}</a></td>\n													<td><a href=\"/campaigns/edit/{$worksheet.campaignID}\">{$worksheet.campaignName}</a></td>\n													<td><a href=\"/{$worksheet.worksheetType}/edit/{$worksheet.worksheetID}\">{$worksheet.type}</a></td>\n													<td><a href=\"/{$worksheet.worksheetType}/edit/{$worksheet.worksheetID}\">{$worksheet.worksheetName}</a></td>\n													<td>{$worksheet.jobNumber}</td>\n													<td>{$worksheet.flightStart}</td>\n\n	<td>{$worksheet.flightEnd}</td>\n													<td>{$worksheet.totalSpots}</td>		\n													<td>{$worksheet.totalSpend}</td>		\n													<td>{if $worksheet.isOrdered > 0}{if $worksheet.isCancelled}Cancelled{else}Ordered{/if}{else}{$worksheet.status|default:\"Active\"}{/if}</td>		\n\n	<td><a href=\"/{$worksheet.worksheetType}/edit/{$worksheet.worksheetID}\" style=\"a { color: #333;}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></td>\n																									</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\">\n\n\n\n		function copyBox(campaignID) {\n			 \n			var campaignIDStr = \"\'\"+campaignID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Client-</option><option>-This Client-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyCampaign(\"+campaignID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Campaign to: \' + worksheets);\n\n	  	}\n\n		function copyCampaign(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/campaigns/ajax/copy/campaignID\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#campaign-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n  		}\n\n		function deleteCampaign(campaignID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/campaigns/ajax/delete/\"+campaignID, null, function() {\n						$(\"#campaign-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n							$(\"#campaign-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var campaignDataTable = $(\'#campaigns\').dataTable();\n							campaignDataTable.fnDeleteRow(  wsDataTable.$(\'#campaign-\'+campaignID)[0] );\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n	</script>\n	\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(75,0,'worksheet-create','2014-09-02 13:29:36','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n{/block}\n\n{block name=\"header-css\"}\n   \n<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n<style>\n\n.form-control .select2-choice {\n    border: 0;\n    border-radius: 2px;\n}\n\n.form-control .select2-choice .select2-arrow {\n    border-radius: 0 2px 2px 0;   \n}\n\n.form-control.select2-container {\n    height: auto !important;\n    padding: 0px;\n}\n\n.form-control.select2-container.select2-dropdown-open {\n    border-color: #5897FB;\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control .select2-container.select2-dropdown-open .select2-choices {\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control.select2-container .select2-choices {\n    border: 0 !important;\n    border-radius: 3px;\n}\n</style>\n\n<style>\n\n.dropdown-menu {\n	border: 1px solid #555;\n	padding-bottom: 10px;\n}\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"\">Worksheet</li>\n			<li class=\"active\">Add</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Worksheet</h2>\n								<em>Create A New Worksheet</em>\n							</div>\n<div class=\"col-lg-12 col-sm-12 col-md-10\">\n\n		<div class=\"widget widget-table\" style=\"overflow: visible;\">\n			<div class=\"widget-header\">\n				<h3><i class=\"fa fa-table\"></i>Create Worksheet</h3>\n			</div>\n			<div class=\"widget-content\">\n				<div class=\"row\">\n					<div class=\"col-sm-10 col-md-10 col-lg-8\">\n						<form class=\"form-horizontal label-left\"  id=\"addWorksheet\" name=\"addWorksheet\" role=\"form\">\n\n<div  id=\"worksheet-alert-success\" class=\"alert alert-success alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> <span id=\"worksheet-alert-success-message\"></span>\n</div>\n\n<div id=\"worksheet-alert-error\" class=\"alert alert-danger alert-dismissable\" style=\"display: none;\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Whoa!</strong> <span id=\"worksheet-alert-error-message\"></span>\n</div>\n\n				<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n				<input type=\"hidden\" id=\"useBroadcastWeeks\" name=\"useBroadcastWeeks\" value=\"1\">\n				<input type=\"hidden\" id=\"isAutoComm\" name=\"isAutoComm\">\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Client</label>\n																		<div class=\"col-sm-10 col-lg-8 col-md-10\" >\n\n								<select name=\"clientID\" id=\"client-select\" style=\"width: 100%;\">\n									{foreach $clients as $client} \n																					<option value=\"{$client.id}\" {if $client.id == $campaign.clientID}selected{/if}>{$client.name}</option>\n\n									{/foreach}\n\n								</select>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Campaign</label>\n																		<div class=\"col-sm-10 col-lg-8 col-md-10\" >\n\n								<select name=\"campaignID\" id=\"campaign-select\" style=\"width: 100%;\">\n									{foreach $campaigns as $campaign} \n																					<option value=\"{$campaign.id}\" {if $campaign.id == $campaign.ID}selected{/if}>{$campaign.name}</option>\n\n									{/foreach}\n\n								</select>\n						</div>\n																	</div>\n							<div class=\"form-group\" id=\"worksheet-name\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Worksheet Name</label>\n																				<div class=\"col-sm-6\">\n										<input type=\"text\" name=\"worksheetName\" id=\"worksheetName\" value=\"{$worksheet.name}\" class=\"form-control\" required>\n										<span id=\"worksheet-name-help\" class=\"help-block text-danger\" style=\"display: none;\">Worksheet Name Already Exists!</span>								</div>\n																			</div>\n		\n							<div class=\"form-group\">\n																				<label for=\"text-input\" class=\"col-sm-4 control-label\">Market Type</label>\n																				<div class=\"col-sm-6\">\n\n								<select id=\"marketType\" name=\"rated\" class=\"form-control\">\n																					<option value=\"unrated\" selected>Unrated</option>\n	\n									<option value=\"rated\" disabled>Rated</option>\n	\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor Type</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"marketTypes\" name=\"marketType\" class=\"form-control\">\n\n									{foreach $marketTypes as $marketType}\n										<option value=\"{$marketType.id}\" {if $marketType.isDisabled}disabled{/if}>{$marketType.description}</option>\n									{/foreach}\n									\n								</select>\n\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Market</label>\n																			<div class=\"col-sm-6\">\n\n								<select id=\"markets\" name=\"market\" class=\"form-control\">\n									{foreach $markets as $market}										<option value=\"{$market.name}\">{$market.name}</option>\n									{/foreach}\n									<option value=\"\"></option>\n\n								</select>\n	\n							</div>\n																		</div>\n\n						<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Vendor(s)</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"vendors\" name=\"vendors\" class=\"multiselect\" multiple=\"multiple\" style=\"width: 100%;\">\n									{foreach $vendors as $vendor}										<option value=\"{$vendor.id}\">{$vendor.name}</option>\n									{/foreach}\n																					<option value=\"0\">Other</option>\n\n								</select>\n	\n							</div>\n\n						</div>\n\n						<div id=\"vendorReps\">\n												\n\n						</div>\n				\n						<div id=\"grpGoal\">\n\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\">Total GRP Goal</label>\n\n							<div class=\"col-sm-2 col-md-3 col-lg-2\">\n																				<input type=\"text\" id=\"grpGoal\" name=\"grpGoal\" class=\"form-control\">\n																			</div>\n\n												\n						     </div>\n\n						</div>\n\n						<div id=\"demoPrimary\">\n\n						    <div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\"> Primary Demographic</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"demographics-primary\" name=\"demographic[]\" class=\"form-control\">\n									<option value=\"\"></option>\n									{foreach $demographics as $demo}										<option value=\"{$demo.id}\">{if $demo.description}{$demo.description}{else}{$demo.gender} {$demo.ageFrom}{if $demo.ageTo == 0}+{else} - {$demo.ageTo}{/if}{/if}</option>\n									{/foreach}\n										<option value=\"\">None</option>\n								</select>\n	\n							</div>\n\n						    </div>\n\n						</div>\n\n						<div id=\"demoSecondary\">\n\n						    <div class=\"form-group\" >\n																			<label for=\"text-input\" class=\"col-sm-4 control-label\"> Secondary Demographic</label>\n																			<div class=\"col-sm-6 col-md-6 col-lg-6\">\n\n								<select id=\"demographics-secondary\" name=\"demographic[]\" class=\"form-control\">\n									<option value=\"\"></option>\n									{foreach $demographics as $demo}										<option value=\"{$demo.id}\">{if $demo.description}{$demo.description}{else}{$demo.gender} {$demo.ageFrom}{if $demo.ageTo == 0}+{else} - {$demo.ageTo}{/if}{/if}</option>\n									{/foreach}\n										<option value=\"\">None</option>\n								</select>\n	\n							</div>\n\n						    </div>\n\n						</div>\n\n					<div class=\"form-group\" >\n							<label for=\"commission\" class=\"col-sm-4 control-label\"> Commission</label>																					<div class=\"col-xs-4 col-sm-3 col-md-2 col-lg-2\">\n											<input type=\"text\" id=\"worksheetCommission\" name=\"commission\" value=\"{$campaign.commission}\" class=\"form-control\">\n									</div>	\n									<div class=\"col-xs-4 col-sm-4 col-md-4 col-lg-2\" id=\"autoCommGroup\">											<input type=\"checkbox\" id=\"autoComm\" name=\"autoComm\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Auto\" data-off-label=\"Man\" checked >\n									</div>\n																	</div>\n\n					<div class=\"form-group\" id=\"broadcastWeeksGroup\">\n																		<label for=\"broadcastWeeks\" class=\"col-sm-4 control-label\">Use Broadcast Weeks?</label>\n																		<div class=\"col-sm-2 col-md-3 col-lg-2\">\n																			<input type=\"checkbox\" id=\"broadcastWeeks\" name=\"broadcastWeeks\"  class=\"switch\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\"  checked>\n						</div>\n																	</div>\n				<div class=\"form-group\">\n							<div class=\"col-sm-12 col-md-12 col-lg-12\">\n								<div class=\"pull-right\">\n									<button type=\"button\" class=\"btn btn-success\" onclick=\"createWorksheet();\">Add Worksheet</button>\n								</div>\n							</div>\n						</div>				\n				</div>\n							\n					</div>\n\n\n			</div>\n\n			<div id=\"addWorksheet-footer\" class=\"widget-footer\">\n			\n			</div>\n		</div>\n\n\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-datepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/daterangepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/moment.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script>\n\n		function getVendors(marketType, market) {\n\n			$.post( \"/vendors/ajax/search/marketandtype/\" + marketType + \"/\" + encodeURI(market) ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Searching For Vendors...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n//					$(\"#\"+response.field).addClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").show();\n				}\n				else {\n//					$(\"#worksheet-name\").removeClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").hide();\n				        $(\'#vendors\').select2(\"val\", \"\").on(\"select2-removed\", function(vendorRep) { removeVendorRep(vendorRep.val) });\n				        var select = $(\'#vendors\').empty();\n					  $.each(response.vendors, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n					\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function removeVendorRep(vendorID) {\n			$(\'#vendor-\'+vendorID).remove();\n			$(\'#vendorReps-\'+vendorID).remove();\n		}\n\n		function getVendorReps(vendorID, marketName) {\n\n			$.post( \"/vendors/ajax/search/reps/\" + vendorID+ \"/\" + encodeURI(marketName) ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Searching For Vendor Reps...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n\n				}\n				else {\n\n				        //$(\'#vendorReps-\'+vendorID).select2(\"val\", \"\");\n				        var select = $(\'#vendorReps-\'+vendorID).select2();\n					  $.each(response.vendorReps, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.contactName\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n		function getDemographics(marketType, marketTypes) {\n\n			$.post( \"/demographics/ajax/search/\"+marketType+\"/\" + marketTypes + \"/\" + \"?PHPSESSID={$sessionID}\" ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Loading Demographics...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n//					$(\"#\"+response.field).addClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").show();\n				}\n				else {\n//					$(\"#worksheet-name\").removeClass(\"has-error error\");\n//					$(\"#worksheet-name-help\").hide();\n\n//				        $(\'#demographics-primary\').select2(\"val\", \"\");\n				        var select = $(\'#demographics-primary\').empty();\n					 select.append( \'<option value=\"\"></option>\' ); \n					 $.each(response.demographics, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                          			      + item.id\n                            			      + \'\">\'\n                          			      + item.description\n                            			      + \'</option>\' ); \n   				          });\n				        var select = $(\'#demographics-secondary\').empty();\n					 select.append( \'<option value=\"\"></option>\' ); \n					 $.each(response.demographics, function(i,item) {\n	    					 select.append( \'<option value=\"\'\n                          			      + item.id\n                            			      + \'\">\'\n                          			      + item.description\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n\n		$(document).ready(function(){\n\n			$(\"#client-select\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n			$(\"#campaign-select\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n			$(\"#broadcastWeeks\").change(function () {\n			    broadcastWeeks();\n			}); \n\n			$(\"#autoComm\").change(function () {\n			    autoComm();\n			}); 	\n\n			$(\"#client-select\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n			$(\"#campaign-form\").change(function () {\n			    resetFooter(); \n			}); \n\n			$(\"#campaignActive\").change(function () {\n			    resetFooter();\n			   campaignActive(); \n			}); \n\n			$(\"#markets\").change(function () {\n				getVendors(\"{$worksheet.typeID}\", $(\"#markets\").val());\n				$(\"#vendorReps\").html(\"\");\n			}); \n\n\n			$(\"#marketTypes\").change(function () {\n				$(\"#vendorReps\").html(\"\");\n				getDemographics($(\"#marketType\").val(), $(\"#marketTypes\").val());\n				getVendors($(\"#marketTypes\").val(), $(\"#markets\").val());\n				updateWorksheetFields($(\"#marketTypes\").val());\n			}); \n\n			$(\"#vendors\").select2({\n			    placeholder: \"Search Vendors\",\n			    allowClear: true\n			});\n\n			$(\"#vendors\").change(function () {\n			   refreshVendorReps(); \n			}); \n\n			{foreach $marketReps as $marketRep}\n				$(\"#vendorReps-{$marketRep.vendorID}\").select2({\n				    allowClear: true\n				});				\n				$(\"#vendorReps-{$marketRep.vendorID}\").select2(\"val\",\"{$marketRep.id}\");\n			{/foreach}\n\n			$(\"#vendors\").select2(\"val\", [ {foreach $wsVendors as $vendor} \"{$vendor.id}\"{if ! $vendor@last},{/if} {/foreach}] ).on(\"select2-removed\", function(vendorRep) { removeVendorRep(vendorRep.val)});\n\n			{foreach $vendors as $vendor} \n			{/foreach}\n		});\n\n		$(\'#campaignActive\').bootstrapSwitch();\n		$(\'#broadcastWeeks\').bootstrapSwitch();\n		$(\'#autoComm\').bootstrapSwitch();\n\n		$(\"#markets\").val(\"{$market}\");\n		//getVendors(\"{$worksheet.typeID}\", \"{$market.name}\");\n		{if $vendorType.isDemographics >= 1}\n			//getDemographics(\"unrated\", \"{$worksheet.typeID}\");\n			$(\"#demographics-primary\").val(\"{$demographics[0][\"id\"]}\");\n			$(\"#demographics-secondary\").val(\"{$demographics[1][\"id\"]}\");\n		{/if}\n	</script>\n\n	<script>\n\n\n		function createWorksheet() {\n\n			$(\"#addWorksheet-footer\").html(\"Saving.\");\n\n			$.post( \"/worksheets/ajax/add/\", $( \"#addWorksheet\" ).serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#worksheet-name-help\").html(\'\');\n					$(\"#worksheet-name-help\").show();\n				}\n				else {\n					$(\"#worksheet-name\").removeClass(\"has-error error\");\n					$(\"#worksheet-name-help\").hide();\n					var newRow = $(\'#worksheets\').dataTable().fnAddData( [\"<a href=\'\"+response.newWorksheet.type+\"/edit/\"+response.newWorksheet.id+\"\' style=\'a { color: #333;}\'>\"+response.newWorksheet.id+\"</a>\",\"<a href=\'\"+response.newWorksheet.type+\"/edit/\"+response.newWorksheet.id+\"\' style=\'a { color: #333;}\'>\"+response.newWorksheet.name+\"</a>\",response.newWorksheet.vendorType,\"\",\"\",\"\",\"\",\"\", \"<a href=\'\"+response.newWorksheet.type+\"/edit/\" + response.newWorksheet.id + \"\' style=\'a { color: #333;}\'><i class=\'fa fa-pencil fa-lg\'></i></a>\",  \"<a href=\'javascript:copyBox(\" + response.newWorksheet.id + \");\' style=\'a { color: #333;}\'><i class=\'fa fa-copy fa-lg\'></i></a>\",\"<a href=\'javascript:deleteWorksheet(\" + response.newWorksheet.id + \");\' style=\'a { color: #333;}\'><i class=\'fa fa-trash-o fa-lg\'></i></a>\"] );\n	\n					var wsDataTable = $(\'#worksheets\').dataTable();\n					var newRowTR = wsDataTable.fnSettings().aoData[ newRow[0] ].nTr;\n					newRowTR.setAttribute(\"id\", \"worksheet-\" + response.newWorksheet.id);\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#addWorksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#addWorksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n		function resetFooter() {\n				$(\"#campaign-footer\").html(\"Not Saved\");\n		}\n\n		function campaignActive() {\n\n			if ($(\"#campaignActive\").is(\":checked\")) {\n				$(\"#campaign-active\").val(\"1\");\n			}\n			else {\n				$(\"#campaign-active\").val(\"0\");\n			}\n		}\n\n		function getDateRange(datepicker, fromField, toField) {\n\n			$(fromField).val($(\'#flightRange\').data(\'daterangepicker\').startDate.format(\'YYYY-MM-DD\'));\n			$(toField).val($(\'#flightRange\').data(\'daterangepicker\').endDate.format(\'YYYY-MM-DD\'));\n						\n		}\n\n		function saveCampaign() {\n\n			getDateRange(\"#flightRange\", \"#flightStart\", \"#flightEnd\");\n			\n			$(\"#campaign-footer\").html(\"Saving.\");\n\n			campaignActive();\n\n			$.post( \"/campaigns/ajax/save/{$campaign.id}\", $( \"#campaign-form\" ).serialize(), function() {\n				$(\"#campaign-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#campaign-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#campaign-name-help\").show();\n\n				}\n				else {\n					$(\"#campaign-name\").removeClass(\"has-error error\");\n					$(\"#campaign-name-help\").hide();\n				}\n				$(\"#breadcrumb-campaign-name\").html($(\"#campaignName\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#campaign-footer\").html(\"Error!\");\n			})\n		}\n	  \n	  	function deleteCampaign() {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#campaign-footer\").html(\"Deleting..\");\n\n					$.post( \"/campaigns/ajax/delete/{$campaign.id}\", $( \"#campaign-form\" ).serialize(), function() {\n						$(\"#campaign-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#campaign-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/all\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#campaign-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#campaign-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n	 	 }\n\n		function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/worksheets/ajax/delete/\"+worksheetID, $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Delete Failed.\");\n						}\n						else {\n							var wsDataTable = $(\'#worksheets\').dataTable();\n							wsDataTable.fnDeleteRow(  wsDataTable.$(\'#worksheet-\'+worksheetID)[0] );\n//							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  		}\n\n		function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option>-This Campaign-</option></select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet(\"+ worksheetID+\");\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n	  	}\n\n\n		function copyWorksheet(worksheetID) {\n				if (worksheetID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheets/ajax/copy/{$worksheet.id}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n//							window.location.href=\"/worksheets/edit/{$worksheet.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  		}\n\n		function refreshVendorReps() {\n\n		         var vendors = $(\"#vendors\").val();\n		         var vendorNames = $(\"#vendors\").text();\n\n 			$(\'#vendors :selected\').each(function(i,sel){\n			   if ($(\"#vendorReps-\"+$(sel).val()).length) {\n			   }\n			   else {\n				var repHTML = \'<div class=\"form-group\"  id=\"vendor-\'+$(sel).val()+\'\"><label for=\"text-input\" class=\"col-sm-offset-2 col-sm-2 control-label\">\'+$(sel).text()+\'</label>\\\n			 				<div class=\"col-sm-6 col-md-5 col-lg-4\">\\\n								<select id=\"vendorReps-\'+$(sel).val()+\'\" name=\"vendorReps[]\" class=\"form-control\">\\\n								</select>\\\n							</div></div>\';\n\n				$(\'#vendorReps\').append(repHTML);\n	\n				$(\"#vendorReps-\"+$(sel).val()).select2({\n				    placeholder: \"Search \"+$(sel).text()+\" Reps\",\n				    allowClear: true\n				});\n				getVendorReps($(sel).val(),$(\"#markets\").val()); \n			   }\n		       });\n\n		}\n\n		function broadcastWeeks() {\n\n			if ($(\"#broadcastWeeks\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Broadcast Weeks Turned On.\");\n				$(\"#useBroadcastWeeks\").val(\"1\");\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Broadcast Weeks Turned Off.\");\n				$(\"#useBroadcastWeeks\").val(\"0\");\n			}\n		}\n\n		function autoComm() {\n\n			if ($(\"#autoComm\").is(\":checked\")) {\n				$(\"#addWorksheet-footer\").html(\"Auto Commission Turned On.\");\n				$(\"#isAutoComm\").val(\"1\");\n				$(\"#worksheetCommission\").attr(\"disabled\",false);\n			}\n			else {\n				$(\"#addWorksheet-footer\").html(\"Auto Commission Turned Off.\");\n				$(\"#isAutoComm\").val(\"0\");\n				$(\"#worksheetCommission\").attr(\"disabled\",\"disabled\");\n			}\n		}\n\n		function updateWorksheetFields(vendorType) {\n\n			$.post( \"/vendors/ajax/type/\" + vendorType + \"?PHPSESSID={$sessionID}\"  ,  function() {\n				$(\"#addWorksheet-footer\").html(\"Updating Vendor Type...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#addWorksheet-footer\").html(response.message);\n				if (response.error) {\n					\n				}\n				else {\n					if (response.vendorType.isAutoComm >= 1) {\n						$(\"#autoCommGroup\").show();\n					}\n					else {\n						$(\"#autoCommGroup\").hide();\n					}\n					if (response.vendorType.isGoalGRP >= 1) {\n						$(\"#grpGoal\").show();		\n					}\n					else {\n						$(\"#grpGoal\").hide();\n					}\n					if (response.vendorType.isBroadcastWeeks >= 1) {\n						$(\"#broadcastWeeksGroup\").show();\n					}\n					else {\n						$(\"#broadcastWeeksGroup\").hide();\n					}\n					if (response.vendorType.isDemographics >= 1) {\n						$(\"#demoPrimary\").show();\n						$(\"#demoSecondary\").show();\n					}\n					else {\n						$(\"#demoPrimary\").hide();\n						$(\"#demoSecondary\").hide();\n					}\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n	</script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(76,0,'admin-agency-create','2014-09-03 15:58:23','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/admin\">Admin</a>\n			</li>\n			<li class=\"active\">Agency</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Agency</h2>\n								<em>Create A New Agency</em>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-6\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Agency Information</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			<form class=\"form-horizontal label-left\"  id=\"agency-form\" name=\"agencyInfo\" role=\"form\" data-parsley-validate novalidate >\n			\n					<input type=\"hidden\" name=\"agencyID\" value=\"0\">\n\n					<div class=\"form-group\">\n																		<label for=\"agencyName\" class=\"col-sm-4 control-label\">Agency Name</label>\n																		<div class=\"col-sm-8\">\n							<input type=\"text\" name=\"agencyName\" id=\"agencyName\" class=\"form-control\"  value=\"{$agency.name}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Contact Name</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"text\" name=\"contactName\" id=\"contactName\" class=\"form-control\" value=\"{$agency.contactName}\" required {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Email Address</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"email\" id=\"emailAddress\" name=\"emailAddress\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$agency.emailAddress}\" {if $readOnly} readonly{/if}>\n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-4 control-label\">Address</label>\n																		<div class=\"col-sm-8\">\n								<textarea class=\"form-control\"  name=\"address\" id=\"address\" rows=\"5\" cols=\"30\" style=\"resize: none;\" {if $readOnly} readonly{/if}>{$agency.address}</textarea>\n						</div>\n																	</div>\n																	<div class=\"form-group\">\n																		<label for=\"phone\" class=\"col-sm-4 control-label\">Phone Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"phone\" name=\"phoneNumber\" class=\"form-control\" value=\"{$agency.phoneNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"fax\" class=\"col-sm-4 control-label\">Fax Number\n																		<br>\n																		<small>(999) 999-9999</small>\n																		</label>\n																		<div class=\"col-sm-4 pull-left\">\n																			<input type=\"text\" id=\"fax\" name=\"faxNumber\" class=\"form-control\" value=\"{$agency.faxNumber}\" {if $readOnly} readonly{/if}>\n																		</div>\n																	</div>\n\n					<div class=\"form-group\">\n																		<label for=\"website\" class=\"col-sm-4 control-label\">Website</label>\n																		<div class=\"col-sm-8\">\n								<input type=\"url\" id=\"website\" name=\"website\" class=\"form-control\" data-parsley-trigger=\"change\" value=\"{$agency.emailAddress}\" {if $readOnly} readonly{/if}> \n						</div>\n																	</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p>Default Comments</p>\n							<textarea id=\"textarea\" name=\"comments\" id=\"comments\" class=\"form-control\" rows=\"6\" cols=\"30\" maxlength=\"99\" style=\"resize: vertical;\" {if $readOnly} readonly{/if}>{$agency.comments}</textarea>							<p class=\"textarea-msg\"></p>\n						</div>\n					</div>\n{if ! $readOnly} \n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" class=\"btn btn-success\" onclick=\"addAgency();\">Create Agency</button>\n							</p>\n						</div>\n					</div>	\n{/if}\n			</form>\n							</div>\n\n		<div class=\"widget-footer\" id=\"agency-footer\">\n		</div>\n\n	</div>\n</div>\n\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/dropzone.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/lib/bootstrap-validator/js/bootstrapValidator.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n        <script type=\"text/javascript\" src=\"https://js.stripe.com/v2/\"></script>\n\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				$(\".dropzone\").dropzone({\n					url: \"php/dropzone-upload.php\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'image/*, application/pdf, .txt\',\n					dictResponseError: \'File Upload Error.\'\n				});\n			} // end if dropzone exist\n\n\n            var select = $(\"#exp-year\"),\n            year = new Date().getFullYear();\n \n            for (var i = 0; i < 12; i++) {\n                select.append($(\"<option value=\'\"+(i + year)+\"\' \"+(i === 0 ? \"selected\" : \"\")+\">\"+(i + year)+\"</option>\"))\n            }\n	    select.val(\"Year\");\n\n  // This identifies your website in the createToken call below\n    Stripe.setPublishableKey(\'{$stripeKey|default:\"pk_test_YEGSIbAArH5vGBkDqlkf0AYo\"}\');\n 	  	   \n\n    var stripeResponseHandler = function(status, response) {\n      var $form = $(\'#payment-form\');\n \n      if (response.error) {\n        // Show the errors on the form\n//	console.log(\"Stripe Error: \" + response.error.message);\n//	console.log(response);\n        $(\'#payment-error\').html(response.error.message);\n        $(\'#payment-error\').show();\n        $form.find(\'button\').prop(\'disabled\', false);\n      } else {\n        $(\'#payment-error\').hide();\n        // token contains id, last4, and card type\n        var token = response.id;\n        // Insert the token into the form so it gets submitted to the server\n        $(\"agency-form\").append($(\'<input type=\"hidden\" name=\"stripeToken\" />\').val(token));\n	$(\"#cvv\").val(\"\")\n	var cardNumber = $(\"#card-number\").val();\n	$(\"#card-number\").val(cardNumber.replace(/\\d/g, \"*\").substr(0,cardNumber.length-4) + cardNumber.substr(cardNumber.length - 4));\n//console.log(\"Stripe: \" + token);\n//console.log(response);\n        // and re-submit\n//        $form.get(0).submit();\n	updateCard(token);\n      }\n    };\n \n    jQuery(function($) {\n      $(\'#payment-form\').submit(function(e) {\n        var $form = $(this);\n \n\n        // Disable the submit button to prevent repeated clicks\n        $form.find(\'button\').prop(\'disabled\', true);\n \n        Stripe.createToken($form, stripeResponseHandler);\n\n        // Prevent the form from submitting with the default action\n        return false;\n      });\n    });\n\n\n    $(\'#payment-form\').bootstrapValidator({\n        feedbackIcons: {\n            valid: \'glyphicon glyphicon-ok\',\n            invalid: \'glyphicon glyphicon-remove\',\n            validating: \'glyphicon glyphicon-refresh\'\n        },\n        submitButtons: \'button[type=\"submit\"]\',\n	threshold: 5,\n        fields: {\n	    cardholdername: {\n		threshold: 6,\n                validators: {\n                    notEmpty: {\n                        message: \'The card holder name is required and can\\\'t be empty\'\n                    },\n					stringLength: {\n                        min: 6,\n                        max: 70,\n                        message: \'The card holder name must be more than 6 and less than 70 characters long\'\n                    }\n                }\n            },\n            ccNumber: {\n		selector: \'[data-stripe=\"number\"]\',\n                validators: {\n                    creditCard: {\n                        message: \'The credit card number is not valid\'\n                    },\n                    notEmpty: {\n                        message: \'The credit card number is required\'\n                    }\n                }\n            },\n            cvvNumber: {\n		selector: \'[data-stripe=\"cvc\"]\',\n                validators: {\n                    cvv: {\n                        creditCardField: \'ccNumber\',\n                        message: \'The CVV number is not valid\'\n                    }, \n                    notEmpty: {\n                        message: \'The CVV number is required\'\n                    }\n                }\n            },\n	    expMonth: {\n                selector: \'[data-stripe=\"exp-month\"]\',\n		feedbackIcons: false,\n                validators: {\n                    notEmpty: {\n                        message: \'The expiration month is required\'\n                    },\n                    digits: {\n                        message: \'The expiration month can contain digits only\'\n                    },\n                    callback: {\n                        message: \'Expired\',\n                        callback: function(value, validator) {\n                            value = parseInt(value, 10);\n                            var year         = validator.getFieldElements(\'expYear\').val(),\n                                currentMonth = new Date().getMonth() + 1,\n                                currentYear  = new Date().getFullYear();\n                            if (value < 0 || value > 12) {\n                                return false;\n                            }\n                            if (year == \'\') {\n                                return true;\n                            }\n                            year = parseInt(year, 10);\n                            if (year > currentYear || (year == currentYear && value > currentMonth)) {\n                                validator.updateStatus(\'expYear\', \'VALID\');\n                                return true;\n                            } else {\n                                return false;\n                            }\n                        }\n                    }\n                }\n            },\n            expYear: {\n                selector: \'[data-stripe=\"exp-year\"]\',\n		feedbackIcons: false,\n                validators: {\n                    notEmpty: {\n                        message: \'The expiration year is required\'\n                    },\n                    digits: {\n                        message: \'The expiration year can contain digits only\'\n                    },\n                    callback: {\n                        message: \'Expired\',\n                        callback: function(value, validator) {\n                            value = parseInt(value, 10);\n                            var month        = validator.getFieldElements(\'expMonth\').val(),\n                                currentMonth = new Date().getMonth() + 1,\n                                currentYear  = new Date().getFullYear();\n                            if (value < currentYear || value > currentYear + 100) {\n                                return false;\n                            }\n                            if (month == \'\') {\n                                return false;\n                            }\n                            month = parseInt(month, 10);\n                            if (value > currentYear || (value == currentYear && month > currentMonth)) {\n                                validator.updateStatus(\'expMonth\', \'VALID\');\n                                return true;\n                            } else {\n                                return false;\n                            }\n                        }\n                    }\n                }\n            },\n        }\n    });\n\n		});\n\n\n		function addAgency() {\n			\n			$(\"#agency-footer\").html(\"Creating.\");\n\n			$.post( \"/admin/ajax/agency/add/\", $( \"#agency-form\" ).serialize(), function() {\n				$(\"#agency-footer\").html(\"Creating...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#agency-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#agency-name-help\").show();\n\n				}\n				else {\n					$(\"#agency-name\").removeClass(\"has-error error\");\n					$(\"#agency-name-help\").hide();\n					window.location = \"/admin/agency/edit/\"+response.agencyID;\n				}\n				$(\"#breadcrumb-agency-name\").html($(\"#agency-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#agency-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#agency-footer\").html(\"Error!\");\n			})\n		}\n\n		function updateCard(token) {\n			\n			$(\"#agency-footer\").html(\"Saving.\");\n\n			$.post( \"/admin/ajax/agency/update/cc/{$agency.id}\", { \"token\": token }, function() {\n				$(\"#agency-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#agency-footer\").html(response.message);\n				if (response.error) {\n\n				}\n				else {\n\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#agency-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#agency-footer\").html(\"Error!\");\n			})\n		}\n\n	</script>\n\n\n<script type=\"text/javascript\">\n\n</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(77,0,'pay','2014-09-24 12:24:07','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Pay | BluHorn</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<br>\n	<div class=\"full-page-wrapper center-block\">\n		<div class=\"container\">\n			<div class=\"col-lg-offset-2 col-lg-8\">\n				<div class=\"well\">\n\n\n\n						<!-- main -->\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Pay</h2>\n								<em>Pay now using your credit card</em>\n							</div>\n\n							<div class=\"main-content\">\n								<!-- INVOICE -->\n								<div class=\"invoice\">\n									<!-- invoice header -->\n									<div class=\"invoice-header\">\n										<div class=\"row\">\n											<div class=\"col-lg-3 col-print-3\">\n												<img src=\"assets/img/kingboard-logo.png\" alt=\"BluHorn Logo\" />\n											</div>\n											<div class=\"col-lg-9 col-print-9\">\n												<ul class=\"list-inline\">\n\n\n													<li>Customer #:\n														<strong>{$customer.id|string_format:\"%06d\"}</strong>\n													</li>\n													<li>Date:\n														<strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}</strong>\n													</li>\n													<li>Total Amount:\n														<strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>\n													</li>\n												</ul>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice header -->\n\n									<!-- invoice address -->\n									<div class=\"invoice-from-to\">\n										<div class=\"row\">\n											<div class=\"col-sm-6 col-print-6\">\n												<span>PROVIDER</span>\n												<p class=\"name\">BluHorn, Inc.</p>\n												<address>\n													1611 San Marco Blvd\n													<br />Jacksonville, FL 32207\n													<br />\n													<div class=\"contact\">\n														<p><span>Email:</span> support@bluhorn.com</p>\n														<p><span>Phone:</span> (904) 232-3001</p>\n													</div>\n												</address>\n											</div>\n											<div class=\"col-sm-6 col-print-6\">\n												<span>CUSTOMER</span>\n												<p class=\"name\">{$customer.name}</p>\n												<address>\n													{$customer.address|replace:\"\\n\":\"<br>\"}\n\n																						<div class=\"contact\">\n														<p><span>Email:</span> {$customer.emailAddress}</p>\n														<p><span>Phone:</span> {$customer.phoneNumber}</p>\n													</div>\n												</address>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice address -->\n<div class=\"panel panel-default\">\n<div class=\"panel-body\" style=\"text-align: center;\">\n								By reading and signing below, I agree to let BluHorn, Inc. charge my credit card <strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>{if $plan.term} for a {$plan.term} {$plan.periodStr} term, beginning <strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}{/if}</strong>. \n</div>\n</div>\n\n<div class=\"panel panel-default\">\n  <div class=\"panel-heading\">Terms & Conditions</div>\n  <div class=\"panel-body\" style=\"min-height: 100px; max-height: 200px; overflow-y: scroll;\">\n	{include file=\"db:eula\"}\n  </div>\n</div>\n							\n<div class=\"panel panel-default\">\n<div class=\"panel-body\">\n									{include file=\"db:stripe-payment-form-new\"}\n<div id=\"payment-footer\"></div>	\n</div>\n</div>\n								</div>\n								<!-- INVOICE -->\n								<a href=\"/subscribe/confirm/{$subscriptionKey}/{$customer.id}\"> < Back To Subscription Confirmation Page</a>\n							</div>\n							<!-- /main-content -->\n						</div>\n						<!-- /main -->\n				</div>\n			</div>\n		</div>		\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/lib/bootstrap-validator/js/bootstrapValidator.min.js\"></script>\n\n        <script type=\"text/javascript\" src=\"https://js.stripe.com/v2/\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n\n\n            var select = $(\"#exp-year\"),\n            year = new Date().getFullYear();\n \n            for (var i = 0; i < 12; i++) {\n                select.append($(\"<option value=\'\"+(i + year)+\"\' \"+(i === 0 ? \"selected\" : \"\")+\">\"+(i + year)+\"</option>\"))\n            }\n	    select.val(\"Year\");\n\n  // This identifies your website in the createToken call below\n    Stripe.setPublishableKey(\'{$stripeKey|default:\"pk_live_fpocHp6ChWWI81Dl2c1QkU0p\"}\');\n 	  	   \n\n    var stripeResponseHandler = function(status, response) {\n      var $form = $(\'#payment-form\');\n//	console.log(response);\n \n      if (response.error) {\n        // Show the errors on the form\n//	console.log(\"Stripe Error: \" + response.error.message);\n        $(\'#payment-error\').html(response.error.message);\n        $(\'#payment-error\').show();\n        $form.find(\'button\').prop(\'disabled\', false);\n	submitted = false;\n      } else {\n        $(\'#payment-error\').hide();\n        // token contains id, last4, and card type\n        var token = response.id;\n        // Insert the token into the form so it gets submitted to the server\n        $(\"payment-form\").append($(\'<input type=\"hidden\" name=\"stripeToken\" />\').val(token));\n	$(\"#cvv\").val(\"\")\n	var cardNumber = $(\"#card-number\").val();\n	$(\"#card-number\").val(cardNumber.replace(/\\d/g, \"*\").substr(0,cardNumber.length-4) + cardNumber.substr(cardNumber.length - 4));\n//console.log(\"Stripe: \" + token);\n//console.log(response);\n        // and re-submit\n  //      $form.get(0).submit();\n	processPayment(token);  \n    }\n    };\n \n	var submitted = false;\n\n    jQuery(function($) {\n      $(\'#payment-form\').submit(function(e) {\n        var $form = $(this);\n \n	if (submitted == false) {\n		submitted = true;\n        // Disable the submit button to prevent repeated clicks\n        $form.find(\'button\').prop(\'disabled\', true);\n \n        Stripe.createToken($form, stripeResponseHandler);\n	}\n        // Prevent the form from submitting with the default action\n        return false;\n      });\n    });\n\n\n    $(\'#payment-form\').bootstrapValidator({\n        feedbackIcons: {\n            valid: \'glyphicon glyphicon-ok\',\n            invalid: \'glyphicon glyphicon-remove\',\n            validating: \'glyphicon glyphicon-refresh\'\n        },\n        submitButtons: \'button[type=\"submit\"]\',\n	threshold: 5,\n        fields: {\n	    cardholdername: {\n		threshold: 6,\n                validators: {\n                    notEmpty: {\n                        message: \'The card holder name is required and can\\\'t be empty\'\n                    },\n					stringLength: {\n                        min: 6,\n                        max: 70,\n                        message: \'The card holder name must be more than 6 and less than 70 characters long\'\n                    }\n                }\n            },\n            ccNumber: {\n		selector: \'[data-stripe=\"number\"]\',\n                validators: {\n                    creditCard: {\n                        message: \'The credit card number is not valid\'\n                    },\n                    notEmpty: {\n                        message: \'The credit card number is required\'\n                    }\n                }\n            },\n            cvvNumber: {\n		selector: \'[data-stripe=\"cvc\"]\',\n                validators: {\n                    cvv: {\n                        creditCardField: \'ccNumber\',\n                        message: \'The CVV number is not valid\'\n                    }, \n                    notEmpty: {\n                        message: \'The CVV number is required\'\n                    }\n                }\n            },\n	    expMonth: {\n                selector: \'[data-stripe=\"exp-month\"]\',\n		feedbackIcons: false,\n                validators: {\n                    notEmpty: {\n                        message: \'The expiration month is required\'\n                    },\n                    digits: {\n                        message: \'The expiration month can contain digits only\'\n                    },\n                    callback: {\n                        message: \'Expired\',\n                        callback: function(value, validator) {\n                            value = parseInt(value, 10);\n                            var year         = validator.getFieldElements(\'expYear\').val(),\n                                currentMonth = new Date().getMonth() + 1,\n                                currentYear  = new Date().getFullYear();\n                            if (value < 0 || value > 12) {\n                                return false;\n                            }\n                            if (year == \'\') {\n                                return true;\n                            }\n                            year = parseInt(year, 10);\n                            if (year > currentYear || (year == currentYear && value > currentMonth)) {\n                                validator.updateStatus(\'expYear\', \'VALID\');\n                                return true;\n                            } else {\n                                return false;\n                            }\n                        }\n                    }\n                }\n            },\n            expYear: {\n                selector: \'[data-stripe=\"exp-year\"]\',\n		feedbackIcons: false,\n                validators: {\n                    notEmpty: {\n                        message: \'The expiration year is required\'\n                    },\n                    digits: {\n                        message: \'The expiration year can contain digits only\'\n                    },\n                    callback: {\n                        message: \'Expired\',\n                        callback: function(value, validator) {\n                            value = parseInt(value, 10);\n                            var month        = validator.getFieldElements(\'expMonth\').val(),\n                                currentMonth = new Date().getMonth() + 1,\n                                currentYear  = new Date().getFullYear();\n                            if (value < currentYear || value > currentYear + 100) {\n                                return false;\n                            }\n                            if (month == \'\') {\n                                return false;\n                            }\n                            month = parseInt(month, 10);\n                            if (value > currentYear || (value == currentYear && month > currentMonth)) {\n                                validator.updateStatus(\'expMonth\', \'VALID\');\n                                return true;\n                            } else {\n                                return false;\n                            }\n                        }\n                    }\n                }\n            },\n        }\n    });\n\n		});\n\n		function processPayment(token) {\n			\n			$.post( \"/subscribe/ajax/payment/cc/{$subscriptionKey}/{$customer.id}/{$subscription.id}\", { \"token\": token }, function() {\n				$(\"#payment-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#payment-footer\").html(response.message);\n				if (response.error) {\n					submitted=false;\n				}\n				else {\n					window.location = \"/subscribe/paid/{$subscriptionKey}/{$customer.id}/{$subscription.id}\";\n				}\n\n			})\n			.fail(function(data) {\n				submitted=false;\n				$(\"#payment-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				submitted=false;\n				$(\"#payment-footer\").html(\"Error!\");\n			})\n		}\n\n	</script>\n\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(78,0,'choose','2015-04-14 00:28:44','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Dashboard</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<br>\n	<div class=\"full-page-wrapper center-block\">\n		<div class=\"container\">\n			<div class=\"col-lg-offset-2 col-lg-8\">\n				<div class=\"well\">\n\n\n\n						<!-- main -->\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Subscribe</h2>\n								<em>Configure your plan</em>\n							</div>\n\n							<div class=\"main-content\">\n<form name=\"plan\" id=\"plan\" action=\"/subscribe/confirm/{$subscriptionKey}/{$customer.id}\" method=\"post\">\n								<!-- INVOICE -->\n								<div class=\"invoice\">\n									<!-- invoice header -->\n									<div class=\"invoice-header\">\n										<div class=\"row\">\n											<div class=\"col-lg-3 col-print-3\">\n												<img src=\"assets/img/kingboard-logo.png\" alt=\"BluHorn Logo\" />\n											</div>\n											<div class=\"col-lg-9 col-print-9\">\n												<ul class=\"list-inline\">\n													<li>Customer #:\n														<strong>{$customer.id|string_format:\"%06d\"}</strong>\n													</li>\n													<li>Date:\n														<strong>{$smarty.now|date_format:\'%Y-%m-%d\'}</strong>\n													</li>\n											\n												</ul>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice header -->\n									<!-- invoice address -->\n									<div class=\"invoice-from-to\">\n										<div class=\"row\">\n											<div class=\"col-sm-6 col-print-6\">\n												<span>PROVIDER</span>\n												<p class=\"name\">BluHorn, Inc.</p>\n												<address>\n													1611 San Marco Blvd\n													<br />Jacksonville, FL 32207\n													<br />\n													<div class=\"contact\">\n														<p><span>Email:</span> support@bluhorn.com</p>\n														<p><span>Phone:</span> (904) 232-3001</p>\n													</div>\n												</address>\n											</div>\n											<div class=\"col-sm-6 col-print-6\">\n												<span>CUSTOMER</span>\n												<p class=\"name\">{$customer.name}</p>\n												<address>\n													{$customer.address|replace:\"\\n\":\"<br>\"}\n																						<div class=\"contact\">\n														<p><span>Email:</span> {$customer.emailAddress}</p>\n														<p><span>Phone:</span> {$customer.phoneNumber}</p>\n		\n		<input type=\"hidden\" name=\"customerID\" value=\"{$customer.id}\">\n		<input type=\"hidden\" name=\"customerKey\" value=\"{$subscriptionKey}\">\n		<input type=\"hidden\" name=\"subscriptionKey\" value=\"{$subscriptionKey}\">\n													</div>\n												</address>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice address -->\n\n									<!-- invoice item table -->\n									<div class=\"table-responsive\">\n										<table class=\"table invoice-table\">\n											<thead>\n												<tr>\n\n	<th></th>\n\n	<th>Plan</th>\n													<th>Amount</th>\n	\n												</tr>\n											</thead>\n											<tbody>\n{foreach $plans as $plan}\n												<tr>\n													<td><input type=\"radio\" class=\"plans\" id=\"plan-{$plan.id}\" name=\"planID\" value=\"{$plan.id}\" data-rate=\"{$plan.rate}\"  {if $plan.id == $planID}checked{/if}></td>\n\n	<td>{$plan.description} {if $plan.id == $planID} <strong style=\"color: #f00;\">(Current Plan)</strong>{/if}</td>\n		\n	<td>{$plan.rate}{if $plan.isRecurring}/{$plan.periodStr}{/if}</td>\n\n\n												</tr>\n{/foreach}\n\n											</tbody>\n										</table>\n									</div>\n\n									<div class=\"table-responsive\">\n										<table class=\"table invoice-table\">\n											<thead>\n												<tr>\n													<th>Optional Items</th>\n													<th>Amount</th>\n	\n	<th>Term</th>\n\n	<th>Quantity</th>\n													<th>Total</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $extras as $extra}\n												<tr>\n													<td>{$extra.description}</td>\n													<td>{$extra.amount}</td>\n		\n	<td>{$extra.term}</td>\n\n	<td><input type=\"hidden\" name=\"extras[]\" value=\"{$extra.id}\"><input type=numeric class=\"form-control\" name=\"{$extra.id}-quantity\" value=\"1\" size=\"3\"></td>\n													<td>{$extra.total}</td>\n\n												</tr>\n{foreachelse}\n<td colspan=\"5\" style=\"text-align: center;\">There are no additional options available for the selected plan</td>\n{/foreach}\n\n\n											</tbody>\n										</table>\n									</div>\n									<!-- end invoice item table -->\n									<!-- invoice footer -->\n									<div class=\"invoice-footer\">\n										<div class=\"row\">\n											<div class=\"col-sm-5 col-sm-offset-1 col-print-4 col-print-offset-2 right-col\">\n												<div class=\"invoice-total\">\n													<div class=\"row\">\n														<div class=\"col-xs-4 col-xs-offset-4 col-print-6 col-print-offset-2\">\n															<p>Total</p>\n														</div>\n														<div class=\"col-xs-4 text-right col-print-4\">\n															<p id=\"planTotal\">{$plan.total|default:\"$0.00\"}</p>\n														</div>\n													</div>\n												</div>\n											</div>\n											<div class=\"col-sm-6 col-print-6 left-col\">\n												<blockquote class=\"invoice-notes\">\n													<strong>Notes:</strong>\n													<p>{$subscription.notes|default:\"14 Day Money Back Guarantee\"}</p>\n												</blockquote>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice footer -->\n\n									<!-- invoice action buttons -->\n									<div class=\"invoice-buttons\">\n										{if $planID}\n											<a href=\"javascript:changePlan();\" id=\"change-subscription\" class=\"btn btn-custom-primary\"><i class=\"fa fa-arrow-right\"></i> Change Subscription</a>\n										{else}\n											<a href=\"javascript:choosePlan();\" id=\"confirm-subscription\" class=\"btn btn-custom-primary disabled\"><i class=\"fa fa-arrow-right\"></i> Confirm Subscription</a>\n										{/if}\n									</div>\n									<!-- end invoice action buttons -->\n								</div>\n								<!-- INVOICE -->\n</form>\n\n							</div>\n							<!-- /main-content -->\n						</div>\n						<!-- /main -->\n\n\n\n\n\n				</div>\n			</div>\n		</div>		\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n{*\n	<script type=\"text/javascript\" src=\"/assets/js/king-page.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n*}\n	<script type=\"text/javascript\">\n	\n		$(\".plans\").change(function (plan) {\n		\n			var rate = $(\"#plan-\" + $(\"input:radio[name=\'planID\']:checked\").val()).data(\"rate\");\n\n			$(\"#planTotal\").html(\"$\" + rate);\n\n			$(\"#confirm-subscription\").removeClass(\"disabled\");\n		});\n\n		function choosePlan() {\n\n			$(\"#plan\").submit();\n		\n		};\n\n		function changePlan() {\n\n			$(\"#plan\").submit();\n		\n		};\n	\n	{if $planID > 0}\n\n 		$(document).ready(function(){\n			\n			$(\"#plan-{$planID}\").attr(\'checked\', true);\n\n			var rate = $(\"#plan-{$planID}\").data(\"rate\");\n\n			$(\"#planTotal\").html(\"$\" + rate);\n\n		});\n\n	{/if} \n\n	</script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(79,0,'customer','2014-08-11 04:55:10','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Signup</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/lib/parsley/2.0.3/parsley.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-login text-center\">\n\n		<div class=\"inner-page\">\n\n			<div class=\"logo\">\n				<a href=\"/login\">\n					<img src=\"assets/img/kingboard-logo.png\" alt=\"\" />\n				</a>\n			</div>\n\n			<div class=\"login-box center-block\">\n\n\n		{if $alertError}\n			<div class=\"alert alert-danger\">\n                		<a class=\"close\" data-dismiss=\"alert\" href=\"#\">Ã—</a>{$errorMsg}\n                		</div>\n  		{/if}\n          	{if $alertSuccess}\n			<div class=\"alert alert-success\">\n                		{$successMsg}\n                		</div>\n  		{/if}	\n\n			<form action=\"/login/register\" method=\"post\" data-parsley-validate>\n					<div class=\"form-group\">\n				<label>Email Address?</label>\n				<input type=\"email\" id=\"emailAddress\" class=\"form-control\" name=\"emailAddress\" value=\"{$emailAddress}\" placeholder=\"Email Address\" data-parsley-trigger=\"change\" required>\n</div>\n					<div class=\"form-group\">\n				<label>First Name?</label>\n				<input type=\"text\" id=\"firstName\" class=\"form-control\" name=\"firstName\" value=\"{$firstName}\" placeholder=\"First Name\" required>\n</div>\n<div class=\"form-group\">\n				<label>Last Name?</label>\n			 	<input type=\"text\" id=\"lastName\" class=\"form-control\" name=\"lastName\" value=\"{$lastName}\" placeholder=\"Last Name\" required>\n</div>\n					<div class=\"form-group\">\n				<label>Agency or Company Name?</label>\n			 	<input type=\"text\" id=\"agency\" class=\"form-control\" name=\"organization\" value=\"{$organization}\" placeholder=\"Organization / Agency\" required>\n</div>\n					<div class=\"form-group\">\n\n				<label>Phone Number?</label>\n			 	<input type=\"text\" id=\"phoneNumber\" class=\"form-control\" name=\"phoneNumber\" value=\"{$phoneNumber}\" placeholder=\"Phone Number\" required>\n</div>\n				<button class=\"btn btn-custom-primary btn-lg btn-block btn-login\"><i class=\"fa fa-arrow-circle-o-right\"></i> Sign Up For An Account</button>\n				</form>\n\n				<div class=\"links\">\n					<p><a href=\"/login/forgot\">Forgot Username or Password?</a></p>\n					<p><a href=\"/login\">Return To Login</a></p>\n				</div>\n			</div>\n\n		</div>\n	</div>\n</div>\n\n\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/parsley/2.0.3/parsley.min.js\"></script>\n\n	<script type=\"text/javascript\"> \n\n		$(document).ready(function(){\n	\n			$(\'#phoneNumber\').mask(\'(999) 999-9999? x99999\');\n\n		});\n\n	</script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(80,0,'admin-logs','2014-09-15 01:32:54','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li>Admin</li>\n			<li class=\"active\">Logs</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Connections</h2>\n								<em>Incoming HTTP Requests</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-users\"></i> Connections</h3>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>ID</th>\n													<th>Type</th>\n													<th>Session</th>\n													<th>Timestamp</th>\n													<th>IP</th>\n													<th>URL</th>\n													<th>Server</th>\n													<th>Cookie</th>\n													<th>Get</th>\n													<th>Post</th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n\n{foreach $connections as $connection}\n												<tr>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection.id}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection.type}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection.sessionID}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection.createdStamp}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection.ipAddress}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection.requestURI}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection._server|truncate:30:\"...\":true}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection._cookie|truncate:30:\"...\":true}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection._get|truncate:30:\"...\":true}</a></td>\n													<td><a href=\"/admin/logs/connection/{$connection.id}\">{$connection._post|truncate:30:\"...\":true}</a></td>\n\n	<td><center><a href=\"/admin/logs/connection/{$connection.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n	\n												</tr>\n{/foreach}\n												</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(81,0,'admin-logs-connection','2014-09-15 01:41:48','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n	<link href=\"/lib/bootstrap-switch/3.0/css/bootstrap3/bootstrap-switch.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/lib/parsley/2.0.3/parsley.css\" rel=\"stylesheet\" type=\"text/css\">\n\n\n<style>\n\n.dropzone .dz-message::before {\n\n	margin-top: 150px;\n\n}\n\n.dropzone {\n	height: auto;\n}	\n\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"/home\">Home</a>\n			<li><a href=\"/admin\">Admin</a>\n			</li>\n			<li><a href=\"/admin/logs\">Logs</a></li>\n			<li class=\"active\">Connection</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Connection</h2>\n							</div>\n<div class=\"row\">\n<div class=\"col-lg-10 col-md-12 col-sm-12 col-xs-12\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Server</h3>\n		</div>\n		<div class=\"widget-content\">\n			{$connection._server|replace:\"\\n\":\"<br>\"}\n		</div>\n\n		<div id=\"user-footer\" class=\"widget-footer\">\n\n		</div>\n\n	</div>\n</div>\n\n<div class=\"col-lg-10 col-md-12 col-sm-12 col-xs-12\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Cookie</h3>\n		</div>\n		<div class=\"widget-content\">\n			{$connection._cookie|replace:\"\\n\":\"<br>\"}\n\n\n		</div>\n\n		<div id=\"user-footer\" class=\"widget-footer\">\n\n		</div>\n\n	</div>\n</div>\n\n<div class=\"col-lg-10 col-md-12 col-sm-12 col-xs-12\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Get</h3>\n		</div>\n		<div class=\"widget-content\">\n			{$connection._get|replace:\"\\n\":\"<br>\"}\n		</div>\n\n		<div id=\"user-footer\" class=\"widget-footer\">\n\n		</div>\n\n	</div>\n</div>\n\n<div class=\"col-lg-10 col-md-12 col-sm-12 col-xs-12\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Post</h3>\n		</div>\n		<div class=\"widget-content\">\n\n			{$connection._post|replace:\"\\n\":\"<br>\"}\n\n		</div>\n\n		<div id=\"user-footer\" class=\"widget-footer\">\n\n		</div>\n\n	</div>\n</div>\n\n</div>\n\n{if $agencies|@count>0}\n<div class=\"row\">\n\n<div class=\"col-lg-12 col-sm-12 col-md-12\">\n\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-building-o\"></i> {if $agencies|@count > 1}Agencies{else}Agency{/if}</h3>\n										<em> {$agencies|@count} {if $agencies|@count > 1}Agencies{else}Agency{/if} found.</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n\n	<th>Agency Name</th>\n													<th>Address</th>\n													<th>Phone Number</th>\n													<th style=\"text-align: center;\">Active?</th>\n													<th style=\"text-align: center;\">Admin?</th>\n													<th style=\"text-align: center;\">Billing?</th>\n													<th></th>\n													<th></th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $agencies as $agency}\n												<tr>\n													<td>{if $agency.isAgencyAdmin}Administrator{else}User{/if}</td>\n													<td>{$agency.name}</td>\n													<td>{$agency.address}</td>\n													<td>{$agency.phoneNumber}</td>\n													<td><center><input type=\"radio\" id=\"isActive-{$agency.agencyID}\" data-wrapper-class=\"bootstrap-switch-small\" class=\"switch-small bootstrap-switch-small\" data-radio-all-off name=\"isActive[]\" value=\"{$agency.agencyID}\" {if $agency.agencyID == $agencyID}checked{/if}></center></td>\n\n	<td><center><input type=\"radio\" id=\"isAdmin-{$agency.agencyID}\" data-wrapper-class=\"bootstrap-switch-small\" class=\"switch-small bootstrap-switch-small\" data-radio-all-off name=\"isAdmin[]\" value=\"{$agency.agencyID}\" {if $agency.agencyID == $agencyID}checked{/if}></center></td>\n\n	<td><center><input type=\"radio\" id=\"isBilling-{$agency.agencyID}\" data-wrapper-class=\"bootstrap-switch-small\" class=\"switch-small bootstrap-switch-small\" data-radio-all-off name=\"isBilling[]\" value=\"{$agency.agencyID}\" {if $agency.agencyID == $agencyID}checked{/if}></center></td>\n\n	<td><center><i class=\"fa fa-pencil fa-lg\" ></i></center></td>\n\n	<td><center><i class=\"fa fa-trash-o fa-lg\" ></i></center></td>\n\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n								</div>\n\n</div>\n{/if}\n\n\n{/block}\n\n{block name=\"scripts\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n	\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/lib/bootstrap-switch/3.0/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/parsley/2.0.3/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/dropzone.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script>\n\n		var activeAgencyID = \"{$agencyID}\";\n\n		$(document).ready(function(){\n\n  $(\'#userInfo\').parsley().subscribe(\'parsley:form:validate\', function (formInstance) {\n\n    // if one of these blocks is not failing do not prevent submission\n    // we use here group validation with option force (validate even non required fields)\n    if (formInstance.isValid(\'block1\', true) || formInstance.isValid(\'block2\', true)) {\n      $(\'.invalid-form-error-message\').html(\'\');\n      return;\n    }\n    // else stop form submission\n    formInstance.submitEvent.preventDefault();\n\n    // and display a gentle message\n    $(\'.invalid-form-error-message\')\n      .html(\"You must correctly fill the fields of at least one of these two blocks!\")\n      .addClass(\"filled\");\n    return;\n  });\n\n			$(\'#phoneNumber\').mask(\'(999) 999-9999? x99999\');\n\n			$(\"[name=\'activeAgencyID\']\").bootstrapSwitch();\n			$(\".bootstrap-switch\").addClass(\"bootstrap-switch-mini\");\n\n			if( $(\'.dropzone\').length > 0 ) {\n				Dropzone.autoDiscover = false;\n		\n				$(\".dropzone\").dropzone({\n					url: \"php/dropzone-upload.php\",\n					addRemoveLinks : true,\n					maxFilesize: 5.0,\n					maxFiles: 5,\n					acceptedFiles: \'image/*, application/pdf, .txt\',\n					dictResponseError: \'File Upload Error.\'\n				});\n			} // end if dropzone exist\n		});\n\n		$(\"[name=\'activeAgencyID\']\").on(\'switchChange.bootstrapSwitch\', function(event, state) { \n			activeAgency(event.currentTarget.value);\n		 });\n\n//		$(\"[name=\'activeAgencyID\']\").on(\'change\', function(event, state) { \n//			activeAgency(event.currentTarget.value);\n//		 });\n\n		function activeAgency(toAgencyID) {\n			\n			$(\"#user-footer\").html(\"Switching Active Agency...\");\n\n			$.post( \"/user/ajax/agency/active/\" + toAgencyID, function() {\n				$(\"#user-footer\").html(\"Switching to Agency \" + toAgencyID);\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#user-footer\").html(response.message);\n				if (response.error) {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", true);\n				        //$(\"#agency-\" + toAgencyID).prop(\"checked\", false);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',false, true);\n					$(\"#agency-\" + response.agencyID).bootstrapSwitch(\'state\',true, false);\n				}\n				else {\n				        //$(\"#agency-\" + fromAgencyID).prop(\"checked\", false);\n				       // $(\"#agency-\" + toAgencyID).prop(\"checked\", true);\n					$(\"#agency-\" + toAgencyID).bootstrapSwitch(\'state\',true, true);\n				}\n			})\n			.fail(function(data) {\n				$(\"#user-footer\").html(\"Connection Failed! Not Switched.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n\n\n		function changePassword() {\n			\n			$(\"#userInfo\").parsley().validate();\n\n			return true;\n\n		}\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(82,0,'subscribe','2015-04-14 00:28:27','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Login | BluHorn - Dashboard</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<br>\n	<div class=\"full-page-wrapper center-block\">\n		<div class=\"container\">\n			<div class=\"col-lg-offset-2 col-lg-8\">\n				<div class=\"well\">\n\n\n\n						<!-- main -->\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Subscribe</h2>\n								<em>Confirm your plan and setup payments</em>\n							</div>\n\n							<div class=\"main-content\">\n								<!-- INVOICE -->\n								<div class=\"invoice\">\n									<!-- invoice header -->\n									<div class=\"invoice-header\">\n										<div class=\"row\">\n											<div class=\"col-lg-3 col-print-3\">\n												<img src=\"assets/img/kingboard-logo.png\" alt=\"BluHorn Logo\" />\n											</div>\n											<div class=\"col-lg-9 col-print-9\">\n												<ul class=\"list-inline\">\n\n\n													<li>Customer #:\n														<strong>{$customer.id|string_format:\"%06d\"}</strong>\n													</li>\n													<li>Date:\n														<strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}</strong>\n													</li>\n													<li>Total Amount:\n														<strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>\n													</li>\n												</ul>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice header -->\n\n									<!-- invoice address -->\n									<div class=\"invoice-from-to\">\n										<div class=\"row\">\n											<div class=\"col-sm-6 col-print-6\">\n												<span>PROVIDER</span>\n												<p class=\"name\">BluHorn, Inc.</p>\n												<address>\n													1611 San Marco Blvd\n													<br />Jacksonville, FL 32207\n													<br />\n													<div class=\"contact\">\n														<p><span>Email:</span> support@bluhorn.com</p>\n														<p><span>Phone:</span> (904) 232-3001</p>\n													</div>\n												</address>\n											</div>\n											<div class=\"col-sm-6 col-print-6\">\n												<span>CUSTOMER</span>\n												<p class=\"name\">{$customer.name}</p>\n												<address>\n													{$customer.address|replace:\"\\n\":\"<br>\"}\n\n																						<div class=\"contact\">\n														<p><span>Email:</span> {$customer.emailAddress}</p>\n														<p><span>Phone:</span> {$customer.phoneNumber}</p>\n													</div>\n												</address>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice address -->\n\n									<!-- invoice item table -->\n									<div class=\"table-responsive\">\n										<table class=\"table invoice-table\">\n											<thead>\n												<tr>\n													<th>#</th>\n													<th>Description</th>\n													<th>Quantity</th>\n													<th>Term</th>\n													<th>Unit Price</th>\n													<th>Total</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $items as $item}\n												<tr>\n													<td>{$item.lineNumber}</td>\n													<td>{$item.description}</td>\n													<td>{$item.qty}</td>\n		\n	<td>{$item.amount}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n\n	<td>{$item.amount}</td>\n													<td>{$item.total}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n									<!-- end invoice item table -->\n\n									<!-- invoice footer -->\n									<div class=\"invoice-footer\">\n										<div class=\"row\">\n											<div class=\"col-sm-5 col-sm-offset-1 col-print-4 col-print-offset-2 right-col\">\n												<div class=\"invoice-total\">\n													<div class=\"row\">\n														<div class=\"col-xs-6 col-xs-offset-2 col-print-8 col-sm-6 col-sm-offset-2 col-md-6 col-md-offset-2 col-lg-5 col-lg-offset-3 col-print-offset-1\">\n															<p>{$subscription.period|lower|capitalize} Total</p>\n														</div>\n														<div class=\"col-xs-4 text-right col-print-4\">\n															<p>{$subscription.amount|default:\"$0.00\"}</p>\n														</div>\n													</div>\n												</div>\n											</div>\n											<div class=\"col-sm-6 col-print-6 left-col\">\n												<blockquote class=\"invoice-notes\">\n													<strong>Notes:</strong>\n													<p>{$subscription.notes|default:\"14 Day Money Back Guarantee\"}</p>\n												</blockquote>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice footer -->\n\n									<!-- invoice action buttons -->\n									<div class=\"invoice-buttons\">\n										<a href=\"/subscribe/change/plan/{$subscriptionKey}/{$customerID}/{$subscription.id}\" class=\"btn btn-warning\"><i class=\"fa fa-arrow-left\"></i> Change Plan</a>\n										<button class=\"btn btn-default print-btn\"><i class=\"fa fa-print\"></i> Print</button>\n										<a href=\"/subscribe/pay/{$subscriptionKey}/{$customer.id}/{$subscription.id}\" class=\"btn btn-custom-primary\"><i class=\"fa fa-arrow-right\"></i> Proceed to Payment</a>\n									</div>\n									<!-- end invoice action buttons -->\n								</div>\n								<!-- INVOICE -->\n\n							</div>\n							<!-- /main-content -->\n						</div>\n						<!-- /main -->\n\n\n\n\n\n				</div>\n			</div>\n		</div>		\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-page.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(83,0,'stripe-payment-form-new','2014-09-15 07:57:22','','<div class=\"container\">\n  <div class=\"alert alert-danger\" role=\"alert\" id=\"payment-error\" style=\"display: none;\"></div>\n  <form class=\"form-horizontal\" id=\"payment-form\" role=\"form\" autocomplete=\"off\" onsubmit=\"javascript: return false;\" method=\"post\">\n    <fieldset>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"card-holder-name\">Name on Card</label>\n        <div class=\"col-sm-9 col-lg-6\">\n          <input type=\"text\" class=\"form-control\" name=\"cardholdername\" id=\"card-holder-name\" placeholder=\"Card Holder\'s Name\" value=\"{$cardHolderName}\" >\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"card-number\">Card Number</label>\n        <div class=\"col-sm-9 col-lg-5\">\n          <input type=\"text\" class=\"form-control\" data-stripe=\"number\" id=\"card-number\" placeholder=\"Debit/Credit Card Number\" value=\"{$ccNumber}\" data-bv-stringlength-min=\"8\">\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"expiry-month\">Expiration Date</label>\n        <div class=\"col-sm-9\">\n          <div class=\"row\">\n            <div class=\"col-xs-3 col-lg-3\">\n              <select class=\"form-control col-sm-2\" data-stripe=\"exp-month\" id=\"expiry-month\">\n                <option selected>Month</option>\n                <option value=\"01\">Jan (01)</option>\n                <option value=\"02\">Feb (02)</option>\n                <option value=\"03\">Mar (03)</option>\n                <option value=\"04\">Apr (04)</option>\n                <option value=\"05\">May (05)</option>\n                <option value=\"06\">June (06)</option>\n                <option value=\"07\">July (07)</option>\n                <option value=\"08\">Aug (08)</option>\n                <option value=\"09\">Sep (09)</option>\n                <option value=\"10\">Oct (10)</option>\n                <option value=\"11\">Nov (11)</option>\n                <option value=\"12\">Dec (12)</option>\n              </select>\n            </div> \n            <div class=\"col-xs-3 col-lg-3\"> \n              <select class=\"form-control\" data-stripe=\"exp-year\" id=\"exp-year\">\n                <option selected>Year</option>\n\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label class=\"col-sm-3 control-label\" for=\"cvv\">Card CVV</label>\n        <div class=\"col-sm-3\">\n          <input type=\"text\" class=\"form-control\" id=\"cvv\" data-stripe=\"cvc\" size=\"6\" placeholder=\"CVV Code\" data-bv-stringlength-min=\"1\">\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <div class=\"pull-right\">\n          <button type=\"submit\" class=\"btn btn-success\" id=\"payNow\" >Sign & Pay Now</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n</div>\n\n\n\n\n\n ','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(84,0,'paid','2014-09-24 19:44:29','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Thank You | BluHorn </title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<br>\n	<div class=\"full-page-wrapper center-block\">\n		<div class=\"container\">\n			<div class=\"col-lg-offset-2 col-lg-8\">\n				<div class=\"well\">\n\n\n\n						<!-- main -->\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Subscribed</h2>\n								<em>Thank you!</em>\n{if $subscription.isActive}\n								<span class=\"badge badge-success pull-right\">Active</span>\n{/if}\n							</div>\n\n							<div class=\"main-content\">\n								<!-- INVOICE -->\n								<div class=\"invoice\">\n									<!-- invoice header -->\n									<div class=\"invoice-header\">\n										<div class=\"row\">\n											<div class=\"col-lg-3 col-print-3\">\n												<img src=\"assets/img/kingboard-logo.png\" alt=\"BluHorn Logo\" />\n											</div>\n											<div class=\"col-lg-9 col-print-9\">\n												<ul class=\"list-inline\">\n\n\n													<li>Customer #:\n														<strong>{$customer.id|string_format:\"%06d\"}</strong>\n													</li>\n													<li>Date:\n														<strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}</strong>\n													</li>\n													<li>Total Amount:\n														<strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>\n													</li>\n												</ul>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice header -->\n									<!-- invoice address -->\n									<div class=\"invoice-from-to\">\n										<div class=\"row\">\n											<div class=\"col-sm-6 col-print-6\">\n												<span>PROVIDER</span>\n												<p class=\"name\">BluHorn, Inc.</p>\n												<address>\n													1611 San Marco Blvd\n													<br />Jacksonville, FL 32207\n													<br />\n													<div class=\"contact\">\n														<p><span>Email:</span> support@bluhorn.com</p>\n														<p><span>Phone:</span> (904) 232-3001</p>\n													</div>\n												</address>\n											</div>\n											<div class=\"col-sm-6 col-print-6\">\n												<span>CUSTOMER</span>\n\n												<p class=\"name\">{$customer.name}</p>\n												<address>\n													{$customer.address|replace:\"\\n\":\"<br>\"}\n\n																						<div class=\"contact\">\n														<p><span>Email:</span> {$customer.emailAddress}</p>\n														<p><span>Phone:</span> {$customer.phoneNumber}</p>\n			\n	</div>\n												</address>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice address -->\n									<!-- invoice item table -->\n									<div class=\"table-responsive\">\n										<table class=\"table invoice-table\">\n											<thead>\n												<tr>\n													<th>#</th>\n													<th>Description</th>\n													<th>Quantity</th>\n													<th>Term</th>\n													<th>Unit Price</th>\n													<th>Total</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $items as $item}\n												<tr>\n													<td>{$item.lineNumber}</td>\n													<td>{$item.description}</td>\n													<td>{$item.qty}</td>\n		\n	<td>{$item.amount}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n\n	<td>{$item.amount}</td>\n													<td>{$item.total}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n									<!-- end invoice item table -->\n\n									<!-- invoice footer -->\n									<div class=\"invoice-footer\">\n										<div class=\"row\">\n											<div class=\"col-sm-5 col-sm-offset-1 col-print-4 col-print-offset-2 right-col\">\n												<div class=\"invoice-total\">\n													<div class=\"row\">\n														<div class=\"col-xs-6 col-xs-offset-2 col-print-8 col-sm-6 col-sm-offset-2 col-md-6 col-md-offset-2 col-lg-5 col-lg-offset-3 col-print-offset-1\">\n															<p>{if $plan.isRenewable}{$subscription.period|lower|capitalize}{/if} Total</p>\n														</div>\n														<div class=\"col-xs-4 text-right col-print-4\">\n															<p>{$subscription.amount|default:\"$0.00\"}</p>\n														</div>\n													</div>\n												</div>\n											</div>\n											<div class=\"col-sm-6 col-print-6 left-col\">\n												<blockquote class=\"invoice-notes\">\n													<strong>Notes:</strong>\n													<p>{$subscription.notes}</p>\n												</blockquote>\n\n											</div>\n										</div>\n									</div>\n									<!-- end invoice footer -->\n\n									<!-- invoice action buttons -->\n									<div class=\"invoice-buttons\">\n										{*\n<a href=\"/subscribe/change/plan/{$subscriptionKey}/{$customer.id}/{$subscription.id}\" class=\"btn btn-warning\"><i class=\"fa fa-arrow-left\"></i> Cancel Subscription</a>\n*}\n										<button class=\"btn btn-default print-btn\"><i class=\"fa fa-print\"></i> Print</button>\n										<a href=\"/home\" class=\"btn btn-custom-primary\"><i class=\"fa fa-home\"></i>Home</a>\n									</div>\n									<!-- end invoice action buttons -->\n								</div>\n								<!-- INVOICE -->\n							</div>\n							<!-- /main-content -->\n						</div>\n						<!-- /main -->\n\n\n\n\n\n				</div>\n			</div>\n		</div>		\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-page.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(85,0,'eula','2014-08-28 12:29:16','','END USER AGREEMENT\n \nThank you for selecting BluHorn Solutions software (the \"Software\"). This End User Agreement (the \"Agreement\") constitute a legal agreement between you (\"Licensee\", \"you\", \"your\"), and BluHorn, LLC (\"BluHorn,\" \"we\", \"our\"). By signing this Agreement, you understand that you are bound by the terms of this Agreement and that this Agreement applies to all Software and services provided by BluHorn.\n \n1.         LICENSE GRANT AND RESTRICTIONS. Subject to the terms and conditions of this Agreement, including the payment of any applicable subscription fees, BluHorn grants you a limited, non-exclusive, non-transferable license to electronically access and use the Software solely for media planning and buying.\n \nIn addition to the BluHorn Solutions software, the term \"Software\" includes any other programs, tools, internet-based services, components and any \"updates\" (for example, Software maintenance, service information, help content, bug fixes, or maintenance releases etc.) of the Software that BluHorn provides or makes available to you. You are entitled to download updates to the Software that BluHorn generally makes available to other users of the Software. Certain Software may be accompanied by, and will be subject to, additional terms.\nYou are not licensed or permitted under this Agreement to do any of the following and shall not allow any third party to do any of the following: (i) access or attempt to access any other BluHorn systems, programs or data that are not made available for public use; (ii) copy, reproduce, republish, upload, post, transmit, resell or distribute in any way the material from the BluHorn or BluHorn Solutions Online sites; (iii) permit any third party to benefit from the use or functionality of the Software or services via a rental, lease, timesharing, service bureau, or other arrangement; (iv) transfer any of the rights granted to you under this Agreement; (v) work around any technical limitations in the Software, use any tool to enable features or functionalities that are otherwise disabled in the Software, or decompile, disassemble, or otherwise reverse engineer the Software except as otherwise permitted by applicable law; (vi) perform or attempt to perform any actions that would interfere with the proper working of the Software or services, prevent access to or the use of the Software or services by BluHornâ€™s other licensees or customers, or impose an unreasonable or disproportionately large load on BluHorn\'s infrastructure; or (vii) otherwise use the Software except as expressly allowed under this Section.\n \n2.         RESERVATION OF RIGHTS AND OWNERSHIP. It is hereby understood and agreed that BluHorn, a North Dakota limited liability company with offices at 2414 LaCorte Loop, Bismarck, North Dakota (Licensor) is the owner of all right title and interest to the Software, regardless of the media or form of the original, whether by the World Wide Web, disk or otherwise. The Software is licensed not sold, and BluHorn reserves all rights not expressly granted to you in this Agreement. The Software is protected by copyright, trade secret and other intellectual property laws. BluHorn and its licensors, if any, own the title, copyright, and other worldwide intellectual property rights in the Software and all copies of the Software. This Agreement does not grant you any rights to trademarks or service marks of BluHorn.\n \n3.         REGISTRATION DATA. You must register to use the Software and services and (i) provide true, accurate, current and complete registration information, and (ii) maintain and promptly update the registration information to keep it accurate, current and complete. If you provide any registration information that is inaccurate, not current or incomplete, or BluHorn has reasonable grounds to suspect is inaccurate, not current or incomplete, BluHorn may, in its sole discretion, suspend or terminate your account and refuse any and all current or future access to and use of the Software or services (or any portion thereof).\n \n4.         LICENSEE ACCESS INFORMATION AND ACCOUNT DATA. You are solely responsible for (i) maintaining the confidentiality and security of your access number(s), password(s), security question(s) and answer(s), account number(s), login information, and any other security or access information, used by you to access the Software, services and your accounts (collectively, \"Licensee Access Information\"), and (ii) preventing unauthorized access to or use of the information, files or data that you store or use in or with the Software and services (collectively, \"Account Data\"). You are responsible for providing access and assigning passwords to other users under your account for the Software and services, and ensuring that such authorized users comply with this Agreement. You will be responsible for all electronic communications, including registration and other account holder information, email and other data (\"Communications\") entered using the Licensee Access Information. BluHorn assumes that any Communications it receives through use of the Licensee Access Information were sent or authorized by you. You agree to immediately notify BluHorn if Licensee becomes aware of any loss, theft or unauthorized use of any Licensee Access Information. BluHorn reserves the right to deny you access to the Software or services (or any part thereof) if BluHorn reasonably believes that any loss, theft or unauthorized use of Licensee Access Information has occurred. You must inform BluHorn of, and hereby grant to BluHorn permission to use, Licensee Access Information to enable BluHorn to provide the services to you, including updating and maintaining Account Data, addressing errors or service interruptions, and to enhance the types of data and services BluHorn may provide to you.\n \n5.         INTELLECTUAL PROPERTY RIGHTS. You acknowledge and agree that copyrights, trademarks, service marks, patents, trade secrets, and other proprietary rights and laws protect all content and materials available on any BluHorn website and the Software. Unless expressly stated, nothing in this Agreement, the Software or any BluHorn website shall be interpreted or implied in such as way as conferring any license or right to any intellectual property rights or license to any intellectual property, content, technology, system, process, or related material belonging to BluHorn by virtue of it being displayed or made accessible on any BluHorn website. Except as expressly authorized by BluHorn, you agree not to use any BluHorn website or the Software in any manner that would infringe, violate, dilute or misappropriate any such rights, with respect to any material, which you access or receive.\n \nThe BluHorn and BluHorn Solutions names, logos, related names, design marks, product names, feature names and related logos are trademarks of BluHorn, LLC, and may only be used with the express written permission of BluHorn. BluHorn claims copyright interests in all original content or works provided by BluHorn. If any pages, information or content is copied, it may only be copied for non-commercial uses and BluHorn shall, in any event, retain all copyright and other proprietary interests therein.\n \n6.         SOFTWARE USE, STORAGE AND ACCESS. BluHorn shall have the right, in its sole discretion and with reasonable notice posted on the BluHorn website and/or sent to your email address provided in the registration information, to revise, update, or otherwise modify the services and establish or change limits concerning use of the Software and services, temporarily or permanently, including but not limited to (i) the amount of storage space you have on the Software at any time, and (ii) the number of times (and the maximum duration for which) you may access the Software in a given period of time. BluHorn reserves the right to make any such changes effective immediately to maintain the security of the system or Licensee Access Information or to comply with any laws or regulations, and to provide you with electronic or written notice within thirty (30) days after such change.  You may reject changes by discontinuing use of the Software and services to which such changes relate. Your continued use of the Software or services will constitute Licensee\'s acceptance of and agreement to such changes.\nBluHorn may, from time to time, perform maintenance upon the Software or services resulting in interrupted service, delays or errors in the Software or services. BluHorn will attempt to provide prior notice of scheduled maintenance but cannot guarantee that such notice will be provided.\n \n7.         SUBSCRIPTION FEE. The Software and services are licensed on a monthly subscription basis with a minimum contract term of twelve months. You hereby agree to pay the full dollar amount due for the Software and services subscription pursuant to the agreed to fees and payment terms.  All fees are subject to change on a prospective basis upon notice from BluHorn.\n \nBy subscribing to the Software and services, you authorize BluHorn to charge the applicable fee to your designated billing payment method. All subscription fees are in U.S. Dollars and are non-refundable unless expressly agreed to by BluHorn. The subscription fees do not include any national, state or local sales, use, value-added or other taxes, customs duties or similar tariffs and fees that BluHorn may be required to pay upon delivery of the Software and services. You will be responsible for payment of all such taxes (other than taxes based on BluHornâ€™s income), fees, duties, and charges applicable to your subscription. Your obligation to pay the subscription fee, when not subject to a reasonable dispute, will be unconditional and not subject to abatement, setoff or defense of any kind. Any portion of the subscription fee not paid when due will accrue interest at 18% per annum (1.5% per month) or the maximum rate permitted by applicable law, whichever is greater, from the due date until paid. If payment is made to BluHorn by check and the check is returned to BluHorn unpaid due to nonsufficient funds, you agree to pay BluHorn an additional NSF check charge equal to $30.00.\n \nIf your billing payment method changes during the term of your subscription plan, you must immediately update the billing payment method associated with your BluHorn account. If BluHorn is unable to charge your billing payment method, BluHorn may: (i) immediately suspend or terminate your account, (ii) seek collection of the outstanding amount owed and/or (iii) seek legal action against you for breach of this Agreement. You will reimburse BluHorn for all reasonable costs incurred in collecting past due amounts. Such costs may include, but are not limited to, wire transfer fees, collection agency fees, reasonable attorney fees, and court costs.\n \n8.         THIRD PARTY SERVICES. In connection with your use of the Software, you may be made aware of services, products, offers and promotions provided by third parties, and not by BluHorn (\"Third Party Services\"). If you decide to use Third Party Services, you are responsible for reviewing and understanding the terms and conditions governing any Third Party Services. You agree that the third party, and not BluHorn, is responsible for the performance of the Third Party Services.\n \n9.         FEEDBACK. BluHorn may provide you with a mechanism to provide feedback, suggestions and ideas about its online products and services. You agree that BluHorn may, in its sole discretion, use the feedback you provide in any way, including in future modifications of the Software, multimedia works and/or advertising and promotional materials relating thereto.  You hereby grant BluHorn a perpetual, worldwide, fully transferable, non-revocable, royalty free license to use, modify, create derivative works from, distribute and display any information you provide in the feedback.\n \n10.       DISCLAIMER OF WARRANTIES. THE SOFTWARE AND SERVICES ARE PROVIDED ON AN \"AS-IS\" AND \"AS AVAILABLE\" BASIS AND, TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, BLUHORN, ITS AFFILIATES, LICENSORS, THIRD-PARTY CONTENT OR SERVICE PROVIDERS, DISTRIBUTORS, DEALERS AND SUPPLIERS (COLLECTIVELY, \"SUPPLIERS\") DISCLAIM ALL GUARANTEES AND WARRANTIES, EXPRESS, IMPLIED OR STATUTORY, REGARDING THE SOFTWARE AND SERVICES, INCLUDING ANY WARRANTY OF FITNESS FOR A PARTICULAR PURPOSE, TITLE, MERCHANTABILITY, AND NON-INFRINGEMENT. BLUHORN DOES NOT WARRANT THAT THE SOFTWARE OR SERVICES\nARE SECURE OR FREE FROM BUGS, VIRUSES, INTERRUPTION, ERRORS, IDENTITY THEFT, THREAT OF HACKERS, OTHER PROGRAM LIMITATIONS, OR THAT THE SOFTWARE OR SERVICES WILL MEET YOUR REQUIREMENTS. BLUHORN ATTEMPTS TO ENSURE THAT THE INFORMATION STORED ON IT\'S SERVERS IS SAFE AND SECURE BY EMPLOYING REASONABLE, INDUSTRY-RECOGNIZED SECURITY AND VIRUS SAFEGUARDS, AND CONDUCTING ROUTINE SYSTEM MAINTENANCE AND MONITORING. SOME STATES DO NOT ALLOW THE EXCLUSION OF IMPLIED WARRANTIES, SO THE ABOVE EXCLUSIONS MAY NOT APPLY TO YOU. IN THAT EVENT, ANY IMPLIED WARRANTIES ARE LIMITED IN DURATION TO 60 DAYS FROM THE DATE OF PURCHASE OR DELIVERY OF THE SOFTWARE, AS APPLICABLE. HOWEVER, SOME STATES DO NOT ALLOW LIMITATIONS ON HOW LONG AN IMPLIED WARRANTY LASTS, SO THE ABOVE LIMITATION MAY NOT APPLY TO YOU. THIS WARRANTY GIVES YOU SPECIFIC LEGAL RIGHTS, AND YOU MAY HAVE OTHER RIGHTS THAT VARY FROM STATE TO STATE.\n \n11.       LIMITATION OF LIABILITY AND DAMAGES. THE ENTIRE CUMULATIVE LIABILITY OF BLUHORN FOR ALL MATTERS ARISING FROM OR RELATING TO THIS AGREEMENT SHALL BE LIMITED TO THE AMOUNT PAID BY YOU FOR THE SOFTWARE OR SERVICES, AS APPLICABLE. TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, BLUHORN AND ITS SUPPLIERS SHALL NOT BE LIABLE FOR ANY INDIRECT, SPECIAL, INCIDENTAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES OR FOR ANY DAMAGES RELATING TO LOSS OF BUSINESS, TELECOMMUNICATION FAILURES, CORRUPTION, SECURITY OR THEFT OF DATA, VIRUSES, SPYWARE, LOSS OF INCOME, OR THE LIKE, WHETHER BASED IN CONTRACT, TORT (INCLUDING NEGLIGENCE), PRODUCT LIABILITY OR OTHERWISE, EVEN IF BLUHORN HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES, AND EVEN IF A REMEDY SET FORTH HEREIN IS FOUND TO HAVE FAILED OF ITS ESSENTIAL PURPOSE. IN NO EVENT WILL BLUHORN BE LIABLE FOR ANY LOSS, COST, LIABILITY OR DAMAGE INCURRED AS A RESULT OF YOUR RECEIPT OF OR PARTICIPATION IN ANY THIRD PARTY SERVICES, THIRD PARTY WEBSITES, OR RATING SERVICES. IN NO EVENT DOES BLUHORN ASSUME ANY LIABILITY TO ANY PARTY OTHER THAN YOU ARISING OUT OF YOUR USE OR INABILITY TO USE THE SOFTWARE OR SERVICES. THE LIMITATIONS OF DAMAGES SET FORTH ABOVE ARE FUNDAMENTAL ELEMENTS OF THE BASIS OF THE BARGAIN BETWEEN BLUHORN AND YOU. BLUHORN WOULD NOT BE ABLE TO HAVE PROVIDED THE SOFTWARE OR THE SERVICES WITHOUT SUCH LIMITATIONS.\n \n12.       CONSENT TO CONDUCT BUSINESS ELECTRONICALLY (\"CONSENT\").\n(a)        Consent to Electronic Communications. BluHorn may be required by law to send \"Communications\" to you that may pertain to the Software, the use of information you may submit to BluHorn, and the services you choose. Additionally, certain of the Third Party Services you choose may require Communications with the third parties who administer these programs. You agree that BluHorn, on behalf of itself, and others who administer such services (as applicable), may send Communications to you by email and/or may make Communications available to you by posting them at BluHornâ€™s website. You consent to receive these Communications electronically. The term \"Communications\" means any notice, record, agreement, or other type of information that is made available to you or received from you in connection with the Software and the online services and any third-party services.\n(b)        Consenting to Do Business Electronically. The decision whether to do business electronically is yours, and you should consider whether you have the required hardware and software capabilities described below. Your consent to do business electronically and our agreement to do so covers all transactions you conduct through the Software for as long as you remain a subscriber to the Software.\n(c)        Hardware and Software Requirements. In order to access and retain an electronic record of Communications, you will need: a computer, a monitor, a connection to an Internet service provider, Internet browser software, and an e-mail address. Although BluHorn will use reasonable efforts to safeguard the confidentiality of the Communications, transmissions made by means of the Internet cannot be made absolutely secure. BluHorn is not liable for disclosure of the Communications due to errors in transmission or unauthorized acts of third parties.\n(d)        Changes to Your Email Address. You agree to notify us promptly of any change in your email address.\n \n13.       LIMITATION ON TIME TO SUE. Unless otherwise required by law, an action or proceeding by you to enforce an obligation, duty, or right arising under this Agreement or by law with respect to the Software or Third Party Services must be commenced within one year after the cause of action accrues.\n \n14.       MISCELLANEOUS. Except as expressly set forth in this Agreement, this Agreement is a complete statement of the agreement between you and BluHorn and sets forth the entire liability of BluHorn and your exclusive remedy with respect to the Software and services. Any waiver of the terms herein by BluHorn must be in a writing signed by an authorized officer of BluHorn and expressly referencing the applicable provisions of this Agreement. If any provision of this Agreement is invalid or unenforceable under applicable law, then it shall be changed and interpreted to accomplish the objectives of such provision to the greatest extent possible under applicable law, and the remaining provisions will continue in full force and effect. This Agreement will be governed by North Dakota law as applied to agreements entered into and to be performed entirely within North Dakota, without regard to its choice of law or conflicts of law principles that would require the application of law of a different jurisdiction, and applicable federal law. The parties hereby consent to the exclusive jurisdiction and venue in the state courts in Burleigh County, North Dakota or the Federal District Court, District of North Dakota, Southwestern Division. Headings are included for convenience only, and shall not be considered in interpreting this Agreement. As used in this Agreement, the word \"including\" means \"including but not limited to.\" This Agreement does not limit any rights that BluHorn may have under trade secret, copyright, patent or other laws.\n \n15.       AMENDMENT. BluHorn shall have the right to change or add to the terms of its Agreement at any time, and to change, delete, discontinue, or impose conditions on any feature or aspect of Software and services (including but not limited to Internet based services, pricing, technical support options, and other product-related policies) upon notice by any means BluHorn determines in its discretion to be reasonable, including posting information concerning any such change, addition, deletion, discontinuance or conditions in Software or on BluHornâ€™s web site. Any use of the Software by Licensee after BluHorn\'s publication of any such changes shall constitute your acceptance of this Agreement as modified.\n \n16.       TERMINATION.        Your rights under this Agreement may be terminated or suspended by BluHorn immediately and without notice if you fail to comply with any term or condition of this Agreement.  Additionally, BluHorn reserves the right (but has no obligation) to delete all Licensee Access Information and data stored on BluHornâ€™s servers if the subscription has been terminated or if you have not renewed a subscription for the Software.  Upon termination you must immediately cease using the Software and services.  Any termination of this Agreement shall not affect BluHornâ€™s rights hereunder.  Further, you agree that upon termination of the Agreement, BluHorn shall not be liable to you or any third party for any termination of your access to the Software or deletion of the Access Information and data.    \n \n17.       CANCELATION POLICY. It is understood that you have agreed to subscribe to BluHorn Solutionsâ€™ Software and services. Once you have so subscribed and agreed to the terms set forth in this Agreement, there will be no ability to cancel prior to the Contract End date specified in Purchase details.\n \n18.       INDEMNITY. You agree to indemnify and hold harmless BluHorn and its agents, employees, representatives, licensors, affiliates, parents and subsidiaries from and against any and all claims, losses, demands, causes of action and judgments (including attorneys\' fees and court costs) arising from or concerning your breach of this Agreement and your use of the Software and/or services and to reimburse BluHorn on demand for any losses, costs or expenses it incurs as a result thereof. This obligation will survive the termination of the Agreement.\n \n19.       AGREEMENT CONSTRUCTION. This Agreement is between commercially sophisticated parties and may not be construed and interpreted for or against either party. Each party is aware that each is free to seek independent professional guidance or legal counsel regarding this Agreement. Each party has either sought such guidance or legal counsel or decided, after reviewing the Agreement carefully, to waive such right.\n \n20.       AUTHORITY TO SIGN. The Licensee warrants and represents that its representative signing this Agreement has full power and proper authority to sign this Agreement and to bind the Licensee.','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(86,0,'MAIL_ACTIVATE','2014-08-08 22:20:44','','<meta content=\"width=device-width\" name=\"viewport\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\" />\n<meta content=\"text/html; charset=UTF-8\" http-equiv=\"Content-Type\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\" />\n<title style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\"></title>\n<table class=\"body-wrap\" style=\"margin: 0;padding: 20px;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n	<tbody>\n		<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n			<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">&nbsp;</td>\n			<td bgcolor=\"#FFFFFF\" class=\"container\" style=\"margin: 0 auto;padding: 20px;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;border: 1px solid #f0f0f0;display: block;max-width: 600px;clear: both;\"><!-- content -->\n			<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n				<tbody>\n					<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n						<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n						<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">Welcome to BluHorn!</p>\n\n						<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">Thanks for signing up, we can&#39;t wait to get you on board.</p>\n\n						<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">To activate your account and set your password, please use the link below.</p>\n\n						<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\"><span style=\"line-height: 1.6;\">For security purposes, you only have a short period of time, before this expires.</span></p>\n\n						<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n							<tbody>\n								<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n									<td class=\"padding\" style=\"margin: 0;padding: 10px 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n									<p style=\"margin: 0px 0px 10px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 14px; line-height: 1.6; font-weight: normal; text-align: center;\"><a class=\"btn-primary\" href=\"https://bluhorn.filelogix.com/login/activate/{$email.activationCode}\" style=\"margin: 0px 10px 0px 0px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 100%; color: rgb(255, 255, 255); text-decoration: none; background-color: rgb(52, 142, 218); border-style: solid; border-color: rgb(52, 142, 218); border-width: 10px 20px; font-weight: bold; text-align: center; cursor: pointer; display: inline-block; border-top-left-radius: 25px; border-top-right-radius: 25px; border-bottom-right-radius: 25px; border-bottom-left-radius: 25px;\">Activate Your BluHorn Account</a>&nbsp;</p>\n									</td>\n								</tr>\n							</tbody>\n						</table>\n\n						<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">For any immediate questions, please call 1-800-818-7647&nbsp;<span style=\"line-height: 1.6;\">or email us at support@bluhorn.com</span></p>\n\n						<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\">Thanks, and have a great day!</p>\n\n						<p style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 14px;line-height: 1.6;margin-bottom: 10px;font-weight: normal;\"><a href=\"http://twitter.com/iwantabuzz\" style=\"margin: 0px; padding: 0px; font-family: \'Helvetica Neue\', Helvetica, Helvetica, Arial, sans-serif; font-size: 100%; color: rgb(52, 142, 218);\">Follow @bluhorn on Twitter</a></p>\n						</td>\n					</tr>\n				</tbody>\n			</table>\n			<!-- /content --></td>\n			<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">&nbsp;</td>\n		</tr>\n	</tbody>\n</table>\n<!-- /body --><!-- footer -->\n\n<table class=\"footer-wrap\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;clear: both;\">\n	<tbody>\n		<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n			<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">&nbsp;</td>\n			<td class=\"container\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;display: block;max-width: 600px;clear: both;\"><!-- content -->\n			<p class=\"content\" style=\"margin: 0 auto;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;max-width: 600px;display: block;\">&nbsp;</p>\n\n			<table style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;width: 100%;\">\n				<tbody>\n					<tr style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">\n						<td align=\"center\" style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">&nbsp;</td>\n					</tr>\n				</tbody>\n			</table>\n			<!-- /content --></td>\n			<td style=\"margin: 0;padding: 0;font-family: &quot;Helvetica Neue&quot;, &quot;Helvetica&quot;, Helvetica, Arial, sans-serif;font-size: 100%;line-height: 1.6;\">&nbsp;</td>\n		</tr>\n	</tbody>\n</table>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(87,0,'search','2014-09-15 14:05:42','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\n	td {\n	   text-align: center;\n	}\n	td:nth-child(2) {\n	   text-align: center;\n	}\n	td:nth-child(23) {\n	   text-align: center;\n	}\n	td:nth-child(24) {\n	   text-align: center;\n	}\n	td:nth-child(25) {\n	   text-align: center;\n	}\n</style>\n\n{/block}\n\n{block name=\"sidebar-clicked\"}onclick=\"updateSummary();\"{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Search</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Search</h2>\n								<em>Quickly find items by keywords</em>\n							</div>\n\n							<div class=\"main-content\">\n								<!-- knowledge search box -->\n								<form class=\"form-knowledge-search\">\n									<div class=\"input-group input-group-lg\">\n										<input type=\"search\" placeholder=\"enter a search term\" class=\"form-control\">\n										<span class=\"input-group-btn\">\n											<button class=\"btn btn-primary\" type=\"button\"><i class=\"fa fa-search\"></i> Search</button>\n										</span>\n									</div>\n								</form>\n								<!-- end knowledge search box -->\n\n								<div class=\"row\">\n									<!-- left side, main content -->\n									<div class=\"col-lg-9\">\n										<div class=\"row\">\n											<div class=\"col-md-5\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Campaigns <span class=\"pull-right\">22</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left pull-left\"></i><a href=\"#\">What is KINGBOARD admin dashboard?</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left pull-left\"></i><a href=\"#\">How do I change my password?</a></li>\n													</ul>\n												</div>\n											</div>\n											<div class=\"col-md-5 col-md-offset-1\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Worksheets <span class=\"pull-right\">15</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Payment Problems</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Shopping Cart</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Discount Policy</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How do I use promo code?</a></li>\n													</ul>\n												</div>\n											</div>\n										</div>\n										<div class=\"row\">\n											<div class=\"col-md-5\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Clients <span class=\"pull-right\">27</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How to review a product</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Recommend a product</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">I can\'t see the product stock</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Back Order</a></li>\n													</ul>\n												</div>\n											</div>\n											<div class=\"col-md-5 col-md-offset-1\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Vendors<span class=\"pull-right\">14</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Shipping Cost</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Shipping &amp; Warranty</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Where do we ship?</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How can I find my shipping code?</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">How to track my shipping?</a></li>\n													</ul>\n												</div>\n											</div>\n										</div>\n										<div class=\"row\">\n											<div class=\"col-md-5\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Markets <span class=\"pull-right\">6</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Find out downloadable products type.</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Where can I find the link for my digital product</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Link Expiration</a></li>\n													</ul>\n												</div>\n											</div>\n											<div class=\"col-md-5 col-md-offset-1\">\n												<div class=\"knowledge\">\n													<h3><a href=\"#\"><i class=\"fa fa-folder\"></i> Inventory<span class=\"pull-right\">17</span></a></h3>\n													<ul class=\"list-unstyled\">\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Turn on my browser cookies</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">The page keeps reloading</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Report a broken link</a></li>\n														<li><i class=\"fa fa-file-text-o pull-left\"></i><a href=\"#\">Contact Technical Support</a></li>\n													</ul>\n												</div>\n											</div>\n										</div>\n\n										<div class=\"well well-lg knowledge-recent-popular\">\n											<div class=\"row\">\n												<div class=\"col-md-6\">\n													<h4>Tools</h4>\n													<ol>\n														<li><a href=\"#\">I can\'t add otem to Shopping Cart, what should I do?</a></li>\n														<li><a href=\"#\">Error When Uploading File</a></li>\n														<li><a href=\"#\">How to Deposit Money?</a></li>\n													</ol>\n												</div>\n												<div class=\"col-md-6\">\n													<h4>Resources</h4>\n													<ol>\n														<li><a href=\"#\">Avoid Any Type of Scam, Now!</a></li>\n														<li><a href=\"#\">Update to Terms &amp; Agreements</a></li>\n														<li><a href=\"#\">A Step-by-Step Guide to Participate in CSR Program</a></li>\n														<li><a href=\"#\">Where Can I Find My Order History?</a></li>\n													</ol>\n												</div>\n											</div>\n										</div>\n									</div>\n									<!-- end left side, main content -->\n\n									<!-- right sidebar -->\n									<div class=\"col-lg-3\">\n										<h3>Categories</h3>\n										<ul class=\"nav nav-pills nav-stacked nav-categories\">\n											<li><a href=\"#\">Campaigns <span class=\"badge pull-right\">22</span></a></li>\n											<li><a href=\"#\">Worksheets<span class=\"badge pull-right\">15</span></a></li>\n											<li><a href=\"#\">Clients <span class=\"badge pull-right\">6</span></a></li>\n											<li><a href=\"#\">Vendors<span class=\"badge pull-right\">27</span></a></li>\n											<li><a href=\"#\">Markets <span class=\"badge pull-right\">20</span></a></li>\n											<li><a href=\"#\">Inventory<span class=\"badge pull-right\">14</span></a></li>\n											<li><a href=\"#\">Orders<span class=\"badge pull-right\">8</span></a></li>\n										</ul>\n\n									</div>\n									<!-- end right sidebar -->\n								</div>\n\n							</div>\n							<!-- /main-content -->\n						</div>\n\n\n	\n{/block}\n\n{block name=\"footer-js\"}\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(88,0,'MAIL_ORDERS','2014-09-19 01:26:41','','{literal}\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta name=\"viewport\" content=\"width=device-width\" />\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n<title>Really Simple HTML Email Template</title>\n<style>\n/* -------------------------------------\n		GLOBAL\n------------------------------------- */\n* {\n	margin: 0;\n	padding: 0;\n	font-family: \"Helvetica Neue\", \"Helvetica\", Helvetica, Arial, sans-serif;\n	font-size: 100%;\n	line-height: 1.6;\n}\n\nimg {\n	max-width: 100%;\n}\n\nbody {\n	-webkit-font-smoothing: antialiased;\n	-webkit-text-size-adjust: none;\n	width: 100%!important;\n	height: 100%;\n}\n\n\n/* -------------------------------------\n		ELEMENTS\n------------------------------------- */\na {\n	color: #348eda;\n}\n\n.btn-primary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #348eda;\n	border: solid #348eda;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.btn-secondary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #aaa;\n	border: solid #aaa;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.last {\n	margin-bottom: 0;\n}\n\n.first {\n	margin-top: 0;\n}\n\n.padding {\n	padding: 10px 0;\n}\n\n\n/* -------------------------------------\n		BODY\n------------------------------------- */\ntable.body-wrap {\n	width: 100%;\n	padding: 20px;\n}\n\ntable.body-wrap .container {\n	border: 1px solid #f0f0f0;\n}\n\n\n/* -------------------------------------\n		FOOTER\n------------------------------------- */\ntable.footer-wrap {\n	width: 100%;	\n	clear: both!important;\n}\n\n.footer-wrap .container p {\n	font-size: 12px;\n	color: #666;\n\n}\n\ntable.footer-wrap a {\n	color: #999;\n}\n\n\n/* -------------------------------------\n		TYPOGRAPHY\n------------------------------------- */\nh1, h2, h3 {\n	font-family: \"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif;\n	line-height: 1.1;\n	margin-bottom: 15px;\n	color: #000;\n	margin: 40px 0 10px;\n	line-height: 1.2;\n	font-weight: 200;\n}\n\nh1 {\n	font-size: 36px;\n}\nh2 {\n	font-size: 28px;\n}\nh3 {\n	font-size: 22px;\n}\n\np, ul, ol {\n	margin-bottom: 10px;\n	font-weight: normal;\n	font-size: 14px;\n}\n\nul li, ol li {\n	margin-left: 5px;\n	list-style-position: inside;\n}\n\n/* ---------------------------------------------------\n		RESPONSIVENESS\n		Nuke it from orbit. It\'s the only way to be sure.\n------------------------------------------------------ */\n\n/* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\n.container {\n	display: block!important;\n	max-width: 600px!important;\n	margin: 0 auto!important; /* makes it centered */\n	clear: both!important;\n}\n\n/* Set the padding on the td rather than the div for Outlook compatibility */\n.body-wrap .container {\n	padding: 20px;\n}\n\n/* This should also be a block element, so that it will fill 100% of the .container */\n.content {\n	max-width: 600px;\n	margin: 0 auto;\n	display: block;\n}\n\n/* Let\'s make sure tables in the content area are 100% wide */\n.content table {\n	width: 100%;\n}\n\n</style>\n</head>\n\n{/literal}\n\n<body bgcolor=\"#f6f6f6\">\n\n<!-- body -->\n<table class=\"body-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\" bgcolor=\"#FFFFFF\">\n\n			<!-- content -->\n			<div class=\"content\">\n			<table>\n				<tr>\n					<td>\n						<p>{$vendorRep},</p>\n						<p>A new order has been sent to you automatically from {$agencyName}.</p>\n						<h1>Order</h1>\n						<p>Please see the attached pdf.</p>\n						<h2>Changes/Revisions?</h2>\n						<p>You may reply to the address on this email with any changes/revisions.</p>\n\n						<p>Thank You.</p>\n						<p>{userFullName}</p>\n						<p><a href=\"http://bluhorn.com\">(Sent By BluHorn)</a></p>\n					</td>\n				</tr>\n			</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /body -->\n\n<!-- footer -->\n<table class=\"footer-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\">\n\n			<!-- content -->\n			<div class=\"content\">\n				<table>\n					<tr>\n						<td align=\"center\">\n							<p>Are you the wrong person to be receiving these orders? <a href=\"#\"><unsubscribe>Unsubscribe</unsubscribe></a>.\n							</p>\n						</td>\n					</tr>\n				</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /footer -->\n\n</body>\n</html>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(89,0,'MAIL_ORDER','2014-09-22 10:59:57','','to: {$to}\nreply-to: {$replyto|default:$from}\nfrom: {$from}\ncc: {$cc}\nsubject: {$subject} \nContent-Type: multipart/mixed; boundary={$boundary}\n\n{$begin}\nContent-Type: text/plain; charset=UTF-8\n\nPlease open the attached order.\n\n{foreach $attachments as $attachment}{$begin}\n{$attachment}\n{/foreach}\n{$end}\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(90,0,'send-order','2014-09-21 15:19:26','','<strong>Orders will be sent to the following vendors:</strong><br/>\n{foreach $vendorRep as $rep}\n{$rep.0.vendorName}: {$rep.0.contactName} {$rep.0.emailAddress}<br/>\n{/foreach}\n{if $emailAddress}\n<strong>A copy of each order will be sent to: {$emailAddress}</strong>\n{/if}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(91,0,'MAIL_MIME','2014-09-23 11:28:49','','to: {$to}\nreply-to: {$replyto|default:$from}\nfrom: {$from}\ncc: {$cc}\nsubject: {$subject} \nContent-Type: multipart/mixed; boundary={$boundary}\n\nThis is a multi-part message in MIME format\n\n{$begin}\nContent-Type: text/plain; charset=UTF-8\n\n{$text}\n\n\n{$begin}\nContent-Type: text/html; charset=UTF-8\nContent-Transfer-Encoding: quoted-printable\nContent-Disposition: inline\n\n{$html}\n\n{foreach $attachments as $attachment}{$begin}\n{$attachment}\n{/foreach}\n{$end}\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(92,0,'MAIL_WELCOME','2014-10-27 20:00:13','','{literal}\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta name=\"viewport\" content=\"width=device-width\" />\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n<title>Really Simple HTML Email Template</title>\n<style>\n/* -------------------------------------\n		GLOBAL\n------------------------------------- */\n* {\n	margin: 0;\n	padding: 0;\n	font-family: \"Helvetica Neue\", \"Helvetica\", Helvetica, Arial, sans-serif;\n	font-size: 100%;\n	line-height: 1.6;\n}\n\nimg {\n	max-width: 100%;\n}\n\nbody {\n	-webkit-font-smoothing: antialiased;\n	-webkit-text-size-adjust: none;\n	width: 100%!important;\n	height: 100%;\n}\n\n\n/* -------------------------------------\n		ELEMENTS\n------------------------------------- */\na {\n	color: #348eda;\n}\n\n.btn-primary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #348eda;\n	border: solid #348eda;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.btn-secondary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #aaa;\n	border: solid #aaa;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.last {\n	margin-bottom: 0;\n}\n\n.first {\n	margin-top: 0;\n}\n\n.padding {\n	padding: 10px 0;\n}\n\n\n/* -------------------------------------\n		BODY\n------------------------------------- */\ntable.body-wrap {\n	width: 100%;\n	padding: 20px;\n}\n\ntable.body-wrap .container {\n	border: 1px solid #f0f0f0;\n}\n\n\n/* -------------------------------------\n		FOOTER\n------------------------------------- */\ntable.footer-wrap {\n	width: 100%;	\n	clear: both!important;\n}\n\n.footer-wrap .container p {\n	font-size: 12px;\n	color: #666;\n\n}\n\ntable.footer-wrap a {\n	color: #999;\n}\n\n\n/* -------------------------------------\n		TYPOGRAPHY\n------------------------------------- */\nh1, h2, h3 {\n	font-family: \"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif;\n	line-height: 1.1;\n	margin-bottom: 15px;\n	color: #000;\n	margin: 40px 0 10px;\n	line-height: 1.2;\n	font-weight: 200;\n}\n\nh1 {\n	font-size: 36px;\n}\nh2 {\n	font-size: 28px;\n}\nh3 {\n	font-size: 22px;\n}\n\np, ul, ol {\n	margin-bottom: 10px;\n	font-weight: normal;\n	font-size: 14px;\n}\n\nul li, ol li {\n	margin-left: 5px;\n	list-style-position: inside;\n}\n\n/* ---------------------------------------------------\n		RESPONSIVENESS\n		Nuke it from orbit. It\'s the only way to be sure.\n------------------------------------------------------ */\n\n/* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\n.container {\n	display: block!important;\n	max-width: 600px!important;\n	margin: 0 auto!important; /* makes it centered */\n	clear: both!important;\n}\n\n/* Set the padding on the td rather than the div for Outlook compatibility */\n.body-wrap .container {\n	padding: 20px;\n}\n\n/* This should also be a block element, so that it will fill 100% of the .container */\n.content {\n	max-width: 600px;\n	margin: 0 auto;\n	display: block;\n}\n\n/* Let\'s make sure tables in the content area are 100% wide */\n.content table {\n	width: 100%;\n}\n\n</style>\n</head>\n\n<body bgcolor=\"#f6f6f6\">\n{/literal}\n<!-- body -->\n<table class=\"body-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\" bgcolor=\"#FFFFFF\">\n\n			<!-- content -->\n			<div class=\"content\">\n			<table>\n				<tr>\n					<td>\n						<p>{$firstName|default:\"Hi there\"},</p>\n						<p>Thank you for signing up for BluHorn!</p>\n						<h2>Getting Started</h2>\n						<p>We are here to help you get started, please let us know a time and date that works best to schedule your training.</p>\n						<h2>How do I use it?</h2>\n						<p>Watch videos, read the FAQ and dive right in, BluHorn is easy to use.</p>\n						<table>\n							<tr>\n								<td class=\"padding\">\n									<p><a href=\"https://bluhorn.filelogix.com/subscribe/accept/{$activationKey}/{$customerKey}/{$activationCode}/{$userKey}\" class=\"btn-primary\">Activate Your Subscription</a></p>\n								</td>\n							</tr>\n						</table>\n						<p>We look forward to hearing from you.</p>\n						<p>Thanks, have a great day!</p>\n						<p>Marie Meyer</p>\n						<p><a href=\"http://twitter.com/bluhorn\">Follow @bluhorn on Twitter</a></p>\n					</td>\n				</tr>\n			</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /body -->\n\n<!-- footer -->\n<table class=\"footer-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\">\n\n			<!-- content -->\n			<div class=\"content\">\n				<table>\n					<tr>\n						<td align=\"center\">\n							<p>Don\'t like these annoying emails? <a href=\"#\"><unsubscribe>Unsubscribe</unsubscribe></a>.\n							</p>\n						</td>\n					</tr>\n				</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /footer -->\n\n</body>\n</html>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(93,0,'password','2014-09-24 09:57:48','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Password | BluHorn </title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n	<style>\n\n.input-group-focus {\n  border-radius:4px;\n\n  -webkit-transition: box-shadow ease-in-out .15s;\n          transition: box-shadow ease-in-out .15s;\n}\n.input-group-addon {\n\n  -webkit-transition: border-color ease-in-out .15s;\n          transition: border-color ease-in-out .15s;\n}\n.input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, .6) !important;\n          box-shadow: inset 0 0px 0px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, .6) !important;  \n}\n.has-error.input-group.input-group-focus,\n.has-error .input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #ce8483 !important;\n          box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #ce8483 !important;\n}\n.has-warning.input-group.input-group-focus,\n.has-warning .input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #67b168 !important;\n          box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #67b168 !important;\n\n}\n.has-success .input-group.input-group-focus,\n.has-success .input-group.input-group-focus {\n  -webkit-box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #c0a16b !important;\n          box-shadow: inset 0 0px 0px rgba(0, 0, 0, .075), 0 0 6px #c0a16b !important;\n\n}\n.input-group-focus input:focus {\n  -webkit-box-shadow: none !important;\n          box-shadow: none !important;\n\n}\n\n.input-group-addon input:focus .has-error {\n	border: 0px solid #fff;\n	border-color: #ccc;\n}\n\n\n	</style>\n\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-login text-center\">\n\n		<div class=\"inner-page\">\n\n			<div class=\"logo\">\n				<a href=\"/\">\n					<img src=\"assets/img/kingboard-logo.png\" alt=\"\" />\n				</a>\n			</div>\n\n			<div class=\"login-box center-block\">\n\n          	{if $alertError}\n		<div class=\"alert alert-error\">\n                <a class=\"close\" data-dismiss=\"alert\" href=\"#\">Ã—</a>Please enter a valid username or email address.\n                </div>\n  		{/if}\n\n\n				<form action=\"/login/password\" method=\"post\" accept-charset=\"UTF-8\" onsubmit=\"return validate();\">\n			{if $showEmailAddress}\n					<div class=\"form-group\" id=\"emailAddressGroup\">\n						<label class=\"control-label\" for=\"emailAddress\">Email Address?</label>\n							<input type=\"text\" id=\"emailAddress\" name=\"emailAddress\" value=\"{$emailAddress}\" class=\"form-control\" onchange=\"javascript:checkEmailAddress();\" readonly>\n						<div class=\"pull-right\" style=\"margin-bottom: 10px;\" id=\"emailHelp\"></div>\n					</div>\n			{/if}\n					<div class=\"form-group\" id=\"passwordGroup\">\n						<label class=\"control-label\" for=\"password\">Password?</label>\n							<input type=\"password\" id=\"password\" name=\"password\" class=\"form-control\"  onchange=\"javascript:comparePasswords();\">\n					</div>\n					<div class=\"form-group\" id=\"confirmGroup\">\n						<label class=\"control-label\" for=\"confirm\">Confirm?</label>\n							<input type=\"password\"  id=\"confirm\" _name=\"confirm\"  class=\"form-control\" onkeyup=\"javascript:comparePasswords();\" style=\"box-shadow: none;\">\n						<div class=\"pull-right\" style=\"margin-bottom: 10px;\" id=\"passwordHelp\"></div>\n					</div>\n					<button id=\"resetButton\" class=\"btn btn-custom-default btn-lg btn-block btn-login\" disabled><i class=\"fa fa-arrow-circle-o-right\" ></i> Save Password</button>\n					<input type=\"hidden\" id=\"activationCode\" class=\"span4\" name=\"activationCode\" value=\"{$activationCode}\"> \n					<input type=\"hidden\" id=\"activationKey\" class=\"span4\" name=\"activationKey\" value=\"{$activationKey}\"> \n				</form>\n\n				<div class=\"links\">\n					<p><a href=\"/\">Return To Login</a></p>\n				</div>\n			</div>\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n</body>\n\n<script type=\"text/javascript\">\n\n	function checkEmailAddress() {\n\n		return true;\n	}\n\n	function comparePasswords() {\n\n		var password = document.getElementById(\"password\").value;\n		var confirm = document.getElementById(\"confirm\").value;\n\n		if (confirm == \"\") {\n			document.getElementById(\"passwordHelp\").innerHTML = \"\";\n			return false;\n\n		}\n		else if (password.length < 6) {\n			$(\"#passwordGroup\").addClass(\"has-error\");\n			document.getElementById(\"passwordHelp\").innerHTML = \"Password is too short.\";\n			return false;\n		}\n		else if (password == confirm) {\n			$(\"#confirmGroup\").removeClass(\"has-error\");\n			$(\"#passwordGroup\").removeClass(\"has-error\");\n\n			document.getElementById(\"passwordHelp\").innerHTML = \"Great! Passwords Match.\";\n\n			$(\"#resetButton\").removeClass(\"btn-custom-default\");\n			$(\"#resetButton\").addClass(\"btn-custom-primary\");\n			$(\"#resetButton\").attr(\"disabled\", false);\n\n			return true;\n		}\n		else {\n			$(\"#passwordGroup\").addClass(\"has-error\");\n			$(\"#confirmGroup\").addClass(\"has-error\");\n\n			document.getElementById(\"passwordHelp\").innerHTML = \"Passwords do not match\";\n			return false;\n		}\n	}\n\n$(document).ready(function() {\n    $(\".input-group > input\").focus(function(e){\n        $(this).parent().addClass(\"input-group-focus\");\n    }).blur(function(e){\n        $(this).parent().removeClass(\"input-group-focus\");\n    });\n});\n\n</script>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(95,0,'accept','2014-09-25 12:11:54','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Sign & Accept| BluHorn </title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<br>\n	<div class=\"full-page-wrapper center-block\">\n		<div class=\"container\">\n			<div class=\"col-lg-offset-2 col-lg-8\">\n				<div class=\"well\">\n\n\n\n						<!-- main -->\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Sign & Accept</h2>\n								<em>Please Accept & Confirm To Begin The Subscription</em>\n{if $subscription.isActive}\n								<span class=\"badge badge-success pull-right\">Active</span>\n{/if}\n							</div>\n\n							<div class=\"main-content\">\n								<!-- INVOICE -->\n								<div class=\"invoice\">\n									<!-- invoice header -->\n									<div class=\"invoice-header\">\n										<div class=\"row\">\n											<div class=\"col-lg-3 col-print-3\">\n												<img src=\"assets/img/kingboard-logo.png\" alt=\"BluHorn Logo\" />\n											</div>\n											<div class=\"col-lg-9 col-print-9\">\n												<ul class=\"list-inline\">\n\n\n													<li>Customer #:\n														<strong>{$customer.id|string_format:\"%06d\"}</strong>\n													</li>\n													<li>Date:\n														<strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}</strong>\n													</li>\n													<li>Total Amount:\n														<strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>\n													</li>\n												</ul>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice header -->\n									<!-- invoice address -->\n									<div class=\"invoice-from-to\">\n										<div class=\"row\">\n											<div class=\"col-sm-6 col-print-6\">\n												<span>PROVIDER</span>\n												<p class=\"name\">BluHorn, Inc.</p>\n												<address>\n													1611 San Marco Blvd\n													<br />Jacksonville, FL 32207\n													<br />\n													<div class=\"contact\">\n														<p><span>Email:</span> support@bluhorn.com</p>\n														<p><span>Phone:</span> (904) 232-3001</p>\n													</div>\n												</address>\n											</div>\n											<div class=\"col-sm-6 col-print-6\">\n												<span>CUSTOMER</span>\n\n												<p class=\"name\">{$customer.name}</p>\n												<address>\n													{$customer.address|replace:\"\\n\":\"<br>\"}\n\n																						<div class=\"contact\">\n														<p><span>Email:</span> {$customer.emailAddress}</p>\n														<p><span>Phone:</span> {$customer.phoneNumber}</p>\n			\n	</div>\n												</address>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice address -->\n									<!-- invoice item table -->\n									<div class=\"table-responsive\">\n										<table class=\"table invoice-table\">\n											<thead>\n												<tr>\n													<th>#</th>\n													<th>Description</th>\n													<th>Quantity</th>\n													<th>Term</th>\n													<th>Unit Price</th>\n													<th>Total</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $items as $item}\n												<tr>\n													<td>{$item.lineNumber}</td>\n													<td>{$item.description}</td>\n													<td>{$item.qty}</td>\n		\n	<td>{$item.amount}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n\n	<td>{$item.amount}</td>\n													<td>{$item.total}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n									<!-- end invoice item table -->\n\n									<!-- invoice footer -->\n									<div class=\"invoice-footer\">\n										<div class=\"row\">\n											<div class=\"col-sm-5 col-sm-offset-1 col-print-4 col-print-offset-2 right-col\">\n												<div class=\"invoice-total\">\n													<div class=\"row\">\n														<div class=\"col-xs-6 col-xs-offset-2 col-print-8 col-sm-6 col-sm-offset-2 col-md-6 col-md-offset-2 col-lg-5 col-lg-offset-3 col-print-offset-1\">\n															<p>{if $plan.isRenewable}{$subscription.period|lower|capitalize}{/if} Total</p>\n														</div>\n														<div class=\"col-xs-4 text-right col-print-4\">\n															<p>{$subscription.amount|default:\"$0.00\"}</p>\n														</div>\n													</div>\n												</div>\n											</div>\n											<div class=\"col-sm-6 col-print-6 left-col\">\n												<blockquote class=\"invoice-notes\">\n													<strong>Notes:</strong>\n													<p>{$subscription.notes}</p>\n												</blockquote>\n\n											</div>\n										</div>\n									</div>\n									<!-- end invoice footer -->\n\n<div class=\"panel panel-default\">\n<div class=\"panel-body\" style=\"text-align: center;\">\n								By reading and signing below, I agree to let BluHorn, Inc. charge my credit card <strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>{if $plan.term} for a {$plan.term} {$plan.periodStr} term, beginning <strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}{/if}</strong>. \n</div>\n</div>\n\n<div class=\"panel panel-default\">\n  <div class=\"panel-heading\">Terms & Conditions</div>\n  <div class=\"panel-body\" style=\"min-height: 100px; max-height: 200px; overflow-y: scroll;\">\n	{include file=\"db:eula\"}\n  </div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"panel-body\" style=\"text-align: center;\">\n							<h4><span class=\"col-lg-4\"><strong>Signed By: </strong><u>{$fullname}</u></span><span class=\"col-lg-4\"><strong>Date:  </strong><u>{$today}</u></span></h4><h6>IP Address: {$ipAddress}</h6>\n</div>\n</div>\n\n									<!-- invoice action buttons -->\n									<div class=\"invoice-buttons\">\n										{*\n<a href=\"/subscribe/change/plan/{$subscriptionKey}/{$customer.id}/{$subscription.id}\" class=\"btn btn-warning\"><i class=\"fa fa-arrow-left\"></i> Cancel Subscription</a>\n*}\n										<button class=\"btn btn-default print-btn\"><i class=\"fa fa-print\"></i> Print</button>\n										<a href=\"/subscribe/sign/{$subscriptionKey}/{$customerKey}/{$activationCode}/{$userKey}\" class=\"btn btn-custom-primary\"><i class=\"fa fa-home\"></i>Sign & Accept</a>									</div>\n									<!-- end invoice action buttons -->\n								</div>\n								<!-- INVOICE -->\n							</div>\n							<!-- /main-content -->\n						</div>\n						<!-- /main -->\n\n\n\n\n\n				</div>\n			</div>\n		</div>		\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-page.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(96,0,'signed','2014-09-25 12:19:52','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>Sign & Accept| BluHorn </title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn Dashboard\">\n	<meta name=\"author\" content=\"BluHorn\">\n\n	<!-- CSS -->\n	<link href=\"/assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"/assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<br>\n	<div class=\"full-page-wrapper center-block\">\n		<div class=\"container\">\n			<div class=\"col-lg-offset-2 col-lg-8\">\n				<div class=\"well\">\n\n\n\n						<!-- main -->\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Accepted</h2>\n								<em>Thank you! </em>\n								<div class=\"pull-right\">\n{if $subscription.isActive}\n									<span class=\"badge badge-success\">Active</span>\n{/if}\n{if $subscription.isSigned}\n									<span class=\"badge badge-success\">Signed</span>\n{/if}\n								</div>\n							</div>\n\n							<div class=\"main-content\">\n								<!-- INVOICE -->\n								<div class=\"invoice\">\n									<!-- invoice header -->\n									<div class=\"invoice-header\">\n										<div class=\"row\">\n											<div class=\"col-lg-3 col-print-3\">\n												<img src=\"assets/img/kingboard-logo.png\" alt=\"BluHorn Logo\" />\n											</div>\n											<div class=\"col-lg-9 col-print-9\">\n												<ul class=\"list-inline\">\n\n\n													<li>Customer #:\n														<strong>{$customer.id|string_format:\"%06d\"}</strong>\n													</li>\n													<li>Date:\n														<strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}</strong>\n													</li>\n													<li>Total Amount:\n														<strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>\n													</li>\n												</ul>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice header -->\n									<!-- invoice address -->\n									<div class=\"invoice-from-to\">\n										<div class=\"row\">\n											<div class=\"col-sm-6 col-print-6\">\n												<span>PROVIDER</span>\n												<p class=\"name\">BluHorn, Inc.</p>\n												<address>\n													1611 San Marco Blvd\n													<br />Jacksonville, FL 32207\n													<br />\n													<div class=\"contact\">\n														<p><span>Email:</span> support@bluhorn.com</p>\n														<p><span>Phone:</span> (904) 232-3001</p>\n													</div>\n												</address>\n											</div>\n											<div class=\"col-sm-6 col-print-6\">\n												<span>CUSTOMER</span>\n\n												<p class=\"name\">{$customer.name}</p>\n												<address>\n													{$customer.address|replace:\"\\n\":\"<br>\"}\n\n																						<div class=\"contact\">\n														<p><span>Email:</span> {$customer.emailAddress}</p>\n														<p><span>Phone:</span> {$customer.phoneNumber}</p>\n			\n	</div>\n												</address>\n											</div>\n										</div>\n									</div>\n									<!-- end invoice address -->\n									<!-- invoice item table -->\n									<div class=\"table-responsive\">\n										<table class=\"table invoice-table\">\n											<thead>\n												<tr>\n													<th>#</th>\n													<th>Description</th>\n													<th>Quantity</th>\n													<th>Term</th>\n													<th>Unit Price</th>\n													<th>Total</th>\n												</tr>\n											</thead>\n											<tbody>\n{foreach $items as $item}\n												<tr>\n													<td>{$item.lineNumber}</td>\n													<td>{$item.description}</td>\n													<td>{$item.qty}</td>\n		\n	<td>{$item.amount}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n\n	<td>{$item.amount}</td>\n													<td>{$item.total}{if $item.isRecurring}/{$item.periodStr}{/if}</td>\n												</tr>\n{/foreach}\n											</tbody>\n										</table>\n									</div>\n									<!-- end invoice item table -->\n\n									<!-- invoice footer -->\n									<div class=\"invoice-footer\">\n										<div class=\"row\">\n											<div class=\"col-sm-5 col-sm-offset-1 col-print-4 col-print-offset-2 right-col\">\n												<div class=\"invoice-total\">\n													<div class=\"row\">\n														<div class=\"col-xs-6 col-xs-offset-2 col-print-8 col-sm-6 col-sm-offset-2 col-md-6 col-md-offset-2 col-lg-5 col-lg-offset-3 col-print-offset-1\">\n															<p>{if $plan.isRenewable}{$subscription.period|lower|capitalize}{/if} Total</p>\n														</div>\n														<div class=\"col-xs-4 text-right col-print-4\">\n															<p>{$subscription.amount|default:\"$0.00\"}</p>\n														</div>\n													</div>\n												</div>\n											</div>\n											<div class=\"col-sm-6 col-print-6 left-col\">\n												<blockquote class=\"invoice-notes\">\n													<strong>Notes:</strong>\n													<p>{$subscription.notes}</p>\n												</blockquote>\n\n											</div>\n										</div>\n									</div>\n									<!-- end invoice footer -->\n\n<div class=\"panel panel-default\">\n<div class=\"panel-body\" style=\"text-align: center;\">\n								By reading and signing below, I agree to let BluHorn, Inc. charge my credit card <strong>{$plan.amount} {if $plan.isRecurring} per {$plan.periodStr}{/if}</strong>{if $plan.term} for a {$plan.term} {$plan.periodStr} term, beginning <strong>{$plan.startDate|date_format:\'%Y-%m-%d\'}{/if}</strong>. \n</div>\n</div>\n\n<div class=\"panel panel-default\">\n  <div class=\"panel-heading\">Terms & Conditions</div>\n  <div class=\"panel-body\" style=\"min-height: 100px; max-height: 200px; overflow-y: scroll;\">\n	{include file=\"db:eula\"}\n  </div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"panel-body\" style=\"text-align: center;\">\n							<h4><span class=\"col-lg-4\"><strong>Signed By: </strong><u>{$fullname}</u></span><span class=\"col-lg-4\"><strong>Date:  </strong><u>{$today}</u></span></h4><h6>From IP Address: {$ipAddress}<br/>Date & Time: {$signedStamp}</h6>\n</div>\n</div>\n\n									<!-- invoice action buttons -->\n									<div class=\"invoice-buttons\">\n										{*\n<a href=\"/subscribe/change/plan/{$subscriptionKey}/{$customer.id}/{$subscription.id}\" class=\"btn btn-warning\"><i class=\"fa fa-arrow-left\"></i> Cancel Subscription</a>\n*}\n										<button class=\"btn btn-default print-btn\"><i class=\"fa fa-print\"></i> Print</button>\n										<a href=\"/home\" class=\"btn btn-custom-primary\"><i class=\"fa fa-home\"></i>Home</a>\n									</div>\n									<!-- end invoice action buttons -->\n								</div>\n								<!-- INVOICE -->\n							</div>\n							<!-- /main-content -->\n						</div>\n						<!-- /main -->\n\n\n\n\n\n				</div>\n			</div>\n		</div>		\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"/assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-page.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(97,0,'MAIL_NOTIFY','2014-09-25 13:08:25','','{literal}\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta name=\"viewport\" content=\"width=device-width\" />\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n<title>Really Simple HTML Email Template</title>\n<style>\n/* -------------------------------------\n		GLOBAL\n------------------------------------- */\n* {\n	margin: 0;\n	padding: 0;\n	font-family: \"Helvetica Neue\", \"Helvetica\", Helvetica, Arial, sans-serif;\n	font-size: 100%;\n	line-height: 1.6;\n}\n\nimg {\n	max-width: 100%;\n}\n\nbody {\n	-webkit-font-smoothing: antialiased;\n	-webkit-text-size-adjust: none;\n	width: 100%!important;\n	height: 100%;\n}\n\n\n/* -------------------------------------\n		ELEMENTS\n------------------------------------- */\na {\n	color: #348eda;\n}\n\n.btn-primary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #348eda;\n	border: solid #348eda;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.btn-secondary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #aaa;\n	border: solid #aaa;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.last {\n	margin-bottom: 0;\n}\n\n.first {\n	margin-top: 0;\n}\n\n.padding {\n	padding: 10px 0;\n}\n\n\n/* -------------------------------------\n		BODY\n------------------------------------- */\ntable.body-wrap {\n	width: 100%;\n	padding: 20px;\n}\n\ntable.body-wrap .container {\n	border: 1px solid #f0f0f0;\n}\n\n\n/* -------------------------------------\n		FOOTER\n------------------------------------- */\ntable.footer-wrap {\n	width: 100%;	\n	clear: both!important;\n}\n\n.footer-wrap .container p {\n	font-size: 12px;\n	color: #666;\n\n}\n\ntable.footer-wrap a {\n	color: #999;\n}\n\n\n/* -------------------------------------\n		TYPOGRAPHY\n------------------------------------- */\nh1, h2, h3 {\n	font-family: \"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif;\n	line-height: 1.1;\n	margin-bottom: 15px;\n	color: #000;\n	margin: 40px 0 10px;\n	line-height: 1.2;\n	font-weight: 200;\n}\n\nh1 {\n	font-size: 36px;\n}\nh2 {\n	font-size: 28px;\n}\nh3 {\n	font-size: 22px;\n}\n\np, ul, ol {\n	margin-bottom: 10px;\n	font-weight: normal;\n	font-size: 14px;\n}\n\nul li, ol li {\n	margin-left: 5px;\n	list-style-position: inside;\n}\n\n/* ---------------------------------------------------\n		RESPONSIVENESS\n		Nuke it from orbit. It\'s the only way to be sure.\n------------------------------------------------------ */\n\n/* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\n.container {\n	display: block!important;\n	max-width: 600px!important;\n	margin: 0 auto!important; /* makes it centered */\n	clear: both!important;\n}\n\n/* Set the padding on the td rather than the div for Outlook compatibility */\n.body-wrap .container {\n	padding: 20px;\n}\n\n/* This should also be a block element, so that it will fill 100% of the .container */\n.content {\n	max-width: 600px;\n	margin: 0 auto;\n	display: block;\n}\n\n/* Let\'s make sure tables in the content area are 100% wide */\n.content table {\n	width: 100%;\n}\n\n</style>\n</head>\n\n<body bgcolor=\"#f6f6f6\">\n{/literal}\n<!-- body -->\n<table class=\"body-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\" bgcolor=\"#FFFFFF\">\n\n			<!-- content -->\n			<div class=\"content\">\n			<table>\n				<tr>\n					<td>\n						<p>Marie,</p>\n						<p>You have a new subscriber!</p>\n						<h2>{$firstName} {$lastName} of {$customerName}</h2>\n						<table>\n							<tr>\n								<td class=\"padding\">\n									<p><a href=\"https://bluhorn.filelogix.com/admin/agency/edit/{$agencyID}\" class=\"btn-primary\">View More</a></p>\n								</td>\n							</tr>\n						</table>\n					</td>\n				</tr>\n			</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /body -->\n\n<!-- footer -->\n<table class=\"footer-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\">\n\n			<!-- content -->\n			<div class=\"content\">\n				<table>\n					<tr>\n						<td align=\"center\">\n							<p>This email was sent automatically from BluHorn, Inc.</a>.\n							</p>\n						</td>\n					</tr>\n				</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /footer -->\n\n</body>\n</html>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(98,0,'maintenance','2014-09-25 13:28:48','','<!DOCTYPE html>\n<!--[if IE 9 ]><html class=\"ie ie9\" lang=\"en\" class=\"no-js\"> <![endif]-->\n<!--[if !(IE)]><!-->\n<html lang=\"en\" class=\"no-js\">\n<!--<![endif]-->\n\n<head>\n	<base href=\"{$base|default:\"/bluhorn/\"}\">\n	<title>404 Page Not Found | BluHorn</title>\n	<meta charset=\"utf-8\">\n	<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\">\n	<meta name=\"description\" content=\"BluHorn\">\n	<meta name=\"author\" content=\"BluHorn (powered by FileLogix)\">\n\n	<!-- CSS -->\n	<link href=\"assets/css/bootstrap.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"assets/css/font-awesome.min.css\" rel=\"stylesheet\" type=\"text/css\">\n	<link href=\"assets/css/main.css\" rel=\"stylesheet\" type=\"text/css\">\n\n	<!-- Fav and touch icons -->\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"assets/ico/kingboard-favicon144x144.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"assets/ico/kingboard-favicon114x114.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"assets/ico/kingboard-favicon72x72.png\">\n	<link rel=\"apple-touch-icon-precomposed\" sizes=\"57x57\" href=\"assets/ico/kingboard-favicon57x57.png\">\n	<link rel=\"shortcut icon\" href=\"assets/ico/favicon.png\">\n\n</head>\n\n<body>\n	<div class=\"full-page-wrapper page-error text-center\">\n		<div class=\"inner-page\">\n			<h1>\n				<span class=\"clearfix title\">\n					<span class=\"number\">503</span>\n					<span class=\"text\">Hold on...<br/>Check back soon!</span>\n				</span>\n			</h1>\n\n			<p>The page you are requesting is currently under maintenance.  please <a href=\"mailto:support@bluhorn.com\">contact us</a> to report this issue.</p>\n			<p>We will have this feature ready for use very soon.</p>\n			<p class=\"hide\">You can also use search form below to find the page you are looking for.</p>\n			<form class=\"searchbox center-block hidden\">\n				<div class=\"input-group input-group-lg\">\n					<input type=\"search\" placeholder=\"type keyword here\" class=\"form-control\">\n					<span class=\"input-group-btn\">\n						<button class=\"btn btn-primary\" type=\"button\"><i class=\"fa fa-search\"></i> Search</button>\n					</span>\n				</div>\n			</form>\n			<p>\n				<a href=\"javascript:history.go(-1)\" class=\"btn btn-custom-primary\"><i class=\"fa fa-arrow-left\"></i> Go Back</a>\n				<a href=\"#\" class=\"btn btn-primary\"><i class=\"fa fa-home\"></i> Home</a>\n			</p>\n		</div>\n\n		<footer class=\"footer\">&copy; 2014 BluHorn (powered by FileLogix)</footer>\n	</div>\n\n	<!-- Javascript -->\n	<script type=\"text/javascript\" src=\"assets/js/jquery-2.1.0.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/modernizr.js\"></script>\n\n</body>\n\n</html>','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0);
INSERT  IGNORE INTO `FLX_TEMPLATE` (`id`, `templateID`, `name`, `modified`, `title`, `source`, `template`, `sequence`, `media`, `version`, `editWith`, `doctype`, `status`, `expireStamp`, `beginStamp`, `views`, `isDefault`, `themeID`) VALUES (99,0,'worksheet-digital-alt-new','2015-03-09 13:49:04','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-Digital | BluHorn{/block}\n{block name=\"header-js\"}\n\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n	<link href=\"/lib/datetimepicker/css/bootstrap-datetimepicker.min.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n	text-align: center;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 1px 2px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Digital (New)</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Digital)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet</h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar\">\n<div class=\"control-inline toolbar-item-group\">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\">\n												<div class=\"container\">\n											   	<div class=\"col-lg-6\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'}   <strong>Campaign:</strong> {$campaign.name|default:\'none\'}    <strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong>  {foreach $vendors as $vendor} <a href=\"/vendors/edit/{$vendor.id}\">{$vendor.name}</a>{/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Contract #:</strong> {$campaign.contractNumber|default:\'none\'}</div>\n												</div>\n\n												<div class=\"col-md-12 col-lg-6 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 19, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n												</div>\n												</div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"17\">\n												     </form>\n												</div>\n\n											</div>\n											<div class=\"widget-footer\" id=\"worksheet-footer\">\n												Worksheet Loaded.\n											</div>\n								</div>\n\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Insertion Order</h3>\n												<em></em>\n												<div class=\"btn-group widget-header-toolbar\">\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"><i class=\"fa fa-chevron-down\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"Digital\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Station(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printStartDate\"  value=\"1\" {if $order.printStartDate}checked{elseif !$order.id}checked{/if} > Start Date</label><br>\n												        <label><input type=\"checkbox\" name=\"printEndDate\"  value=\"1\" {if $order.printEndDate}checked{elseif !$order.id}checked{/if} > End Date</label><br>\n												        <label><input type=\"checkbox\" name=\"printType\" value=\"1\" {if $order.printType}checked{elseif !$order.id}checked{/if} > Type</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printName\"  value=\"1\" {if $order.printCaption}checked{elseif !$order.id}checked{/if} > Name</label><br>\n												        <label><input type=\"checkbox\" name=\"printLocation\"  value=\"1\" {if $order.printLocation}checked{elseif !$order.id}checked{/if}  > Site/URL</label><br>\n												        <label><input type=\"checkbox\" name=\"printDeadline\"  value=\"1\" {if $order.printDeadline}checked{/if}> Deadline</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printCPI\"  value=\"1\" {if $order.printCPI}checked{elseif !$order.id}checked{/if} > Impressions</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPC\"  value=\"1\" {if $order.printCPC}checked{elseif !$order.id}checked{/if} > Clicks</label><br>\n												      </div>\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printGrossDollars\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if} > Gross Dollars</label><br>\n												        <label><input type=\"checkbox\" name=\"printNetDollars\"  value=\"1\" {if $order.printNetDollars}checked{elseif !$order.id}checked{/if} > Net Dollars</label><br>\n												      </div>\n\n												</div>\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>												</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\" id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs hide\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"date\" id=\"summary-switch-date\" onchange=\"javascript:summarySwitchDigital();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"vendor\" id=\"summary-switch-vendor\" onchange=\"javascript:summarySwitchDigital();\"> V\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitchDigital();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												<tbody id=\"summaryTotals\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Inserts: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Gross: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalGrossSpend\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total Net: </strong></td><td style=\"text-align: right;\"><div id=\"totalNetSpend\">$0.00</div></td></tr>\n												</tbody>\n												</table>	\n{if $userID==1}\n												<div class=\"vendor-summary-widget\" id=\"vendor-summary-widget\" ></div>\n{/if}\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n<div class=\"form\">\n<table id=\"worksheet-{$worksheet.id}\" class=\"table  table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n          <tr>\n                            <th colspan=\"9\">&nbsp;</th>\n                            <th colspan=\"3\" style=\"text-align: center;\">Gross</th>\n                            <th colspan=\"3\" style=\"text-align: center;\">Net</th>\n                            <th colspan=\"6\">&nbsp;</th>\n  	   </tr>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"caption\">Name</th>\n                <th data-index=\"startDate\">Start Date</th>\n                <th data-index=\"endDate\">End Date</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"type\">Type</th>\n                <th data-index=\"impressions\">Imp</th>\n                <th data-index=\"clicks\">Clicks</th>\n                <th data-index=\"grossCPI\">CPI</th>\n                <th data-index=\"grossCPC\">CPC</th>\n                <th data-index=\"grossCost\">Cost</th>\n                <th data-index=\"netCPI\">CPI</th>\n                <th data-index=\"netCPC\">CPC</th>\n                <th data-index=\"netCost\">Cost</th>\n                <th data-index=\"location\">Site/URL</th>\n                <th data-index=\"creativeDeadline\">Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n\n            <tr >\n		<td style=\"text-align: center;\"></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-name-{$line.worksheetLine}\" name=\"name[]\" data-index=\"name\" data-name=\"name\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"{$line.name|escape:\'html\'}\"></td>\n              <td><div class=\'input-group input-sm date date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-startDate-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-startDate-{$line.worksheetLine}\" value=\"{if $line.startDate != \"0000-00-00\"}{$line.startDate|escape:\'html\'}{/if}\" name=\"startDate[]\" data-index=\"startDate\" data-name=\"startDate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n              <td><div class=\'input-group input-sm date date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-endDate-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-endDate-{$line.worksheetLine}\" value=\"{if $line.endDate != \"0000-00-00\"}{$line.endDate|escape:\'html\'}{/if}\" name=\"endDate[]\" data-index=\"endDate\" data-name=\"endDate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  style=\"min-width: 120px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name|escape:\'html\'}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-type-{$line.worksheetLine}\" value=\"{$line.type|escape:\'html\'}\" name=\"type[]\" data-index=\"type\" data-name=\"type\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\"  size=3 id=\"field-impressions-{$line.worksheetLine}\" value=\"{$line.impressions}\" name=\"impressions[]\" data-index=\"impressions\" data-name=\"impressions\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n            <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-clicks-{$line.worksheetLine}\" size=3 value=\"{$line.clicks}\" name=\"clicks[]\" data-index=\"clicks\" data-name=\"clicks\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-{$line.worksheetLine}\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.grossCPI}\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" ></div></td>\n              <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpc-{$line.worksheetLine}\" value=\"{$line.grossCPC}\" size=\"6\" name=\"grossCPC[]\" data-index=\"grossCPC\" data-name=\"grossCPC\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-{$line.worksheetLine}\" value=\"{$line.grossCost}\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-{$line.worksheetLine}\" value=\"{$line.netCPI}\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" {if $worksheet.isAutoComm}  tabindex=\"-1\" readonly {/if} ></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpc-{$line.worksheetLine}\" value=\"{$line.netCPC}\" size=\"6\" name=\"netCPC[]\"   data-name=\"netCPC\" data-line=\"{$line.worksheetLine}\" data-index=\"netCPC\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-{$line.worksheetLine}\" value=\"{$line.netCost}\" size=\"6\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"{$line.worksheetLine}\" data-index=\"netTotal\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-siteurl-{$line.worksheetLine}\" value=\"{$line.location|escape:\'html\'}\" size=\"40\" name=\"siteURL[]\" data-index=\"siteURL\" data-name=\"siteURL\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-{$line.worksheetLine}\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-{$line.worksheetLine}\"  value=\"{if $line.creativeDeadline != \"0000-00-00 00:00:00\"}{$line.creativeDeadline|escape:\'html\'}{/if}\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=30 value=\"{$line.comments|escape:\'html\'}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-{$line.worksheetLine}\" value=\"{$line.vendorName}\" name=\"vendorName[]\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button></td>\n                <td><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n             <td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-name-new\" name=\"name[]\" data-index=\"name\" data-name=\"name\" data-line=\"new\" data-row=\"new\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\" value=\"\"></td>\n              <td><div class=\'input-group input-sm date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-startDate-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-startDate-new\" value=\"\" name=\"startDate[]\" data-index=\"startDate\" data-name=\"startDate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>    \n              <td><div class=\'input-group input-sm date datetimepicker-dateonly\' data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-endDate-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-endDate-new\" value=\"\" name=\"endDate[]\" data-index=\"endDate\" data-name=\"endDate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>        \n	 <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  style=\"min-width: 120px;\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n              <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-type-new\" value=\"\" name=\"type[]\" data-index=\"type\" data-name=\"type\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\"  size=3 id=\"field-impressions-new\" value=\"\" name=\"impressions[]\" data-index=\"impressions\" data-name=\"impressions\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n            <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-clicks-new\" size=3 value=\"\" name=\"clicks[]\" data-index=\"clicks\" data-name=\"clicks\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-new\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpc-new\" value=\"\" size=\"6\" name=\"grossCPC[]\" data-index=\"grosscpc\" data-name=\"grossCPC\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-new\" value=\"\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\" ></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-new\" value=\"\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"   {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpc-new\" value=\"\" size=\"6\" name=\"netCPC[]\"  data-name=\"netCPC\" data-line=\"new\" data-index=\"netCPC\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if} onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-nettotal-new\" value=\"\" size=\"6\" name=\"netTotal[]\"  data-name=\"netTotal\" data-line=\"new\" data-index=\"netTotal\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if} onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-siteURL-new\" value=\"\" size=\"40\" name=\"siteURL[]\" data-index=\"siteURL\" data-name=\"siteURL\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n             <td><div class=\'input-group input-sm date datetimepicker-datetime\' data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-new\">\n<input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-new\" value=\"\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span>\n                    </span></td>\n\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=30  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"3\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                 <th>Line</th>\n                <th>Line #</th>\n                <th>Name</th>\n                <th>Start Date</th>\n                <th>End Date</th>\n                <th>Vendor</th>\n                <th>Type</th>\n                <th>Imp</th>\n                <th>Clicks</th>\n                <th>Gross CPI</th>\n                <th>CPC</th>\n                <th>Total</th>\n                <th>Net CPI</th>\n                <th>CPC</th>\n                <th>Total</th>\n                <th>Site/URL</th>\n                <th>Deadline</th>\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n{/block}\n\n	{block name=\"datatables\"}\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/media/js/jquery.dataTables.min.js\"></script>\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10/extensions/FixedColumns/js/dataTables.fixedColumns.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n\n	{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/moment/moment-2.7.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/datetimepicker/js/bootstrap-datetimepicker.min.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-datepicker.js\"></script>\n	<script src=\"/js/bluhorn.js\"></script>\n\n	<script>\n\n	  var vendorList = {};\n\n          {foreach $vendors as $vendor} \n	   	vendorList[ \"{$vendor.id}\" ]=\"{$vendor.name}\";\n 	   {/foreach}\n\n	var lastCursor = 0;\n        var data;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n//		    minDate: moment()\n		    default: moment(),\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\n$(document).ready(function(){\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n});\n\n\n		$(document).ready(function() {\n\n		   updateSummaryDigital();\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n		$(document).ready(function() {\n\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n      					  \"order\": [[ 1, \'asc\' ]],\n\n\"columns\": [\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"120px\", \"orderDataType\": \"dom-text\", \"type\":\"numeric\"},\n     { width: \"120px\", \"orderDataType\": \"dom-text\", \"type\":\"numeric\"},\n     { width: \"120px\", \"searchable\": false, \"orderDataType\": \"dom-select\"},\n     { width: \"70px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"100px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"50px\", \"orderDataType\": \"dom-text\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"150px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n					  \"lengthMenu\": [[10, 25, 50, 100, -1], [10, 25, 50, 100, \"All\"]],\n					  \"autoWidth\": false,			\n					  \"displayLength\": -1,\n					  \"paginate\": true,\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n			updateSelectValues();\n		}\n				\n			  } );\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n \n{/literal}\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw();\n*/\n\n		reSort();\n\n			  $(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { 		  console.log(\"sort\"); fGetSortInfo(); } );\n		} );\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		  updateSelectValues();\n		}\n\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var vendors = [];\n\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n	  var maxLineNumber = {$maxLineNumber|default:1};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n\n\n	{if $wsLines|@count>0}\n	  data = [ \n			{foreach $wsLines as $line}\n				{ lineNumber: \"{$line.worksheetLine}\", vendor: \"{$line.vendorName|escape:\'javascript\'}\", vendorName: \"{$line.vendorName|escape:\'javascript\'}\", vendorID: \"{$line.vendorID}\", insertionDate: \"{$line.insertionDate|escape:\'javascript\'}\", startDate: \"{$line.startDate|escape:\'javascript\'}\",  endDate: \"{$line.endDate|escape:\'javascript\'}\",name: \"{$line.name|escape:\'javascript\'}\", clicks: \"{$line.clicks}\", grossTotal: \"{$line.grossCost}\", netTotal: \"{$line.netCost}\",  impressions: \"{$line.impressions|escape:\'javascript\'}\", grossCPI: \"{$line.grossCPI}\", grossCPC: \"{$line.grossCPC}\", netCPC: \"{$line.netCPC}\",  netCPI: \"{$line.netCPI}\", deadline: \"{$line.creativeDeadline}\", siteURL: \"{$line.location|escape:\'javascript\'}\", type: \"{$line.type|escape:\'javascript\'}\", color: \"{$line.color|escape:\'javascript\'}\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments|escape:\'javascript\'}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, delete: {if $line.isDeleted}true{else}false{/if} } {if ! $line@last},{/if}\n			{/foreach}\n	  ];\n	{else}\n				{ lineNumber: maxLineNumber, vendorName: \"\", vendor: \"\", vendorID: \"\", startDate: \"\", endDate: \"\", name: \"\",  type: \"\", clicks: \"\", grossTotal: \"\", grossCPC: \"\", netCPC: \"\", netTotal: \"\",  impressions: \"\", grossCPI: \"\",  netCPI: \"\", deadline: \"\", siteURL: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments}\", copy: false, bold: false, delete: false }\n\n	{/if}\n\n	var maxRow = data.length;\n\n		data[maxRow] = { lineNumber: \"\", vendorName:\"\", vendor: \"\", vendorID: \"\", startDate: \"\",  endDate: \"\", name: \"\",  clicks: \"\", grossTotal: \"\", netTotal: \"\",  impressions: \"\", grossCPC: \"\", netCPC: \"\",  grossCPI: \"\", type: \"\", netCPI: \"\", deadline: \"\", siteURL: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"\", copy: false, bold: false, delete: false  };\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n			$(document).ready(function(){\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n	function calculateLines() {\n			var row=0;\n			data.forEach(function(line) {\n					data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(3); \n					data[row][\"cpm\"] =   ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n			$.post( \"/digital/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n		    }\n		}\n	    }\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/digital/ajax/lines/remove/{$worksheet.id}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/digital/ajax/line/update/{$worksheet.id}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/digital/ajax/line/add/{$worksheet.id}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", \"disabled\");\n			$.post( \"/digital/ajax/lines/update/{$worksheet.id}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/digital/edit/{$worksheet.id}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n		dt.draw();\n\n		$(\"#worksheet-footer\").html(\"Sorted!\");\n	}\n\n	function updateSelectValues() {\n\n/*\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				console.log(src.lineNumber);\n				if ($(\'#field-vendorID-\'+src.lineNumber).length) {\n					$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				}\n			}\n		});\n\n*/\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function saveOrder() {\n			$.post( \"/orders/ajax/create/digital/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		saveOrder();\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/digital/ajax/delete/{$worksheetID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\")-1;\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n		data[row] = { lineNumber: \"\", vendor: \"\", vendorID: \"\", startDate: \"\", endDate: \"\", name: \"\",  clicks: \"\", grossTotal: \"\", grossCPC: \"\", netCPC: \"\", netTotal: \"\",  type: \"\", impressions: \"\", grossCPI: \"\", netCPI: \"\", deadline: \"\", siteURL: \"\", color: \"\", commission: \"{$worksheet.commission|default:0}\", comments: \"{$line.comments}\", copy: false, bold: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n//console.log(fieldName);\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			data[row][\"vendorName\"] = $(\"#field-vendorID-\"+line + \" option:selected\").text();\n			$(\"#field-vendorName-\"+line).val(data[row][\"vendorName\"]);\n			var table =  $(\'#worksheet-{$worksheet.id}\').DataTable();			table.draw();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"name\") {\n			newValue = $(field).val();\n			data[row][\"name\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n\n		else if (fieldName == \"type\") {\n			newValue = $(field).val();\n			data[row][\"type\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName ==\"startDate\") {\n			newValue = $(field).val();\n			data[row][\"startDate\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName ==\"endDate\") {\n			newValue = $(field).val();\n			data[row][\"endDate\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName ==\"deadline\") {\n			newValue = $(field).val();\n			data[row][\"deadline\"] = newValue;\n			var changes = [[row,fieldName,0,newValue]];\n		}\n\n		else if (fieldName == \"siteURL\") {\n			newValue = $(field).val();\n			data[row][\"siteURL\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"clicks\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if ((oldValue == \"\") || (newValue == 0)) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosstotal-\"+line).attr(\"disabled\",false);\n				$(\"#field-grosstotal-\"+line).attr(\"readonly\",false);\n\n\n				data[row][\"grossTotal\"] = \"\";\n\n				$(\"#field-grosscpi-\"+line).val(\"\");\n				$(\"#field-netcpi-\"+line).val(\"\");\n\n				{if $worksheet.isAutoComm < 1}  \n					$(\"#field-nettotal-\"+line).attr(\"disabled\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\", false);\n					$(\"#field-nettotal-\"+line).attr(\"tabindex\", \"\");\n				{/if}\n				var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,fieldName,oldValue,newValue]];\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosscpi-\"+line).attr(\"readonly\", false);\n\n				{if $worksheet.isAutoComm < 1} \n					$(\"#field-netcpi-\"+line).attr(\"disabled\",false);\n					$(\"#field-netcpi-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n				{/if}\n\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"clicks\"] = newValue;\n				$(\"#field-clicks-\"+line).val(data[row][\"clicks\"]);\n				data[row][\"grossTotal\"] =  ((data[row][\"clicks\"] * data[row][\"grossCPC\"]) + (data[row][\"impressions\"] * data[row][\"grossCPI\"])).toFixed(2); \n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commissiom\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else}\n					var changes = [[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"impressions\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if ((oldValue == \"\")  || (newValue == 0)) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n\n\n				{if $worksheet.isAutoComm < 1} \n					$(\"#field-nettotal-\"+line).attr(\"disabled\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"tabindex\", \"\");\n				{/if}\n\n\n				$(\"#field-grosscpi-\"+line).val(\"\");\n				$(\"#field-netcpi-\"+line).val(\"\");\n				var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,fieldName,oldValue,newValue]];\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(\"#field-grosscpi-\"+line).attr(\"readonly\", false);\n\n				{if !$worksheet.isAutoComm} \n					$(\"#field-netcpi-\"+line).attr(\"disabled\",false);\n					$(\"#field-netcpi-\"+line).attr(\"readonly\",false);\n					$(\"#field-nettotal-\"+line).attr(\"readonly\",false);\n				{/if}\n\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impressions\"] = newValue;\n				$(\"#field-impressions-\"+line).val(data[row][\"impressions\"]);\n				data[row][\"grossTotal\"] =  ((data[row][\"clicks\"] * data[row][\"grossCPC\"]) + (data[row][\"impressions\"] * data[row][\"grossCPI\"])).toFixed(2); \n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else}\n					var changes = [[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossCPI\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n				data[row][\"grossCPI\"] = \"0.00\";\n			}\n			else if (newValue == 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n				data[row][\"grossCPI\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(\"#field-grosscpi-\"+line).attr(\"disabled\", false);\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossCPI\"] = newValue;\n				$(\"#field-grosscpi-\"+line).val(data[row][\"grossCPI\"]);\n				data[row][\"grossTotal\"] =  ((data[row][\"clicks\"] * data[row][\"grossCPC\"]) + (data[row][\"impressions\"] * data[row][\"grossCPI\"])).toFixed(2); \n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossCPI\"])).toFixed(2);\n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossCPC\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossCPC\"] = \"0.00\";\n			}\n\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				oldValue = data[row][\"grossCPC\"];\n				data[row][\"grossCPC\"] = newValue;\n				data[row][\"grossTotal\"] =  ((data[row][\"clicks\"] * data[row][\"grossCPC\"]) + (data[row][\"impressions\"] * data[row][\"grossCPI\"])).toFixed(2); \n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n		\n				$(\"#field-grosscpc-\"+line).val(data[row][\"grossCPC\"]);\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n					data[row][\"netCPC\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossCPC\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					$(\"#field-netcpc-\"+line).val(data[row][\"netCPC\"]);\n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netCPC\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPC\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPC\"] = newValue;\n//				data[row][\"grossTotal\"] =  ( data[row][\"cols\"] * data[row][\"impressions\"] * data[row][\"grossCPI\"] + data[row][\"netCPC\"] ).toFixed(2); \n				$(\"#field-netcpc-\"+line).val(data[row][\"netCPC\"]);\n				data[row][\"netTotal\"] =  ((data[row][\"clicks\"] * data[row][\"netCPC\"]) + (data[row][\"impressions\"] * data[row][\"netCPI\"])).toFixed(2); \n				$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n				{if $worksheet.isAutoComm} \n//					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n//					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"grossTotal\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"grossTotal\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"grossTotal\"] = newValue;\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-grosstotal-\"+line).val(data[row][\"grossTotal\"]);\n\n//				data[row][\"grossCPC\"] = ( ( ( (data[row][\"clicks\"]) / (data[row][\"clicks\"] + data[row][\"impressions\"]) ) * (data[row][\"grossTotal\"]) ) ).toFixed(2);\n\n//				data[row][\"grossCPI\"] = ( (((data[row][\"impressions\"])/(data[row][\"clicks\"] + data[row][\"impressions\"])) * (data[row][\"grossTotal\"]) )  ).toFixed(2);\n\n//				$(\"#field-grosscpc-\"+line).val(data[row][\"grossCPC\"]);\n//				$(\"#field-grosscpi-\"+line).val(data[row][\"grossCPI\"]);\n\n				{if $worksheet.isAutoComm} \n					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"grossCPI\",0,data[row][\"grossCPI\"]],[row,\"grossTotal\",0,data[row][\"grossTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netCPI\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPI\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netCPI\"] = newValue;\n				$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n				data[row][\"netTotal\"] =  ((data[row][\"clicks\"] * data[row][\"netCPC\"]) + (data[row][\"impressions\"] * data[row][\"netCPI\"])).toFixed(2); \n				$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n				{if $worksheet.isAutoComm} \n//					data[row][\"netTotal\"] = ((1-{$worksheet.commission|default:\"(data[row][\'commission\']\"}/100)*(data[row][\"grossTotal\"])).toFixed(2);\n//					$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,\"netTotal\",0,data[row][\"netTotal\"]],[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"netTotal\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (oldValue == \"\") {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"netTotal\"] = \"0.00\";\n			}\n			else if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				data[row][\"netTotal\"] = newValue;\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				$(\"#field-nettotal-\"+line).val(data[row][\"netTotal\"]);\n\n				{if !$worksheet.isAutoComm} \n					data[row][\"netCPI\"] = ( (data[row][\"netTotal\"]) / ( (data[row][\"cols\"])*(data[row][\"impressions\"]) ) ).toFixed(2);\n					$(\"#field-netcpi-\"+line).val(data[row][\"netCPI\"]);\n					var changes = [[row,\"netCPI\",0,data[row][\"netCPI\"]],[row,fieldName,oldValue,newValue]];\n				{else} \n					var changes = [[row,fieldName,oldValue,newValue]];\n				{/if}\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n\n		else if (fieldName == \"color\") {\n			newValue = $(field).val();\n			data[row][\"color\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"siteURL\") {\n			newValue = $(field).val();\n			data[row][\"position\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n			console.log(\"building new line \" + row);\n			console.log(data[row]);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummaryDigital();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n\n		console.log(data[maxRow-1]);\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td style=\"text-align: center;\"></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n                \'<td><input type=\"text\"  size=30  class=\"form-control input-sm worksheet-field\" id=\"field-name-\'+maxLineNumber+\'\" name=\"name[]\" data-index=\"name\" data-name=\"name\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" value=\"\'+data[maxRow-1][\"name\"]+\'\"></td>\',\n               \'<td><div class=\"input-group input-sm date date datetimepicker-dateonly\" data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-startDate-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-startDate-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"startDate\"]+\'\" name=\"startDate[]\" data-index=\"startDate\" data-name=\"startDate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n               \'<td><div class=\"input-group input-sm date date datetimepicker-dateonly\" data-date-format=\"YYYY-MM-DD\" data-target-id=\"field-endDate-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 90px;\" id=\"field-endDate-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"endDate\"]+\'\" name=\"endDate[]\" data-index=\"endDate\" data-name=\"endDate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n               \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  style=\"min-width: 120px;\" name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\">{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\',\n              \'<td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-type-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"type\"]+\'\" name=\"type[]\" data-index=\"type\" data-name=\"type\" data-line=\"{$line.worksheetLine}\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n               \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\"  size=3 id=\"field-impressions-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"impressions\"]+\'\" name=\"impressions[]\" data-index=\"impressions\" data-name=\"impressions\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n              \'<td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-clicks-\'+maxLineNumber+\'\" size=3 value=\"\'+data[maxRow-1][\"clicks\"]+\'\" name=\"clicks[]\" data-index=\"clicks\" data-name=\"clicks\" data-line=\"{$line.worksheetLine}\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpi-{$line.worksheetLine}\" data-index=\"grossCPI\" data-name=\"grossCPI\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"grossCPI\"]+\'\" size=\"6\" name=\"grossCPI[]\" onchange=\"updateField(this);\" ></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosscpc-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"grossCPC\"]+\'\" size=\"6\" name=\"grossCPC[]\" data-index=\"grossCPC\" data-name=\"grossCPC\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" ></td>\',\n \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-grosstotal-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"grossTotal\"]+\'\" size=\"6\" name=\"grossTotal[]\" data-index=\"grossTotal\" data-name=\"grossTotal\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\" ></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-netcpi-\'+maxLineNumber+\'}\" value=\"\'+data[maxRow-1][\"netCPI\"]+\'\" size=\"6\" name=\"netCPI[]\" data-index=\"netCPI\" data-name=\"netCPI\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\' onchange=\"updateField(this);\"  {if $worksheet.isAutoComm}  tabindex=\"-1\" readonly {/if} ></td>\',\n                \'<td><input type=text class=\"form-control input-sm\" id=\"field-netcpc-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"netCPC\"]+\'\" size=\"6\" name=\"netCPC[]\"   data-name=\"netCPC\" data-line=\"\'+maxLineNumber+\'\" data-index=\"netCPC\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\',\n                \'<td><input type=text class=\"form-control input-sm\" id=\"field-nettotal-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"netTotal\"]+\'\" size=\"6\" name=\"netTotal[]\"   data-name=\"netTotal\" data-line=\"\'+maxLineNumber+\'\" data-index=\"netTotal\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"  {if $worksheet.isAutoComm} tabindex=\"-1\" readonly {/if}></div></td>\',\n                \'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-siteURL-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"siteURL\"]+\'\" size=\"40\" name=\"siteURL[]\" data-index=\"siteURL\" data-name=\"siteURL\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n                \'<td><div class=\"input-group input-sm date datetimepicker-datetime\" data-date-format=\"YYYY/MM/DD hh:mma\" data-target-id=\"field-deadline-\'+maxLineNumber+\'\"><input type=text class=\"form-control input-sm  worksheet-field\" style=\"width: 150px;\" id=\"field-deadline-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"deadline\"]+\'\" name=\"deadline[]\" data-index=\"deadline\" data-name=\"deadline\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><span class=\"input-group-addon input-sm\"><span class=\"glyphicon glyphicon-calendar input-sm\"></span></span></td>\',\n\n\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=30  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"><input type=hidden id=\"field-vendorName-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"vendorName\"]+\'\" name=\"vendorName[]\"></td>\',\n\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\"onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, vendor: data[maxRow-1][\"vendor\"], vendorID: data[maxRow-1][\"vendorID\"], startDate: data[maxRow-1][\"startDate\"], endDate: data[maxRow-1][\"endDate\"], name: data[maxRow-1][\"name\"], type: data[maxRow-1][\"type\"], clicks: data[maxRow-1][\"clicks\"], grossTotal: data[maxRow-1][\"grossTotal\"], netTotal: data[maxRow-1][\"netTotal\"],  impressions: data[maxRow-1][\"impressions\"], grossCPI: data[maxRow-1][\"grossCPI\"], grossCPC: data[maxRow-1][\"grossCPC\"], netCPI: data[maxRow-1][\"netCPI\"], netCPC: data[maxRow-1][\"netCPC\"], deadline: data[maxRow-1][\"deadline\"], siteURL: data[maxRow-1][\"siteURL\"], color: data[maxRow-1][\"color\"], commission: \"{$worksheet.commission|default:0}\", comments: data[maxRow-1][\"comments\"],  vendorName: data[maxRow-1][\"vendorName\"], copy: false, bold: false, delete: false };\n\n                $(\'.datetimepicker-dateonly\').datetimepicker({\n                    pickTime: false\n                });\n\n                $(\'.datetimepicker-datetime\').datetimepicker({\n                    pickTime: true,\n		    pickDate: true,\n//		    minDate: moment(),\n		    default: moment()\n                });\n\n            	$(\'.datetimepicker-datetime\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n            	$(\'.datetimepicker-dateonly\').on(\"dp.change\", function (e) {\n			updateField(\"#\"+$(this).data(\"target-id\"));\n            	});\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n	\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n//   $(\"#summaryTotals\").width();    \n//   $(\"#widget-summary\").width($(\"#summaryTotals\").width()+50);\n\n})\n\n	function updateDaypartSummary() {\n	\n		return false;\n	}\n\n	function clearNewLine() {\n		$(\'#field-name-new\').val(\'\');\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-insertionDate-new\').val(\'\');\n		$(\'#field-deadline-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-color-new\').val(\'\');\n		$(\'#field-type-new\').val(\'\');\n		$(\'#field-siteURL-new\').val(\'\');\n		$(\'#field-clicks-new\').val(\'\');\n		$(\'#field-impressions-new\').val(\'\');\n		$(\'#field-grossCPI-new\').val(\'\');\n		$(\'#field-grossCPC-new\').val(\'\');\n		$(\'#field-grossCost-new\').val(\'\');\n		$(\'#field-netCost-new\').val(\'\');\n		$(\'#field-netCPI-new\').val(\'\');\n		$(\'#field-netCPC-new\').val(\'\');\n\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		console.log(\"Worksheet Saved.\");\n//		window.location.href = \"/worksheet/edit/{$worksheetID}\";\n		$(location).attr(\'href\', \"/worksheet/edit/{$worksheetID}\");\n\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n		function exportWorksheet(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/worksheet/csv\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to export worksheet at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n	$(document).ready(function () {\n	\n	    	$(\'.toggle-col\').change(function(box) {\n	            var colName = $(this).data(\"name\");\n	    	    if ($(this).is(\':checked\')) {\n	//		console.log(\"Box is checked\");\n			saveCols(colName, 0);\n		    }\n	            else {\n	//		console.log(\"Box is unchecked\");\n			saveCols(colName, 1);\n		    }\n	    	});\n	});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/digital/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/digital/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/digital/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n	</script>\n	\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(100,0,'reports-planning','2015-03-21 10:00:11','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n<link href=\"/lib/daterangepicker/daterangepicker-bs3.css\" rel=\"stylesheet\">\n\n<style>\n\n.form-control .select2-choice {\n    border: 0;\n    border-radius: 2px;\n}\n\n.form-control .select2-choice .select2-arrow {\n    border-radius: 0 2px 2px 0;   \n}\n\n.form-control.select2-container {\n    height: auto !important;\n    padding: 0px;\n}\n\n.form-control.select2-container.select2-dropdown-open {\n    border-color: #5897FB;\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control .select2-container.select2-dropdown-open .select2-choices {\n    border-radius: 3px 3px 0 0;\n}\n\n.form-control.select2-container .select2-choices {\n    border: 0 !important;\n    border-radius: 3px;\n}\n</style>\n\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"/reports/\">Reports</a></li>\n			<li><a href=\"/reports/summary/\">Summary</a></li>\n			<li class=\"active\" id=\"breadcrumb-report-type\">{$reportType}</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Reports {if $reportTitle}({$reportTitle}){/if}</h2>\n								<em>{$reportDescription}</em>\n							</div>\n<div class=\"col-lg-10\">\n	<div class=\"widget\">\n		<div class=\"widget-header\">\n				<h3>Parameters</h3>\n\n				<div class=\"btn-group widget-header-toolbar\">\n\n																</div>					\n\n\n		</div>\n		<div class=\"widget-content\">\n{if $alert.success}\n<div class=\"alert alert-success alert-dismissable\">\n  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>\n  <strong>Yay!</strong> {$alert.success}\n</div>\n{/if}	\n		<form id=\"report-form\" class=\"form-horizontal label-left\" role=\"form\">\n			<input type=\"hidden\" name=\"reportID\" value=\"{$reportID}\">\n			<input type=\"hidden\" name=\"reportType\" value=\"{$reportType}\">\n			<input type=\"hidden\" name=\"agencyID\" value=\"{$agencyID}\">\n			<input type=\"hidden\" id=\"category\" name=\"category\" value=\"{$reportCategory}\">\n			<input type=\"hidden\" id=\"reportType\" name=\"reportType\" value=\"{$reportType}\">\n			<input type=\"hidden\" name=\"templateID\" value=\"{$templateID}\">\n			<input type=\"hidden\" id=\"startDate\" name=\"startDate\" value=\"\">\n			<input type=\"hidden\" id=\"endDate\" name=\"endDate\" value=\"\">\n			<input type=\"hidden\" name=\"isPlanning\" value=\"{$isPlanning}\">\n			<input type=\"hidden\" name=\"isPending\" value=\"{$isPending}\">\n			<input type=\"hidden\" id=\"isNetCost\" name=\"isNetCost\" value=\"{$isNetCost}\">\n			<input type=\"hidden\" id=\"showOrderedOnly\" name=\"showOrderedOnly\" value=\"{$report.showOrderedOnly}\">\n			<input type=\"hidden\" id=\"showSpots\" name=\"showSpots\" value=\"{$showSpots}\">\n			<input type=\"hidden\" id=\"showMonths\" name=\"showMonths\" value=\"{$report.showMonths}\">\n			<input type=\"hidden\" id=\"showWeeks\" name=\"showWeeks\" value=\"{$report.showWeeks}\">\n			<input type=\"hidden\" id=\"showCPP\" name=\"showCPP\" value=\"{$showCPP}\">\n			<input type=\"hidden\" id=\"showGRP\" name=\"showGRP\" value=\"{$showGRP}\">\n			<input type=\"hidden\" id=\"showPercent\" name=\"showPercent\" value=\"{$showPercent}\">\n\n					<div class=\"form-group\">\n																		<label for=\"text-input\" class=\"col-sm-3 control-label\">Date Range</label>\n																		<div class=\"col-xs-12 col-sm-8 col-md-8 col-lg-8\" >\n							<div id=\"reportDates\" class=\"pull-left report-range\">\n																				<i class=\"fa fa-calendar\"></i>\n																				<span class=\"range-value\"></span><b class=\"caret\"></b>\n						\n							</div>										</div>				\n																	</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Client(s)</label>\n																			<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"clients\" name=\"clients[]\" class=\"form-control input multiselect\" multiple=\"multiple\"\">\n									{foreach $clients as $client}										<option value=\"{$client.id}\">{$client.name}</option>\n									{/foreach}\n\n								</select>\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"allClients\" name=\"allClients\" {if $report.allClients}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n							</div>\n\n					</div>\n\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Type?</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"marketType\" name=\"marketTypes[]\" class=\"form-control input multiselect\" multiple=\"multiple\" >\n									{foreach $vendorTypes as $vendorType}										<option value=\"{$vendorType.id}\">{$vendorType.description}</option>\n									{/foreach}\n								</select>\n\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"allTypes\" name=\"allMarketTypes\" {if $report.allTypes}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n	\n							</div>\n\n					</div>\n\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Campaign(s)</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"campaigns\" name=\"campaigns[]\" class=\"form-control input multiselect\" multiple=\"multiple\" >\n									{foreach $campaigns as $campaign}										<option value=\"{$campaign.id}\">{$campaign.name}</option>\n									{/foreach}\n								</select>						\n\n								</select>\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n\n								<input type=\"checkbox\" id=\"allCampaigns\" name=\"allCampaigns\" {if $report.allCampaigns}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Vendor(s)</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" >\n\n								<select id=\"vendors\" name=\"vendors[]\" class=\"form-control input multiselect\" multiple=\"multiple\" >\n									{foreach $vendors as $vendor}										<option value=\"{$vendor.id}\">{$vendor.name}</option>\n									{/foreach}\n								</select>						\n\n								</select>\n							</div>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n\n								<input type=\"checkbox\" id=\"allVendors\" name=\"allVendors\" {if $report.allVendors}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"All\" data-off-label=\"All\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group hidden  {if $userID != 1} hidden {/if}\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Include Net Cost?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeNet\" name=\"includeNet\" {if $report.includeNet}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Only Ordered?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeOrderedOnly\" name=\"includeOrderedOnly\" {if $report.showOrderedOnly}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Include Spot Counts?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeSpots\" name=\"includeSpots\" {if $report.showSpots}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Include Weekly Totals?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeWeekly\" name=\"includeWeekly\" {if $report.showWeeks}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Include Monthly Totals?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeMonthly\" name=\"includeMonthly\" {if $report.showMonths}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Show Percent (%)?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includePercent\" name=\"includePercent\" {if $report.showPercent}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group hidden\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Show GRPs?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeGRP\" name=\"includeGRP\" {if $report.showGRP}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group hidden\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Show CPP?</label>\n																			<div class=\"col-xs-4 col-sm-2 col-md-2 col-lg-2\" >\n\n								<input type=\"checkbox\" id=\"includeCPP\" name=\"includeCPP\" {if $report.showCPP}checked{/if} class=\"switch switch-sm\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n																			<label for=\"text-input\" class=\"col-sm-3 control-label\">Format?</label>\n\n							<div class=\"col-xs-6 col-sm-6 col-md-6 col-lg-6\" style=\"white-space: nowrap;\" nowrap>\n\n								<select id=\"format\" name=\"format\"  class=\"form-control\" >\n									{foreach $formats as $format}										<option value=\"{$format.id}\">{$format.name}</option>\n									{foreachelse}\n										<option value=\"pdf\" selected>PDF</option>\n										<option value=\"csv\" disabled>XLS/SV</option>\n										<option value=\"web\" disabled>Web</option>\n									{/foreach}\n								</select>\n	\n							</div>\n\n					</div>\n\n					<div class=\"form-group\">\n						<div class=\"col-sm-12\">\n							<p class=\"pull-right\">\n								<button type=\"button\" id=\"createReportButton\" class=\"btn btn-success\" onclick=\"createReport();\">Create</button>\n							</p>\n						</div>\n					</div>		\n															</form>\n\n		</div>\n\n		<div id=\"report-footer\" class=\"widget-footer\">\n		</div>\n\n	</div>\n\n<div class=\"modal fade\" id=\"reportWait\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Please Wait</h4>\n      </div>\n      <div class=\"modal-body\">\n		<div class=\"progress progress-striped active\">\n		  <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n		  </div>\n		</div>\n		<span class=\"reportStatus\">Creating Report...</span>\n      </div>\n\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n\n\n\n\n\n</div>\n</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/parsley.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-datepicker.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/moment/js/moment.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/daterangepicker/daterangepicker.js\"></script>\n\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n\n			$(\'#allClients\').bootstrapSwitch();\n			$(\'#allTypes\').bootstrapSwitch();\n			$(\'#allCampaigns\').bootstrapSwitch();\n			$(\'#includeNet\').bootstrapSwitch();\n			$(\'#includeOrderedOnly\').bootstrapSwitch();\n			$(\'#includeSpots\').bootstrapSwitch();\n			$(\'#includeWeekly\').bootstrapSwitch();\n			$(\'#includeMonthly\').bootstrapSwitch();\n			$(\'#includePercent\').bootstrapSwitch();\n			$(\'#includeCPP\').bootstrapSwitch();\n			$(\'#includeGRP\').bootstrapSwitch();\n			$(\'#allVendors\').bootstrapSwitch();\n	\n			$(\'#reportDates\').daterangepicker({\n				startDate: moment().startOf(\'year\'),\n				endDate: moment().endOf(\'year\'),\n				minDate: \'01/01/1900\',\n				maxDate: \'12/31/2019\',\n				dateLimit: false,\n				showDropdowns: true,\n				showWeekNumbers: true,\n				timePicker: false,\n				timePickerIncrement: 1,\n				timePicker12Hour: true,\n				ranges: {\n					\'Last Month\': [moment().subtract(1, \'month\').startOf(\'month\'), moment().subtract(1, \'month\').endOf(\'month\')],\n					\'This Month\': [moment().startOf(\'month\'), moment().endOf(\'month\')],\n					\'Next Month\': [moment().add(1, \'month\').startOf(\'month\'), moment().add(1,\'month\').endOf(\'month\')],\n					\'This Quarter\': [moment().startOf(\'quarter\'), moment().endOf(\'quarter\')],\n					\'This Year\': [moment().startOf(\'year\'), moment().endOf(\'year\')],\n					\'This Year To Date\': [moment().startOf(\'year\'), moment()],\n					\'Last Year\': [moment().subtract(1, \'year\').startOf(\'year\'), moment().subtract(1, \'year\').endOf(\'year\')]\n					},\n				opens: \'left\',\n				buttonClasses: [\'btn btn-default\'],\n				applyClass: \'btn-small btn-primary\',\n				cancelClass: \'btn-small\',\n				format: \'MM/DD/YYYY\',\n				separator: \' to \',\n				locale: {\n						applyLabel: \'Submit\',\n						fromLabel: \'From\',\n						toLabel: \'To\',\n						customRangeLabel: \'Custom Range\',\n						daysOfWeek: [\'Su\', \'Mo\', \'Tu\', \'We\', \'Th\', \'Fr\',\'Sa\'],\n						monthNames: [\'January\', \'February\', \'March\', \'April\', \'May\', \'June\', \'July\', \'August\', \'September\', \'October\', \'November\', \'December\'],\n						firstDay: 1\n					}\n				},\n	\n				function(start, end) {\n	\n					var startDate = new Date(start);\n					$(\'#reportDates span\').html(start.format(\'MMMM D, YYYY\') + \' - \' + end.format(\'MMMM D, YYYY\'));\n				\n				}\n			);\n\n			$(\'#reportDates span\').html(moment().startOf(\'year\').format(\'MMMM D, YYYY\') + \' - \' + moment().endOf(\'year\').format(\'MMMM D, YYYY\'));\n\n			$(\"#allClients\").change(function () {\n				allClients();\n			}); \n\n			$(\"#allTypes\").change(function () {\n				allTypes();\n			}); \n\n			$(\"#allCampaigns\").change(function () {\n				allCampaigns();\n			}); \n\n			$(\"#includeNet\").change(function () {\n				includeNet();\n			}); \n\n			$(\"#includeOrderedOnly\").change(function () {\n				includeOrderedOnly();\n			}); \n\n			$(\"#includeSpots\").change(function () {\n				includeSpots();\n			}); \n\n			$(\"#includeWeekly\").change(function () {\n				includeWeekly();\n			}); \n\n			$(\"#includeMonthly\").change(function () {\n				includeMonthly();\n			}); \n\n			$(\"#includePercent\").change(function () {\n				includePercent();\n			}); 	\n\n			$(\"#includeCPP\").change(function () {\n				includeCPP();\n			}); \n\n			$(\"#includeGRP\").change(function () {\n				includeGRP();\n			}); \n\n			$(\"#allVendors\").change(function () {\n				allVendors();\n			}); \n\n			$(\"#clients\").change(function () {\n				getCampaigns($(\"#clients\").val());\n			        $(\'#vendors\').select2(\"val\", \"\");\n			        $(\'#vendors\').empty();\n			        $(\'#markets\').select2(\"val\", \"\");\n			        $(\'#markets\').empty();\n			}); \n\n			$(\"#campaigns\").change(function () {\n				getVendors($(\"#campaigns\").val());\n			        $(\'#markets\').select2(\"val\", \"\");\n			        $(\'#markets\').empty();\n			}); \n\n			$(\"#vendors\").change(function () {\n				getMarkets($(\"#vendors\").val());\n			}); \n\n			$(\"#clients\").select2({\n			    placeholder: \"Search Clients\",\n			    allowClear: true\n			});\n\n			$(\"#vendors\").select2({\n			    placeholder: \"Search Vendors\",\n			    allowClear: true\n			});\n\n			$(\"#campaigns\").select2({\n			    placeholder: \"Search Campaigns\",\n			    allowClear: true\n			});\n\n			$(\"#format\").select2({\n			    placeholder: \"Report Format\",\n			    allowClear: false\n			});\n\n			$(\"#marketType\").select2({\n			    placeholder: \"Report Type\",\n			    allowClear: false\n			});\n\n			$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n			$(\"#types\").attr(\"disabled\",\"disabled\");\n\n			if ($(\"#clients\").val() != \"\") {\n				getCampaigns($(\"#clients\").val());\n			}\n		});\n\n	</script>\n\n	<script type=\"text/javascript\">\n\n		function resetFooter() {\n				$(\"#client-footer\").html(\"Not Saved\");\n		}\n\n		function clientActive() {\n\n			if ($(\"#clientActive\").is(\":checked\")) {\n				$(\"#client-active\").val(\"1\");\n			}\n			else {\n				$(\"#client-active\").val(\"0\");\n			}\n		}\n\n	 	 function createClient() {\n	  \n	  		alert(\"saving client\");\n			  		 		  \n	  	}\n\n		function saveClient() {\n			\n			$(\"#client-footer\").html(\"Saving.\");\n\n			clientActive();\n\n			$.post( \"/clients/ajax/save/{$client.id}\"+ \"?PHPSESSID={$sessionID}\", $( \"#client-form\" ).serialize(), function() {\n				$(\"#client-footer\").html(\"Saving...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				$(\"#client-footer\").html(response.message);\n				if (response.error) {\n					$(\"#\"+response.field).addClass(\"has-error error\");\n					$(\"#client-name-help\").show();\n\n				}\n				else {\n					$(\"#client-name\").removeClass(\"has-error error\");\n					$(\"#client-name-help\").hide();\n				}\n				$(\"#breadcrumb-client-name\").html($(\"#client-name-input\").val());\n\n			})\n			.fail(function(data) {\n				$(\"#client-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#client-footer\").html(\"Error!\");\n			})\n		}\n	\n		function getCampaigns(client) {\n\n			$.post( \"/campaigns/ajax/search/campaigns/clientID/\" + client + \"?PHPSESSID={$sessionID}\",  function() {\n				$(\"#report-footer\").html(\"Searching For Campaigns...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#campaigns\").attr(\"disabled\", false);\n				        $(\'#campaigns\').select2(\"val\", \"\");\n				        var select = $(\'#campaigns\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n	\n		function getVendors(campaign) {\n\n			$.post( \"/campaigns/ajax/search/vendors/campaignID/\" + campaign + \"?PHPSESSID={$sessionID}\" ,  function() {\n				$(\"#report-footer\").html(\"Searching For Vendors...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#vendors\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#vendors\").attr(\"disabled\", false);\n				        $(\'#vendors\').select2(\"val\", \"\");\n				        var select = $(\'#vendors\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n\n		function allVendors() {\n\n			$.post( \"/vendors/ajax/all/\" + \"?PHPSESSID={$sessionID}\" ,  function() {\n				$(\"#report-footer\").html(\"Searching For Vendors...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#vendors\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#vendors\").attr(\"disabled\", false);\n				        $(\'#vendors\').select2(\"val\", \"\");\n				        var select = $(\'#vendors\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n	\n		function getMarkets(vendor) {\n\n			$.post( \"/campaigns/ajax/search/markets/marketVendorID/\" + vendor + \"?PHPSESSID={$sessionID}\",  function() {\n				$(\"#report-footer\").html(\"Searching For Markets...\");\n			})\n 			.done(function(data) {\n			        var response = jQuery.parseJSON(data);\n				console.log(response);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n				}\n				else {\n					$(\"#markets\").attr(\"disabled\", false);\n				        $(\'#markets\').select2(\"val\", \"\");\n				        var select = $(\'#markets\').empty();\n					  $.each(response.results, function(i,item) {\n           					 select.append( \'<option value=\"\'\n                           			      + item.id\n                            			      + \'\">\'\n                          			      + item.name\n                            			      + \'</option>\' ); \n   				          });\n				}\n\n			})\n			.fail(function(data) {\n				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#report-footer\").html(\"Error!\");\n			})\n		}\n\n		function runReport() {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$.post( \"/reports/ajax/create/\"+$(\"#category\").val()+\"/\"+$(\"#reportType\").val() + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#report-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#report-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createReportButton\").text(\"Create\");\n					$(\"#createReportButton\").attr(\"disabled\", false);					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						$(\"#createReportButton\").text(\"Create\");\n						$(\"#createReportButton\").attr(\"disabled\", false);\n						window.location.href=\"/reports/show/\" + response.reportID + \"/pdf\" + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n//						$(\"#reportWait\").modal(\'hide\');\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#createReportButton\").text(\"Create\");\n						$(\"#createReportButton\").attr(\"disabled\", false);\n						$(\"#report-footer\").html(\"Unable to display order at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createReportButton\").text(\"Create\");\n				$(\"#createReportButton\").attr(\"disabled\", false);				$(\"#report-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#createReportButton\").text(\"Create\");\n				$(\"#createReportButton\").attr(\"disabled\", false);				$(\"#report-footer\").html(\"Error!\");\n			})\n\n		}	\n	\n		function createReport() {\n			getDateRange(\"#reportDates\", \"#startDate\", \"#endDate\");\n			allClients();\n			allTypes();\n			allCampaigns();\n\n			$(\"#createReportButton\").text(\"Creating...\");\n			$(\"#createReportButton\").attr(\"disabled\", \"disabled\");\n			runReport();\n		\n		}\n\n		function getDateRange(datepicker, fromField, toField) {\n\n			$(fromField).val($(\'#reportDates\').data(\'daterangepicker\').startDate.format(\'YYYY-MM-DD\'));\n			$(toField).val($(\'#reportDates\').data(\'daterangepicker\').endDate.format(\'YYYY-MM-DD\'));\n						\n		}\n\n		function allClients() {\n\n			if ($(\"#allClients\").is(\":checked\")) {\n				$(\"#allClients\").val(\"1\");\n				$(\"#clients\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allClients\").val(\"0\");\n				$(\"#clients\").attr(\"disabled\",false);\n			}\n		}\n\n		function allTypes() {\n\n			if ($(\"#allTypes\").is(\":checked\")) {\n				$(\"#allTypes\").val(\"1\");\n				$(\"#marketType\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allTypes\").val(\"0\");\n				$(\"#marketType\").attr(\"disabled\",false);\n			}\n		}\n\n		function allCampaigns() {\n\n			if ($(\"#allCampaigns\").is(\":checked\")) {\n				$(\"#allCampaigns\").val(\"1\");\n				$(\"#campaigns\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allCampaigns\").val(\"0\");\n				$(\"#campaigns\").attr(\"disabled\",false);\n			}\n		}\n\n		function allVendors() {\n\n			if ($(\"#allVendors\").is(\":checked\")) {\n				$(\"#allVendors\").val(\"1\");\n				$(\"#vendors\").attr(\"disabled\",\"disabled\");\n			}\n			else {\n				$(\"#allVendors\").val(\"0\");\n				$(\"#vendors\").attr(\"disabled\",false);\n			}\n		}\n\n		function includeNet() {\n\n			if ($(\"#includeNet\").is(\":checked\")) {\n				$(\"#isNetCost\").val(\"1\");\n			}\n			else {\n				$(\"#isNetCost\").val(\"0\");\n			}\n		}\n\n		function includeSpots() {\n\n			if ($(\"#includeSpots\").is(\":checked\")) {\n				$(\"#showSpots\").val(\"1\");\n			}\n			else {\n				$(\"#showSpots\").val(\"0\");\n			}\n		}\n\n		function includeOrderedOnly() {\n\n			if ($(\"#includeOrderedOnly\").is(\":checked\")) {\n				$(\"#showOrderedOnly\").val(\"1\");\n			}\n			else {\n				$(\"#showOrderedOnly\").val(\"0\");\n			}\n		}\n\n		function includeWeekly() {\n\n			if ($(\"#includeWeekly\").is(\":checked\")) {\n				$(\"#showWeeks\").val(\"1\");\n			}\n			else {\n				$(\"#showWeeks\").val(\"0\");\n			}\n		}\n\n		function includeMonthly() {\n\n			if ($(\"#includeMonthly\").is(\":checked\")) {\n				$(\"#showMonths\").val(\"1\");\n			}\n			else {\n				$(\"#showMonths\").val(\"0\");\n			}\n		}\n\n		function includePercent() {\n\n			if ($(\"#includePercent\").is(\":checked\")) {\n				$(\"#showPercent\").val(\"1\");\n			}\n			else {\n				$(\"#showPercent\").val(\"0\");\n			}\n		}	\n\n		function includeCPP() {\n\n			if ($(\"#includeCPP\").is(\":checked\")) {\n				$(\"#showCPP\").val(\"1\");\n			}\n			else {\n				$(\"#showCPP\").val(\"0\");\n			}\n		}\n\n		function includeGRP() {\n\n			if ($(\"#includeGRP\").is(\":checked\")) {\n				$(\"#showGRP\").val(\"1\");\n			}\n			else {\n				$(\"#showGRP\").val(\"0\");\n			}\n		}\n\n\n</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(101,0,'worksheet-tv-alt-simple-new','2015-02-23 00:18:41','','{extends file=\"db:kingboard-framework\"}\n{block name=\"title\"}Campaign Worksheet-TV | BluHorn{/block}\n{block name=\"header-js\"}\n\n	<link href=\"/lib/select2/select2.css\" rel=\"stylesheet\"/>\n\n	<link rel=\"stylesheet\" media=\"screen\" href=\"/lib/handsontable/jquery.handsontable.full.css\">\n\n{/block}\n\n{block name=\"header-css\"}\n\n<style>\nhtml, body {\n    max-width: 100%;\n    overflow-x: hidden;\n}\n\n	.dropdown-menu {\n		border: 1px solid #555;\n		padding-bottom: 10px;\n	}\n\nth, td { white-space: nowrap; }\n    div.dataTables_wrapper {\n        width: 100%;\n        margin: 0 auto;\n    }\n\n.form input, form textarea, form select {\n    font-size: 8px;\n}\n.form .input-sm {\n	height: 20px;\n	padding: 2px 5px;\n	font-size: 12px;\n	line-height: 1.2;\n}\n\n.table td:nth-last-child(n-3)\n{\n\n text-align:center !important;\n}\n\n.DTFC_LeftBodyLiner thead {\n	display: none;\n}\n\n.DTFC_LeftBodyWrapper {\n	margin-bottom: 20px;\n}\n\n.DTFC_LeftFootWrapper tfoot {\n	background-color: #efefef;\n}\n\n\n.DTFC_LeftBodyWrapper {\n	top: 20px;\n	background-color: #ececec;\n}\n\n<link rel=\"stylesheet\" media=\"screen\" href=\"https://cdn.datatables.net/1.10.4/css/jquery.dataTables.min.css\">\n\n\n\n</style>\n\n\n{/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li><a href=\"campaigns/edit/{$campaign.id}\">{$campaign.name}</a></li>\n			<li class=\"active\">Worksheet: Broadcast TV</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n						<div class=\"content\">\n							<div class=\"main-header\">\n								<h2>Worksheet (Broadcast TV)</h2>\n								<em>Media Buying Summary</em>\n							</div>\n							<div class=\"col-md-12\">\n\n{* {include file=\"db:worksheet-info\"} *}\n\n\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-windows\"></i> Pre-Buy Worksheet </h3>\n				\n																		<em></em>\n\n\n												<div class=\"btn-group widget-header-toolbar hidden-xs\">\n<div class=\"control-inline toolbar-item-group \">\n\n																	<span class=\"control-title\"><i class=\"fa fa-magic\"></i>Auto-Update?</span>\n			\n						<input type=\"hidden\" id=\"autoUpdate\" name=\"autoUpdate\" value=\"{$worksheet.isAutoCalc}\">\n	\n						<input type=\"checkbox\" id=\"autoCalc\" name=\"isAutoCalc\" {if $worksheet.isAutoCalc}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Yes\" data-off-label=\"No\" >	<!--<input type=\"checkbox\" id=\"scrolling\" name=\"isScrolling\" {if $worksheet.isScrolling}checked{/if} class=\"switch-mini\" data-on=\"success\" data-off=\"default\" data-on-label=\"Scroll\" data-off-label=\"Full\" >-->					</div>											 	     <a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\n												     <a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>												  												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: block;\">\n											   	<div class=\"col-md-8 col-lg-5\">\n												<div style=\"width:100%;\"><strong>Name:</strong> {$worksheet.name|default:\'none\'} </div>\n												<div style=\"width:100%;\"><strong>Advertiser:</strong> {$client.name|default:\'none\'} </div>\n												<div style-\"width: 100%;\"><strong>Campaign:</strong> {$campaign.name|default:\'none\'} </div>\n												<div style=\"width: 100%;\"><strong>Flight Dates:</strong> {$campaign.flightStart} to {$campaign.flightEnd}</div>\n												<div style=\"width: 100%;\"><strong>Market:</strong> {$marketName} </div>\n												<div style=\"width: 100%;\"><strong>Vendor(s):</strong> {foreach $vendors as $vendor} <a href=\"/vendors/edit/{$vendor.id}\">{$vendor.name}</a>{/foreach}</div>\n												<div style=\"width: 100%;\"><strong>Demo(s):</strong> {foreach $demographics as $demo} {$demo.description} {foreachelse}none{/foreach} </div>\n												<div class=\"hidden\" style=\"width: 100%;\"><strong>Sorting:</strong>{foreach $worksheet.sorting as $sorting} {$sorting.name} {$sorting.direction} {/foreach}</div>\n												 <div style=\"width: 100%; padding-bottom: 30px;\"><strong>Contract #:</strong> {$orderInfo.contractNumber|default:\'none\'}</div>\n												</div>\n												<div class=\"col-md-12 col-lg-7 hidden-xs hidden-sm\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheet\" onclick=\"editWorksheet(\'{$worksheet.id}\');\">Edit Worksheet</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummary\" onclick=\"toggleSummary();\">Hide Summary</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLines\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButton\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create Order</button>\n  <button type=\"button\" class=\"btn btn-success dropdown-toggle\" id=\"createOrderButtonDropDown\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a href=\"javascript:createOrder(\'{$worksheet.id}\');\">Create Order</a></li>\n    <li><a href=\"javascript:viewSchedule(\'{$worksheet.id}\',11, \'pdf\');\">Show Schedule</a></li>\n    <li><a href=\"javascript:exportWorksheet(\'{$worksheet.id}\', 14, \'csv\');\">Export to CSV</a></li>\n    <li><a class=\"\" href=\"javascript:sendOrder(\'{$worksheet.id}\');\">Send Order</a></li>\n    <li><a href=\"javascript:previewOrder(\'{$worksheet.id}\');\">Preview Order</a></li>\n    <li class=\"divider\"></li>\n    <li {if ! $worksheet.isOrdered}class=\"disabled\"{/if}><a class=\"\" href=\"javascript:cancelBox(\'{$worksheet.id}\');\" >Cancel Order</a></li>\n  </ul>\n												   </div>\n											 	 </div>\n												</div>\n\n												  <div class=\"col-xs-12 col-sm-12 hidden-md hidden-lg\" style=\"padding-bottom: 50px;\">\n												   <div class=\"pull-right\">\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-primary\" id=\"editWorksheetSmall\" onclick=\"editWorksheet(\'{$worksheet.id}\');\" >Edit</button>\n												    </div>\n												    <div class=\"btn-group\">\n												         <button type=\"button\" class=\"btn btn-warning\" id=\"toggleSummarySmall\" onclick=\"toggleSummary();\">Hide</button>\n												    </div>\n												    <div class=\"btn-group\">												         <button type=\"button\" class=\"btn btn-default\" id=\"saveWorksheetLinesSmall\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save</button>												   </div>\n												   <div class=\"btn-group \">\n												         <button type=\"button\" class=\"btn btn-success\" id=\"createOrderButtonSmall\" onclick=\"createOrder(\'{$worksheet.id}\');\">Create</button>\n												   </div>\n											 	 </div>\n												</div>\n\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"margin-top: 20px; overflow-x: hidden; overflow-y: hidden;\">\n												           <div id=\"summaryTable\"></div>\n												    </div>\n												</div>\n												<div class=\"hidden\">\n												     <form id=\"report-form\">\n												          <input type=\"hidden\" name=\"campaigns[]\" value=\"{$campaign.id}\">\n												          <input type=\"hidden\" name=\"worksheets[]\" value=\"{$worksheet.id}\">\n												          <input type=\"hidden\" name=\"clients[]\" value=\"{$client.id}\">\n												          <input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												          <input type=\"hidden\" id=\"reportFormat\" name=\"format\" value=\"pdf\">\n												          <input type=\"hidden\" name=\"category\" value=\"schedule\">\n												          <input type=\"hidden\" id=\"templateID\" name=\"templateID\" value=\"11\">\n												     </form>\n												</div>\n\n											</div>\n									<div class=\"widget-footer\" id=\"worksheet-footer\">\n									&nbsp;\n									</div>\n								</div>\n\n								<div id=\"worksheet-status\">\n\n\n\n								<div id=\"isCancelled\" class=\"widget\" style=\"border-color: #c92929; {if ! $worksheet.isCancelled}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #c92929; border-bottom-color: #c92929;; border-color: #c92929;\">\n												<h3><i class=\"fa fa-trash-o\"></i> Cancelled!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"background-color: #c92929; border-left-color: #c92929; float: right;\'\">\n												    <h3 id=\"cancelledStamp\" class=\"\">{$orderInfo.orderCancelled}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<br/>\n											</div>								</div>\n\n\n\n								<div id=\"isOrdered\" class=\"widget\"  style=\"border-color: #4ba84b; {if ! $worksheet.isOrdered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #4ba84b; border-bottom-color: #4ba84b; border-color: #4ba84b;\">\n												<h3><i class=\"fa fa-gavel\"></i> Ordered!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #4ba84b; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderCreated}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div id=\"isDelivered\" class=\"widget\"  style=\"border-color: #d19804; {if ! $worksheet.isDelivered}display: none;{/if}\">\n											<div class=\"widget-header\" style=\"background-color: #d19804; border-bottom-color: #d19804; border-color: #d19804;\">\n												<h3><i class=\"fa fa-bolt\"></i> Sent!</h3> \n												<div class=\"btn-group widget-header-toolbar\" style=\"border-left-color: #d19804; float: right;\">\n												    <h3 id=\"orderedStamp\">{$orderInfo.orderSent}</h3>\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n			\n											</div>\n								</div>\n\n								<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3><i class=\"fa fa-truck\"></i> Station Order</h3> \n												<div class=\"btn-group widget-header-toolbar\">\n												    <a href=\"\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-collapse\"  ><i class=\"fa fa-chevron-down\"></i></a>\n												</div>\n											</div>\n											<div class=\"widget-content\" style=\"display: none;\">\n												<form name=\"order\" class=\"form\" id=\"orderForm\" method=\"post\" action=\"\">\n												<input type=\"hidden\" name=\"agencyID\" value=\"{$worksheet.agencyID}\">\n												<input type=\"hidden\" name=\"campaignID\" value=\"{$worksheet.campaignID}\">\n												<input type=\"hidden\" name=\"worksheetID\" value=\"{$worksheet.id}\">\n												<input type=\"hidden\" name=\"sessionID\" value=\"{$sessionID}\">\n												<input type=\"hidden\" name=\"orderID\" value=\"{$order.id}\">\n												<input type=\"hidden\" name=\"orderType\" value=\"TV\">\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n												   <div style=\"width: 100%;\"><strong>Vendor(s):</strong></div>\n												      <div class=\"col-lg-12 form-group\">\n												        {foreach $vendors as $vendor}\n												        <div class=\"col-lg-3\"><label><input type=\"checkbox\" name=\"vendor[]\" value=\"{$vendor.id}\"> {$vendor.name}</label></div>\n												        {foreachelse}\n												        <label>Order will contain all vendors on Worksheet.</label>\n											                {/foreach}\n												      </div>\n												   <div style=\"width: 100%;\"><strong>Please choose fields to be printed on the Station Order:</strong></div>\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printSpotsPerStation\" value=\"1\" {if $order.printSpotsStation}checked{elseif !$order.id}checked{/if}> Spots/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPPStation\"  value=\"1\" {if $order.printCPPStation}checked{elseif !$order.id}checked{/if}> CPP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCallLetters\" value=\"1\" {if $order.printCallLetters}checked{elseif !$order.id}checked{/if}> Station Call Letters</label><br>\n												      </div>\n							\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printCPPLine\"  value=\"1\" {if $order.printCPPLine}checked{elseif !$order.id}checked{/if}> CPP/Line</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMStation\"  value=\"1\" {if $order.printCPMStation}checked{elseif !$order.id}checked{/if}> CPM/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printCPMLine\"  value=\"1\" {if $order.printCPMLine}checked{elseif !$order.id}checked{/if}> CPM/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group \">\n												        <label><input type=\"checkbox\" name=\"printNetDollarsStation\"  value=\"1\" {if $order.printNetDollarsStation}checked{elseif !$order.id}checked{/if}> Net Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGrossDollarsStation\"  value=\"1\" {if $order.printGrossDollarsStation}checked{elseif !$order.id}checked{/if}> Gross Dollars/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printRatingLine\"  value=\"1\" {if $order.printRatingLine}checked{elseif !$order.id}checked{/if}> Rating/Line</label><br>\n												      </div>\n\n												      <div class=\"col-lg-3 form-group\">\n												        <label><input type=\"checkbox\" name=\"printGRPStation\"  value=\"1\" {if $order.printGRPStation}checked{elseif !$order.id}checked{/if}> GRP/Station</label><br>\n												        <label><input type=\"checkbox\" name=\"printGRPWeek\"  value=\"1\" {if $order.printGRPWeek}checked{elseif !$order.id}checked{/if}> GRP/Week</label><br>\n												      </div>\n\n												</div>\n												</div>\n\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n\n												   <div style=\"width: 100%;\"><strong>Show/Hide Columns?</strong><em> (<a href=\"javascript:showAllColumns(20);\">Show All Columns</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"1\" id=\"col-1\" name=\"showLineNumber\" data-name=\"lineNumber\" value=\"1\"> Worksheet Line #</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"2\" id=\"col-2\" name=\"showDaypart\" data-name=\"daypart\" value=\"1\" checked> Daypart </label>\n												        </div>												        <div class=\"col-lg-3\">\n											                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"3\" id=\"col-3\" name=\"showVendor\" data-name=\"vendor\" value=\"1\" checked> Vendor </label>\n												         </div>												        <div class=\"col-lg-3\">												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"4\" id=\"col-4\" name=\"showStation\" data-name=\"station\" value=\"1\" checked> Station </label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"5\" id=\"col-5\" name=\"showTimePeriod\" data-name=\"timePeriod\" value=\"1\" checked> Time Period</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"6\" id=\"col-7\" name=\"showProgramName\"  data-name=\"program\" value=\"1\" checked> Program Name</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"14\" id=\"col-14\" name=\"showLength\"  data-name=\"seconds\" value=\"1\" checked> Length</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"15\" id=\"col-15\" name=\"showRate\"  data-name=\"rate\" value=\"1\" checked> Rate</label>\n												         </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"16\" id=\"col-16\" name=\"showAQH\"  data-name=\"aqh\" value=\"1\" checked> AQH</label>\n												        </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"17\" id=\"col-17\" name=\"showCPP\" data-name=\"cpp\" value=\"1\" checked> CPP</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"18\" id=\"col-18\" name=\"showImpact\"  data-name=\"impact\" value=\"1\" checked> Impact</label>\n											                </div>												        <div class=\"col-lg-3\">\n												        <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"19\" id=\"col-19\" name=\"showCPM\"  data-name=\"cpm\" value=\"1\" checked> CPM</label>\n												        </div>\n												      </div>\n												      {counter name=\"colCounter\" start=20 skip=1 assign=\"colCounter\" print=FALSE}\n												      {counter name=\"weekCounter\" start=1 skip=1 assign=\"weekCounter\" print=FALSE}\n												    </div>\n											         </div>\n												<div class=\"row\">\n											   	<div class=\"col-lg-12\">\n\n												   <div style=\"width: 100%;\"><strong>Show/Hide Weeks?</strong><em> (<a href=\"javascript:showAllWeeks(21,30);\">Show All Weeks</a>)</em></div>\n												      <div class=\"col-lg-12 form-group\">\n												           {foreach $weekNames as $weekName}\n												              <div class=\"col-lg-3\">												                 <label><input type=\"checkbox\" class=\"toggle-col\" data-column=\"{$colCounter}\" id=\"col-{$colCounter}\" name=\"showWeek-{$weekCounter}\"  value=\"1\" checked> {$weekName}</label>\n											                         {counter name=\"colCounter\"}\n											                         {counter name=\"weekCounter\"}\n												              </div>\n												           {/foreach}\n												      </div>\n\n												</div>\n\n												<div class=\"col-lg-6\">\n\n												</div>\n												</div>\n												<div class=\"row\" style=\"overflow; hidden;\">\n												    <div class=\"col-lg-12\" style=\"overflow; hidden;\">\n												             <label for=\"revision\"><strong>Revision #</strong>\n												                   <input type=\"text\" name=\"revision\" value=\"{$orderInfo.revision|default:\"1\"}\" class=\"form-control input input-sm\" id=\"revisionNumber\" width=10></input>\n												             </label>\n											  	    </div>												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"comments\"><strong>Comments</strong>												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"comments\">{$orderInfo.comments}</textarea>\n									                                     </label>\n												    </div>\n												    <div class=\"col-lg-4\" style=\"overflow; hidden;\">\n												             <label for=\"traffic\"><strong>Traffic</strong>\n												             <textarea class=\"form-control col-lg-5\" rows=\"4\" cols=\"50\" name=\"traffic\">{$orderInfo.traffic}</textarea>\n											                     </label>\n											    	   </div>	\n												    <div class=\"col-lg-3\" style=\"overflow; hidden;\">\n<div class=\"panel panel-default\">\n  <div class=\"panel-heading\">\n    <strong>Order Settings</strong>\n  </div>\n  <div class=\"panel-body\">\n  </div>\n</div>\n												</div>\n											</div>											</form>\n											</div>\n									\n								</div>\n\n							</div>\n							<div class=\"col-md-12 col-lg-2 col-sm-12 col-xs-12\"  id=\"widget-summary\">\n										<div class=\"widget\">\n											<div class=\"widget-header\">\n												<h3>Summary</h3>\n												<div class=\"pull-right\" style=\"margin-top: 5px;\">\n												    <div class=\"btn-group btn-group-xs\" data-toggle=\"buttons\">\n												    <label class=\"btn btn-default active\">\n   												        <input type=\"radio\" name=\"summary-switch\" value=\"daypart\" id=\"summary-switch-daypart\" onchange=\"javascript:summarySwitch();\" checked> D\n											  	    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"station\" id=\"summary-switch-station\" onchange=\"javascript:summarySwitch();\"> S\n	 											    </label>\n												    <label class=\"btn btn-default\">\n												       <input type=\"radio\" name=\"summary-switch\" value=\"full\" id=\"summary-switch-full\" onchange=\"javascript:summarySwitch();\"> F\n												    </label>\n												   </div>\n											       </div>\n											</div>\n											<div class=\"widget-content\" class=\"col-lg-2 col-md-4 col-sm-6 col-xs-12\" id=\"widget-content-summary\" style=\"width: 100%;\">\n												<table style=\"border: 0px; margin: 0 auto;\">\n												     <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"totalSpots\">0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"totalSpend\">$0.00</div></td></tr>\n												      {if $worksheet.grpGoal} <tr><td style=\"width: 60%;\"><strong> GRP Goal: </strong></td><td style=\"text-align: right;\"> {$worksheet.grpGoal}</td></tr>{/if}												     <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"totalGRPs\">0.0</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Overall CPP: </strong></td><td style=\"text-align: right;\"><div id=\"overallCPP\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"totalCPM\">$0.00</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"totalReach\">0.00%</div></td></tr>\n												     <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"totalFreq\">0.00</div></td></tr>\n												</table>	\n												<hr>\n												<div class=\"daypart-summary-widget\" id=\"widget-station-summary\">\n\n												    {foreach $dayparts as $daypart=>$daypartName} {if $daypart != \"none\"}\n												    <div class=\"summary-daypartName\" id=\"summary-daypart-{$daypartName}\">\n												       <center><h5>{$daypartName}</h5></center>\n												       <table style=\"border: 0px; margin: 0 auto; \">\n												         <tr><td style=\"width: 60%;\"><strong>Total Spots: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalSpots-{$daypartName}\">0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total $$: </strong></td><td style=\"width: 50%; text-align: right;\"><div id=\"daypart-totalSpend-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Total GRPs: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalGRPs-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-overallCPP-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>CPM: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-totalCPM-{$daypartName}\">$0.00</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>% of GRP: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-percentOfTotalGRP-{$daypartName}\">0.0</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Reach: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-reach-{$daypartName}\">0.00%</div></td></tr>\n												         <tr><td style=\"width: 60%;\"><strong>Freq: </strong></td><td style=\"text-align: right;\"><div id=\"daypart-freq-{$daypartName}\">0.00</div></td></tr>\n												      </table>\n												    </div>\n\n												    {/if} {/foreach}\n\n												</div>\n											\n												<div class=\"station-summary-widget\" id=\"station-summary-widget\" style=\"display: none; with: 95%; overflow: none;\"></div>\n\n										        </div>\n											<div class=\"widget-footer\">\n												{$status}\n											</div>\n										</div>	\n							</div>\n							<div class=\"col-md-12 col-lg-10\" id=\"worksheet-div\" >\n\n<div class=\"form\" id=\"worksheet-form\">\n\n<table id=\"worksheet-{$worksheet.id}\" class=\"table table-sorting table-striped table-hover\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" style=\"max-width: none;\">\n        <thead>\n            <tr>\n                <th>Line</th>\n                <th>Line #</th>\n                <th data-index=\"daypart\">DP</th>\n                <th data-index=\"vendorID\">Vendor</th>\n                <th data-index=\"station\">Station</th>\n                <th data-index=\"timePeriod\">Time Period</th>\n                <th data-index=\"programName\">Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th data-index=\"seconds\">Len</th>\n                <th data-index=\"rate\">Rate</th>\n                <th data-index=\"aqhRating\">AQH RTG</th>\n                <th data-index=\"cpp\">CPP</th>\n                <th data-index=\"impact\">000</th>\n                <th data-index=\"cpm\">CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Trade</th>\n                <th style=\"text-align: center;\">Skip</th>\n                <th style=\"text-align: center;\">Delete</th>\n\n            </tr>\n        </thead>\n 	<tbody id=\"worksheet-body\">\n	{counter name=\"rowCounter\" start=0 skip=1 print=false assign=\"rowCounter\"}\n	{foreach $wsLines as $line}\n\n{if $isInlineForm}\n            <tr >\n		<td></td>\n                <td><span class=\"col-lg-1\">{$line.worksheetLine}</span><input type=\"hidden\" class=\"worksheet-field\" value=\"{$line.worksheetLine}\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-{$line.worksheetLine}\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" {if $line.daypart == $daypart}selected{/if}>{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-{$line.worksheetLine}\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\" {if $line.vendorID == $vendor.id}selected{/if}>{$vendor.name}</option>{/foreach}</select></td>\n                <td><label class=\"sr-only\">{$line.station}</label><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-{$line.worksheetLine}\" value=\"{$line.station}\" name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.fromTime}{$line.endTime}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" worksheet-field\" placeholder=\"####A/P-####A/P\"  id=\"field-timeOfDay-{$line.worksheetLine}\" value=\"{$line.timePeriod}\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.programName}</label><input type=text class=\"form-control input-sm\" id=\"field-program-{$line.worksheetLine}\" value=\"{$line.programName}\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-{$line.worksheetLine}\" data-index=\"mon\" data-name=\"mon\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  {if $line.isMonday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-{$line.worksheetLine}\" data-index=\"tue\" data-name=\"tue\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTuesday[]\" class=\"\"  {if $line.isTuesday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-{$line.worksheetLine}\" data-name=\"wed\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isWednesday[]\" class=\"\" {if $line.isWednesday} value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-{$line.worksheetLine}\" data-index=\"thu\" data-name=\"thu\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isThursday[]\" class=\"\"  {if $line.isThursday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-{$line.worksheetLine}\" data-index=\"fri\" data-name=\"fri\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isFriday[]\" class=\"\"  {if $line.isFriday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-{$line.worksheetLine}\" data-index=\"sat\" data-name=\"sat\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSaturday[]\" class=\"\" {if $line.isSaturday}value=\"1\"  checked{/if} onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-{$line.worksheetLine}\" data-index=\"sun\" data-name=\"sun\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSunday[]\" class=\"\" {if $line.isSunday}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-{$line.worksheetLine}\" value=\"{$line.seconds}\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.rate}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-{$line.worksheetLine}\" data-index=\"rate\" data-name=\"rate\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" value=\"{$line.rate}\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.aqhRating}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-{$line.worksheetLine}\" value=\"{$line.aqhRating}\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></td>\n                <td><label class=\"sr-only\">{$line.cpp}</label><input type=text class=\"form-control input-sm\" id=\"field-cpp-{$line.worksheetLine}\" value=\"{$line.cpp}\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"{$line.worksheetLine}\" data-index=\"cpp\" readonly></div></td>\n                <td><label class=\"sr-only\">{$line.impact}</label><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-{$line.worksheetLine}\"\" value=\"{$line.impact}\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" onchange=\"updateField(this);\"></div></td>\n                <td><label class=\"sr-only\">{$line.cpm}</label><input type=text class=\"form-control input-sm\" id=\"field-cpm-{$line.worksheetLine}\" value=\"{$line.cpm}\" id=\"field-cpm-{$line.worksheetLine}\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><label class=\"sr-only\">{$weekValue}</label><input type=text class=\"form-control input-sm\" id=\"field-week-{$line.worksheetLine}-{$weekCounter}\" value=\"{$wsWeeks[$line.worksheetLine][{$weekCounter}]}\" name=\"week[{$line.worksheetLine}][{$weekCounter}]\" size=\"3\" data-index=\"field-week-{$line.worksheetLine}-{$weekCounter}\" data-name=\"week\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-{$line.worksheetLine}\" size=40 value=\"{$line.comments}\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-copy-{$line.worksheetLine}\" data-index=\"copy\" data-name=\"copy\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isCopy[]\" {if $line.isCopy}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-bold-{$line.worksheetLine}\" data-index=\"bold\" data-name=\"bold\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isBold[]\" {if $line.isBold}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n		<td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-trade-{$line.worksheetLine}\" data-index=\"trade\" data-name=\"trade\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isTrade[]\" {if $line.isTrade}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-skip-{$line.worksheetLine}\" data-index=\"skip\" data-name=\"skip\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isSkipped[]\" {if $line.isSkipped}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n                <td style=\"text-align: center;\"><input type=checkbox class=\"centered\" id=\"field-delete-{$line.worksheetLine}\" data-index=\"delete\" data-name=\"delete\" data-line=\"{$line.worksheetLine}\" data-row=\"{$line@iteration}\" data-counter=\"{$rowCounter}\"  name=\"isDeleted[]\" {if $line.isDeleted}value=\"1\" checked{/if} onchange=\"updateField(this);\"></td>\n            </tr>\n\n{elseif $isInlineText}\n\n            <tr >\n		<td></td>\n                <td>{$line.worksheetLine}</td>\n                <td>{$line.daypart}</td>\n                <td>{$line.vendorID}</td>\n                <td>{$line.station}</td>\n                <td>{$line.timePeriod}</td>\n                <td>{$line.programName}</td>\n                <td>{$line.isMonday}</td>\n                <td>{$line.isTuesday}</td>\n                <td>{$line.isWednesday}</td>\n                <td>{$line.isThursday}</td>\n                <td>{$line.isFriday}</td>\n                <td>{$line.isSaturday}</td>\n                <td>{$line.isSunday}</td>\n                <td>{$line.seconds}</td>\n                <td>{$line.rate}</td>\n                <td>{$line.aqhRating}</td>\n                <td>{$line.cpp}</td>\n                <td>{$line.impact}</td>\n                <td>{$line.cpm}</td>\n                                \n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td>{$weekValue}</td>\n{/foreach}\n                <td>{$line.comments}</td>\n                <td></td>\n                <td></td>\n                <td></td>\n                <td></td>\n                <td></td>\n            </tr>\n\n{/if}\n	    {counter name=\"rowCounter\"}\n  	{/foreach}\n	</tbody>\n	<tfoot>\n            <tr id=\"worksheet-line-new\" >\n		<td></td>\n                <td><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button><input type=\"hidden\" class=\"worksheet-field\" value=\"new\" name=\"worksheetLine[]\"></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-new\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\"></option>{foreach $dayparts as $daypart}<option value=\"{$daypart}\" >{$daypart}</option>{/foreach}</select></td>\n                <td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-new\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"><option value=\"\" selected></option>{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}</select></td>\n                <td><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-station-new\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-new\" value=\"\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-program-new\" value=\"\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-new\" data-index=\"mon\" data-name=\"mon\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-tue-new\" data-index=\"tue\" data-name=\"tue\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox data-index=\"wed\" id=\"field-wed-new\" data-name=\"wed\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-thu-new\" data-index=\"thu\" data-name=\"thu\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-fri-new\" data-index=\"fri\" data-name=\"fri\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sat-new}\" data-index=\"sat\" data-name=\"sat\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><input type=checkbox id=\"field-sun-new\" data-index=\"sun\" data-name=\"sun\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-new\" value=\"\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-new\" data-index=\"rate\" data-name=\"rate\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" value=\"\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-new\" value=\"\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpp-new\" value=\"\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"new\" data-index=\"cpp\" readonly></div></td>\n                <td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-new\"\" value=\"\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" onchange=\"updateField(this);\"></div></td>\n                <td><input type=text class=\"form-control input-sm\" id=\"field-cpm-new\" value=\"\" id=\"field-cpm-new\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n                <td><input type=text class=\"form-control input-sm\" id=\"field-week-new-{$weekCounter}\"  name=\"week-new[{$weekCounter}]\" size=\"3\" data-index=\"field-week-new-{$weekCounter}\" data-name=\"week\" data-line=\"new\" data-row=\"new\" data-counter=\"new\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\n{/foreach}\n                <td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-new\" size=40  name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"new\" data-row=\"new\" data-counter=\"new\"  onchange=\"updateField(this);\"></td>\n\n                <td colspan=\"5\"><button class=\"btn btn-xs btn-primary\" onclick=\"addNewLine(); return false;\">Add Line</button>  <button class=\"btn btn-xs btn-danger\" onclick=\"clearNewLine(this);\">Clear Line</button></td>\n            </tr>\n\n            <tr style=\"text-align: center;\">\n                <th>Line</th>\n                <th>Line #</th>\n                <th>DP</th>\n                <th>Vendor</th>\n                <th>Station</th>\n                <th>Time Period</th>\n                <th>Program Name</th>\n                <th>M</th>\n                <th>T</th>\n                <th>W</th>\n                <th>R</th>\n                <th>F</th>\n                <th>Sa</th>\n                <th>Su</th>\n                <th>Len</th>\n                <th>Rate</th>\n                <th>AQH RTG</th>\n                <th>CPP</th>\n                <th>000</th>\n                <th>CPM</th>\n{foreach $weekNames as $weekName}\n		<th>{$weekName}</th>\n{/foreach}\n                <th class=\"hidden-sm hidden-xs\">Comments</th>\n                <th style=\"text-align: center;\">Copy</th>\n                <th style=\"text-align: center;\">Bold</th>\n                <th style=\"text-align: center;\">Trade</th>\n                <th style=\"text-align: center;\">Skip</th>\n                <th style=\"text-align: center;\">Delete</th>\n            </tr>\n        </tfoot>\n    </table>\n\n</div>		\n							</div>\n							<div class=\"col-md-12 col-lg-12\" >\n									<div class=\"pull-right\" style=\"padding-top: 10px;\">\n 								        <button class=\"btn btn-default saveWorksheetLines\" id=\"saveWorksheetLinesBottom\" onclick=\"saveWorksheet(\'{$worksheet.id}\');\" disabled>Save Worksheet</button>\n									<button class=\"btn btn-warning\" id=\"copyWorksheet\" onclick=\"copyBox(\'{$worksheetID}\');\">Copy Worksheet</button>\n									<button class=\"btn btn-danger\" id=\"deleteWorksheet\" onclick=\"deleteWorksheet(\'{$worksheetID}\');\">Delete Worksheet</button>\n									<br><br>\n							</div>	\n							<!-- /main-content -->\n						</div>\n\n\n<div class=\"modal fade\" id=\"reportWait\">\n  <div class=\"modal-dialog\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Please Wait</h4>\n      </div>\n      <div class=\"modal-body\">\n		<div class=\"progress progress-striped active\">\n		  <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"40\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 100%\">\n		  </div>\n		</div>\n		<span class=\"reportStatus\">Creating Report...</span>\n      </div>\n\n    </div><!-- /.modal-content -->\n  </div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n\n\n{/block}\n\n\n	{block name=\"scripts\"}\n		<script type=\"text/javascript\" src=\"/assets/js/king-common.js\"></script>\n		<script type=\"text/javascript\" src=\"/assets/js/bootstrap-tour.custom.js\"></script>\n\n		<script type=\"text/javascript\" src=\"/assets/js/modernizr.js\"></script>\n\n{*\n		<script type=\"text/javascript\" src=\"/assets/js/king-table.js\"></script>\n*}\n	{/block}\n\n	{block name=\"datatables\"}\n{*\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/media/js/jquery.dataTables.min.js\"></script>\n*}\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js\"></script>\n\n		<script type=\"text/javascript\" src=\"/lib/datatables/1.10.2/extensions/FixedColumns/js/dataTables.fixedColumns.new.js\"></script>\n\n		<script type=\"text/javascript\" src=\"https://cdn.datatables.net/plug-ins/505bef35b56/integration/bootstrap/3/dataTables.bootstrap.js\"></script>\n	{/block}\n\n\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"/assets/js/bootstrap-multiselect.js\"></script>\n    	<script type=\"text/javascript\" src=\"/lib/select2/select2.js\"></script>\n	<script src=\"/lib/handsontable/jquery.handsontable.full.js\"></script>\n	<script type=\"text/javascript\" src=\"/lib/bootbox/bootbox-4.2.0/bootbox.min.js\"></script>\n	<script src=\"/js/bluhorn-alt.js\"></script>\n\n\n	<script>\n\n	var lastCursor = 0;\n        var data;\n	var pageNumber = 0;\n	var remember = false;\n\n(function($, undefined) {  \n    $.fn.getCursorPosition = function() {  \n        var el = $(this).get(0);  \n        var pos = 0;  \n        if (\'selectionStart\' in el) {  \n            pos = el.selectionStart;  \n        } else if (\'selection\' in document) {  \n            el.focus();  \n            var Sel = document.selection.createRange();  \n            var SelLength = document.selection.createRange().text.length;  \n            Sel.moveStart(\'character\', -el.value.length);  \n            pos = Sel.text.length - SelLength;  \n        }  \n        return pos;  \n    }  \n})(jQuery); \n\n\n$(document).ready(function() {\n\n\n\n  $(window).keydown(function(event){\n    //console.log(event.keyCode);\n    if(event.keyCode == 13) {\n      event.preventDefault();\n      return false;\n    }\n  });\n});\n\nfunction bindKeyEvents() {\n\n$(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\nconsole.log(\"key down\");\nconsole.log($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\'));\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n\n}\n\n$(document).ready(function(){\n	bindKeyEvents();\n});\n\n\n		$(document).ready(function() {\n\n		   $(\'#autoCalc\').bootstrapSwitch();\n	\n		});\n\n	</script>\n\n	<script>\n\n\n\n		$(document).ready(function() {\n\n			 var table =  $(\'#worksheet-{$worksheet.id}\').DataTable( {\n					  \"stateSave\": true,\n					  \"scrollX\": true,\n					\"scrollY\": \"100%\",\n				        \"scrollCollapse\": true,\n					 \n//      					  \"order\": [{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"]{if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}],\n     					  \"order\": [ [ 1, \"asc\" ] ],\n{if $isInlineForm}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"300px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isInlineText}\n\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\"},\n     { width: \"120px\", \"searchable\":false},\n     { width: \"120px\"},\n     { width: \"300px\"},\n     { width: \"100px\"},\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"50px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\" },\n     { width: \"20px\" },\n     { width: \"20px\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{elseif $isAjaxSource}\n\n        \"ajax\": \"/tv/ajax/worksheet/{$worksheet.id}\",\n\"columns\": [\n     { \"data\" : null, width: \"120px\", sortable: false },\n     { \"data\": \"worksheetLine\", width: \"120px\", sortable: false, visible: false },\n     { \"data\": \"daypart\", width: \"120px\",\"orderDataType\": \"dom-select\" },\n     { \"data\": \"vendor\", width: \"120px\",\"orderDataType\": \"dom-select\", \"searchable\":false},\n     { \"data\": \"station\", width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"timeOfDay\", width: \"120px\", \"type\":\"numeric\"},\n     { \"data\": \"program\", width: \"160px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"isMonday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isTuesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isWednesday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isThursday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isFriday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSaturday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"isSunday\", width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { \"data\": \"length\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"rate\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { \"data\": \"aqhRating\", width: \"20px\", sortable: false },\n     { \"data\": \"cpp\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"impact\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { \"data\": \"cpm\", width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { \"data\": \"week.{$week@iteration}\", width: \"20px\", sortable: false },\n{/foreach}\n     { \"data\": \"comments\", width: \"200px\", sortable: false },\n     { \"data\": \"copy\",  width: \"20px\", sortable: false },\n     { \"data\": \"bold\", width: \"20px\", sortable: false },\n     { \"data\": \"trade\", width: \"20px\", sortable: false },\n     { \"data\": \"skip\", width: \"20px\", sortable: false },\n     { \"data\": \"delete\", width: \"20px\", sortable: false }\n],\n\n{else}\n\"columns\": [\n     { width: \"120px\", sortable: false },\n     { width: \"120px\", sortable: false, visible: false },\n     { width: \"120px\",\"orderDataType\": \"dom-select\"},\n     { width: \"120px\",\"orderDataType\": \"dom-select\",\"searchable\":false},\n     { width: \"120px\",\"orderDataType\": \"dom-text\", \"type\": \"text\" },\n     { width: \"300px\", \"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"100px\",\"orderDataType\": \"dom-text\", \"type\": \"text\"},\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"50px\", sortable: false, \"orderDataType\": \"dom-select\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\"},\n     { width: \"20px\", sortable: false },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n     { width: \"20px\",\"orderDataType\": \"dom-text\", \"type\": \"numeric\" },\n{foreach $weeks as $week}\n     { width: \"20px\", sortable: false },\n{/foreach}\n     { width: \"200px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false },\n     { width: \"20px\", sortable: false }\n],\n\n{/if}\n					  \"lengthMenu\": [[10, 25, 50, 100, 200], [10, 25, 50, 100, 200]],\n					  \"autoWidth\": false,			\n					  \"displayLength\": 10,\n					  //\"deferRender\": true,\n					  \"processing\": true,\n					  \"paginate\": true,\n					  \"drawCallback\": function( settings ) {\n						 console.log(\"redraw\");\n					         bindKeyEvents();\n					   },\n//					  \"initComplete\": function() { mapDataAttributes(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents();  },\n//					  \"initComplete\": function() { loadWorksheetData(); $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); reSort(); bindKeyEvents(); updateSelectValues();  },\n					  \"initComplete\": function() { $(\"#worksheet-loading\").hide(); $(\"#worksheet-form\").show(); },\n					  \"dom\": \"<\'row\'<\'col-md-6\'l><\'col-md-6\'f>r>t<\'row\'<\'col-md-6\'i><\'col-md-6\'p>>\",\n					  \"language\": {\n						\"lengthMenu\": \"_MENU_ lines per page\"\n					  },\n\n		\"fnDrawCallback\": function ( oSettings ) {\n	        		 bindKeyEvents();\n			/* Need to redo the counters if filtered or sorted */\n			if ( oSettings.bSorted || oSettings.bFiltered )\n			{\n				for ( var i=0, iLen=oSettings.aiDisplay.length ; i<iLen ; i++ )\n				{\n					$(\'td:eq(0)\', oSettings.aoData[ oSettings.aiDisplay[i] ].nTr ).html( i+1 );\n				}\n			}\n\n		}\n\n\n			  } );\n\n    $(\'.toggle-col\').change( function (e) {\n        e.preventDefault();\n \n        // Get the column API object\n        var column = table.column( $(this).attr(\'data-column\') );\n \n        // Toggle the visibility\n        column.visible( ! column.visible() );\n    } );\n\n\n \n//			   new $.fn.dataTable.FixedColumns( table );\n\n\n\n{if $isInline}\n{/if}\n\nnew $.fn.dataTable.FixedColumns( table, {\n        leftColumns: 7\n   } );\n\n{literal}\n\n/* Create an array with the values of all the input boxes in a column */\n$.fn.dataTable.ext.order[\'dom-text\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the input boxes in a column, parsed as numbers */\n$.fn.dataTable.ext.order[\'dom-text-numeric\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).val() * 1;\n    } );\n}\n \n/* Create an array with the values of all the select options in a column */\n$.fn.dataTable.ext.order[\'dom-select\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'select\', td).val();\n    } );\n}\n \n/* Create an array with the values of all the checkboxes in a column */\n$.fn.dataTable.ext.order[\'dom-checkbox\'] = function  ( settings, col )\n{\n    return this.api().column( col, {order:\'index\'} ).nodes().map( function ( td, i ) {\n        return $(\'input\', td).prop(\'checked\') ? \'1\' : \'0\';\n    } );\n}\n\n{/literal}\n\n\n/*\n\n   table.on( \'order.dt search.dt\', function () {\n        table.column(0, { search:\'applied\', order:\'applied\' }).nodes().each( function (cell, i) {\n            cell.innerHTML = i+1;\n        } );\n    } ).draw(false);\n*/\n\n\n		//reSort();\n\n			$(\'#worksheet-{$worksheet.id}\').on( \'order.dt\',  function () { \n				  console.log(\"sort\"); fGetSortInfo(); } );\n			});\n\n\n		function fGetSortInfo() {\n	  	  // Returns a value of [5, \"desc\", 0] every time.\n		  console.log(\"sort\");\n	  	  var sortInfo = $(\"#worksheet-{$worksheet.id}\").dataTable().fnSettings().aaSorting;\n		  console.log(sortInfo);\n	  	  updateSort(sortInfo);\n		}\n\n		\n	</script>\n\n\n	<script>\n\n	  var counter=1;\n\n	  var savesCounter = 0;\n\n	  var vendors = {};\n\n	  var summaryGRPs = 0;\n	  var summarySpots = 0;\n\n// ####A/P-####A/P\n\n	  var nielsen_time_validator_regex = /(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]-(([0-9])|([0-9][0-9])|([0-9][0-9][0-9][0-9]))[(a|A)|(p|P)|(z|Z)]/;\n\n	  var nielsen_time_validator_fn = function (value, callback) {\n			if (nielsen_time_validator_regex.test(value)) {\n				callback(true);\n			}\n			else {\n				callback(false);\n			}\n	  };\n\n	var copyButtonRenderer = function (instance, td, row, col, prop, value, cellProperties) {\n	  var escaped = Handsontable.helper.stringify(value);\n	  var jsStr = \'onkeyup=\"wsCheckBox(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" onmouseup=\"wsCheckBoxMouseUp(\'+\"\'\"+cellProperties.prop+\"\'\"+\',\'+cellProperties.row+\', this.checked\'+\');\" \';\n	  if (value) {\n		var checkedStr = \'checked\';\n	  }\n	  escaped = \'<input type=checkbox \' + jsStr + \' \' + checkedStr +\'>\'; \n	  td.innerHTML = escaped;\n	  return td;\n	};\n\n	  var weeks = { {foreach $weekNames as $weekName}{$weekName@iteration}: \"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach}  };\n\n{counter name=\"monthCounter\" start=0 skip=1 print=FALSE}\n\n	  var months = [\n			{foreach $months as $month} { month: {$month@iteration}, name: \"{$month.name}\", weeks: { {foreach $month.weeks as $monthWeek}{counter name=\"monthCounter\"}:\"{$monthWeek}\" {if ! $monthWeek@last}, {/if}{/foreach} }} {if ! $month@last}, {/if} {/foreach}\n			 ];\n\n\n          var stations = [];\n\n	  var maxLineNumber = {$maxLineNumber};\n\n	  var vendorNames = [ \n		{foreach $vendors as $vendor} \"{$vendor.name}\" {if ! $vendor@last},{/if}{/foreach}\n	 ];\n\n\n          {foreach $vendors as $vendor} \n	   	vendors[ \"{$vendor.name}\" ]=\"{$vendor.id}\";\n 	   {/foreach}\n\n\n	function calculateLines() {\n			var row=0;\n			$.each(data, function( index, src ) {\n					data[index][\"cpp\"] =  (data[index][\"rate\"] / data[index][\"aqh\"]).toFixed(3); \n					data[index][\"cpm\"] =   ((data[index][\"rate\"]) / (data[index][\"impact\"] / 1000)).toFixed(3); \n					row++;\n			});\n	}\n\n	{if $wsLines|@count>0}\n	data = {};	\n		{foreach $wsLines as $line}\n	  		{if $line.worksheetLine > 0} \n	 		 data[\'{$line.worksheetLine}\'] = \n				{ lineNumber: \"{$line.worksheetLine}\", daypart: \"{$line.daypart}\", vendor: \"{$line.vendorName}\", vendorID: \"{$line.vendorID}\", timeOfDay: \"{$line.timePeriod}\", timeOfDayStd: \"{$line.timePeriodStd|default:$line.timePeriod}\", station: \"{$line.station}\",  program: \"{$line.programName}\", mon: {if $line.isMonday}true{else}false{/if}, tue: {if $line.isTuesday}true{else}false{/if}, wed: {if $line.isWednesday}true{else}false{/if}, thu: {if $line.isThursday}true{else}false{/if}, fri: {if $line.isFriday}true{else}false{/if}, sat: {if $line.isSaturday}true{else}false{/if}, sun: {if $line.isSunday}true{else}false{/if}, length: \"{$line.seconds}\", rate: \"{$line.rate}\", week: { {foreach $weeks as $week}{$week@iteration}:{$wsWeeks[$line.worksheetLine][$week@iteration]|default:\"0\"}{if ! $week@last} , {/if}{/foreach} }, aqh: \"{$line.aqhRating}\", cpp: null, cpm: null, impact: \"{$line.impact}\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"{$line.comments}\", copy: {if $line.isCopy}true{else}false{/if}, bold: {if $line.isBold}true{else}false{/if}, skip: {if $line.isSkipped}true{else}false{/if}, trade: {if $line.isTrade}true{else}false{/if},delete: {if $line.isDeleted}true{else}false{/if} };\n			{/if}\n		{/foreach}\n	\n	{else}\n		data[\'1\'] = { lineNumber: 0, daypart: null, vendorID: \"\", vendor: null, timeOfDay: null,  timeOfDayStd: null, station: null,  program: null, mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: null, week: { {foreach $weeks as $week}{$week@iteration}:null{if ! $week@last},{/if}{/foreach} }, aqh: null, cpp: null, cpm: null, impact: null, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: null, copy: false, bold: false, skip: false, trade: false, delete: false };\n\n	{/if}\n\n//	console.log(data);\n\n	var maxRow = {$maxLineNumber};\n\n		data[\'{$maxLineNumber}\'] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate: 0, week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: 0, cpp: 0, cpm: 0, impact: 0, lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, skip: false, trade: false, delete: false };\n\n	console.log(\"Max Row: \" + maxRow);\n\n	  {if $wsLines|@count>0}\n		calculateLines();\n	  {/if}\n\n	  var summary = [ \n						{ weekly: \"Total Spots\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach} monthly: \"Total Spots\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach}  },\n						{ weekly: \"Total $$\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total $$\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Total GRPs\",  {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Total GRPs\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPP\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPP\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"CPM\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"CPM\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Reach\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Reach (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} },\n						{ weekly: \"Frequency\", {foreach $weekNames as $weekName}week{$weekName@iteration}:0,{/foreach}  monthly: \"Frequency (beta)\", {foreach $months as $month}month{$month@iteration}:0{if ! $month@last},{/if}{/foreach} }\n	   ];\n\n	function mapDataAttributes() {\n\n		$.each(data, function( index, src ) {\n			var timeOfDayStd = src.timeOfDay;\n\n			$(\"#field-program-\"+src.lineNumber).closest(\"td\").attr(\"data-order\",src.program);\n			$(\"#field-timeOfDay-\"+src.lineNumber).closest(\"td\").attr(\"data-order\", timeOfDayStd);\n		});\n	}\n\n\n	function loadWorksheetData() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n\n				{if $filter == 1}\n					if (data[src.lineNumber][\"lineSpendTotal\"] > 0) {\n						addRow(src.lineNumber);	\n\n						console.log(\"Added \" + src.lineNumber + \" = \" + data[src.lineNumber][\"lineSpendTotal\"]);\n\n						$(\"#worksheet-footer\").html(\"Line \" + src.lineNumber + \" added!\");\n					}\n					else {\n						console.log(\"Skipped \" + src.lineNumber);\n					}\n				{else if $filter == \"station\"}\n					if (data[src.lineNumber][\"station\"] == \"{$extra}\") {\n						addRow(src.lineNumber);	\n\n						console.log(\"Added \" + src.lineNumber + \" = \" + data[src.lineNumber][\"station\"]);\n\n						$(\"#worksheet-footer\").html(\"Line (station) \" + src.lineNumber + \" added!\");\n					}\n					else {\n						console.log(\"Skipped \" + src.lineNumber);\n					}\n				{else}\n\n						addRow(src.lineNumber);\n						\n						$(\"#worksheet-footer\").html(\"Line \" + src.lineNumber + \" added!\");\n		\n				{/if}\n			}\n		});\n\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.draw();\n\n//		console.log(\"Datatable loaded\");\n/*\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n\n				}\n		});\n\n*/\n	}\n\n\n	function updateSelectValues() {\n\n		$.each(data, function( index, src ) {\n			if (src.lineNumber>0) {\n				$(\'#field-vendorID-\'+src.lineNumber).val(data[src.lineNumber][\"vendorID\"]);\n				$(\'#field-daypart-\'+src.lineNumber).val(data[src.lineNumber][\"daypart\"]);\n			}\n		});\n	}\n\n	$( document ).ready(function() {\n\n	  $(\"#summaryTable\").handsontable({\n	    data: summary,\n	    colHeaders: [\"<strong>Weekly</strong>\", \n				{foreach $weekNames as $weekName}\"{$weekName}\"{if ! $weekName@last}, {/if}{/foreach},\n				\"<strong>Monthly</strong>\", {foreach $months as $month}\"{$month.name}\"{if ! $month@last}, {/if}{/foreach}],\n	    rowHeaders: false,\n	    minSpareRows: 0,\n	    maxCols: 70,\n	    manualColumnResize: false,\n	    colWidths: [150,{foreach $weeks as $week} 70, {/foreach} 150,{foreach $months as $month} 90{if ! $month@last}, {/if} {/foreach}],\n//	    stretchH: \'hybrid\',\n	    fillHandle: false,\n	    columns: [\n	  	  { data: \"weekly\",  readOnly: true}, // weekly\n		{foreach $weeks as $week}\n	  	  { data: \"week{$week@iteration}\", readOnly: true}, // week {$week@iteration}\n		{/foreach}\n	  	  { data: \"monthly\", readOnly: true}, // monthly\n		{foreach $months as $month}\n	  	  { data: \"month{$month@iteration}\", readOnly: true}{if ! $month@last}, {/if} // month {$month@iteration}\n		{/foreach}\n	    ]\n	  });\n\n\n\n	updateSummary();\n\n});\n\n			$(document).ready(function(){\n\n		$(data).each(function() {\n			$(\"#field-mon-\"+this.lineNumber).prop(\"checked\",this.mon);\n			$(\"#field-tue-\"+this.lineNumber).prop(\"checked\",this.tue);\n			$(\"#field-wed-\"+this.lineNumber).prop(\"checked\",this.wed);\n			$(\"#field-thu-\"+this.lineNumber).prop(\"checked\",this.thu);\n			$(\"#field-fri-\"+this.lineNumber).prop(\"checked\",this.fri);\n			$(\"#field-sat-\"+this.lineNumber).prop(\"checked\",this.sat);\n			$(\"#field-sun-\"+this.lineNumber).prop(\"checked\",this.sun);\n\n		});\n			$(\"#field-mon-new\").prop(\"checked\",false);\n			$(\"#field-tue-new\").prop(\"checked\",false);\n			$(\"#field-wed-new\").prop(\"checked\",false);\n			$(\"#field-thu-new\").prop(\"checked\",false);\n			$(\"#field-fri-new\").prop(\"checked\",false);\n			$(\"#field-sat-new\").prop(\"checked\",false);\n			$(\"#field-sun-new\").prop(\"checked\",false);\n\n\n\n/*\n				$(\'#multiselect4-filter\').multiselect({\n					enableFiltering: true,\n					enableCaseInsensitiveFiltering: true,\n					numberDisplayed: 5,\n					buttonWidth: \'100%\',\n      					includeSelectAllOption: true,\n				        includeSelectAllIfMoreThan: 10\n				});		\n*/	\n				$(\"#multiselect4-filter\").select2({\n				    placeholder: \"Search Vendors\",\n				    allowClear: true\n				});\n\n			});\n\n	function logData() {\n//		console.log(\"Log:\");\n//		console.log(data);\n	}\n\n\n	function saveChanges(changes) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n		if(typeof changes !== \'undefined\') {\n		  if (changes[0][0] != null) {\n\n			savesCounter++;\n\n			$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n			$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n			$(\"#worksheet-footer\").html(\"Not Saved!\");\n\n			$.post( \"/tv/ajax/cell/update/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"changes\": changes,  \"data\" : data, \"vendors\" : vendors }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n\n				savesCounter--;\n\n				$(\"#saveWorksheetLines\").html(\"Saving... (1/\" + savesCounter.toString() +\")\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Saving...(1/\" + savesCounter.toString() +\")\");\n\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n				if (response.newLine) {\n					data[response.rowNumber][\"lineNumber\"]=response.lineNumber;\n				}\n		\n				if (savesCounter < 1) {\n					savesCounter = 0;\n					$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n					$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n				}\n\n			})\n			.fail(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n\n				savesCounter--;\n\n			})\n			.error(function(data) {\n\n				$(\"#saveWorksheetLines\").html(\"Save Worksheet\");\n				$(\"#saveWorksheetLinesBottom\").html(\"Save Worksheet\");\n\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n\n				savesCounter--;\n\n			})\n		    }\n		}\n	    }\n	} \n\n	function reSort() {\n		\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		if (dt) {\n			dt.order([{foreach $worksheet.sorting as $sorting} [{$sorting.column},\"{$sorting.direction}\"] {if ! $sorting@last},{/if}{foreachelse} [ 1, \"asc\" ] {/foreach}]);\n			dt.draw(false);\n		\n			$(\"#worksheet-footer\").html(\"Sorted!\");\n\ndt.FixedColumns( table, {\n        leftColumns: 5\n   } );\n		}\n	}\n\n	function updateSort(sortInfo) {\n\n		var sortStr = \"\";\n		var dt =  $(\'#worksheet-{$worksheet.id}\').DataTable();\n		var sorting = [[]];\n\n		$(sortInfo).each( function (col) {\n			     sorting[col] = [];\n			     var direction = sortInfo[col][1];\n			     var columnIndex = sortInfo[col][0];\n   			     var column = dt.column(columnIndex).header();\n			     var columnName = $(column).data(\"index\");\n			     sortStr += \"[\" + columnName + \" \" + direction + \"] \";\n			     sorting[col] = [ columnIndex, columnName, direction];\n		});\n\n		$(\"#worksheet-footer\").html(\"Sorting Changed. ( \"+sortStr.toString()+\")\");\n			\n		saveSort(sorting);\n	}\n\n	function saveSort(sorting) {\n\n			console.log(sorting);\n\n			$.post( \"/worksheets/ajax/sorting/{$worksheet.id}?PHPSESSID={$sessionID}\", { \"sorting\": sorting }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(results) {\n				//console.log(\"Save Changes Response\");\n				//console.log(results);\n			        var response = $.parseJSON(results);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n			})\n			.fail(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	} \n\n	function removeLines(row,amount) {\n			$.post( \"/tv/ajax/lines/remove/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", { \"row\": row, \"amount\" : amount, \"line\": data[row][\"lineNumber\"], \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n	}\n\n	function saveLine() {\n			$.post( \"/tv/ajax/line/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function addLine(line) {\n			$.post( \"/tv/ajax/line/add/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : line }, function() {\n				$(\"#worksheet-footer\").html(\"Saving New Line...\");\n			})\n 			.done(function(data) {\n			        var response =$.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveLines() {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", \"disabled\");\n			$.post( \"/tv/ajax/lines/update/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\",  { \"data\" : data, \"maxLineNumber\": maxLineNumber-1 }, function() {\n				$(\"#worksheet-footer\").html(\"Not Saved!\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n					$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n				}\n				else {\n					window.location.href=\"/tv/edit/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\";\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n			})\n\n	}\n\n	function saveOrder() {\n\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function saveWorksheet(worksheetID) {\n		saveLines();\n	}\n\n	function editWorksheet(worksheetID) {\n		saveLines();\n		window.location.href=\"/worksheet/edit/{$worksheetID}\";\n	}\n\n	function createOrder(worksheetID) {\n		$(\"#createOrderButton\").text(\"Creating...\");\n		$(\"#createOrderButton\").attr(\"disabled\", \"disabled\");\n		$(\"#createOrderButtonDropDown\").attr(\"disabled\", \"disabled\");\n\n\n		{if $worksheet.isOrdered}\n			console.log(\"Checking Rev #: \" + $(\"#revisionNumber\").val() +  \" = {$orderInfo.revision}\");\n\n			if ($(\"#revisionNumber\").val() == \"{$orderInfo.revision}\") {\n				checkRevision();\n			}\n	\n			else {\n				saveOrder();\n			}\n		{else}\n			saveOrder();\n		{/if}\n		\n	}\n\n	function wsCheckBox(type, row, state) {\n	\n		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 1;\n			oldState = 0;\n		}\n		else {\n			newState = 0;\n			oldState = 1;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			//saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function wsCheckBoxMouseUp(type, row, state) {\n	\n 		var newState;\n		var oldState;\n\n		if (state) {\n			newState = 0;\n			oldState = 1;\n		}\n		else {\n			newState = 1;\n			oldState = 0;\n		}			\n	\n		if (type == \"copy\") {\n			data[row][\"copy\"]=newState;\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"delete\") {\n			data[row][\"delete\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'delete\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n		}\n		else if (type == \"bold\") {\n			data[row][\"bold\"]=newState;\n			var changes = [[]];\n			changes[0][0]=row;\n			changes[0][1]=\'bold\';\n			changes[0][2]=oldState;\n			changes[0][3]=newState;\n			saveChanges(changes);\n		}\n	}\n\n	function refreshWorksheet() {\n	\n		$(\'#main-content\').resize(function(){\n			resizeWorksheet();\n		});\n	}\n\n	function resizeWorksheet() {\n	\n			var maxWidth = $(\'#main-content\').width()-1;\n			//console.log(maxWidth);\n			var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n			//dataTable.updateSettings( { width: maxWidth }  );\n			dataTable.render();\n        		        //dataTable.handsontable(\'render\');\n			//console.log(\"Refresh Worksheet\");\n	}\n\n	function setColumnToCheckBox(i, instance) {\n	  columns[i].type = \"checkbox\";\n	  instance.updateSettings({ columns: columns });\n	  instance.validateCells(function() {\n	    instance.render();\n          });\n        }\n\n	function deleteWorksheet(worksheetID) {\n			  \n		  	bootbox.confirm(\'Are you sure?\', function(result) { \n\n				if (result) {\n\n					$(\"#worksheet-footer\").html(\"Deleting..\");\n\n					$.post( \"/tv/ajax/delete/{$worksheetID}\"+ \"?PHPSESSID={$sessionID}\", $( \"#worksheet-form\" ).serialize(), function() {\n						$(\"#worksheet-footer\").html(\"Deleting...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n						}\n						else {\n							window.location.href=\"/campaigns/edit/{$campaign.id}\"+ \"?PHPSESSID={$sessionID}\";\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n	 	 	});\n  	}\n\n\n\n	function autoCalc() {\n\n			if ($(\"#autoCalc\").is(\":checked\")) {\n				$(\"#autoUpdate\").val(\"1\");\n			}\n			else {\n				$(\"#autoUpdate\").val(\"0\");\n			}\n	}\n\n	function scrolling() {\n\n			if ($(\"#scrolling\").is(\":checked\")) {\n				$(\"#isScrolling\").val(\"1\");\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'1500\' }  );\n				dataTable.render()\n			}\n			else {\n				var dataTable = $(\'#dataTable\').handsontable(\'getInstance\');\n				dataTable.updateSettings( { height:\'100%\' }  );\n				dataTable.render()\n				$(\"#isScrolling\").val(\"0\");\n			}\n	}\n\n\n	function copyBox(worksheetID) {\n			 \n			var worksheetIDStr = \"\'\"+worksheetID + \"\'\";\n\n			var worksheets = \"<div class=\'form-group\'><select id=\'copyCampaign\' class=\'form-control\' name=\'campaign\'><option>-Select A Campaign-</option><option value=\'{$campaign.id}\' selected>-This Campaign-</option>{foreach $campaigns as $campaign}<option value=\'{$campaign.id}\'>{$campaign.name|replace:\'\"\':\'\\\"\'}</option>{/foreach}</select><br><center><button class=\'btn btn-success\' id=\'copyCampaignBtn\' onclick=\'copyWorksheet($(\\\"#copyCampaign\\\").val());\'>Copy</button></center></div>\"; \n\n		  	bootbox.alert(\'Copy this Worksheet to: \' + worksheets);\n\n  	}\n\n	function copyWorksheet(campaignID) {\n				if (campaignID) {\n					$(\"#worksheet-footer\").html(\"Copying Worksheet..\");\n\n					$.post( \"/worksheet/ajax/copy/{$worksheetID}/\"+campaignID, function() {\n						$(\"#worksheet-footer\").html(\"Copying Worksheet...\");\n					})\n 					.done(function(data) {\n					        var response = jQuery.parseJSON(data);\n						$(\"#worksheet-footer\").html(response.message);\n						if (response.error) {\n							$(\"#worksheet-footer\").html(\"Copy Failed.\");\n						}\n						else {\n							window.location =\"/\" + response.newWorksheetType + \"/edit/\" + response.newWorksheetID;\n						}\n					})\n					.fail(function(data) {\n						$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n					})\n					.error(function(data) {\n						$(\"#worksheet-footer\").html(\"Error!\");\n					})\n				}\n  	}\n\n			$(\"#autoCalc\").change(function () {\n				autoCalc();\n			}); \n			$(\"#scrolling\").change(function () {\n				scrolling();\n			});\n\n	function updateField(field) {\n	   if ($(\"#autoCalc\").is(\":checked\")) {\n\n	     var line = $(field).data(\"line\");	\n	     var row = maxRow;\n\n	     if (line !== \"new\") {\n		     row =$(field).data(\"row\");\n	     }\n	     else {\n		     if(typeof data[row] === \'undefined\') {\n			     console.log(\"New Row: \" + row);\n		data[row] = { lineNumber: 0, daypart: \"\", vendorID: \"\", vendor: \"\", timeOfDay: \"\",  timeOfDayStd: \"\", station: \"\",  program: \"\", mon: false, tue: false, wed: false, thu: false, fri: false, sat: false, sun: false, length: 0, rate:\"\", week: { {foreach $weeks as $week}{$week@iteration}:0{if ! $week@last},{/if}{/foreach} }, aqh: \"\", cpp: 0, cpm: 0, impact: \"\", lineSpendTotal: 0.00, lineAQHTotal: 0.0, lineCPPTotal: 0.00, lineCPMTotal: 0.00, comments: \"\", copy: false, bold: false, skip: false, trade: false, delete: false };\n\n		     }\n	     }	\n	     var oldValue = $(field).val();	\n	     var newValue;\n\n	     var fieldName = $(field).data(\"name\");\n\n		if (fieldName ==\"daypart\") {\n			newValue = $(field).val();\n			data[row][\"daypart\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendor\") {\n			newValue = $(field).val();\n			data[row][\"vendor\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"vendorID\") {\n			newValue = $(field).val();\n			data[row][\"vendorID\"] = newValue;\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"station\") {\n			newValue = $(field).val();\n			data[row][\"station\"] = newValue.trim();\n			updateStations();				\n			var changes = [[row,fieldName,oldValue,newValue.trim()]];\n		}\n\n		else if (fieldName ==\"timeOfDay\") {\n			newValue = nielsen_time_format($(field).val());\n			$(field).val(newValue);\n			//$(field).closest(\'.form-group\').addClass(\'has-error\');\n			data[row][\"timeOfDay\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"program\") {\n			newValue = $(field).val();\n			data[row][\"program\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"mon\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"mon\"] = newValue;\n			var changes = [[row,\"mon\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"tue\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"tue\"] = newValue;\n			var changes = [[row,\"tue\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"wed\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"wed\"] = newValue;\n			var changes = [[row,\"wed\",oldValue,newValue]];\n		}	\n		\n		else if (fieldName == \"thu\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"thu\"] = newValue;\n			var changes = [[row,\"thu\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"fri\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"fri\"] = newValue;\n			var changes = [[row,\"fri\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sat\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sat\"] = newValue;\n			var changes = [[row,\"sat\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"sun\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"sun\"] = newValue;\n			var changes = [[row,\"sun\",oldValue,newValue]];\n		}	\n\n		else if (fieldName == \"length\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"length\"] = newValue;\n				$(\"#field-length-\"+line).val(data[row][\"length\"]);\n				var changes = [[row,fieldName,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"rate\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"rate\"] = newValue;\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-rate-\"+line).val(data[row][\"rate\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n\n			}	\n		}\n\n		else if (fieldName == \"impact\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"impact\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); 				$(\"#field-impact-\"+line).val(data[row][\"impact\"]);\n				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"aqh\") {\n			newValue = parseFloat(oldValue).toFixed(2);\n			if (isNaN(newValue)) {\n				$(field).closest(\'.form-group\').addClass(\'has-error\');\n			}\n			else {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				data[row][\"aqh\"] = newValue\n				data[row][\"cpm\"] =  ((data[row][\"rate\"]) / (data[row][\"impact\"] / 1000)).toFixed(2); \n				data[row][\"cpp\"] =  (data[row][\"rate\"] / data[row][\"aqh\"]).toFixed(2); \n				$(\"#field-aqhRating-\"+line).val(data[row][\"aqh\"]);				$(\"#field-cpm-\"+line).val(data[row][\"cpm\"]);\n 				$(\"#field-cpp-\"+line).val(data[row][\"cpp\"]);\n				var changes = [[row,\"cpm\",0,data[row][\"cpm\"]],[row,\"cpp\",0,data[row][\"cpp\"]],[row,fieldName,oldValue,newValue]];\n			}\n			\n		}\n\n		else if (fieldName == \"week\") {\n			newValue = parseFloat(oldValue).toFixed(0);\n\n			if (isNaN(newValue)) {\n				newValue = 0;\n			}\n			if (newValue >= 0) {\n				$(field).closest(\'.form-group\').removeClass(\'has-error\');\n				var weekCounter = $(field).data(\"week\");	\n				data[row][\"week\"][weekCounter] = newValue;\n				$(\"#field-week-\"+line+\"-\"+weekCounter).val(data[row][\"week\"][weekCounter]);\n				var changes = [[row,fieldName+\".\"+weekCounter,oldValue,newValue]];\n			}	\n		}\n\n		else if (fieldName == \"comments\") {\n			newValue = $(field).val();\n			data[row][\"comments\"] = newValue;\n			var changes = [[row,fieldName,oldValue,newValue]];\n		}\n\n		else if (fieldName == \"copy\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"copy\"] = newValue;\n			var changes = [[row,\"copy\",oldValue,newValue]];\n			wsCheckBox(\"copy\", row, newValue);	\n		}\n\n		else if (fieldName == \"bold\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"bold\"] = newValue;\n			var changes = [[row,\"bold\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"trade\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"trade\"] = newValue;\n			var changes = [[row,\"trade\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"skip\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"skip\"] = newValue;\n			var changes = [[row,\"skip\",oldValue,newValue]];\n		}\n\n		else if (fieldName == \"delete\") {\n			newValue = 0;\n			if ($(field).is(\':checked\')) {\n				newValue = 1;\n			}\n			data[row][\"delete\"] = newValue;\n			\n			wsCheckBox(\"delete\", row, newValue);	\n		}\n	\n		if (line == \"new\") {	\n//			console.log(\"building new line \" + row);\n		}\n		else {		\n			saveChanges(changes);\n		}\n	       updateSummary();\n	    \n\n           }\n	   else {\n			$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			$(\"#saveWorksheetLinesBottom\").attr(\"disabled\", false);\n	   }\n	}\n\n	function toggleSideBar(e) {\n\n//		console.log(e);\n\n		if ($(e).hasClass(\"fa-angle-right\")) {\n			updateSideBar(\"open\");\n		}\n		else {\n			updateSideBar(\"close\");\n		}\n\n	}\n\n	function updateSideBar(status) {\n\n			$.post( \"/home/ajax/sidebar/\"+status, function() {\n				$(\"#worksheet-footer\").html(\"\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n	  function updateDaypartSummary() {\n\n		var dayparts =  { none:\"-\", EM:\"EM\", DA:\"DA\", EF:\"EF\", EN:\"EN\", PA:\"PA\", PR:\"PR\", LF:\"LF\", LN:\"LN\", OV:\"OV\", SP:\"SP\", RO:\"RO\" };\n\n		for (var daypart in dayparts) {\n\n			var totalSpend = sumTotalSpendByDaypart(dayparts[daypart]);\n			var totalSpots = sumTotalSpotsByDaypart(dayparts[daypart]);\n			var totalGRPs = sumTotalGRPsByDaypart(dayparts[daypart]);\n			var overallCPP = 0;\n			var totalCPM = 0;\n			var percentOfTotalGRP = 0.0;\n\n			if (summaryGRPs > 0) {\n				var percentOfTotalGRP = (totalGRPs / summaryGRPs) * 100;\n			}\n\n			if (totalSpots > 0) {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).show();\n//				overallCPP = sumTotalCPPByDaypart(dayparts[daypart]) / totalSpots;\n				overallCPP = totalSpend / totalGRPs;\n				totalCPM = sumTotalCPMByDaypart(dayparts[daypart]) / totalSpots;			}\n			else {\n				$(\'#daypart-totalSpots-\'+daypart).html(totalSpots.toFixed(0));\n				$(\'#summary-daypart-\'+daypart).hide();\n			}\n\n			if (totalSpend > 0) {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalSpend-\'+daypart).html(\"$\" + totalSpend.toFixed(2));\n			}\n\n			if (totalGRPs > 0) {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n				var totalReach = ((1 - Math.pow( 1 - (totalGRPs / totalSpots / 100),totalSpots)) * .85 * 100);\n				$(\'#daypart-reach-\'+daypart).html(totalReach.toFixed(2) + \"%\");\n				$(\'#daypart-freq-\'+daypart).html((totalGRPs / totalReach).toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalGRPs-\'+daypart).html(totalGRPs.toFixed(1));\n				$(\'#daypart-percentOfTotalGRP-\'+daypart).html(percentOfTotalGRP.toFixed(1) + \'%\');\n			}\n			if (overallCPP > 0) {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n			else {\n				$(\'#daypart-overallCPP-\'+daypart).html(\"$\" + overallCPP.toFixed(2));\n			}\n\n			if (isFinite(totalCPM)) {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$\" + totalCPM.toFixed(2));\n			}\n			else {\n				$(\'#daypart-totalCPM-\'+daypart).html(\"$0.00\");\n			}	\n		}\n\n	  }\n\n	function addNewLine() {\n		// take current new line, save to server, insert new row by copying existing into main table\n		//do not clear unless asked\n\n		maxRow++;  \n\n		console.log(data);\n		console.log(\"Add New Line: \" + maxRow);\n		console.log(data[maxRow-1]);\n\n		data[maxRow-1][\"lineNumber\"] = maxLineNumber;\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		if(data[maxRow-1][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[maxRow-1][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[maxRow-1][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[maxRow-1][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[maxRow-1][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[maxRow-1][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[maxRow-1][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[maxRow-1][\"daypart\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\"\', \'value=\"\'+data[maxRow-1][\"vendorID\"]+\'\" selected\');\n\n		rememberPage();\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+maxLineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+maxLineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+maxLineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[maxRow-1][\"station\"]+\'\" id=\"field-station-\'+maxLineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+maxLineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+maxLineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+maxLineNumber+\'\" data-name=\"wed\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+maxLineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+maxLineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+maxLineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+maxLineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+maxRow+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+maxLineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" value=\"\'+data[maxRow-1][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+maxLineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+maxLineNumber+\'\"\" value=\"\'+data[maxRow-1][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+maxLineNumber+\'\" value=\"\'+data[maxRow-1][\"cpm\"]+\'\" id=\"field-cpm-\'+maxRow+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\"  value=\"\'+data[maxRow-1][\"week\"][{$weekCounter}]+\'\" name=\"week\'+maxRow+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+maxLineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+maxLineNumber+\'\" size=40  value=\"\'+data[maxRow-1][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+maxLineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+maxLineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isBold[]\" onchange=\"updateField(this);\"></center></td>\',		\'<td><center><input type=checkbox class=\"centered\" id=\"field-trade-\'+maxLineNumber+\'\" data-index=\"trade\" data-name=\"trade\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isTrade[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-skip-\'+maxLineNumber+\'\" data-index=\"skip\" data-name=\"skip\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isSkipped[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+maxLineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+maxLineNumber+\'\" data-row=\"\'+maxRow+\'\" data-counter=\"\'+maxRow+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]).draw(false);\n	\n		$(\'#field-vendorID-\'+maxLineNumber).val(data[maxRow-1][\"vendorID\"]);\n		$(\'#field-daypart-\'+maxLineNumber).val(data[maxRow-1][\"daypart\"]);\n\n		addLine(data[maxRow-1]);\n		\n		maxLineNumber++;\n\n\n		data[maxRow] = { lineNumber: maxLineNumber+1, daypart: data[maxRow-1][\"daypart\"], vendorID: data[maxRow-1][\"vendorID\"],  vendor: data[maxRow-1][\"vendor\"], timeOfDay: data[maxRow-1][\"timeOfDay\"], timeOfDayStd: data[maxRow-1][\"timeOfDayStd\"], station: data[maxRow-1][\"station\"],  program: data[maxRow-1][\"program\"], mon: data[maxRow-1][\"mon\"], tue: data[maxRow-1][\"tue\"], wed: data[maxRow-1][\"wed\"], thu: data[maxRow-1][\"thu\"], fri: data[maxRow-1][\"fri\"], sat: data[maxRow-1][\"sat\"], sun: data[maxRow-1][\"sun\"], length: data[maxRow-1][\"length\"], rate:data[maxRow-1][\"rate\"], week: { {foreach $weeks as $week}{$week@iteration}:data[maxRow-1][\"week\"][{$week@iteration}]{if ! $week@last},{/if}{/foreach} }, aqh: data[maxRow-1][\"aqh\"], cpp: data[maxRow-1][\"cpp\"], cpm: data[maxRow-1][\"cpm\"], impact: data[maxRow-1][\"impact\"], lineSpendTotal: data[maxRow-1][\"lineSpendTotal\"], lineAQHTotal: data[maxRow-1][\"lineAQHTotal\"], lineCPPTotal: data[maxRow-1][\"lineCPPTotal\"], lineCPMTotal: data[maxRow-1][\"lineCPMTotal\"], comments: data[maxRow-1][\"comments\"], copy: false, bold: false, skip: false, trade: false, delete: false };\n\n $(\'input\').keyup(function(e){\n  var cursor = 0;\n  var maxCursor = 0;\n  if ($(\":focus\").attr(\"type\")==\"text\") {\n	  cursor = $(\":focus\").getCursorPosition();\n	  maxCursor = $(\":focus\").val().length;\n  }\n  if(e.which==39) {\n    if (cursor >= maxCursor ) {\n	if (lastCursor == cursor) {\n		lastCursor = -1;\n	   	$(this).closest(\'td\').next().find(\'input\').focus();\n		if ($(\":focus\").attr(\"tabindex\") < 0) {\n		   	$(\":focus\").closest(\'td\').next().find(\'input\').focus();\n		}\n	}\n	else {\n		lastCursor = cursor;\n	}\n   }\n   lastCursor = cursor;\n  }\n  else if(e.which==37) {\n    if (cursor < 1) {\n	if (lastCursor == cursor) {\n	    lastCursor = -1;\n	    $(this).closest(\'td\').prev().find(\'input\').focus();\n	    if ($(\":focus\").attr(\"tabindex\") < 0) {\n	   	$(\":focus\").closest(\'td\').prev().find(\'input\').focus();\n	    }\n	}\n	else {\n	    lastCursor = cursor;\n	}\n    }\n    lastCursor = cursor;\n  }\n  else if(e.which==40) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==38) {\n   $(this).closest(\'tr\').prev().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();\n  }\n  else if(e.which==13) {\n   $(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').focus();  \n   if ($(this).closest(\'tr\').next().find(\'td:eq(\'+$(this).closest(\'td\').index()+\')\').find(\'input\').length==0) {\n	  updateField($(this));\n   }\n  }\n});\n\n\n	}\n\n\n	function addRow(line) {\n	\n		var isMonday = \"\";\n		var isTuesday = \"\";\n		var isWednesday = \"\";\n		var isThursday = \"\";\n		var isFriday = \"\";\n		var isSaturday = \"\";\n		var isSunday = \"\";\n\n		var isBold = \"\";\n		var isTrade = \"\";\n		var isSkipped = \"\";\n\n		lineNumber = line;\n\n		if(data[lineNumber][\"mon\"]) {\n			isMonday = \" checked\";\n		}\n		if(data[lineNumber][\"tue\"]) {\n			isTuesday = \" checked\";\n		}\n		if(data[lineNumber][\"wed\"]) {\n			isWednesday = \" checked\";\n		}\n		if(data[lineNumber][\"thu\"]) {\n			isThursday = \" checked\";\n		}\n		if(data[lineNumber][\"fri\"]) {\n			isFriday = \" checked\";\n		}\n		if(data[lineNumber][\"sat\"]) {\n			isSaturday = \" checked\";\n		} \n		if(data[lineNumber][\"sun\"]) {\n			isSunday = \" checked\";\n		} \n\n		if(data[lineNumber][\"bold\"]) {\n			isBold = \" checked\";\n		} \n\n		if(data[lineNumber][\"trade\"]) {\n			isTrade = \" checked\";\n		} \n\n		if(data[lineNumber][\"skip\"]) {\n			isSkipped = \" checked\";\n		} \n\n\n\n		var daypartStr = \'{foreach $dayparts as $daypart}<option value=\"{$daypart}\">{$daypart}</option>{/foreach}\';\n		\n		daypartStr = daypartStr.replace(\'value=\"\'+data[lineNumber][\"daypart\"]+\'\"\', \'value=\"\'+data[lineNumber][\"daypart\"]+\'\" selected\');\n\n		var vendorStr = \'{foreach $vendors as $vendor}<option value=\"{$vendor.id}\">{$vendor.name}</option>{/foreach}\';\n\n		vendorStr = vendorStr.replace(\'value=\"\'+data[lineNumber][\"vendorID\"]+\'\"\', \'value=\"\'+data[lineNumber][\"vendorID\"]+\'\" selected\');\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n		dt.row.add([\n		\'<td></td>\',\n		\'<td><input type=\"hidden\" class=\"worksheet-field\" value=\"\'+lineNumber+\'\" name=\"worksheetLine[]\"></td>\',\n		\'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-daypart-\'+lineNumber+\'\" name=\"daypart[]\" data-index=\"daypart\" data-name=\"daypart\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"><option value=\"\"></option>\'+daypartStr+\'</select></td>\',\n		 \'<td><select class=\"form-control input-sm worksheet-field\" id=\"field-vendorID-\'+lineNumber+\'\"  name=\"vendorID[]\" data-index=\"vendorID\" data-name=\"vendorID\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\" onload=\"$(this).val(\'+data[lineNumber][\"vendorID\"]+\');\"><option value=\"\"></option>\'+vendorStr+\'</select></td>\',\n		\'<td data-order=\"\'+data[lineNumber][\"station\"]+\'\"><input type=text class=\"form-control input-sm worksheet-field\"  value=\"\'+data[lineNumber][\"station\"]+\'\" id=\"field-station-\'+lineNumber+\'\"  name=\"station[]\" data-index=\"station\" data-name=\"station\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'  <td ><input type=hidden value=\"\'+data[lineNumber][\"timeOfDayStd\"]+\'\" ><div class=\"form-group\"><input type=text class=\"form-control input-sm worksheet-field\" id=\"field-timeOfDay-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"timeOfDay\"]+\'\" placeholder=\"####A/P-####A/P\" name=\"timeOfDay[]\" data-index=\"timeOfDay\" data-name=\"timeOfDay\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\' <td><input type=text class=\"form-control input-sm\" id=\"field-program-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"program\"]+\'\" name=\"program[]\" data-index=\"program\" data-name=\"program\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\' <td><input type=checkbox name=\"isMonday[]\" class=\"\" id=\"field-mon-\'+lineNumber+\'\" data-index=\"mon\" data-name=\"mon\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"\'+isMonday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-tue-\'+lineNumber+\'\" data-index=\"tue\" data-name=\"tue\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isTuesday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isTuesday+\'></td>\',\n		\' <td><input type=checkbox data-index=\"wed\" id=\"field-wed-\'+lineNumber+\'\" data-name=\"wed\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isWednesday[]\" class=\"\" onchange=\"updateField(this);\"\'+isWednesday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-thu-\'+lineNumber+\'\" data-index=\"thu\" data-name=\"thu\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isThursday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isThursday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-fri-\'+lineNumber+\'\" data-index=\"fri\" data-name=\"fri\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isFriday[]\" class=\"\"  onchange=\"updateField(this);\"\'+isFriday+\'></td>\',\n		\' <td><input type=checkbox id=\"field-sat-\'+lineNumber+\'\" data-index=\"sat\" data-name=\"sat\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSaturday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSaturday+\'></td>\',\n		\'<td><input type=checkbox id=\"field-sun-\'+lineNumber+\'\" data-index=\"sun\" data-name=\"sun\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSunday[]\" class=\"\" onchange=\"updateField(this);\"\'+isSunday+\'></td>\',\n		\' <td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-length-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"length\"]+\'\" size=\"3\" name=\"length[]\"  data-index=\"length\" data-name=\"length\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-rate-\'+lineNumber+\'\" data-index=\"rate\" data-name=\"rate\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"rate\"]+\'\" size=\"5\" name=\"rate[]\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm\" id=\"field-aqh-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"aqh\"]+\'\" size=\"4\" name=\"aqh[]\" data-index=\"aqhRating\" data-name=\"aqh\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpp-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpp\"]+\'\" size=\"4\" name=\"cpp[]\" tabindex=\"-1\"  data-name=\"cpp\" data-line=\"\'+lineNumber+\'\" data-index=\"cpp\" readonly></div></td>\',\n		\'<td><div class=\"form-group\"><input type=text class=\"form-control input-sm id=\"field-impact-\'+lineNumber+\'\"\" value=\"\'+data[lineNumber][\"impact\"]+\'\" size=\"4\" name=\"impact[]\" data-index=\"impact\" data-name=\"impact\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" onchange=\"updateField(this);\"></div></td>\',\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-cpm-\'+lineNumber+\'\" value=\"\'+data[lineNumber][\"cpm\"]+\'\" id=\"field-cpm-\'+lineNumber+\'\" size=\"4\"  data-index=\"cpm\" data-name=\"cpm\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" name=\"cpm[]\" tabindex=\"-1\" readonly></td>\',\n{counter start=0 skip=1 print=false assign=\"weekCounter\"}\n{foreach $weeks as $week}\n{counter}\n		\'<td><input type=text class=\"form-control input-sm\" id=\"field-week-\'+lineNumber+\'-{$weekCounter}\"  value=\"\'+data[lineNumber][\"week\"][{$weekCounter}]+\'\" name=\"week\'+lineNumber+\'[{$weekCounter}]\" size=\"3\" data-index=\"field-week-\'+lineNumber+\'-{$weekCounter}\" data-name=\"week\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\" data-week=\"{$weekCounter}\" onchange=\"updateField(this);\"></td>\',\n{/foreach}\n		\n		\'<td class=\"hidden-sm hidden-xs\"><input type=text class=\"form-control input  input-sm\" id=\"field-comments-\'+lineNumber+\'\" size=40  value=\"\'+data[lineNumber][\"comments\"]+\'\" name=\"comments[]\" data-index=\"comments\" data-name=\"comments\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  onchange=\"updateField(this);\"></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-copy-\'+lineNumber+\'\" data-index=\"copy\" data-name=\"copy\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isCopy[]\" onchange=\"updateField(this);\"></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-bold-\'+lineNumber+\'\" data-index=\"bold\" data-name=\"bold\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isBold[]\" onchange=\"updateField(this);\"\'+isBold+\'></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-trade-\'+lineNumber+\'\" data-index=\"trade\" data-name=\"trade\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isTrade[]\" onchange=\"updateField(this);\"\'+isTrade+\'></center></td>\',\n		\'<td><center><input type=checkbox class=\"centered\" id=\"field-skip-\'+lineNumber+\'\" data-index=\"skip\" data-name=\"skip\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isSkipped[]\" onchange=\"updateField(this);\"\'+isSkipped+\'></center></td>\',		\'<td><center><input type=checkbox class=\"centered\" id=\"field-delete-\'+lineNumber+\'\" data-index=\"delete\" data-name=\"delete\" data-line=\"\'+lineNumber+\'\" data-row=\"\'+lineNumber+\'\" data-counter=\"\'+lineNumber+\'\"  name=\"isDeleted[]\" onchange=\"updateField(this);\"></center></td>\'\n		\n		]);\n		\n		\n		$(\'#field-vendorID-\'+lineNumber).val(data[lineNumber][\"vendorID\"]);\n		$(\'#field-daypart-\'+lineNumber).val(data[lineNumber][\"daypart\"]);\n	}\n\n$(document).ready(function () {\n    $(\"select\").each(function () {\n        $(this).val($(this).find(\'option[selected]\').val());\n    });\n\n	loadWorksheetData(); \n	bindKeyEvents();\n	checkCols();\n\n});\n\n	function clearNewLine() {\n		$(\'#field-comments-new\').val(\'\');\n		$(\'#field-daypart-new\').val(\'\');\n		$(\'#field-vendorID-new\').val(\'\');\n		$(\'#field-station-new\').val(\'\');\n		$(\'#field-timeOfDay-new\').val(\'\');\n		$(\'#field-program-new\').val(\'\');\n		$(\'#field-mon-new\').val(\'\');\n		$(\'#field-tue-new\').val(\'\');\n		$(\'#field-wed-new\').val(\'\');\n		$(\'#field-thu-new\').val(\'\');\n		$(\'#field-fri-new\').val(\'\');\n		$(\'#field-sat-new\').val(\'\');\n		$(\'#field-sun-new\').val(\'\');\n		$(\'#field-rate-new\').val(\'\');\n		$(\'#field-length-new\').val(\'\');\n		$(\'#field-cpp-new\').val(\'\');\n		$(\'#field-impact-new\').val(\'\');\n		$(\'#field-aqh-new\').val(\'\');\n		$(\'#field-cpm-new\').val(\'\');\n\n	}\n\n	function toggleSummary() {\n\n		if ($(\"#toggleSummary\").text() == \"Hide Summary\") {\n			$(\"#toggleSummary\").text(\"Show Summary\");\n		}\n		else {\n			$(\"#toggleSummary\").text(\"Hide Summary\");\n		}\n		$(\"#widget-summary\").toggle();\n		$(\"#worksheet-div\").toggleClass(\"col-lg-10\");\n		$(\"#worksheet-div\").toggleClass(\"col-lg-12\");\n	}\n\n\n// toggle function\n$.fn.clickToggle = function( f1, f2 ) {\n	return this.each( function() {\n		var clicked = false;\n		$(this).bind(\'click\', function() {\n			if(clicked) {\n				clicked = false;\n				return f2.apply(this, arguments);\n			}\n\n			clicked = true;\n			return f1.apply(this, arguments);\n		});\n	});\n\n}\n\n\n\nfunction showAllColumns(maxCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\n \nfor ( var i=2 ; i<=maxCol ; i++ ) {\n    table.column( i ).visible( true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction showAllWeeks(startCol, endCol) {\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\nfor ( var i=startCol ; i<cols[0].length; i++ ) {\n    table.column( i ).visible(true, false );\n    $(\"#col-\"+i).prop(\"checked\", true);\n    var colName = $(\"#col-\"+i).data(\"name\");\n    saveCols(colName, 0);\n}\ntable.columns.adjust().draw( false ); // adjust column sizing and redraw\n\n}\n\nfunction checkCols() {\n\nvar table = $(\'#worksheet-{$worksheet.id}\').DataTable();\nvar cols = table.columns();\n\nfor ( var i=0 ; i<cols[0].length; i++ ) {\n    if (table.column( i ).visible()) {\n	    $(\"#col-\"+i).prop(\"checked\", true);\n    }\n    else {\n	    $(\"#col-\"+i).prop(\"checked\", false); \n    }\n}\n\n}\n\n\n		function viewSchedule(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/schedule/pdf\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to display schedule at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}	\n\n		function exportWorksheet(worksheetID, templateID, format) {\n\n			$(\"#reportWait\").modal(\'show\')\n\n			$(\"#templateID\").val(templateID);\n			$(\"#reportFormat\").val(format);\n\n			$.post( \"/reports/ajax/create/worksheet/csv\" + \"?PHPSESSID={$sessionID}\", $(\"#report-form\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Parameters...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#reportWait\").modal(\'hide\')\n				}\n				else {\n					if (response.reportID) {\n						window.location.href=\"/reports/show/\" + response.reportID + \"/\" + response.format + \"?PHPSESSID={$sessionID}\";\n\n//						var myPDF = new PDFObject({ url: \"/reports/show/\" + response.reportID + \"/pdf\" }).embed(\"pdfViewer\");\n						if (response.format != \"pdf\") {\n							$(\"#reportWait\").modal(\'hide\');\n						}\n//						$(\"#pdfFrame\").show();\n//						$(\"#mainContent\").hide();\n					}\n					else {\n						$(\"#worksheet-footer\").html(\"Unable to export worksheet at this time.\");\n						$(\"#reportWait\").modal(\'hide\');\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n		}\n\n	$(document).ready(function () {\n	\n	    	$(\'.toggle-col\').change(function(box) {\n	            var colName = $(this).data(\"name\");\n	    	    if ($(this).is(\':checked\')) {\n	//		console.log(\"Box is checked\");\n			saveCols(colName, 0);\n		    }\n	            else {\n	//		console.log(\"Box is unchecked\");\n			saveCols(colName, 1);\n		    }\n	    	});\n	});\n\n	function saveCols(colName, isChecked) {\n\n			$.post( \"/worksheet/ajax/cols/{$worksheet.id}/\"+colName+\"/\"+isChecked, function() {\n				$(\"#worksheet-footer\").html(\"Saving changes...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n				}\n				else {\n				}\n			})\n			.fail(function(data) {\n				$(\"#worksheet-footer\").html(\"Connection Failed!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n			.error(function(data) {\n				$(\"#worksheet-footer\").html(\"Error!\");\n				$(\"#saveWorksheetLines\").attr(\"disabled\", false);\n			})\n	}\n\n\n	function previewOrder() {\n			$.post( \"/orders/ajax/preview/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Saving Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.orderID) {\n						window.location.href=\"/orders/show/\" + response.worksheetID + \"/pdf\"+ \"?PHPSESSID={$sessionID}&orderKey=\"+response.orderKey;\n//						$(\"#createOrderButton\").attr(\"disabled\", false);\n//						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n//						$(\"#createOrderButton\").text(\"Create Order\");\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to display order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n\n	function sendOrder() {\n\n			$.post( \"/orders/ajax/create/tv/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Creating Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Sending Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", true);					$(\"#createOrderButtonDropDown\").attr(\"disabled\", true);\n				}\n				else {\n					if (response.orderID) {\n						confirmSend(response.worksheetID, response.orderID, response.orderKey);\n					}\n				}\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n	}\n\n	function deliverOrder(worksheetID, orderID, orderKey) {\n\n						$.post( \"/orders/ajax/deliver/tv/\"+ worksheetID + \"?PHPSESSID={$sessionID}&orderKey=\"+orderKey, function() {\n							$(\"#worksheet-footer\").html(\"Sending Order...\");\n						})\n						.done(function(data) {\n						        var response = $.parseJSON(data);\n							$(\"#worksheet-footer\").html(response.message);\n							if (response.error) {\n								$(\"#createOrderButton\").text(\"Create Order\");\n								$(\"#createOrderButton\").attr(\"disabled\", false);							}\n							else {\n								if (response.msgCount) {\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#createOrderButton\").text(\"Create Order\");\n								}\n								else {\n									$(\"#createOrderButton\").text(\"Create Order\");\n									$(\"#createOrderButton\").attr(\"disabled\", false);\n									$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n									$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n								}											}\n						})\n						.fail(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n						})\n						.error(function(data) {\n							$(\"#createOrderButton\").text(\"Create Order\");\n							$(\"#createOrderButton\").attr(\"disabled\", false);							$(\"#worksheet-footer\").html(\"Error!\");\n						})\n\n	}\n\n	function cancelOrder() {\n			$.post( \"/orders/ajax/cancel/{$worksheet.id}\"+ \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Cancelling Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				if (response.error) {\n					$(\"#createOrderButton\").text(\"Cancelling Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);				}\n				else {\n					if (response.cancelled) {\n						$(\"#cancelledStamp\").html(response.timestamp);\n						$(\"#isCancelled\").show();\n					}\n					else {\n						$(\"#createOrderButton\").text(\"Create Order\");\n						$(\"#createOrderButton\").attr(\"disabled\", false);\n						$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n						$(\"#worksheet-footer\").html(\"Unable to cancel order at this time.\");\n					}\n				}\n				\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Not Saved.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Error!\");\n			})\n\n	}\n\n	function confirmSend(worksheetID, orderID, orderKey) {\n			$.post( \"/orders/ajax/send/{$worksheet.id}/\" + orderID + \"/\" + orderKey + \"?PHPSESSID={$sessionID}\", $(\"#orderForm\").serialize(), function() {\n				$(\"#worksheet-footer\").html(\"Sending Order...\");\n			})\n 			.done(function(data) {\n			        var response = $.parseJSON(data);\n				$(\"#worksheet-footer\").html(response.message);\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);\n				$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n				if (response.content) {\n					sendBox(worksheetID, orderID, orderKey, response.content);\n				}		\n			})\n			.fail(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Connection Failed! Nothing Sent.\");\n			})\n			.error(function(data) {\n				$(\"#createOrderButton\").text(\"Create Order\");\n				$(\"#createOrderButton\").attr(\"disabled\", false);				$(\"#worksheet-footer\").html(\"Unable to send order at this time.\");\n			})\n\n	}\n\n	function cancelBox(worksheetID) {\n			 \n		  	bootbox.confirm(\'<h4>Cancel Order?</h4>\', function(response) {\n				if (response) {\n					cancelOrder();									}\n				else {\n					$(\"#worksheet-footer\").html(\"Order Not Cancelled.\");\n				}\n			});\n  	}\n\n	function checkRevision() {\n\nbootbox.dialog({\n  message: \'<h4>This worksheet was previously ordered.<br>Do you want to set a new revision #?</h4>\',\n  title: \"Change Revision?\",\n  buttons: {\n    success: {\n      label: \"No\",\n      className: \"btn-danger\",\n      callback: function() {\n		saveOrder();\n      }\n    },\n    main: {\n      label: \"Yes\",\n      className: \"btn-success\",\n      callback: function() {\n		// increase revision #\n		var revNum = $(\"#revisionNumber\").val();\n		console.log(\"Rev # \" + revNum);\n		var newRevNum = parseInt(revNum) + 1;\n		console.log(\"New Rev # \" + newRevNum);\n		$(\"#revisionNumber\").val(newRevNum);\n		saveOrder();\n      }\n    }\n  }\n});\n			 \n\n  	}\n\n	function sendBox(worksheetID, orderID, orderKey, message) {\n			 \n		  	bootbox.confirm(\'<h4>Send Order?</h4> \' + message, function(response) {\n				if (response) {\n					deliverOrder(worksheetID, orderID, orderKey);\n				}\n				else {\n					$(\"#createOrderButton\").text(\"Create Order\");\n					$(\"#createOrderButton\").attr(\"disabled\", false);\n					$(\"#createOrderButtonDropDown\").attr(\"disabled\", false);\n					$(\"#worksheet-footer\").html(\"Send Order Cancelled.\");\n				}\n			});\n  	}\n\n	function goToPage(pageNum) {\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n	\n		dt.page(pageNum).draw(false);\n\n		console.log(\"GoToPage: \" + pageNum);\n	}\n\n	function currentPage() {\n\n		var dt = $(\'#worksheet-{$worksheet.id}\').DataTable();\n\n		console.log(\"Current Page: \" + dt.page());\n\n		return dt.page();\n\n	}\n\n	function rememberPage() {\n		\n		remember = true;\n		pageNumber = currentPage();\n		console.log(\"Remember Page: \" + pageNumber);\n		if (remember) {\n			goToPage(pageNumber);\n			return pageNumber;\n		}\n		return false;\n	}\n\n	</script>\n\n		\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(102,0,'admin-subscriptions','2015-03-06 01:29:19','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li>Admin</li>\n			<li class=\"active\">Agencies</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n\n							<div class=\"main-header\">\n								<h2>Subscriptions</h2>\n								<em>All Subscribers</em>\n							</div>\n\n								<div class=\"widget widget-table\">\n									<div class=\"widget-header\">\n										<h3><i class=\"fa fa-building-o\"></i> Customers</h3>\n										<em>- <a href=\"/admin/agency/create\">Add A New Agency</a> or Search Existing</em>\n									</div>\n									<div class=\"widget-content\">\n										<table class=\"table table-sorting table-striped table-hover datatable\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n											<thead>\n												<tr>\n													<th>ID</th>\n													<th>Customer</th>\n													<th>Description</th>\n				\n	<th>Rate</th>\n													<th>Term</th>\n													<th>Expires</th>\n\n	<th>Status</th>\n\n	<th></th>\n												</tr>\n											</thead>\n											<tbody>\n\n{foreach $subscribers as $subscriber}\n												<tr>\n													<td><a href=\"/admin/agency/edit/{$subscriber.id}\">{$subscriber.subscriptionID}</a></td>\n													<td>{$subscriber.customerName|truncate:30}</td>\n													<td>{$subscriber.description|truncate:30}</td>\n													<td>{$subscriber.rate}</td>\n													<td>{$subscriber.term}{$subscriber.periodLetter}</td>\n													<td>{$subscriber.expirationDate}</td>\n\n	<td>{$subscriber.status}</td>\n\n	<td><center><a href=\"/admin/subscription/edit/{$subscriber.id}\"><i class=\"fa fa-pencil fa-lg\" ></i></a></center></td>\n	\n												</tr>\n{/foreach}\n												</tbody>\n										</table>\n									</div>\n								</div>\n\n{/block}\n\n{block name=\"footer-js\"}\n\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/datatable/jquery.dataTables.bootstrap.js\"></script>\n\n\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(103,0,'invoices','2014-05-13 11:27:17','','{extends file=\"db:kingboard-framework\"}\n\n{block name=\"header-js\"}\n\n\n{/block}\n\n{block name=\"header-css\"}\n\n{/block}\n\n{block name=\"sidebar-clicked\"} {/block}\n\n{block name=\"breadcrumb\"}\n		<ul class=\"breadcrumb\">\n			<li><i class=\"fa fa-home\"></i><a href=\"home\">Home</a>\n			</li>\n			<li class=\"active\">Invoices</li>\n			</ul>\n{/block}\n\n{block name=\"main\"}\n							<div class=\"main-header\">\n								<h2>Invoices</h2>\n								<em>Invoice Workflow and Post Buy Analysis</em>\n							</div>\n\n	This feature is currently in development\n\n{/block}\n\n{block name=\"footer-js\"}\n\n\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-switch.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/jquery.masked-input.min.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/bootstrap-multiselect.js\"></script>\n	<script type=\"text/javascript\" src=\"js/bluhorn-client.js\"></script>\n	<script type=\"text/javascript\" src=\"assets/js/parsley.min.js\"></script>\n\n	<script>\n\n		$(document).ready(function(){\n	\n			$(\'#phone\').mask(\'(999) 999-9999\');\n\n		});\n\n	</script>\n\n{/block}','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(104,0,'MAIL_SIGNUP','2015-04-13 13:16:05','','{literal}\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta name=\"viewport\" content=\"width=device-width\" />\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n<title>Really Simple HTML Email Template</title>\n<style>\n/* -------------------------------------\n		GLOBAL\n------------------------------------- */\n* {\n	margin: 0;\n	padding: 0;\n	font-family: \"Helvetica Neue\", \"Helvetica\", Helvetica, Arial, sans-serif;\n	font-size: 100%;\n	line-height: 1.6;\n}\n\nimg {\n	max-width: 100%;\n}\n\nbody {\n	-webkit-font-smoothing: antialiased;\n	-webkit-text-size-adjust: none;\n	width: 100%!important;\n	height: 100%;\n}\n\n\n/* -------------------------------------\n		ELEMENTS\n------------------------------------- */\na {\n	color: #348eda;\n}\n\n.btn-primary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #348eda;\n	border: solid #348eda;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.btn-secondary {\n	text-decoration: none;\n	color: #FFF;\n	background-color: #aaa;\n	border: solid #aaa;\n	border-width: 10px 20px;\n	line-height: 2;\n	font-weight: bold;\n	margin-right: 10px;\n	text-align: center;\n	cursor: pointer;\n	display: inline-block;\n	border-radius: 25px;\n}\n\n.last {\n	margin-bottom: 0;\n}\n\n.first {\n	margin-top: 0;\n}\n\n.padding {\n	padding: 10px 0;\n}\n\n\n/* -------------------------------------\n		BODY\n------------------------------------- */\ntable.body-wrap {\n	width: 100%;\n	padding: 20px;\n}\n\ntable.body-wrap .container {\n	border: 1px solid #f0f0f0;\n}\n\n\n/* -------------------------------------\n		FOOTER\n------------------------------------- */\ntable.footer-wrap {\n	width: 100%;	\n	clear: both!important;\n}\n\n.footer-wrap .container p {\n	font-size: 12px;\n	color: #666;\n\n}\n\ntable.footer-wrap a {\n	color: #999;\n}\n\n\n/* -------------------------------------\n		TYPOGRAPHY\n------------------------------------- */\nh1, h2, h3 {\n	font-family: \"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif;\n	line-height: 1.1;\n	margin-bottom: 15px;\n	color: #000;\n	margin: 40px 0 10px;\n	line-height: 1.2;\n	font-weight: 200;\n}\n\nh1 {\n	font-size: 36px;\n}\nh2 {\n	font-size: 28px;\n}\nh3 {\n	font-size: 22px;\n}\n\np, ul, ol {\n	margin-bottom: 10px;\n	font-weight: normal;\n	font-size: 14px;\n}\n\nul li, ol li {\n	margin-left: 5px;\n	list-style-position: inside;\n}\n\n/* ---------------------------------------------------\n		RESPONSIVENESS\n		Nuke it from orbit. It\'s the only way to be sure.\n------------------------------------------------------ */\n\n/* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\n.container {\n	display: block!important;\n	max-width: 600px!important;\n	margin: 0 auto!important; /* makes it centered */\n	clear: both!important;\n}\n\n/* Set the padding on the td rather than the div for Outlook compatibility */\n.body-wrap .container {\n	padding: 20px;\n}\n\n/* This should also be a block element, so that it will fill 100% of the .container */\n.content {\n	max-width: 600px;\n	margin: 0 auto;\n	display: block;\n}\n\n/* Let\'s make sure tables in the content area are 100% wide */\n.content table {\n	width: 100%;\n}\n\n</style>\n</head>\n\n<body bgcolor=\"#f6f6f6\">\n{/literal}\n<!-- body -->\n<table class=\"body-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\" bgcolor=\"#FFFFFF\">\n\n			<!-- content -->\n			<div class=\"content\">\n			<table>\n				<tr>\n					<td>\n						<p>Marie,</p>\n						<p>A new user has signed up for BluHorn!</p>\n						<h2>{$email.firstName} {$email.lastName} of {$email.customerName}</h2>\n						<h3>Phone #: {$email.phoneNumber}</h3>\n						<h3>Email Address: {$email.emailAddress}</h3>\n					</td>\n				</tr>\n			</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /body -->\n\n<!-- footer -->\n<table class=\"footer-wrap\">\n	<tr>\n		<td></td>\n		<td class=\"container\">\n\n			<!-- content -->\n			<div class=\"content\">\n				<table>\n					<tr>\n						<td align=\"center\">\n							<p>Don\'t like these annoying emails? <a href=\"#\"><unsubscribe>Unsubscribe</unsubscribe></a>.\n							</p>\n						</td>\n					</tr>\n				</table>\n			</div>\n			<!-- /content -->\n\n		</td>\n		<td></td>\n	</tr>\n</table>\n<!-- /footer -->\n\n</body>\n</html>\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0),(105,0,'full-calendar','2015-05-06 21:03:58','','\r\n\r\n    <!-- Calendar -->\r\n								<!-- WIDGET MAIN CHART WITH TABBED CONTENT -->\r\n\r\n										<!-- WIDGET TABLE -->\r\n										<div class=\"widget widget-table\">\r\n											<div class=\"widget-header\">\r\n												<h3><i class=\"fa fa-rocket\"></i>Campaigns</h3>\r\n												<div class=\"btn-group widget-header-toolbar\">\r\n													<a href=\"#\" title=\"Focus\" class=\"btn-borderless btn-focus\"><i class=\"fa fa-eye\"></i></a>\r\n													<a href=\"#\" title=\"Expand/Collapse\" class=\"btn-borderless btn-toggle-expand\"><i class=\"fa fa-chevron-up\"></i></a>\r\n													<a href=\"#\" title=\"Remove\" class=\"btn-borderless btn-remove\"><i class=\"fa fa-times\"></i></a>\r\n												</div>\r\n												<div class=\"btn-group widget-header-toolbar\">\r\n											\r\n												</div>\r\n											</div>\r\n											<div class=\"widget-content\">\r\n												<div id=\'calendar\'></div>\r\n											</div>\r\n										</div>\r\n										<!-- END WIDGET TABLE -->\r\n\r\n<!-- END Calendar -->\r\n    \r\n    \r\n    \r\n  <style>\r\n#calendar {\r\n		margin: 0 auto;\r\n	}\r\n</style> \r\n    \r\n\r\n','',NULL,NULL,1.0,'ace','','','0000-00-00 00:00:00','0000-00-00 00:00:00',0,0,0);
/*!40000 ALTER TABLE `FLX_TEMPLATE` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2015-05-06 23:31:03
